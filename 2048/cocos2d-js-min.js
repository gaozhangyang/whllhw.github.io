!(function(t,e,i){function n(i,s){var o=e[i];if(!o){var a=t[i];if(!a){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(r)return r(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var l={};o=e[i]={exports:l},a[0]((function(t){return n(a[1][t]||t)}),o,l)}return o.exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n})({1:[(function(t,e,i){cc._tmp="cc._tmp||{},cc._LogInfos=cc._LogInfos||{};var" n;n="1.5.1" ,window.cocosengine="cc.ENGINE_VERSION=n,cc._drawingUtil=null,cc._renderContext=null,cc._supportRender=!1,cc._canvas=null,cc.container=null,cc._gameDiv=null,t("./cocos2d/core/utils"),t("./cocos2d/core/platform/CCSys"),(function(){function" t(t){var="" e="cc.game.CONFIG_KEY,i=parseInt(t[e.renderMode])||0;(isNaN(i)||i">2||i<0)&&(t[e.rendermode]=0),cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!1,0===i?cc.sys.capabilities.opengl?(cc._rendertype=cc.game.render_type_webgl,cc._supportrender=!0):cc.sys.capabilities.canvas&&(cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!0):1===i&&cc.sys.capabilities.canvas?(cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!0):2===i&&cc.sys.capabilities.opengl&&(cc._rendertype=cc.game.render_type_webgl,cc._supportrender=!0)}function e(t,i,n){if(s[i])return="" null;n="n||"";var" r="[],o=t[i];if(!o)throw" new="" error("can="" not="" find="" module="" ["+i+"]");for(var="" a="cc.path,c=0,h=o.length;c<h;c++){var" l="o[c];if(!s[l]){var" u="a.extname(l);if(u)".js"===u.toLowerCase()&&r.push(a.join(n,l));else{var" _="e(t,l,n);_&&(r=r.concat(_))}s[l]=1}}return" r}function="" i(){cc._engineloaded="!0,console.log(cc.ENGINE_VERSION),a&&a()}function" n(t){var="" n="cc.game.CONFIG_KEY,r=t[n.engineDir],s=cc.loader;if(cc._Class)i();else{var" o="cc.path.join(r,"moduleConfig.json");s.load(o,(function(n,o){if(n)throw" error(n);var="" error(json.stringify(t));i()}))}))}}function="" r(){window.removeeventlistener("load",r,!1),n(cc.game.config)}var="" s="{},o=!1,a=null;cc._engineLoaded=!1,cc.initEngine=function(e,i){if(o){var" void(a="function(){s&&s(),i&&i()})}a=i,!cc.game.config&&e?cc.game.config=e:cc.game.config||cc.game._loadConfig(),e=cc.game.config,t(e),document.body?n(e):window.addEventListener("load",r,!1),o=!0}})()}),{"./cocos2d/core/platform/CCSys":182,"./cocos2d/core/utils":222}],2:[(function(t,e,i){function" n(t,e){return="" function(i){"use="" strict";if(1="==arguments.length)return" void="" t(e+"="" "+i+",="" please="" go="" to="" "+s+"#"+i+"="" see="" details.");var="" ;2="==arguments.length?n="Arguments:" "+arguments[1]:arguments.length="">2&&(n="Arguments: "+cc.js.shiftArguments.apply(null,arguments).join(", ")),t(e+" "+i+", please go to "+s+"#"+i+" to see details. "+n)}}cc._logToWebPage=function(t){if(cc._canvas){var e=cc._logList,i=document;if(!e){var n=i.createElement("Div"),r=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),r.zIndex="99999",r.position="absolute",r.top="0",r.left="0",e=cc._logList=i.createElement("textarea");var s=e.style;e.setAttribute("rows","20"),e.setAttribute("cols","30"),e.setAttribute("disabled",!0),n.appendChild(e),s.backgroundColor="transparent",s.borderBottom="1px solid #cccccc",s.borderRightWidth="0px",s.borderLeftWidth="0px",s.borderTopWidth="0px",s.borderTopStyle="none",s.borderRightStyle="none",s.borderLeftStyle="none",s.padding="0px",s.margin=0}e.value=e.value+t+"\r\n",e.scrollTop=e.scrollHeight}};var r=t("./cocos2d/core/platform/CCEnum");cc.DebugMode=r({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});cc.log||console.log;cc._initDebugSetting=function(t){if(cc.log=cc.logID=cc.warn=cc.warnID=cc.error=cc.errorID=cc._throw=cc.assert=cc.assertID=function(){},t!==cc.DebugMode.NONE){var e;t>cc.DebugMode.ERROR?(e=cc._logToWebPage.bind(cc),cc.error=function(){e("ERROR :  "+cc.js.formatStr.apply(null,arguments))},cc.assert=function(t,i){"use strict";!t&&i&&(i=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments)),e("ASSERT: "+i))},t!==cc.DebugMode.ERROR_FOR_WEB_PAGE&&(cc.warn=function(){e("WARN :  "+cc.js.formatStr.apply(null,arguments))}),t===cc.DebugMode.INFO_FOR_WEB_PAGE&&(cc.log=cc.info=function(){e(cc.js.formatStr.apply(null,arguments))})):console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(t,e){if(!t)throw e&&(e=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),new Error(e)}),t!==cc.DebugMode.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,arguments)}),t===cc.DebugMode.INFO&&(console.log.bind?cc.log=console.log.bind(console):cc.log=function(){return console.log.apply(console,arguments)},cc.info=function(){(console.info||console.log).apply(console,arguments)}),cc.warnID=n(cc.warn,"Warning"),cc.errorID=n(cc.error,"Error"),cc.logID=n(cc.log,"Log");var i=n((function(){for(var t=[!1],e=0;e<arguments.length;++e)t.push(arguments[e]);cc.assert.apply(null,t)}),"assert");cc.assertid=function(t){"use strict";t||i.apply(null,cc.js.shiftarguments.apply(null,arguments))}}},cc._throw="function(t){var" e="t.stack;e?cc.error(e):cc.error(t)};var" s="https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md" }),{".="" cocos2d="" core="" platform="" ccenum":175}],3:[(function(t,e,i){}),{}],4:[(function(t,e,i){cc.action="cc._Class.extend({ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var" t="new" cc.action;return="" t.originaltarget="null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.logID(1006)},update:function(t){cc.logID(1007)},getTarget:function(){return" this.target},settarget:function(t){this.target="t},getOriginalTarget:function(){return" this.originaltarget},setoriginaltarget:function(t){this.originaltarget="t},getTag:function(){return" this.tag},settag:function(t){this.tag="t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return" this._duration*(this._timesforrepeat||1)},setduration:function(t){this._duration="t},reverse:function(){return" cc.logid(1008),null},clone:function(){return="" new="" cc.finitetimeaction}}),cc.speed="cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return" this._speed},setspeed:function(t){this._speed="t},initWithAction:function(t,e){if(!t)throw" error("cc.speed.initwithaction():="" action="" must="" be="" non="" nil");return="" this._inneraction="t,this._speed=e,!0},clone:function(){var" cc.speed;return="" t.initwithaction(this._inneraction.clone(),this._speed),t},startwithtarget:function(t){cc.action.prototype.startwithtarget.call(this,t),this._inneraction.startwithtarget(t)},stop:function(){this._inneraction.stop(),cc.action.prototype.stop.call(this)},step:function(t){this._inneraction.step(t*this._speed)},isdone:function(){return="" this._inneraction.isdone()},reverse:function(){return="" cc.speed(this._inneraction.reverse(),this._speed)},setinneraction:function(t){this._inneraction!="=t&&(this._innerAction=t)},getInnerAction:function(){return" this._inneraction}}),cc.speed="function(t,e){return" cc.speed(t,e)},cc.follow="cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var" cc.follow,e="this._worldRect,i=new" cc.rect(e.x,e.y,e.width,e.height);return="" t.initwithtarget(this._followednode,i),t},isboundaryset:function(){return="" this._boundaryset},setboudaryset:function(t){this._boundaryset="t},initWithTarget:function(t,e){if(!t)throw" error("cc.follow.initwithaction():="" followednode="" nil");var="" i="this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var" n="cc.director.getWinSize();return" i._fullscreensize="cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var" this.target.setposition(r.x,r.y)},isdone:function(){return!this._followednode.isrunning()},stop:function(){this.target="null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return" cc.follow(t,e)}}),{}],5:[(function(t,e,i){function="" n(t){for(var="">=0;i--)e.push(cc.p(t[i].x,t[i].y));return e}function r(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return 0="==t?0:Math.pow(2,10*(t-1))},reverse:function(){return" 1="==t?1:-Math.pow(2,-10*t)+1},reverse:function(){return" e}cc.cardinalsplineat="function(t,e,i,n,r,s){var" o="s*s,a=o*s,c=(1-r)/2,h=c*(-a+2*o-s),l=c*(-a+o)+(2*a-3*o+1),u=c*(a-2*o+s)+(-2*a+3*o),_=c*(a-o),d=t.x*h+e.x*l+i.x*u+n.x*_,f=t.y*h+e.y*l+i.y*u+n.y*_;return" cc.p(d,f)},cc.getcontrolpointat="function(t,e){var" i="Math.min(t.length-1,Math.max(e,0));return" t[i]},cc.cardinalsplineto="cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void" 0!="=i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(!e||0===e.length)throw" new="" error("invalid="" configuration.="" it="" must="" at="" least="" have="" one="" control="" point");return!!cc.actioninterval.prototype.initwithduration.call(this,t)&&(this.setpoints(e),this._tension="i,!0)},clone:function(){var" t="new" cc.cardinalsplineto;return="" t.initwithduration(this._duration,r(this._points),this._tension),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._deltat="1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var" e,i,n="this._points;if(1===t)e=n.length-1,i=1;else{var" r="this._deltaT;e=0|t/r,i=(t-r*e)/r}var" s="cc.cardinalSplineAt(cc.getControlPointAt(n,e-1),cc.getControlPointAt(n,e-0),cc.getControlPointAt(n,e+1),cc.getControlPointAt(n,e+2),this._tension,i);if(cc.macro.ENABLE_STACKABLE_ACTIONS){var" o,a;if(o="this.target.getPositionX()-this._previousPosition.x,a=this.target.getPositionY()-this._previousPosition.y,0!==o||0!==a){var" c="this._accumulatedDiff;o=c.x+o,a=c.y+a,c.x=o,c.y=a,s.x+=o,s.y+=a}}this.updatePosition(s)},reverse:function(){var" cc.cardinalsplineto(this._duration,t,this._tension)},updateposition:function(t){this.target.setposition(t),this._previousposition="t},getPoints:function(){return" this._points},setpoints:function(t){this._points="t}}),cc.cardinalSplineTo=function(t,e,i){return" cc.cardinalsplineto(t,e,i)},cc.cardinalsplineby="cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void" t,e="this._points.slice(),i=e[0],r=1;r<e.length;++r)t=e[r],e[r]=cc.pSub(t,i),i=t;var" cc.cardinalsplineby(this._duration,s,this._tension)},updateposition:function(t){var="" e="this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var" cc.cardinalsplineby;return="" t.initwithduration(this._duration,r(this._points),this._tension),t}}),cc.cardinalsplineby="function(t,e,i){return" cc.cardinalsplineby(t,e,i)},cc.catmullromto="cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return" cc.cardinalsplineto.prototype.initwithduration.call(this,t,e,.5)},clone:function(){var="" cc.catmullromto;return="" t.initwithduration(this._duration,r(this._points)),t}}),cc.catmullromto="function(t,e){return" cc.catmullromto(t,e)},cc.catmullromby="cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return" cc.catmullromby;return="" t.initwithduration(this._duration,r(this._points)),t}}),cc.catmullromby="function(t,e){return" cc.catmullromby(t,e)}}),{}],6:[(function(t,e,i){cc.actionease="cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw" error("cc.actionease.initwithaction():="" action="" be="" non="" nil");return!!this.initwithduration(t.getduration())&&(this._inner="t,!0)},clone:function(){var" cc.actionease;return="" t.initwithaction(this._inner.clone()),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._inner.startwithtarget(this.target)},stop:function(){this._inner.stop(),cc.actioninterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return="" cc.actionease(this._inner.reverse())},getinneraction:function(){return="" this._inner}}),cc.actionease="function(t){return" cc.actionease(t)},cc.easerateaction="cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void" this._rate},initwithaction:function(t,e){return!!cc.actionease.prototype.initwithaction.call(this,t)&&(this._rate="e,!0)},clone:function(){var" cc.easerateaction;return="" t.initwithaction(this._inner.clone(),this._rate),t},reverse:function(){return="" cc.easerateaction(this._inner.reverse(),1="" this._rate)}}),cc.easerateaction="function(t,e){return" cc.easerateaction(t,e)},cc.easein="cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return" cc.easein(this._inner.reverse(),1="" this._rate)},clone:function(){var="" cc.easein;return="" t.initwithaction(this._inner.clone(),this._rate),t}}),cc.easein="function(t){return{_rate:t,easing:function(t){return" math.pow(t,this._rate)},reverse:function(){return="" cc.easein(1="" this._rate)}}},cc.easeout="cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return" cc.easeout(this._inner.reverse(),1="" cc.easeout;return="" t.initwithaction(this._inner.clone(),this._rate),t}}),cc.easeout="function(t){return{_rate:t,easing:function(t){return" math.pow(t,1="" this._rate)},reverse:function(){return="" cc.easeout(1="" this._rate)}}},cc.easeinout="cc.EaseRateAction.extend({update:function(t){t*=2,t<1?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var" cc.easeinout;return="" cc.easeinout(this._inner.reverse(),this._rate)}}),cc.easeinout="function(t){return{_rate:t,easing:function(t){return" t*="2,t<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return" cc.easeinout(this._rate)}}},cc.easeexponentialin="cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return" cc.easeexponentialout(this._inner.reverse())},clone:function(){var="" cc.easeexponentialin;return="" t.initwithaction(this._inner.clone()),t}}),cc._easeexponentialinobj="{easing:function(t){return" cc._easeexponentialoutobj}},cc.easeexponentialin="function(){return" cc._easeexponentialinobj},cc.easeexponentialout="cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:-Math.pow(2,-10*t)+1)},reverse:function(){return" cc.easeexponentialin(this._inner.reverse())},clone:function(){var="" cc.easeexponentialout;return="" t.initwithaction(this._inner.clone()),t}}),cc._easeexponentialoutobj="{easing:function(t){return" cc._easeexponentialinobj}},cc.easeexponentialout="function(){return" cc._easeexponentialoutobj},cc.easeexponentialinout="cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t*=2,t=t<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)),this._inner.update(t)},reverse:function(){return" cc.easeexponentialinout(this._inner.reverse())},clone:function(){var="" cc.easeexponentialinout;return="" t.initwithaction(this._inner.clone()),t}}),cc._easeexponentialinoutobj="{easing:function(t){return" 1!="=t&&0!==t?(t*=2,t<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)):t},reverse:function(){return" cc._easeexponentialinoutobj}},cc.easeexponentialinout="function(){return" cc._easeexponentialinoutobj},cc.easesinein="cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return" cc.easesineout(this._inner.reverse())},clone:function(){var="" cc.easesinein;return="" t.initwithaction(this._inner.clone()),t}}),cc._easesineinobj="{easing:function(t){return" cc._easesineoutobj}},cc.easesinein="function(){return" cc._easesineinobj},cc.easesineout="cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return" cc.easesinein(this._inner.reverse())},clone:function(){var="" cc.easesineout;return="" t.initwithaction(this._inner.clone()),t}}),cc._easesineoutobj="{easing:function(t){return" cc._easesineinobj}},cc.easesineout="function(){return" cc._easesineoutobj},cc.easesineinout="cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var" cc.easesineinout;return="" t.initwithaction(this._inner.clone()),t},reverse:function(){return="" cc.easesineinout(this._inner.reverse())}}),cc._easesineinoutobj="{easing:function(t){return" cc._easesineinoutobj}},cc.easesineinout="function(){return" cc._easesineinoutobj},cc.easeelastic="cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return" this._period},setperiod:function(t){this._period="t},initWithAction:function(t,e){return" cc.actionease.prototype.initwithaction.call(this,t),this._period="null==e?.3:e,!0},reverse:function(){return" cc.logid(1009),null},clone:function(){var="" cc.easeelastic;return="" t.initwithaction(this._inner.clone(),this._period),t}}),cc.easeelasticin="cc.EaseElastic.extend({update:function(t){var" cc.easeelasticout(this._inner.reverse(),this._period)},clone:function(){var="" cc.easeelasticin;return="" t.initwithaction(this._inner.clone(),this._period),t}}),cc._easeelasticinobj="{easing:function(t){return" cc._easeelasticoutobj}},cc.easeelasticin="function(t){return" t&&.3!="=t?{_period:t,easing:function(t){return" cc.easeelasticout(this._period)}}:cc._easeelasticinobj},cc.easeelasticout="cc.EaseElastic.extend({update:function(t){var" cc.easeelasticin(this._inner.reverse(),this._period)},clone:function(){var="" cc.easeelasticout;return="" t.initwithaction(this._inner.clone(),this._period),t}}),cc._easeelasticoutobj="{easing:function(t){return" cc._easeelasticinobj}},cc.easeelasticout="function(t){return" cc.easeelasticin(this._period)}}:cc._easeelasticoutobj},cc.easeelasticinout="cc.EaseElastic.extend({update:function(t){var" n="i/4;t-=1,e=t<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return" cc.easeelasticinout(this._inner.reverse(),this._period)},clone:function(){var="" cc.easeelasticinout;return="" t.initwithaction(this._inner.clone(),this._period),t}}),cc.easeelasticinout="function(t){return" e},reverse:function(){return="" cc.easeelasticinout(this._period)}}},cc.easebounce="cc.ActionEase.extend({bounceTime:function(t){return" t<1="" 2.75?7.5625*t*t:t<2="" 2.75?(t-="1.5/2.75,7.5625*t*t+.75):t<2.5/2.75?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},clone:function(){var" cc.easebounce;return="" cc.easebounce(this._inner.reverse())}}),cc.easebouncein="cc.EaseBounce.extend({update:function(t){var" cc.easebounceout(this._inner.reverse())},clone:function(){var="" cc.easebouncein;return="" t.initwithaction(this._inner.clone()),t}}),cc._bouncetime="function(t){return" 1-cc._bouncetime(1-t)},reverse:function(){return="" cc._easebounceoutobj}},cc.easebouncein="function(){return" cc._easebounceinobj},cc.easebounceout="cc.EaseBounce.extend({update:function(t){var" cc.easebouncein(this._inner.reverse())},clone:function(){var="" cc.easebounceout;return="" t.initwithaction(this._inner.clone()),t}}),cc._easebounceoutobj="{easing:function(t){return" cc._bouncetime(t)},reverse:function(){return="" cc._easebounceinobj}},cc.easebounceout="function(){return" cc._easebounceoutobj},cc.easebounceinout="cc.EaseBounce.extend({update:function(t){var" cc.easebounceinout;return="" cc.easebounceinout(this._inner.reverse())}}),cc._easebounceinoutobj="{easing:function(t){var" e;return="" t<.5?(t*="2,e=.5*(1-cc._bounceTime(1-t))):e=.5*cc._bounceTime(2*t-1)+.5,e},reverse:function(){return" cc._easebounceinoutobj}},cc.easebounceinout="function(){return" cc._easebounceinoutobj},cc.easebackin="cc.ActionEase.extend({update:function(t){var" cc.easebackout(this._inner.reverse())},clone:function(){var="" cc.easebackin;return="" t.initwithaction(this._inner.clone()),t}}),cc._easebackinobj="{easing:function(t){var" cc._easebackoutobj}},cc.easebackin="function(){return" cc._easebackinobj},cc.easebackout="cc.ActionEase.extend({update:function(t){var" cc.easebackin(this._inner.reverse())},clone:function(){var="" cc.easebackout;return="" t.initwithaction(this._inner.clone()),t}}),cc._easebackoutobj="{easing:function(t){var" t-="1,t*t*((e+1)*t+e)+1},reverse:function(){return" cc._easebackinobj}},cc.easebackout="function(){return" cc._easebackoutobj},cc.easebackinout="cc.ActionEase.extend({update:function(t){var" cc.easebackinout;return="" cc.easebackinout(this._inner.reverse())}}),cc._easebackinoutobj="{easing:function(t){var" cc._easebackinoutobj}},cc.easebackinout="function(){return" cc._easebackinoutobj},cc.easebezieraction="cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,r){return" math.pow(1-r,3)*t+3*r*math.pow(1-r,2)*e+3*math.pow(r,2)*(1-r)*i+math.pow(r,3)*n},update:function(t){var="" cc.easebezieraction;return="" t.initwithaction(this._inner.clone()),t.setbezierparamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var="" cc.easebezieraction(this._inner.reverse());return="" t.setbezierparamer(this._p3,this._p2,this._p1,this._p0),t},setbezierparamer:function(t,e,i,n){this._p0="t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.easeBezierAction=function(t,e,i,n){return{easing:function(r){return" cc.easebezieraction.prototype._updatetime(t,e,i,n,r)},reverse:function(){return="" cc.easebezieraction(n,i,e,t)}}},cc.easequadraticactionin="cc.ActionEase.extend({_updateTime:function(t){return" math.pow(t,2)},update:function(t){this._inner.update(this._updatetime(t))},clone:function(){var="" cc.easequadraticactionin;return="" cc.easequadraticactionin(this._inner.reverse())}}),cc._easequadraticactionin="{easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return" cc._easequadraticactionin}},cc.easequadraticactionin="function(){return" cc._easequadraticactionin},cc.easequadraticactionout="cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var" cc.easequadraticactionout;return="" t.initwithaction(),t},reverse:function(){return="" cc.easequadraticactionout(this._inner.reverse())}}),cc._easequadraticactionout="{easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return" cc._easequadraticactionout}},cc.easequadraticactionout="function(){return" cc._easequadraticactionout},cc.easequadraticactioninout="cc.ActionEase.extend({_updateTime:function(t){var" cc.easequadraticactioninout;return="" cc.easequadraticactioninout(this._inner.reverse())}}),cc._easequadraticactioninout="{easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return" cc._easequadraticactioninout}},cc.easequadraticactioninout="function(){return" cc._easequadraticactioninout},cc.easequarticactionin="cc.ActionEase.extend({_updateTime:function(t){return" t*t*t*t},update:function(t){this._inner.update(this._updatetime(t))},clone:function(){var="" cc.easequarticactionin;return="" cc.easequarticactionin(this._inner.reverse())}}),cc._easequarticactionin="{easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return" cc._easequarticactionin}},cc.easequarticactionin="function(){return" cc._easequarticactionin},cc.easequarticactionout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easequarticactionout;return="" cc.easequarticactionout(this._inner.reverse())}}),cc._easequarticactionout="{easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return" cc._easequarticactionout}},cc.easequarticactionout="function(){return" cc._easequarticactionout},cc.easequarticactioninout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easequarticactioninout;return="" cc.easequarticactioninout(this._inner.reverse())}}),cc._easequarticactioninout="{easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return" cc._easequarticactioninout}},cc.easequarticactioninout="function(){return" cc._easequarticactioninout},cc.easequinticactionin="cc.ActionEase.extend({_updateTime:function(t){return" t*t*t*t*t},update:function(t){this._inner.update(this._updatetime(t))},clone:function(){var="" cc.easequinticactionin;return="" cc.easequinticactionin(this._inner.reverse())}}),cc._easequinticactionin="{easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return" cc._easequinticactionin}},cc.easequinticactionin="function(){return" cc._easequinticactionin},cc.easequinticactionout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easequinticactionout;return="" cc.easequinticactionout(this._inner.reverse())}}),cc._easequinticactionout="{easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return" cc._easequinticactionout}},cc.easequinticactionout="function(){return" cc._easequinticactionout},cc.easequinticactioninout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easequinticactioninout;return="" t.initwithaction(this._inner.clone()),="" t},reverse:function(){return="" cc.easequinticactioninout(this._inner.reverse())}}),cc._easequinticactioninout="{easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return" cc._easequinticactioninout}},cc.easequinticactioninout="function(){return" cc._easequinticactioninout},cc.easecircleactionin="cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var" cc.easecircleactionin;return="" cc.easecircleactionin(this._inner.reverse())}}),cc._easecircleactionin="{easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return" cc._easecircleactionin}},cc.easecircleactionin="function(){return" cc._easecircleactionin},cc.easecircleactionout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easecircleactionout;return="" cc.easecircleactionout(this._inner.reverse())}}),cc._easecircleactionout="{easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return" cc._easecircleactionout}},cc.easecircleactionout="function(){return" cc._easecircleactionout},cc.easecircleactioninout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easecircleactioninout;return="" cc.easecircleactioninout(this._inner.reverse())}}),cc._easecircleactioninout="{easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return" cc._easecircleactioninout}},cc.easecircleactioninout="function(){return" cc._easecircleactioninout},cc.easecubicactionin="cc.ActionEase.extend({_updateTime:function(t){return" t*t*t},update:function(t){this._inner.update(this._updatetime(t))},clone:function(){var="" cc.easecubicactionin;return="" cc.easecubicactionin(this._inner.reverse())}}),cc._easecubicactionin="{easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return" cc._easecubicactionin}},cc.easecubicactionin="function(){return" cc._easecubicactionin},cc.easecubicactionout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easecubicactionout;return="" cc.easecubicactionout(this._inner.reverse())}}),cc._easecubicactionout="{easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return" cc._easecubicactionout}},cc.easecubicactionout="function(){return" cc._easecubicactionout},cc.easecubicactioninout="cc.ActionEase.extend({_updateTime:function(t){return" cc.easecubicactioninout;return="" cc.easecubicactioninout(this._inner.reverse())}}),cc._easecubicactioninout="{easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return" cc._easecubicactioninout}},cc.easecubicactioninout="function(){return" cc._easecubicactioninout}}),{}],7:[(function(t,e,i){cc.actioninstant="cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return" this.clone()},clone:function(){return="" cc.actioninstant}}),cc.show="cc.ActionInstant.extend({update:function(t){for(var" cc.hide},clone:function(){return="" cc.show}}),cc.show="function(){return" cc.show},cc.hide="cc.ActionInstant.extend({update:function(t){for(var" cc.show},clone:function(){return="" cc.hide}}),cc.hide="function(){return" cc.hide},cc.togglevisibility="cc.ActionInstant.extend({update:function(t){for(var" cc.togglevisibility},clone:function(){return="" cc.togglevisibility}}),cc.togglevisibility="function(){return" cc.togglevisibility},cc.removeself="cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void" this._isneedcleanup="t,!0},reverse:function(){return" cc.removeself(this._isneedcleanup)},clone:function(){return="" cc.removeself(this._isneedcleanup)}}),cc.removeself="function(t){return" cc.removeself(t)},cc.flipx="cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void" this._flippedx="t,!0},update:function(t){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return" cc.flipx(!this._flippedx)},clone:function(){var="" cc.flipx;return="" t.initwithflipx(this._flippedx),t}}),cc.flipx="function(t){return" cc.flipx(t)},cc.flipy="cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void" this._flippedy="t,!0},update:function(t){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return" cc.flipy(!this._flippedy)},clone:function(){var="" cc.flipy;return="" t.initwithflipy(this._flippedy),t}}),cc.flipy="function(t){return" cc.flipy(t)},cc.place="cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void" this._x="t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var" cc.place;return="" t.initwithposition(this._x,this._y),t}}),cc.place="function(t,e){return" cc.place(t,e)},cc.callfunc="cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return" t&&(this._function="t),e&&(this._selectorTarget=e),void" this._selectortarget},settargetcallback:function(t){t!="=this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var" cc.callfunc;return="" t.initwithfunction(this._function,this._selectortarget,this._data),t}}),cc.callfunc="function(t,e,i){return" cc.callfunc(t,e,i)}}),{}],8:[(function(t,e,i){cc.actioninterval="cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void" this._elapsed},initwithduration:function(t){return="" this._duration="0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return" this._elapsed="">=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easelist.length;e++)t._easelist.push(this._easelist[e].reverse())}},clone:function(){var t="new" cc.actioninterval(this._duration);return="" this._clonedecoration(t),t},easing:function(t){this._easelist?this._easelist.length="0:this._easeList=[];for(var" e="0;e<arguments.length;e++)this._easeList.push(arguments[e]);return" this},_computeeasetime:function(t){var="" t;for(var="" i="0,n=e.length;i<n;i++)t=e[i].easing(t);return" t},step:function(t){this._firsttick?(this._firsttick="!1,this._elapsed=0):this._elapsed+=t;var">1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(t){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(t){return t<=0?(cc.logid(1013),this):(this._speedmethod=!0,this._speed*=t,this)},getspeed:function(){return this._speed},setspeed:function(t){return="" this._speed="t,this},repeat:function(t){return" t="Math.round(t),isNaN(t)||t<1?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return" this._repeatmethod="!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return" new="" cc.actioninterval(t)},cc.sequence="cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var" e="t" instanceof="" array?t:arguments,i="e.length-1;if(i">=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],s=1;s<i;s++)e[s]&&(n=r,r=cc.sequence._actiononetwo(n,e[s]));this.initwithtwoactions(r,e[i])}},initwithtwoactions:function(t,e){if(!t||!e)throw new="" error("cc.sequence.initwithtwoactions():="" arguments="" must="" all="" be="" non="" nil");var="" i="t._duration+e._duration;return" this.initwithduration(i),this._actions[0]="t,this._actions[1]=e,!0},clone:function(){var" t="new" cc.sequence;return="" this._clonedecoration(t),t.initwithtwoactions(this._actions[0].clone(),this._actions[1].clone()),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._split="this._actions[0]._duration/this._duration,this._last=-1},stop:function(){this._last!==-1&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var" e,i,n="0,r=this._split,s=this._actions,o=this._last;t=this._computeEaseTime(t),t<r?(e=0!==r?t/r:1,0===n&&1===o&&(s[1].update(0),s[1].stop())):(n=1,e=1===r?1:(t-r)/(1-r),o===-1&&(s[0].startWithTarget(this.target),s[0].update(1),s[0].stop()),o||(s[0].update(1),s[0].stop())),i=s[n],o===n&&i.isDone()||(o!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e">1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments,i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015);var n=null;if(i>=0){n=e[0];for(var r=1;r<=i;r++)e[r]&&(n=cc.sequence._actiononetwo(n,e[r]))}return n},cc.sequence._actiononetwo="function(t,e){var" i="new" cc.sequence;return="" i.initwithtwoactions(t,e),i},cc.repeat="cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void" 0!="=e&&this.initWithAction(t,e)},initWithAction:function(t,e){var" instanceof="" cc.actioninstant&&(this._actioninstant="!0,this._times-=1),this._total=0,!0)},clone:function(){var" t="new" cc.repeat;return="" this._clonedecoration(t),t.initwithaction(this._inneraction.clone(),this._times),t},startwithtarget:function(t){this._total="0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var" e="this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(t">=r){for(;t>r&&this._total<n;)e.update(1),this._total++,e.stop(),e.startwithtarget(this.target),r+=e._duration i,this._nextdt="r;t">=1&&this._total<n&&(e.update(1),this._total++),this._actioninstant||(this._total===n?e.stop():e.update(t-(r-e._duration i)))}else="" e.update(t*n%1)},isdone:function(){return="" this._total="==this._times},reverse:function(){var" t="new" cc.repeat(this._inneraction.reverse(),this._times);return="" this._clonedecoration(t),this._reverseeaselist(t),t},setinneraction:function(t){this._inneraction!="=t&&(this._innerAction=t)},getInnerAction:function(){return" this._inneraction}}),cc.repeat="function(t,e){return" new="" cc.repeat(t,e)},cc.repeatforever="cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw" error("cc.repeatforever.initwithaction():="" action="" must="" be="" non="" null");return="" this._inneraction="t,!0},clone:function(){var" cc.repeatforever;return="" this._clonedecoration(t),t.initwithaction(this._inneraction.clone()),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._inneraction.startwithtarget(t)},step:function(t){var="" e="this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var" cc.repeatforever(this._inneraction.reverse());return="" this._inneraction}}),cc.repeatforever="function(t){return" cc.repeatforever(t)},cc.spawn="cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var" instanceof="" array?t:arguments,i="e.length-1;if(i">=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],s=1;s<i;s++)e[s]&&(n=r,r=cc.spawn._actiononetwo(n,e[s]));this.initwithtwoactions(r,e[i])}},initwithtwoactions:function(t,e){if(!t||!e)throw new="" error("cc.spawn.initwithtwoactions():="" arguments="" must="" all="" be="" non="" null");var="" i="!1,n=t._duration,r=e._duration;return" this.initwithduration(math.max(n,r))&&(this._one="t,this._two=e,n">r?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-r)):n<r&&(this._one=cc.sequence._actiononetwo(t,cc.delaytime(r-n))),i=!0),i},clone:function(){var t="new" cc.spawn;return="" this._clonedecoration(t),t.initwithtwoactions(this._one.clone(),this._two.clone()),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._one.startwithtarget(t),this._two.startwithtarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.action.prototype.stop.call(this)},update:function(t){t="this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var" this._clonedecoration(t),this._reverseeaselist(t),t}}),cc.spawn="function(t){var" e="t" instanceof="" array?t:arguments;e.length="">0&&null==e[e.length-1]&&cc.logID(1015);for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.spawn._actiononetwo(i,e[n]));return i},cc.spawn._actiononetwo="function(t,e){var" i="new" cc.spawn;return="" i.initwithtwoactions(t,e),i},cc.rotateto="cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void" 0!="=e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngleX=e||0,this._dstAngleY=void" t="new" cc.rotateto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._dstanglex,this._dstangley),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t);var="" e="t.rotationX%360,i=this._dstAngleX-e;i">180&&(i-=360),i<-180&&(i+=360),this._startanglex=e,this._diffanglex=i,this._startangley=t.rotationy%360;var n="this._dstAngleY-this._startAngleY;n">180&&(n-=360),n<-180&&(n+=360),this._diffangley=n},reverse:function(){cc.logid(1016)},update:function(t){t=this._computeeasetime(t),this.target&&(this.target.rotationx=this._startanglex+this._diffanglex*t,this.target.rotationy=this._startangley+this._diffangley*t)}}),cc.rotateto=function(t,e,i){return new="" cc.rotateto(t,e,i)},cc.rotateby="cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void" 0!="=e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._angleX=e||0,this._angleY=void" t="new" cc.rotateby;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._anglex,this._angley),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._startanglex="t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var" cc.rotateby(this._duration,-this._anglex,-this._angley);return="" this._clonedecoration(t),this._reverseeaselist(t),t}}),cc.rotateby="function(t,e,i){return" cc.rotateby(t,e,i)},cc.moveby="cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void" cc.moveby;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._positiondelta),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t);var="" e="t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var" r="this.target.getPositionX(),s=this.target.getPositionY(),o=this._previousPosition;n.x=n.x+r-o.x,n.y=n.y+s-o.y,e+=n.x,i+=n.y,o.x=e,o.y=i,this.target.setPosition(e,i)}else" this.target.setposition(n.x+e,n.y+i)}},reverse:function(){var="" cc.moveby(this._duration,cc.p(-this._positiondelta.x,-this._positiondelta.y));return="" this._clonedecoration(t),this._reverseeaselist(t),t}}),cc.moveby="function(t,e,i){return" cc.moveby(t,e,i)},cc.moveto="cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void" cc.moveto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._endposition),t},startwithtarget:function(t){cc.moveby.prototype.startwithtarget.call(this,t),this._positiondelta.x="this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return" cc.moveto(t,e,i)},cc.skewto="cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void" n="!1;return" cc.actioninterval.prototype.initwithduration.call(this,t)&&(this._endskewx="e,this._endSkewY=i,n=!0),n},clone:function(){var" cc.skewto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._endskewx,this._endskewy),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._startskewx="t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX">180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltax+=360),this._startskewy=t.skewy%360,this._deltay=this._endskewy-this._startskewy,this._deltay>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltay+=360)},update:function(t){t=this._computeeasetime(t),this.target.skewx=this._startskewx+this._deltax*t,this.target.skewy=this._startskewy+this._deltay*t}}),cc.skewto=function(t,e,i){return 0="==r&&(r=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=r,!0)},clone:function(){var" new="" cc.skewto(t,e,i)},cc.skewby="cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void" 0!="=i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var" n="!1;return" cc.skewto.prototype.initwithduration.call(this,t,e,i)&&(this._skewx="e,this._skewY=i,n=!0),n},clone:function(){var" t="new" cc.skewby;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._skewx,this._skewy),t},startwithtarget:function(t){cc.skewto.prototype.startwithtarget.call(this,t),this._deltax="this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var" cc.skewby(this._duration,-this._skewx,-this._skewy);return="" this._clonedecoration(t),this._reverseeaselist(t),t}}),cc.skewby="function(t,e,i){return" cc.skewby(t,e,i)},cc.jumpby="cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,r){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void" cc.jumpby;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._delta,this._height,this._jumps),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t);var="" e="t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var" s="this.target.getPositionX(),o=this.target.getPositionY(),a=this._previousPosition;r.x=r.x+s-a.x,r.y=r.y+o-a.y,n+=r.x,i+=r.y,a.x=n,a.y=i,this.target.setPosition(n,i)}else" this.target.setposition(r.x+n,r.y+i)}},reverse:function(){var="" cc.jumpby(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return="" this._clonedecoration(t),this._reverseeaselist(t),t}}),cc.jumpby="function(t,e,i,n,r){return" cc.jumpby(t,e,i,n,r)},cc.jumpto="cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,r){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void" cc.jumpto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._endposition,this._height,this._jumps),t}}),cc.jumpto="function(t,e,i,n,r){return" cc.jumpto(t,e,i,n,r)},cc.bezierat="function(t,e,i,n,r){return" math.pow(1-r,3)*t+3*r*math.pow(1-r,2)*e+3*math.pow(r,2)*(1-r)*i+math.pow(r,3)*n},cc.bezierby="cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var" cc.bezierby;this._clonedecoration(t);for(var="" t.initwithduration(this._duration,e),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t);var="" d="this.target.getPositionX(),f=this.target.getPositionY(),p=this._previousPosition;_.x=_.x+d-p.x,_.y=_.y+f-p.y,l+=_.x,u+=_.y,p.x=l,p.y=u,this.target.setPosition(l,u)}else" this.target.setposition(_.x+l,_.y+u)}},reverse:function(){var="" cc.bezierby(this._duration,e);return="" this._clonedecoration(i),this._reverseeaselist(i),i}}),cc.bezierby="function(t,e){return" cc.bezierby(t,e)},cc.bezierto="cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var" cc.bezierto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._toconfig),t},startwithtarget:function(t){cc.bezierby.prototype.startwithtarget.call(this,t);var="" cc.bezierto(t,e)},cc.scaleto="cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void" cc.scaleto;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._endscalex,this._endscaley),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._startscalex="t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return" cc.scaleto(t,e,i)},cc.scaleby="cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var" cc.scaleby(this._duration,1="" this._endscalex,1="" this._endscaley);return="" this._clonedecoration(t),this._reverseeaselist(t),t},clone:function(){var="" cc.scaleby;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._endscalex,this._endscaley),t}}),cc.scaleby="function(t,e,i){return" cc.scaleby(t,e,i)},cc.blink="cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void" cc.blink;return="" this._clonedecoration(t),t.initwithduration(this._duration,this._times),t},update:function(t){if(t="this._computeEaseTime(t),this.target&&!this.isDone()){var">e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),e instanceof cc.Color&&(n=e.b,i=e.g,e=e.r),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t));
}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,r=e/t.getTotalDelayUnits(),s=t.getFrames();cc.js.array.verifyType(s,cc.AnimationFrame);for(var o=0;o<s.length;o++){var a="s[o],c=n*r/e;n+=a.getDelayUnits(),i.push(c)}return!0}return!1},clone:function(){var" t="new" cc.animate;return="" this._clonedecoration(t),t.initwithanimation(this._animation.clone()),t},startwithtarget:function(t){cc.actioninterval.prototype.startwithtarget.call(this,t),this._animation.getrestoreoriginalframe()&&(this._origframe="t.getSpriteFrame()),this._nextFrame=0,this._executedLoops=0},update:function(t){if(t=this._computeEaseTime(t),t<1){t*=this._animation.getLoops();var" e="0|t;e">this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1}for(var i=this._animation.getFrames(),n=i.length,r=this._splitTimes,s=this._nextFrame;s<n&&r[s]<=t;s++)_currframeindex=s,this.target.setspriteframe(i[_currframeindex].getspriteframe()),this._nextframe=s+1},reverse:function(){var t="this._animation,e=t.getFrames(),i=[];if(cc.js.array.verifyType(e,cc.AnimationFrame),e.length">0)for(var n=e.length-1;n>=0;n--){var r=e[n];if(!r)break;i.push(r.clone())}var s=new cc.SpriteFrameAnimation(i,t.getDelayPerUnit(),t.getLoops());s.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var o=new cc.Animate(s);return this._cloneDecoration(o),this._reverseEaseList(o),o},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}}),{}],9:[(function(t,e,i){var n=cc._Class.extend({ctor:function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.currentActionSalvaged=!1,this.paused=!1}});cc.ActionManager=cc._Class.extend({_elementPool:[],_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return="" null},ctor:function(){this._hashtargets="{},this._arrayTargets=[],this._currentTarget=null,this._currentTargetSalvaged=!1},_getElement:function(t,e){var" i="this._elementPool.pop();return" i||(i="new" n),i.target="t,i.paused=!!e,i},_putElement:function(t){t.actions.length=0,t.actionIndex=0,t.currentAction=null,t.currentActionSalvaged=!1,t.paused=!1,this._elementPool.push(t)},addAction:function(t,e,i){if(!t)throw" new="" error("cc.actionmanager.addaction():="" action="" must="" be="" non-null");if(!e)throw="" non-null");var="" n="this._hashTargets[e.__instanceId];n?n.actions||(n.actions=[]):(n=this._getElement(e,i),this._hashTargets[e.__instanceId]=n,this._arrayTargets.push(n)),n.actions.push(t),t.startWithTarget(e)},removeAllActions:function(){for(var" t="this._arrayTargets,e=0;e<t.length;e++){var" e="t.getOriginalTarget(),i=this._hashTargets[e.__instanceId];if(i){for(var" cc.logid(1001)}},removeactionbytag:function(t,e){t="==cc.Action.TAG_INVALID&&cc.logID(1002),cc.assertID(e,1003);var" s="i.actions[r];if(s&&s.getTag()===t&&s.getOriginalTarget()===e){this._removeActionAtIndex(r,i);break}}},getActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1004);var" r="i.actions[n];if(r&&r.getTag()===t)return" r}cc.logid(1005,t)}return="" null},getnumberofrunningactionsintarget:function(t){var="" e&&e.actions?e.actions.length:0},pausetarget:function(t){var="" t},resumetargets:function(t){if(t)for(var="">=t&&e.actionIndex--,0===e.actions.length&&(this._currentTarget===e?this._currentTargetSalvaged=!0:this._deleteHashElement(e))},_deleteHashElement:function(t){var e=!1;if(t&&this._hashTargets[t.target.__instanceId]){delete this._hashTargets[t.target.__instanceId];for(var i=this._arrayTargets,n=0,r=i.length;n<r;n++)if(i[n]===t){i.splice(n,1);break}this._putelement(t),e=!0}return e},update:function(t){for(var="" e,i="this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],e=this._currentTarget,!e.paused)for(e.actionIndex=0;e.actionIndex<(e.actions?e.actions.length:0);e.actionIndex++)if(e.currentAction=e.actions[e.actionIndex],e.currentAction){if(e.currentActionSalvaged=!1,e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentActionSalvaged)e.currentAction=null;else" if(e.currentaction.isdone()){e.currentaction.stop();var="" r="e.currentAction;e.currentAction=null,this.removeAction(r)}e.currentAction=null}this._currentTargetSalvaged&&0===e.actions.length&&this._deleteHashElement(e)&&n--}}})}),{}],10:[(function(t,e,i){t("./CCActionManager.js"),t("./CCAction.js"),t("./CCActionInterval.js"),t("./CCActionInstant.js"),t("./CCActionEase.js"),t("./CCActionCatmullRom.js")}),{"./CCAction.js":4,"./CCActionCatmullRom.js":5,"./CCActionEase.js":6,"./CCActionInstant.js":7,"./CCActionInterval.js":8,"./CCActionManager.js":9}],11:[(function(t,e,i){function" n(t,e){a.call(this,t),this.animation="e}function" r(t){var="" e="t.split(".");return" e.shift(),e.length="">0?e:null}function s(t,e){function i(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;e<i;e++){var n="t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}function" n(t,n,s){var="" a,u="t" instanceof="" cc.node&&"position"="==n,_=[];a=u?new" h:new="" c,a.target="t;var" d,f,p="n.indexOf("."),m=p!==-1;m?(d=n.slice(0,p),f=t[d]):d=n,a.prop=d,a.subProps=r(n);for(var" g="0,v=s.length;g<v;g++){var" y="s[g],x=y.frame/e.duration;if(a.ratios.push(x),u){var" t="y.motionPath;T&&!i(T)&&(cc.errorID(3904,t.name,n,g),T=null),_.push(T)}var" b="y.value;a.values.push(b);var" c="y.curve;if(C){if("string"==typeof" c){a.types.push(c);continue}if(array.isarray(c)){c[0]="==C[1]&&C[2]===C[3]?a.types.push(c.Linear):a.types.push(c.Bezier(C));continue}}a.types.push(c.Linear)}return" u&&l(_,a,o.duration,o.sample),a}function="" s(t,e){var="" i="e.props,r=e.comps;if(i)for(var" s="" in="" i){var="" o="i[s],c=n(t,s,o);a.push(c)}if(r)for(var" h="" r){var="" l="t.getComponent(h);if(l){var" u="r[h];for(var" u){var="" p="o.curveData,m=p.paths;s(t,p);for(var" m){var="" v="cc.find(g,t);if(v){var" x="o.events;if(x)for(var" t,b="0,C=x.length;b<C;b++){T||(T=new" u,t.target="t,a.push(T));var" a,s="x[b],E=S.frame/e.duration,w=f(T.ratios,E);w">=0?A=T.events[w]:(A=new _,T.ratios.push(E),T.events.push(A)),A.add(S.func,S.params)}}var o=cc.js,a=t("./animators").Animator,c=t("./animation-curves").DynamicAnimCurve,h=t("./animation-curves").SampledAnimCurve,l=t("./motion-path-helper").sampleMotionPaths,u=t("./animation-curves").EventAnimCurve,_=t("./animation-curves").EventInfo,d=t("./types").WrapModeMask,f=t("../core/utils/binary-search").binarySearchEpsilon;o.extend(n,a);var p=n.prototype;p.playState=function(t,e){t.clip&&(t.curveLoaded||s(this.target,t),this.addAnimation(t),t.animator=this,t.play(),"number"==typeof e&&t.setTime(e),this.play())},p.addAnimation=function(t){a.prototype.addAnimation.call(this,t);for(var e=this.animation._listeners,i=0,n=e.length;i<n;i++){var r="e[i];t.on(r[0],r[1],r[2],r[3])}},p.removeAnimation=function(t){a.prototype.removeAnimation.call(this,t),t.animator=null},p.sample=function(){var" t="this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i){var" i="e[t.i];i.sample()}},p.stopState=function(t){t&&t.stop()},p.pauseState=function(t){t&&t.pause()},p.resumeState=function(t){t&&t.resume(),this.isPaused&&this.resume()},p.setStateTime=function(t,e){if(void" 0!="=e)t&&(t.setTime(e),t.sample());else{e=t;var" n="cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:"Float"},duration:{get:function(){return" this._duration}},sample:{default:60},speed:{default:1},wrapmode:{default:cc.wrapmode.normal},curvedata:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createwithspriteframes:function(t,e){if(!array.isarray(t))return="" cc.errorid(3905),null;var="" n;i.sample="e||i.sample,i._duration=t.length/i.sample;for(var" i.curvedata="{comps:{"cc.Sprite":{spriteFrame:r}}},i}}});cc.AnimationClip=e.exports=n}),{}],13:[(function(t,e,i){function" n(t,e){if("string"="=typeof" e){var="" array.isarray(e)&&(t="r(e,t));return" t}var="" i,n="this.values,r=n[t-1],s=n[t];return" =="typeof" r?r+(s-r)*e:r&&r.lerp?r.lerp(s,e):r},_applyvalue:function(t,e,i){t[e]="i},_findFrameIndex:s,sample:function(t,e,i){var" a,c="this._findFrameIndex(s,e);if(c<0)if(c=~c,c<=0)a=r[0];else" if(c="">=o)a=r[o-1];else{var h=s[c-1],l=s[c],u=this.types[c-1],_=(e-h)/(l-h);_=n(_,u),a=this._calcValue(c,_)}else a=r[c];var d=this.subProps;if(d){for(var f=this.target[this.prop],p=f,m=0;m<d.length-1;m++){var g="d[m];if(!p)return;p=p[g]}var" v="d[d.length-1];if(!p)return;this._applyValue(p,v,a),a=f}this._applyValue(this.target,this.prop,a)}}});h.Linear=null,h.Bezier=function(t){return" t};var="" l="cc.Class({name:"cc.SampledAnimCurve",extends:h,_findFrameIndex:function(t,e){var" i="t.length-1;if(0===i)return" 0;var="" n="t[0];if(e<n)return" r="t[i];if(e">r)return i;e=(e-n)/(r-n);var s=1/i,o=e/s,a=0|o,c=1e-6;return o-a<c?a:~(a+1)}}),u=function(){this.events=[]};u.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var _="cc.Class({name:"cc.EventAnimCurve",extends:c,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return" new="" a}},_lastwrappedinfo:null,_ignoreindex:nan},_wrapiterations:function(t){return="" t-(0|t)="==0&&(t-=1),0|t},sample:function(t,e,i){var" n="this.ratios.length,r=i.getWrappedInfo(i.time,this._wrappedInfo),c=r.direction,h=s(this.ratios,r.ratio);if(h<0&&(h=~h-1,c<0&&(h+=1)),this._ignoreIndex!==h&&(this._ignoreIndex=NaN),r.frameIndex=h,!this._lastWrappedInfo)return" this._fireevent(h),void(this._lastwrappedinfo="new" a(r));var="" l="i.wrapMode,u=this._wrapIterations(r.iterations),_=this._lastWrappedInfo,d=this._wrapIterations(_.iterations),f=_.frameIndex,p=_.direction,m=d!==-1&&u!==d;if(f===h&&m&&1===n)this._fireEvent(0);else" if(f!="=h||m){c=p;do{if(f!==h){if(c===-1&&0===f&&h">0?((l&o.PingPong)===o.PingPong?c*=-1:f=n,d++):1===c&&f===n-1&&h<n-1&&((l&o.pingpong)===o.pingpong?c*=-1:f=-1,d++),f===h)break;if(d>u)break}f+=c,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[f])}while(f!==h&&f>-1&&f<n)}this._lastwrappedinfo.set(r)},_fireevent:function(t){if(!(t<0||t>=this.events.length||this._ignoreIndex===t)){var e=this.events[t],i=e.events;if(this.target.isValid)for(var n=this.target._components,r=0;r<i.length;r++)for(var s="i[r],o=s.func,a=0;a<n.length;a++){var" c="n[a],h=c[o];h&&h.apply(c,s.params)}}},onTimeChangedManually:function(t,e){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var" i="e.getWrappedInfo(t,this._wrappedInfo),n=i.direction,r=s(this.ratios,i.ratio);r<0&&(r=~r-1,n<0&&(r+=1),this._ignoreIndex=r)}});e.exports={AnimCurve:c,DynamicAnimCurve:h,SampledAnimCurve:l,EventAnimCurve:_,EventInfo:u,computeRatioByType:n}}),{"../core/utils/binary-search":220,"./bezier":17,"./types":22}],14:[(function(t,e,n){var" r="cc.js,s=cc.Class({ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._animators=new" r.array.mutableforwarditerator([]),this._delayevents="[]},update:function(t){var" e="this._animators,n=e.array;for(e.i=0;e.i<n.length;++e.i){var" o="s[i];o.target[o.func].apply(o.target,o.args)}s.length=0},destruct:function(){},addAnimator:function(t){var">=0?this._animators.fastRemoveAt(e):cc.errorID(3907)},pushDelayEvent:function(t,e,i){this._delayEvents.push({target:t,func:e,args:i})}});cc.AnimationManager=e.exports=s}),{}],15:[(function(t,e,i){function n(t,e){s.call(this,null,null,{duration:t.length}),this._emit=this.emit,this.emit=function(){for(var t=new Array(arguments.length),e=0,i=t.length;e<i;e++)t[e]=arguments[e];cc.director.getanimationmanager().pushdelayevent(this,"_emit",t)},this._clip=t,this._name=e||t.name}var r="cc.js,s=t("./types").AnimationNode;r.extend(n,s);var" o="n.prototype;r.get(o,"clip",(function(){return" this._clip})),r.get(o,"name",(function(){return="" this._name})),r.obsolete(o,"animationstate.length","duration"),r.getset(o,"curveloaded",(function(){return="" this.curves.length="">0}),(function(){this.curves.length=0})),o.onPlay=function(){this.setTime(0),s.prototype.onPlay.call(this)},o.onStop=function(){s.prototype.onStop.call(this),this.animator&&this.animator.removeAnimation(this)},o.setTime=function(t){this.time=t||0;var e=this;this.curves.forEach((function(i){i.onTimeChangedManually(t,e)}))},cc.AnimationState=e.exports=n}),{"./types":22}],16:[(function(t,e,i){function n(t){this.target=t,this._anims=new c.array.MutableForwardIterator([])}function r(t){n.call(this,t)}function s(t){for(var e=0,i=0,n=t.length,r=0;r<n;r++){var s="t[r],o=s.ratio;if(0===r&&"number"!=typeof" o?s.computedratio="o=0:r===n-1&&"number"!=typeof" o&&(s.computedratio="o=1),"number"==typeof" o){if(e+1<r)for(var="" a="r-e,c=(o-i)/a,h=e+1;h<r;h++)i+=c,t[h].computedRatio=i;e=r,i=o}}}function" o(t,e,i){for(var="" n,r="0;r<t.length;r++)if(n=t[r],n.target===e&&n.prop===i)return" n;return="" null}function="" a(t,e,i,n,r){var="" u,t.push(s),s.target="e,s.prop=i),s.values.push(n),s.ratios.push(r)}var" c="cc.js,h=t("./playable"),l=t("./types").AnimationNode,u=t("./animation-curves").DynamicAnimCurve;c.extend(n,h);var" _="n.prototype;_.update=function(t){var" e="this._anims,i=e.array,n=0,r=i.length;for(e.i=0;e.i<i.length;++e.i){var" o="0===i.length,a=n">=r;(o||a)&&this.stop()},_.stopStatesExcept=function(t){var e=this._anims,i=e.array;for(e.i=0;e.i<i.length;++e.i){var n="i[e.i];n!==t&&this.stopState(n)}},_.on=function(t,e,i,n){for(var" r="this._anims.array,s=0;s<r.length;++s)r[s].on(t,e,i,n)},_.onPlay=function(){cc.director.getAnimationManager().addAnimator(this)},_.onStop=function(){this._isPaused||cc.director.getAnimationManager().removeAnimator(this)},_.onResume=function(){cc.director.getAnimationManager().addAnimator(this)},_.onPause=function(){cc.director.getAnimationManager().removeAnimator(this)},_.addAnimation=function(t){var" e="this._anims.array.indexOf(t);e===-1&&this._anims.push(t)},_.removeAnimation=function(t){var">=0?this._anims.fastRemoveAt(e):cc.errorID(3908)},c.extend(r,n);var d=r.prototype;d.animate=function(t,e){if(!t)return cc.errorID(3909),null;s(t);var i=this._doAnimate(t,e);return this.play(),i},d._doAnimate=function(t,e){var i=new l(this,null,e);i.play();for(var n=i.curves,r=-1,s=0;s<t.length;s++){var o="t[s],c=o.ratio;if("number"!=typeof" c&&(c="o.computedRatio),c<0)cc.errorID(3910);else" if(c<r)cc.errorid(3911);else{r="c;for(var" h="" in="" o){var="" u="o[h];if("props"===h)for(var" _="" u)a(n,this.target,_,u[_],c);else="" if("comps"="==h)for(var" d="" u){var="" f="this.target.getComponent(d),p=u[d];for(var" p)a(n,f,_,p[_],c)}}}}return="" this._anims.push(i),i},e.exports="{Animator:n,EntityAnimator:r}}),{"./animation-curves":13,"./playable":21,"./types":22}],17:[(function(t,e,i){function" n(t,e,i,n,r){var="" s="1-r;return" t*s*s*s+3*e*s*s*r+3*i*s*r*r+n*r*r*r}function="" r(t){return="" t<0?-math.pow(-t,1="" 3):math.pow(t,1="" 3)}function="" s(t,e){var="" i,n,s,o,l,d="e-0,f=e-t[0],p=e-t[2],m=e-1,g=3*d,v=3*f,y=3*p,x=-d+v-y+m,T=1/x,b=1/3,C=(g-6*f+y)*T,A=C*b,S=(-g+v)*T,E=d*T,w=(3*S-C*C)*b,I=w*b,R=(2*C*C*C-9*C*S+27*E)/27,P=R/2,O=P*P+I*I*I;if(O<0){var" b="-w*b,D=B*B*B,M=_(D),L=-R/(2*M),N=L<-1?-1:L">1?1:L,F=c(N),k=r(M),z=2*k;return s=z*a(F*b)-A,o=z*a((F+u)*b)-A,l=z*a((F+2*u)*b)-A,0<=s&&s<=1?0<=o&&o<=1?0<=l&&l<=1?h(s,o,l):h(s,o):0<=l&&l<=1?h(s,l):s:0<=o&&o<=1?0<=l&&l<=1?h(o,l):o:l}if(0===o)return 0="==t?0:Math.pow(1024,t-1)},expoOut:function(t){return" 1="==t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return" i="P<0?r(-P):-r(P),s=2*i-A,o=-i-A,0<=s&&s<=1?0<=o&&o<=1?h(s,o):s:o;var" v="_(O);return" o(t,e){var="" n*c*c*c+3*r*i*c*c+3*o*i*i*c+a*i*i*i}var="" a="Math.cos,c=Math.acos,h=Math.max,l=Math.PI,u=2*l,_=Math.sqrt;e.exports={bezier:n,bezierByTime:o}}),{}],18:[(function(t,e,i){function" n(t,e){return="" function(i){return="" i<.5?e(2*i)="" 2:t(2*i-1)="" 2+.5}}var="" r="{constant:function(){return" 0},linear:function(t){return="" t},quadin:function(t){return="" t*t},quadout:function(t){return="" t*(2-t)},quadinout:function(t){return(t*="2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return" t*t*t},cubicout:function(t){return--t*t*t+1},cubicinout:function(t){return(t*="2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return" t*t*t*t},quartout:function(t){return="" 1-="" --t*t*t*t},quartinout:function(t){return(t*="2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return" t*t*t*t*t},quintout:function(t){return--t*t*t*t*t+1},quintinout:function(t){return(t*="2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return" 1-math.cos(t*math.pi="" 2)},sineout:function(t){return="" math.sin(t*math.pi="" 2)},sineinout:function(t){return.5*(1-math.cos(math.pi*t))},expoin:function(t){return="" 1-math.sqrt(1-t*t)},circout:function(t){return="" math.sqrt(1-="" --t*t)},circinout:function(t){return(t*="2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var" e,i=".1,n=.4;return" e="1.70158;return" t*t*((e+1)*t-e)},backout:function(t){var="" t<1="" 2.75?7.5625*t*t:t<2="" 2.75?7.5625*(t-="1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},smooth:function(t){return" t<="0?0:t">=1?1:t*t*(3-2*t)},fade:function(t){return t<=0?0:t>=1?1:t*t*t*(t*(6*t-15)+10)}};r.quadOutIn=n(r.quadIn,r.quadOut),r.cubicOutIn=n(r.cubicIn,r.cubicOut),r.quartOutIn=n(r.quartIn,r.quartOut),r.quintOutIn=n(r.quintIn,r.quintOut),r.sineOutIn=n(r.sineIn,r.sineOut),r.expoOutIn=n(r.expoIn,r.expoOut),r.circOutIn=n(r.circIn,r.circOut),r.backOutIn=n(r.backIn,r.backOut),r.backOutIn=n(r.backIn,r.backOut),r.bounceIn=function(t){return 1-r.bounceOut(1-t)},r.bounceInOut=function(t){return t<.5?.5*r.bouncein(2*t):.5*r.bounceout(2*t-1)+.5},r.bounceoutin=n(r.bouncein,r.bounceout),cc.easing=e.exports=r}),{}],19:[(function(t,e,i){t(". bezier"),t(".="" easing"),t(".="" types"),t(".="" motion-path-helper"),t(".="" animation-curves"),t(".="" animation-clip"),t(".="" animators"),t(".="" animation-manager"),t(".="" animation-state"),t(".="" animation-animator")}),{".="" animation-animator":11,".="" animation-clip":12,".="" animation-curves":13,".="" animation-manager":14,".="" animation-state":15,".="" animators":16,".="" bezier":17,".="" easing":18,".="" motion-path-helper":20,".="" types":22}],20:[(function(t,e,i){function="" n(t){this.points="t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function" r(){this.start="l(),this.end=l(),this.startCtrlPoint=l(),this.endCtrlPoint=l()}function" s(t,e,i,r){function="" s(t){return="" t="" instanceof="" cc.vec2?{in:t,pos:t,out:t}:array.isarray(t)&&6="==t.length?{in:l(t[2],t[3]),pos:l(t[0],t[1]),out:l(t[4],t[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function" c(t,e,i){f.push(t),p.push(e),m.push(i)}var="" u="e.values;if(0!==t.length&&0!==u.length){if(u=u.map((function(t){return" l(t[0],t[1])})),1="==u.length)return" void(e.values="u);for(var" _="e.types,d=e.ratios,f=e.values=[],p=e.types=[],m=e.ratios=[],g=0,v=1e-6,y=o.Linear,x=0,T=t.length;x<T-1;x++){var" b,c="t[x],A=d[x],S=d[x+1],E=S-A,w=u[x],I=u[x+1],R=_[x],P=[],O=g/E,B=1/(E*i*r);if(C&&C.length">0){var D=[];D.push(s(w));for(var M=0,L=C.length;M<l;m++){var n="s(C[M]);D.push(N)}D.push(s(I));var" f="new" n(d);f.computebeziers();for(var="" k="F.progresses;1-O">v;){b=O,b=a(b,R);var z,V,G,W;if(b<0)v=f.beziers[0],w=(0-b)*v.getlength(),g=v.start.sub(v.endctrlpoint).normalize(),z=v.start.add(g.mul(w));else if(b="">1)V=F.beziers[F.beziers.length-1],W=(b-1)*V.getLength(),G=V.end.sub(V.startCtrlPoint).normalize(),z=V.end.add(G.mul(W));else{var U=h(k,b);U<0&&(u=~u),b-=u>0?k[U-1]:0,b/=F.ratios[U],z=F.beziers[U].getPointAt(b)}P.push(z),O+=B}}else for(;1-O>v;)b=O,b=a(b,R),P.push(w.lerp(I,b)),O+=B;y="constant"===R?R:o.Linear;for(var M=0,L=P.length;M<l;m++){var j="A+g+B*M*E;c(P[M],y,j)}g=Math.abs(O-1)">v?(O-1)*E:0}d[d.length-1]!==m[m.length-1]&&c(u[u.length-1],y,d[d.length-1])}}var o=t("./animation-curves").DynamicAnimCurve,a=t("./animation-curves").computeRatioByType,c=t("./bezier").bezier,h=t("../core/utils/binary-search").binarySearchEpsilon,l=cc.v2;n.prototype.computeBeziers=function(){this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var t,e=1;e<this.points.length;e++){var i="this.points[e-1],n=this.points[e];t=new" r,t.start="i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n.in,this.beziers.push(t),this.length+=t.getLength()}for(var" s="0,e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=s+=this.ratios[e];return" this.beziers},r.prototype.getpointat="function(t){var" e="this.getUtoTmapping(t);return" this.getpoint(e)},r.prototype.getpoint="function(t){var" new="" l(e,i)},r.prototype.getlength="function(){var" t="this.getLengths();return" t[t.length-1]},r.prototype.getlengths="function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return" this.cachearclengths;var="" e,i,n="[],r=this.getPoint(0),s=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),s+=cc.pDistance(e,r),n.push(s),r=e;return" this.cachearclengths="n,n},r.prototype.getUtoTmapping=function(t,e){var" i,n="this.getLengths(),r=0,s=n.length;i=e?e:t*n[s-1];for(var" o,a="0,c=s-1;a<=c;)if(r=Math.floor(a+(c-a)/2),o=n[r]-i,o<0)a=r+1;else{if(!(o">0)){c=r;break}c=r-1}if(r=c,n[r]===i){var h=r/(s-1);return h}var l=n[r],u=n[r+1],_=u-l,d=(i-l)/_,h=(r+d)/(s-1);return h},e.exports={sampleMotionPaths:s,Curve:n,Bezier:r}}),{"../core/utils/binary-search":220,"./animation-curves":13,"./bezier":17}],21:[(function(t,e,i){function n(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var r=cc.js,s=n.prototype;r.get(s,"isPlaying",(function(){return this._isPlaying}),!0),r.get(s,"isPaused",(function(){return this._isPaused}),!0);var o=function(){};s.onPlay=o,s.onPause=o,s.onResume=o,s.onStop=o,s.onError=o,s.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError("already-playing"):(this._isPlaying=!0,this.onPlay())},s.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},s.pause=function(){this._isPlaying&&(this._isPaused=!0,this.onPause())},s.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},s.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.exports=n}),{}],22:[(function(t,e,i){function n(t){return t?void this.set(t):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,void(this.iterations=0))}function r(){a.call(this)}function s(t,e,i){if(r.call(this),this._firstFramePlayed=!1,this._delay=0,this._delayTime=0,this._wrappedInfo=new n,this._lastWrappedInfo=null,this.animator=t,this.curves=e||[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=h.Normal,i){this.delay=i.delay||this.delay;var s=i.duration;"undefined"!=typeof s&&(this.duration=s);var o=i.speed;"undefined"!=typeof o&&(this.speed=o);var a=i.wrapMode;if("undefined"!=typeof a){var l="number"==typeof a;l?this.wrapMode=a:this.wrapMode=h[a]}var u=i.repeatCount;"undefined"!=typeof u?this.repeatCount=u:this.wrapMode&c.Loop&&(this.repeatCount=1/0)}this.time=0}var o=cc.js,a=t("./playable"),c={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},h=cc.Enum({Default:0,Normal:1,Reverse:c.Reverse,Loop:c.Loop,LoopReverse:c.Loop|c.Reverse,PingPong:c.PingPong,PingPongReverse:c.PingPong|c.Reverse});cc.WrapMode=h,n.prototype.set=function(t){for(var e in t)this[e]=t[e]},o.extend(r,a),r.prototype.update=function(t){},o.extend(s,r);var l=s.prototype;l.update=function(t){if(!(this._delayTime>0&&(this._delayTime-=t,this._delayTime>0))){this._firstFramePlayed?this.time+=t*this.speed:this._firstFramePlayed=!0;var e=this.sample();this._lastWrappedInfo||(this._lastWrappedInfo=new n(e));var i=(0|e.iterations)>(0|this._lastWrappedInfo.iterations);this.repeatCount>1&&i&&((this.wrapMode&c.Reverse)===c.Reverse?this._lastWrappedInfo.direction<0&&this.emit("lastframe",this):this._lastwrappedinfo.direction>0&&this.emit("lastframe",this)),e.stopped&&(this.stop(),this.emit("finished",this)),this._lastWrappedInfo.set(e)}},l._needRevers=function(t){var e=this.wrapMode,i=!1;if((e&c.PingPong)===c.PingPong){var n=t-(0|t)===0;n&&t>0&&(t-=1);var r=1&t;r&&(i=!i)}return(e&c.Reverse)===c.Reverse&&(i=!i),i},l.getWrappedInfo=function(t,e){e=e||new n;var i=!1,r=this.duration,s=0,o=this.wrapMode,a=Math.abs(t/r);a>this.repeatCount&&(a=this.repeatCount);var h=!1;o&c.ShouldWrap&&(h=this._needRevers(a));
var l=h?-1:1;if(this.speed<0&&(l*=-1),a>=this.repeatCount){i=!0;var u=this.repeatCount-(0|this.repeatCount);0===u&&(u=1),t=u*r*(t>0?1:-1)}if(t>r){var _=t%r;t=0===_?r:_}else t<0&&(t%=r,0!==t&&(t+=r));return o&c.shouldwrap&&h&&(t="r-t),s=t/r,e.ratio=s,e.time=t,e.direction=l,e.stopped=i,e.iterations=a,e},l.sample=function(){for(var" t="this.getWrappedInfo(this.time,this._wrappedInfo),e=this.curves,i=0,n=e.length;i<n;i++){var" r="e[i];r.sample(t.time,t.ratio,this)}return" t},l.onstop="function(){this.emit("stop",this)},l.onPlay=function(){this._delayTime=this._delay,this.emit("play",this)},l.onPause=function(){this.emit("pause",this)},l.onResume=function(){this.emit("resume",this)},o.getset(l,"wrapMode",(function(){return" this._wrapmode}),(function(t){this._wrapmode="t,this.time=0,t&c.Loop?this.repeatCount=1/0:this.repeatCount=1})),o.getset(l,"delay",(function(){return" this._delay}),(function(t){this._delaytime="this._delay=t})),cc.js.mixin(l,cc.EventTarget.prototype),cc.AnimationNode=s,e.exports={WrapModeMask:c,WrapMode:h,AnimationNode:s,WrappedInfo:n}}),{"./playable":21}],23:[(function(t,e,i){var" n="t("../core/event/event-target"),r=!1,s=[],o=function(t){n.call(this),this._src=t,this._audioType=o.Type.UNKNOWN,this._element=null,this._eventList={},this._state=o.State.INITIALZING,this._loaded=!1,this._onended=function(){this.emit("ended")}.bind(this)};cc.js.extend(o,n),o.Type={DOM:"AUDIO",WEBAUDIO:"WEBAUDIO",NATIVE:"NATIVE",UNKNOWN:"UNKNOWN"},o.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2},(function(t){t.preload=function(){var" i||(i="cc.loader.getItem(t+"?useDom=1")),i?void(i.complete&&(e.mount(i.element||i.buffer),e.emit("load"))):cc.loader.load(t,(function(i){if(!i){var" instanceof="" htmlelement?(this._element="document.createElement("audio"),this._element.src=t.src,this._audioType=o.Type.DOM):(this._element=new" a(t,this),this._audiotype="o.Type.WEBAUDIO),this._bindEnded(),this._state=o.State.INITIALZING,this._loaded=!0},t.play=function(){this._element&&(this._element.play(),this.emit("play"),this._state=o.State.PLAYING,this._audioType===o.Type.DOM&&this._element.paused&&s.push({instance:this,offset:0,audio:this._element}),r||(r=!0,cc.game.canvas.addEventListener("touchstart",(function(){for(var" t;t="s.pop();)t.audio.play(t.offset)}))))},t.pause=function(){this._element&&(this._unbindEnded(),this._element.pause(),this.emit("pause"),this._state=o.State.PAUSED)},t.resume=function(){this._element&&0!==this._element.currentTime&&(this._bindEnded(),this._element.play(),this.emit("resume"),this._state=o.State.PLAYING)},t.stop=function(){if(this._element){try{this._element.currentTime=0}catch(t){}this._element.pause();for(var" this._element&&this._element.loop},t.setvolume="function(t){this._element&&(this._element.volume=t)},t.getVolume=function(){return" this._element?this._element.volume:1},t.setcurrenttime="function(t){this._element&&(this._unbindEnded(),this._bindEnded(function(){this._bindEnded()}.bind(this)),this._element.currentTime=t)},t.getCurrentTime=function(){return" this._element?this._element.currenttime:0},t.getduration="function(){return" this._element?this._element.duration:0},t.getstate="function(){var" o.state.playing="==this._state&&t.paused&&(this._state=o.State.PAUSED),this._state},t.__defineGetter__("src",(function(){return" this._src})),t.__definesetter__("src",(function(t){return="" this._src="t})),t.__defineGetter__("paused",(function(){return!this._element||this._element.paused}))})(o.prototype);var" a="function(t,e){this._audio=e,this._context=cc.sys.__audioSupport.context,this._buffer=t,this._volume=this._context.createGain(),this._volume.gain.value=1,this._volume.connect(this._context.destination),this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currextTimer=null,this._endCallback=function(){this.onended&&this.onended(this)}.bind(this)};!(function(t){t.play=function(t){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var" e="this._context.createBufferSource();e.buffer=this._buffer,e.connect(this._volume),e.loop=this._loop,this._startTime=this._context.currentTime,t=t||this.playedLength,t&&(this._startTime-=t);var" i,n="this._buffer.duration,r=t;if(this._loop?e.start?e.start(0,r):e.notoGrainOn?e.noteGrainOn(0,r):e.noteOn(0,r):(i=n-t,e.start?e.start(0,r,i):e.notoGrainOn?e.noteGrainOn(0,r,i):e.noteOn(0,r,i)),this._currentSource=e,e.onended=this._endCallback,0===this._context.currentTime){var" o="this;clearTimeout(this._currextTimer),this._currextTimer=setTimeout((function(){0===o._context.currentTime&&s.push({instance:o._audio,offset:t,audio:o})}),10)}},t.pause=function(){if(clearTimeout(this._currextTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration;var">this._buffer.duration)})),t.__defineGetter__("loop",(function(){return this._loop})),t.__defineSetter__("loop",(function(t){return this._currentSource&&(this._currentSource.loop=t),this._loop=t})),t.__defineGetter__("volume",(function(){return this._volume.gain.value})),t.__defineSetter__("volume",(function(t){return this._volume.gain.value=t,cc.sys.os===cc.sys.OS_IOS&&!this.paused&&this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play()),t})),t.__defineGetter__("currentTime",(function(){return this.paused?this.playedLength:(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration,this.playedLength)})),t.__defineSetter__("currentTime",(function(t){return this.paused?this.playedLength=t:(this.pause(),this.playedLength=t,this.play()),t})),t.__defineGetter__("duration",(function(){return this._buffer.duration}))})(a.prototype),e.exports=cc.Audio=o}),{"../core/event/event-target":112}],24:[(function(t,e,i){var n=t("./CCAudio"),r=0,s={},o={},a=function(t){var e=r++,i=o[t];i||(i=o[t]=[]);var a;if(h._maxAudioInstance<=i.length){var c="i.shift(),l=s[c];l.stop()}return" a="new" n(t),a.on("ended",(function(){var="" t="this.instanceId;delete" s[t];var="" e="i.indexOf(t);cc.js.array.fastRemoveAt(i,e)})),s[e]=a,a.instanceId=e,i.push(e),a},c=function(t){return" s[t]},h="{AudioState:n.State,_maxWebAudioSize:2097152,_maxAudioInstance:24,_id2audio:s,play:function(t,e,i){var" n="a(t),r=function(){n.setLoop(e||!1),n.setVolume(i||1),n.play()};return" n.__callback="r,n.on("load",r),n.preload(),n.instanceId},setLoop:function(t,e){var" i="c(t);i&&i.setLoop&&i.setLoop(e)},isLoop:function(t){var" e&&e.getvolume?e.getvolume():1},setcurrenttime:function(t,e){var="" e&&e.getcurrenttime?e.getcurrenttime():0},getduration:function(t){var="" e&&e.getduration?e.getduration():0},getstate:function(t){var="" e&&e.getstate?e.getstate():this.audiostate.error},setfinishcallback:function(t,e){var="" in="" s){var="">0;){var t=this._pauseIDCache.pop(),e=c(t);e&&e.resume&&e.resume()}},stop:function(t){var e=c(t);return!(!e||!e.stop)&&(e.off("load",e.__callback),e.stop(),e.emit("ended"),!0)},stopAll:function(){for(var t in s){var e=s[t];e&&e.stop&&(e.stop(),e.off("load",e.__callback),e.emit("ended"))}},setMaxAudioInstance:function(t){return this._maxAudioInstance=t},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(t){var e=o[t];if(e)for(;e.length>0;){var i=e.pop(),n=s[i];n&&(n.stop(),delete s[i])}},uncacheAll:function(){this.stopAll(),s={},o={}},getProfile:function(t){},preload:function(t,e){cc.loader.load(t,(function(t){t||e()}))},setMaxWebAudioSize:function(t){this._maxWebAudioSize=1024*t},_breakCache:null,_break:function(){this._breakCache=[];for(var t in s){var e=s[t],i=e.getState();i===n.State.PLAYING&&(this._breakCache.push(t),e.pause())}},_restore:function(){if(this._breakCache){for(;this._breakCache.length>0;){var t=this._breakCache.pop(),e=c(t);e&&e.resume&&e.resume()}this._breakCache=null}}};e.exports=cc.audioEngine=h;var l=t("./deprecated");l.removed(h),l.deprecated(h)}),{"./CCAudio":23,"./deprecated":25}],25:[(function(t,e,i){var n=cc.js;i.removed=function(t){function e(){cc.errorID(1403)}n.getset(t,"willPlayMusic",e,e)},i.deprecated=function(t){var e=-1,i=1,r=1,s=1,o=1,a=[];n.get(t,"playMusic",(function(){return function(n,o){return t.stop(e),e=t.play(n,o,s),i=n,r=o,e}})),n.get(t,"stopMusic",(function(){return function(){return t.stop(e),e}})),n.get(t,"pauseMusic",(function(){return function(){return t.pause(e),e}})),n.get(t,"resumeMusic",(function(){return function(){return t.resume(e),e}})),n.get(t,"rewindMusic",(function(){return function(){return t.setCurrentTime(e,0),e}})),n.get(t,"getMusicVolume",(function(){return function(){return s}})),n.get(t,"setMusicVolume",(function(){return function(i){return s=i,t.setVolume(e,s),s}})),n.get(t,"isMusicPlaying",(function(){return function(){return t.getState(e)===t.AudioState.PLAYING}})),n.get(t,"playEffect",(function(){return function(e,i,n){return t.play(e,i,void 0===n?o:n)}})),n.get(t,"setEffectsVolume",(function(i){return function(i){o=i;var n=t._id2audio;for(var r in n)r!==e&&t.setVolume(r,i)}})),n.get(t,"getEffectsVolume",(function(){return function(){return o}})),n.get(t,"pauseEffect",(function(){return function(e){return t.pause(e)}})),n.get(t,"pauseAllEffects",(function(){return function(){a.length=0;var i=t._id2audio;for(var n in i)if(n!==e){var r=i[n],s=r.getState();s===t.AudioState.PLAYING&&(a.push(n),r.pause())}}})),n.get(t,"resumeEffect",(function(){return function(e){t.resume(e)}})),n.get(t,"resumeAllEffects",(function(){return function(){for(var e=t._id2audio;a.length>0;){var i=a.pop(),n=e[i];n&&n.resume&&n.resume()}}})),n.get(t,"stopEffect",(function(){return function(e){return t.stop(e)}})),n.get(t,"stopAllEffects",(function(){return function(){var i=t._id2audio;for(var n in i)if(n!==e){var r=i[n],s=r.getState();s===t.AudioState.PLAYING&&r.stop()}}})),n.get(t,"unloadEffect",(function(){return function(e){return t.stop(e)}})),n.get(t,"end",(function(){return function(){return t.stopAll()}}))}}),{}],26:[(function(t,e,i){cc.ClippingNode=_ccsg.Node.extend({inverted:!1,_alphaThreshold:0,_stencil:null,_className:"ClippingNode",_originStencilProgram:null,ctor:function(t){t=t||null,_ccsg.Node.prototype.ctor.call(this),this._stencil=t,t&&(this._originStencilProgram=t.getShaderProgram()),this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},onEnter:function(){_ccsg.Node.prototype.onEnter.call(this),this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onEnter)},onEnterTransitionDidFinish:function(){_ccsg.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),_ccsg.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil&&this._stencil.performRecursive(_ccsg.Node.performType.onExit),_ccsg.Node.prototype.onExit.call(this)},visit:function(t){this._renderCmd.clippingVisit(t&&t._renderCmd)},_visitChildren:function(){this._reorderChildDirty&&this.sortAllChildren();for(var t,e=this._children,i=0,n=e.length;i<n;i++)t=e[i],t&&t._visible&&t.visit(this);this._rendercmd._dirtyflag=0},getalphathreshold:function(){return this._alphathreshold},setalphathreshold:function(t){1="==t&&t!==this._alphaThreshold&&this._renderCmd.resetProgramByStencil(),this._alphaThreshold=t},isInverted:function(){return" this.inverted},setinverted:function(t){this.inverted="t},getStencil:function(){return" this._stencil},setstencil:function(t){this._stencil!="=t&&(t&&(this._originStencilProgram=t.getShaderProgram()),this._renderCmd.setStencil(t))},_createRenderCmd:function(){return" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" cc.clippingnode.canvasrendercmd(this):new="" cc.clippingnode.webglrendercmd(this)}}),cc.clippingnode.stencilbits="-1;var" n="cc.ClippingNode.prototype;cc.defineGetterSetter(n,"stencil",n.getStencil,n.setStencil),cc.defineGetterSetter(n,"alphaThreshold",n.getAlphaThreshold,n.setAlphaThreshold)}),{}],27:[(function(t,e,i){cc.ClippingNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._rendererClipCmd=new" cc.customrendercmd(this,this._drawstencilcommand),this._rendererrestorecmd="new" cc.customrendercmd(this,this._restorecmdcallback)};var="" instanceof="" cc.drawnode||cc.errorid(6300))},n._restorecmdcallback="function(t){var" e="t||cc._renderContext;e.restore()},n._drawStencilCommand=function(t,e,i){var" s="this._node._stencil._buffer,o=0;o<s.length;++o){var" a="s[o].verts;if(!(a.length<3)){r.moveTo(a[0].x,-a[0].y);for(var" c="1;c<a.length;++c)r.lineTo(a[c].x,-a[c].y)}}r.clip()},n.clippingVisit=function(t){var" i,n="e._children,r=n.length;if(r">0)for(e.sortAllChildren(),i=0;i<r;i++)n[i].visit(e);e._stencil&&cc.renderer.pushrendercommand(this._rendererrestorecmd),this._dirtyflag=0}}}),{}],28:[(function(t,e,i){function n(t,e){t.shaderprogram="e;var" i="t.children;if(i)for(var" r="0;r<i.length;r++)n(i[r],e)}var" cc.customrendercmd(this,this._onbeforevisit),this._afterdrawstencilcmd="new" cc.customrendercmd(this,this._onafterdrawstencil),this._aftervisitcmd="new" cc.customrendercmd(this,this._onaftervisit),this._previousstate="null,this._state={stencilEnabled:!0,stencilWriteMask:0,depthWriteMask:!1,stencilFunc:0,stencilRef:0,stencilValueMask:0}};var" s="cc.ClippingNode.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);s.constructor=cc.ClippingNode.WebGLRenderCmd,cc.ClippingNode.WebGLRenderCmd._init_once=null,cc.ClippingNode.WebGLRenderCmd._visit_once=null,cc.ClippingNode.WebGLRenderCmd._layer=-1,s.initStencilBits=function(){cc.ClippingNode.WebGLRenderCmd._init_once=!0,cc.ClippingNode.WebGLRenderCmd._init_once&&(cc.ClippingNode.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),cc.ClippingNode.stencilBits<=0&&cc.logID(6301),cc.ClippingNode.WebGLRenderCmd._init_once=!1)},s.transform=function(t,e){var" e="this._node;if(t=t||this.getParentRenderCmd(),this.visit(t),cc.ClippingNode.stencilBits<1)return" void="" e._visitchildren();if(!e._stencil||!e._stencil.visible)return="" void(e.inverted&&e._visitchildren());if(cc.clippingnode.webglrendercmd._layer+1="==cc.ClippingNode.stencilBits)return" cc.clippingnode.webglrendercmd._visit_once="!0,cc.ClippingNode.WebGLRenderCmd._visit_once&&(cc.logID(6302,cc.ClippingNode.stencilBits),cc.ClippingNode.WebGLRenderCmd._visit_once=!1),void" e._visitchildren();cc.renderer.pushrendercommand(this._beforevisitcmd),e._stencil.visit(e),cc.renderer.pushrendercommand(this._afterdrawstencilcmd);var="">0){var n=i.length;e.sortAllChildren();for(var r=0;r<n;r++)i[r].visit(e)}cc.renderer.pushrendercommand(this._aftervisitcmd),this._dirtyflag=0},s.setstencil=function(t){var e="this._node;e._stencil&&(e._stencil._parent=null),e._stencil=t,e._stencil&&(e._stencil._parent=e)},s._drawFullScreenQuadClearStencil=function(){var" t="cc.math.projection_matrix_stack;t.push(),t.top.identity();var" s="1<<cc.ClippingNode.WebGLRenderCmd._layer,o=s-1,a=s|o;if(this._previousState=r,e.enable(e.STENCIL_TEST),e.stencilMask(s),e.depthMask(!1),e.stencilFunc(e.NEVER,s,s),e.stencilOp(this._node.inverted?e.REPLACE:e.ZERO,e.KEEP,e.KEEP),this._drawFullScreenQuadClearStencil(),e.stencilFunc(e.NEVER,s,s),e.stencilOp(this._node.inverted?e.ZERO:e.REPLACE,e.KEEP,e.KEEP),i.alphaThreshold<1){var" c="cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLORALPHATEST);cc.gl.useProgram(c.getProgram()),c.setUniformLocationWith1f(cc.macro.UNIFORM_ALPHA_TEST_VALUE_S,i.alphaThreshold),c.setUniformLocationWithMatrix4fv(cc.macro.UNIFORM_MVMATRIX_S,cc.renderer.mat4Identity.mat),n(i._stencil,c)}this._state.stencilWriteMask=s,this._state.stencilRef=this._state.stencilValueMask=a,this._state.stencilFunc=e.NEVER,r=this._state},s._onAfterDrawStencil=function(t){var" cc.codec.gzip.gunzip.apply(cc.codec.gzip,arguments)},cc.codec.unzipbase64="function(){var" cc.codec.gzip.gunzip.call(cc.codec.gzip,t)}catch(e){return="" t.slice(7)}},cc.codec.unzipbase64asarray="function(t,e){e=e||1;var" i,n,r,s="this.unzipBase64(t),o=[];for(i=0,r=s.length/e;i<r;i++)for(o[i]=0,n=e-1;n">=0;--n)o[i]+=s.charCodeAt(i*e+n)<<8*n;return o},cc.codec.unzipasarray="function(t,e){e=e||1;var" i,n,r,s="this.unzip(t),o=[];for(i=0,r=s.length/e;i<r;i++)for(o[i]=0,n=e-1;n">=0;--n)o[i]+=s.charCodeAt(i*e+n)<<8*n;return o}}),{}],30:[(function(t,e,i){cc.codec.base64="{name:"Jacob__Codec__Base64"},cc.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cc.Codec.Base64.decode=function(t){var" e,i,n,r,s,o,a,c="[],h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)r=this._keyStr.indexOf(t.charAt(h++)),s=this._keyStr.indexOf(t.charAt(h++)),o=this._keyStr.indexOf(t.charAt(h++)),a=this._keyStr.indexOf(t.charAt(h++)),e=r<<2|s">>4,i=(15&s)<<4|o>>2,n=(3&o)<<6|a,c.push(string.fromcharcode(e)),64!==o&&c.push(string.fromcharcode(i)),64!==a&&c.push(string.fromcharcode(n));return c="c.join("")},cc.Codec.Base64.decodeAsArray=function(t,e){var" i,n,r,s="this.decode(t),o=[];for(i=0,r=s.length/e;i<r;i++)for(o[i]=0,n=e-1;n">=0;--n)o[i]+=s.charCodeAt(i*e+n)<<8*n;return o}}),{}],31:[(function(t,e,i){cc.codec.gzip="function(t){this.data=t,this.debug=!1,this.gpflags=void" 0,this.files="0,this.unzipped=[],this.buf32k=new" array(32768),this.bidx="0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void" 0,this.literaltree="new" array(cc.codec.gzip.literals),this.distancetree="new" array(32),this.treepos="0,this.Places=null,this.len=0,this.fpos=new" array(17),this.fpos[0]="0,this.flens=void" 0,this.fmax="void" 0},cc.codec.gzip.gunzip="function(t){t.constructor===Array||t.constructor===String;var" e="new" cc.codec.gzip(t);return="" e.gunzip()[0][0]},cc.codec.gzip.hufnode="function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},cc.Codec.GZip.LITERALS=288,cc.Codec.GZip.NAMEMAX=256,cc.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],cc.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cc.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],cc.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cc.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],cc.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],cc.Codec.GZip.prototype.gunzip=function(){return" this.outputarr="[],this.nextFile(),this.unzipped},cc.Codec.GZip.prototype.readByte=function(){return" this.bits+="8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},cc.Codec.GZip.prototype.byteAlign=function(){this.bb=1},cc.Codec.GZip.prototype.readBit=function(){var" t;return="" this.bits++,t="1&this.bb,this.bb">>=1,0===this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},cc.Codec.GZip.prototype.readBits=function(t){for(var e=0,i=t;i--;)e=e<<1|this.readbit();return t&&(e="cc.Codec.GZip.bitReverse[e]">>8-t),e},cc.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},cc.Codec.GZip.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768===this.bIdx&&(this.bIdx=0)},cc.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},cc.Codec.GZip.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,t=this.IsPat(),t>=0)e.b0=t;else if(e.b0=32768,this.Rec())return-1;if(t=this.IsPat(),t>=0)e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},cc.Codec.GZip.prototype.CreateTree=function(t,e,i,n){var r;for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,r=0;r<17;r++)this.fpos[r]=0;return this.len="0,this.Rec()?-1:0},cc.Codec.GZip.prototype.DecodeValue=function(t){for(var" e,i,n,r="0,s=t[r];;)if(n=this.readBit()){if(!(32768&s.b1))return" s.b1;for(s="s.jump,e=t.length,i=0;i<e;i++)if(t[i]===s){r=i;break}}else{if(!(32768&s.b0))return" s.b0;r++,s="t[r]}return-1},cc.Codec.GZip.prototype.DeflateLoop=function(){var" t,e,i,n,r;do="" if(t="this.readBit(),i=this.readBits(2),0===i){var" s,o;for(this.bytealign(),s="this.readByte(),s|=this.readByte()<<8,o=this.readByte(),o|=this.readByte()<<8,65535&(s^~o)&&document.write("BlockLen" checksum="" mismatch\n");s--;)e="this.readByte(),this.addBuffer(e)}else" if(1="==i)for(var" a;;)if(a="cc.Codec.GZip.bitReverse[this.readBits(7)]">>1,a>23?(a=a<<1|this.readbit(),a>199?(a-=128,a=a<<1|this.readbit()):(a-=48,a>143&&(a+=136))):a+=256,a<256)this.addbuffer(a);else{if(256===a)break;var r,c;for(a-="257,r=this.readBits(cc.Codec.GZip.cplext[a])+cc.Codec.GZip.cplens[a],a=cc.Codec.GZip.bitReverse[this.readBits(5)]">>3,cc.Codec.GZip.cpdext[a]>8?(c=this.readBits(8),c|=this.readBits(cc.Codec.GZip.cpdext[a]-8)<<8):c=this.readbits(cc.codec.gzip.cpdext[a]),c+=cc.codec.gzip.cpdist[a],a=0;a<r;a++){var e="this.buf32k[this.bIdx-c&32767];this.addBuffer(e)}}else" if(2="==i){var" a,h,l,u,_,d="new" array(320);for(l="257+this.readBits(5),u=1+this.readBits(5),_=4+this.readBits(4),a=0;a<19;a++)d[a]=0;for(a=0;a<_;a++)d[cc.Codec.GZip.border[a]]=this.readBits(3);for(r=this.distanceTree.length,n=0;n<r;n++)this.distanceTree[n]=new" cc.codec.gzip.hufnode;if(this.createtree(this.distancetree,19,d,0))return="" this.flushbuffer(),1;h="l+u,n=0;for(var" f="-1;n<h;)if(f++,a=this.DecodeValue(this.distanceTree),a<16)d[n++]=a;else" if(16="==a){var" p;if(a="3+this.readBits(2),n+a">h)return this.flushBuffer(),1;for(p=n?d[n-1]:0;a--;)d[n++]=p}else{if(a=17===a?3+this.readBits(3):11+this.readBits(7),n+a>h)return this.flushBuffer(),1;for(;a--;)d[n++]=0}for(r=this.literalTree.length,n=0;n<r;n++)this.literaltree[n]=new cc.codec.gzip.hufnode;if(this.createtree(this.literaltree,l,d,0))return="" this.flushbuffer(),1;for(r="this.literalTree.length,n=0;n<r;n++)this.distanceTree[n]=new" cc.codec.gzip.hufnode;var="" m="new" array;for(n="l;n<d.length;n++)m[n-l]=d[n];if(this.CreateTree(this.distanceTree,u,m,0))return" this.flushbuffer(),1;for(;;)if(a="this.DecodeValue(this.literalTree),a">=256){var r,c;if(a-=256,0===a)break;for(a--,r=this.readBits(cc.Codec.GZip.cplext[a])+cc.Codec.GZip.cplens[a],a=this.DecodeValue(this.distanceTree),cc.Codec.GZip.cpdext[a]>8?(c=this.readBits(8),c|=this.readBits(cc.Codec.GZip.cpdext[a]-8)<<8):c=this.readbits(cc.codec.gzip.cpdext[a]),c+=cc.codec.gzip.cpdist[a];r--;){var e="this.buf32k[this.bIdx-c&32767];this.addBuffer(e)}}else" this.addbuffer(a)}while(!t);return="" this.flushbuffer(),this.bytealign(),0},cc.codec.gzip.prototype.unzipfile="function(t){var" e;for(this.gunzip(),e="0;e<this.unzipped.length;e++)if(this.unzipped[e][1]===t)return" this.unzipped[e][0]},cc.codec.gzip.prototype.nextfile="function(){this.outputArr=[],this.modeZIP=!1;var" t="[];if(t[0]=this.readByte(),t[1]=this.readByte(),120===t[0]&&218===t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===t[0]&&139===t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===t[0]&&75===t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3===t[2]&&4===t[3])){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var" i="this.readByte();i|=this.readByte()<<8,i|=this.readByte()<<16,i|=this.readByte()<<24;var" n="this.readByte();n|=this.readByte()<<8,n|=this.readByte()<<16,n|=this.readByte()<<24;var" r="this.readByte();r|=this.readByte()<<8;var" s="this.readByte();for(s|=this.readByte()<<8,a=0,this.nameBuf=[];r--;){var" o="this.readByte();"/"===o|":"===o?a=0:a<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[a++]=String.fromCharCode(o))}this.fileout||(this.fileout=this.nameBuf);for(var" a="0;a<s;)o=this.readByte(),a++;8===e&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},cc.Codec.GZip.prototype.skipdir=function(){var" t,e,i,n,r,s="[];if(8&this.gpflags&&(s[0]=this.readByte(),s[1]=this.readByte(),s[2]=this.readByte(),s[3]=this.readByte(),t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24,e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24),this.modeZIP&&this.nextFile(),s[0]=this.readByte(),8!==s[0])return" 0;if(this.gpflags="this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),i=this.readByte(),4&this.gpflags)for(s[0]=this.readByte(),s[2]=this.readByte(),this.len=s[0]+256*s[1],n=0;n<this.len;n++)this.readByte();if(8&this.gpflags)for(n=0,this.nameBuf=[];r=this.readByte();)"7"!==r&&":"!==r||(n=0),n<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[n++]=r);if(16&this.gpflags)for(;r=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24,this.modeZIP&&this.nextFile()}}),{}],32:[(function(t,e,i){t("./ZipUtils"),t("./base64"),t("./gzip"),t("./zlib.min")}),{"./ZipUtils":29,"./base64":30,"./gzip":31,"./zlib.min":33}],33:[(function(t,e,i){(function(){"use" strict";function="" t(t){throw="" t}function="" e(t,e){var="" n)&&n.execscript&&n.execscript("var="" "+i[0]);for(var="" r;i.length&&(r="i.shift());)i.length||e===v?n=n[r]?n[r]:n[r]={}:n[r]=e}function" i(t){if("string"="=typeof" t){var="" e,i,n="t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))">>>0;t=n}for(var r,s=1,o=0,a=t.length,c=0;0<a;){r=1024<a?1024:a,a-=r;do s+="t[c++],o+=s;while(--r);s%=65521,o%=65521}return(o<<16|s)">>>0}function n(e,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=e instanceof(T?Uint8Array:Array)?e:new(T?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(error("invalid index")),this.buffer.length<="this.index&&this.f()}function" r(t){this.buffer="new(T?Uint16Array:Array)(2*t),this.length=0}function" s(t){var="" e,i,n,r,s,o,a,c,h,l="t.length,u=0,_=Number.POSITIVE_INFINITY;for(c=0;c<l;++c)t[c]">u&&(u=t[c]),t[c]<_&&(_=t[c]);for(e=1<<u,i=new(t?uint32array:array)(e),n=1,r=0,s=2;n<=u;){for(c=0;c<l;++c)if(t[c]===n){for(o=0,a=r,h=0;h<n;++h)o=o<<1|1&a,a>>=1;for(h=o;h<e;h+=s)i[h]=n<<16|c;++r}++n,r<<=1,s<<=1}return[i,u,_]}function 3="==e:return[257,e-3,0];case" 4="==e:return[258,e-4,0];case" 5="==e:return[259,e-5,0];case" 6="==e:return[260,e-6,0];case" 7="==e:return[261,e-7,0];case" 8="==e:return[262,e-8,0];case" 9="==e:return[263,e-9,0];case" 10="==e:return[264,e-10,0];case" 12="" o(t,e){this.h="P,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof" e.compressiontype&&(this.h="e.compressionType),e.outputBuffer&&(this.a=T&&e.outputBuffer" instanceof="" array?new="" uint8array(e.outputbuffer):e.outputbuffer),"number"="=typeof" e.outputindex&&(this.b="e.outputIndex)),this.a||(this.a=new(T?Uint8Array:Array)(32768))}function" a(t,e){this.length="t,this.G=e}function" c(){var="" e="D;switch(y){case">=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:
return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}}function h(e,i){function n(e,i){var n,r=e.G,s=[],o=0;n=N[e.length],s[o++]=65535&n,s[o++]=n>>16&255,s[o++]=n>>24;var a;switch(y){case 1===r:a=[0,r-1,0];break;case 2===r:a=[1,r-2,0];break;case 3===r:a=[2,r-3,0];break;case 4===r:a=[3,r-4,0];break;case 6>=r:a=[4,r-5,1];break;case 8>=r:a=[5,r-7,1];break;case 12>=r:a=[6,r-9,2];break;case 16>=r:a=[7,r-13,2];break;case 24>=r:a=[8,r-17,3];break;case 32>=r:a=[9,r-25,3];break;case 48>=r:a=[10,r-33,4];break;case 64>=r:a=[11,r-49,4];break;case 96>=r:a=[12,r-65,5];break;case 128>=r:a=[13,r-97,5];break;case 192>=r:a=[14,r-129,6];break;case 256>=r:a=[15,r-193,6];break;case 384>=r:a=[16,r-257,7];break;case 512>=r:a=[17,r-385,7];break;case 768>=r:a=[18,r-513,8];break;case 1024>=r:a=[19,r-769,8];break;case 1536>=r:a=[20,r-1025,9];break;case 2048>=r:a=[21,r-1537,9];break;case 3072>=r:a=[22,r-2049,10];break;case 4096>=r:a=[23,r-3073,10];break;case 6144>=r:a=[24,r-4097,11];break;case 8192>=r:a=[25,r-6145,11];break;case 12288>=r:a=[26,r-8193,12];break;case 16384>=r:a=[27,r-12289,12];break;case 24576>=r:a=[28,r-16385,13];break;case 32768>=r:a=[29,r-24577,13];break;default:t("invalid distance")}n=a,s[o++]=n[0],s[o++]=n[1],s[o++]=n[2];var c,h;for(c=0,h=s.length;c<h;++c)p[m++]=s[c];x[s[0]]++,b[s[3]]++,g=e.length+i-1,_=null}var r,s,o,c,h,l,u,_,d,f="{},p=T?new" uint16array(2*i.length):[],m="0,g=0,x=new(T?Uint32Array:Array)(286),b=new(T?Uint32Array:Array)(30),C=e.w;if(!T){for(o=0;285">=o;)x[o++]=0;for(o=0;29>=o;)b[o++]=0}for(x[256]=1,r=0,s=i.length;r<s;++r){for(o=h=0,c=3;o<c&&r+o!==s;++o)h=h<<8|i[r+o];if(f[h]===v&&(f[h]=[]),l=f[h],!(0<g--)){for(;0<l.length&&32768<r-l[0];)l.shift();if(r+3>=s){for(_&&n(_,-1),o=0,c=s-r;o<c;++o)d=i[r+o],p[m++]=d,++x[d];break}if(0<l.length){var a="v,S=v,E=0,w=v,I=v,R=v,P=v,O=i.length,I=0,P=l.length;t:for(;I<P;I++){if(A=l[P-I-1],w=3,3<E){for(R=E;3<R;R--)if(i[A+R-1]!==i[r+R-1])continue" t;w="E}for(;258">w&&r+w<o&&i[a+w]===i[r+w];)++w;if(w>E&&(S=A,E=w),258===w)break}u=new a(E,r-S),_?_.length<u.length?(d=i[r-1],p[m++]=d,++x[d],n(u,0)):n(_,-1):u.length<c?_=u:n(u,0)}else _?n(_,-1):(d="i[r],p[m++]=d,++x[d])}l.push(r)}return" p[m++]="256,x[256]++,e.L=x,e.K=b,T?p.subarray(0,m):p}function" l(t,e){function="" i(t){var="" e="C[t][A[t]];e===g?(i(t+1),i(t+1)):--x[e],++A[t]}var" n,s,o,a,c,h="t.length,l=new" r(572),u="new(T?Uint8Array:Array)(h);if(!T)for(a=0;a<h;a++)u[a]=0;for(a=0;a<h;++a)0<t[a]&&l.push(a,t[a]);if(n=Array(l.length/2),s=new(T?Uint32Array:Array)(l.length/2),1===n.length)return" u[l.pop().index]="1,u;for(a=0,c=l.length/2;a<c;++a)n[a]=l.pop(),s[a]=n[a].value;var" _,d,f,p,m,g="s.length,v=new(T?Uint16Array:Array)(e),y=new(T?Uint8Array:Array)(e),x=new(T?Uint8Array:Array)(g),b=Array(e),C=Array(e),A=Array(e),S=(1<<e)-g,E=1<<e-1;for(v[e-1]=g,d=0;d<e;++d)S<E?y[d]=0:(y[d]=1,S-=E),S<<=1,v[e-2-d]=(v[e-1-d]/2|0)+g;for(v[0]=y[0],b[0]=Array(v[0]),C[0]=Array(v[0]),d=1;d<e;++d)v[d]">2*v[d-1]+y[d]&&(v[d]=2*v[d-1]+y[d]),b[d]=Array(v[d]),C[d]=Array(v[d]);for(_=0;_<g;++_)x[_]=e;for(f=0;f<v[e-1];++f)b[e-1][f]=s[f],c[e-1][f]=f;for(_=0;_<e;++_)a[_]=0;for(1===y[e-1]&&(--x[0],++a[e-1]),d=e-2;0<=d;--d){for(p=_=0,m=a[d+1],f=0;f<v[d];f++)p=b[d+1][m]+b[d+1][m+1],p>s[_]?(b[d][f]=p,C[d][f]=g,m+=2):(b[d][f]=s[_],C[d][f]=_,++_);A[d]=0,1===y[d]&&i(d)}for(o=x,a=0,c=n.length;a<c;++a)u[n[a].index]=o[a];return u}function="" u(e){var="" i,n,r,s,o="new(T?Uint16Array:Array)(e.length),a=[],c=[],h=0;for(i=0,n=e.length;i<n;i++)a[e[i]]=(0|a[e[i]])+1;for(i=1,n=16;i<=n;i++)c[i]=h,h+=0|a[i],h">1<<i&&t("overcommitted"),h<<=1;for(65536>h&&t("undercommitted"),i=0,n=e.length;i<n;i++)for(h=c[e[i]],c[e[i]]+=1,r=o[i]=0,s=e[i];r<s;r++)o[i]=o[i]<<1|1&h,h>>>=1;return o}function _(t,e){this.input=t,this.a=new(T?Uint8Array:Array)(32768),this.h=F.j;var i,n={};!e&&(e={})||"number"!=typeof e.compressionType||(this.h=e.compressionType);for(i in e)n[i]=e[i];n.outputBuffer=this.a,this.z=new o(this.input,n)}function d(e,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=T?new Uint8Array(e):e,this.s=!1,this.m=z,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case k:this.b=32768,this.a=new(T?Uint8Array:Array)(32768+this.l+258);break;case z:this.b=0,this.a=new(T?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:t(Error("invalid inflate mode"))}}function f(e,i){for(var n,r=e.g,s=e.e,o=e.input,a=e.c;s<i;)n=o[a++],n===v&&t(error("input buffer="" is="" broken")),r|="n<<s,s+=8;return" n="r&(1<<i)-1,e.g=r">>>i,e.e=s-i,e.c=a,n}function p(e,i){for(var n,r,s,o=e.g,a=e.e,c=e.input,h=e.c,l=i[0],u=i[1];a<u;)n=c[h++],n===v&&t(error("input buffer="" is="" broken")),o|="n<<a,a+=8;return" r="l[o&(1<<u)-1],s=r">>>16,e.g=o>>s,e.e=a-s,e.c=h,65535&r}function m(t){function e(t,e,i){var n,r,s,o;for(o=0;o<t;)switch(n=p(this,e)){case 16:for(s="3+f(this,2);s--;)i[o++]=r;break;case" 17:for(s="3+f(this,3);s--;)i[o++]=0;r=0;break;case" 18:for(s="11+f(this,7);s--;)i[o++]=0;r=0;break;default:r=i[o++]=n}return" i}var="" i,n,r,o,a="f(t,5)+257,c=f(t,5)+1,h=f(t,4)+4,l=new(T?Uint8Array:Array)(j.length);for(o=0;o<h;++o)l[j[o]]=f(t,3);i=s(l),n=new(T?Uint8Array:Array)(a),r=new(T?Uint8Array:Array)(c),t.o(s(e.call(t,a,i,n)),s(e.call(t,c,i,r)))}function" g(e,i){var="" n,r;switch(this.input="e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=e[this.c++],r=e[this.c++],15&n){case" mt:this.method="mt;break;default:t(Error("unsupported" compression="" method"))}0!="=((n<<8)+r)%31&&t(Error("invalid" fcheck="" flag:"+((n<<8)+r)%31)),32&r&&t(error("fdict="" flag="" is="" not="" supported")),this.a="new" d(e,{index:this.c,buffersize:i.buffersize,buffertype:i.buffertype,resize:i.resize})}var="" v="void" 0,y="!0,x=this,T="undefined"!=typeof" uint8array&&"undefined"!="typeof" uint16array&&"undefined"!="typeof" uint32array;n.prototype.f="function(){var" t,e="this.buffer,i=e.length,n=new(T?Uint8Array:Array)(i<<1);if(T)n.set(e);else" for(t="0;t<i;++t)n[t]=e[t];return" this.buffer="n},n.prototype.d=function(t,e,i){var" n,r="this.buffer,s=this.index,o=this.i,a=r[s];if(i&&1<e&&(t=8<e?(w[255&t]<<24|w[t">>>8&255]<<16|w[t>>>16&255]<<8|w[t>>>24&255])>>32-e:w[t]>>8-e),8>e+o)a=a<<e|t,o+=e;else for(n="0;n<e;++n)a=a<<1|t">>e-n-1&1,8===++o&&(o=0,r[s++]=w[a],a=0,s===r.length&&(r=this.f()));r[s]=a,this.buffer=r,this.i=o,this.index=s},n.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.i&&(e[i]<<=8-this.i,e[i]=w[e[i]],i++),t?t=e.subarray(0,i):(e.length=i,t=e),t};var b,c="new(T?Uint8Array:Array)(256);for(b=0;256">b;++b){for(var A=b,S=A,E=7,A=A>>>1;A;A>>>=1)S<<=1,s|=1&a,--e;c[b]=(s<<e&255)>>>0}var w=C,I=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];T&&new Uint32Array(I),r.prototype.getParent=function(t){return 2*((t-2)/4|0)},r.prototype.push=function(t,e){var i,n,r,s=this.buffer;for(i=this.length,s[this.length++]=e,s[this.length++]=t;0<i&&(n=this.getparent(i),s[i]>s[n]);)r=s[i],s[i]=s[n],s[n]=r,r=s[i+1],s[i+1]=s[n+1],s[n+1]=r,i=n;return this.length},r.prototype.pop=function(){var t,e,i,n,r,s=this.buffer;for(e=s[0],t=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],r=0;(n=2*r+2,!(n>=this.length))&&(n+2<this.length&&s[n+2]>s[n]&&(n+=2),s[n]>s[r]);)i=s[r],s[r]=s[n],s[n]=i,i=s[r+1],s[r+1]=s[n+1],s[n+1]=i,r=n;return{index:t,value:e,length:this.length}};var R,P=2,O={NONE:0,r:1,j:P,N:3},B=[];for(R=0;288>R;R++)switch(y){case 143>=R:B.push([R+48,8]);break;case 255>=R:B.push([R-144+400,9]);break;case 279>=R:B.push([R-256+0,7]);break;case 287>=R:B.push([R-280+192,8]);break;default:t("invalid literal: "+R)}o.prototype.n=function(){var e,i,r,s,o=this.input;switch(this.h){case 0:for(r=0,s=o.length;r<s;){i=t?o.subarray(r,r+65535):o.slice(r,r+65535),r+=i.length;var a="i,c=r===s,_=v,d=v,f=v,p=v,m=v,g=this.a,x=this.b;if(T){for(g=new" uint8array(this.a.buffer);g.length<="x+a.length+5;)g=new" uint8array(g.length<<1);g.set(this.a)}if(_="c?1:0,g[x++]=0|_,d=a.length,f=~d+65536&65535,g[x++]=255&d,g[x++]=d">>>8&255,g[x++]=255&f,g[x++]=f>>>8&255,T)g.set(a,x),x+=a.length,g=g.subarray(0,x);else{for(p=0,m=a.length;p<m;++p)g[x++]=a[p];g.length=x}this.b=x,this.a=g}break;case 1:var="" b="new" n(new="" uint8array(this.a.buffer),this.b);b.d(1,1,y),b.d(1,2,y);var="" c,a,s,e="h(this,o);for(C=0,A=E.length;C<A;C++)if(S=E[C],n.prototype.d.apply(b,B[S]),256<S)b.d(E[++C],E[++C],y),b.d(E[++C],5),b.d(E[++C],E[++C],y);else" if(256="==S)break;this.a=b.finish(),this.b=this.a.length;break;case" p:var="" w,i,r,o,d,m,l,n,f,k,z,v,g,w,u,j="new" uint8array(this.a),this.b),x="[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=Array(19);for(w=P,j.d(1,1,y),j.d(w,2,y),I=h(this,o),M=l(this.L,15),L=u(M),N=l(this.K,7),F=u(N),R=286;257<R&&0===M[R-1];R--);for(O=30;1<O&&0===N[O-1];O--);var" h,q,z,j,q,k,$="R,tt=O,et=new(T?Uint32Array:Array)($+tt),it=new(T?Uint32Array:Array)(316),nt=new(T?Uint8Array:Array)(19);for(H=q=0;H<$;H++)et[q++]=M[H];for(H=0;H<tt;H++)et[q++]=N[H];if(!T)for(H=0,J=nt.length;H<J;++H)nt[H]=0;for(H=Q=0,J=et.length;H<J;H+=q){for(q=1;H+q<J&&et[H+q]===et[H];++q);if(Z=q,0===et[H])if(3">Z)for(;0<z--;)it[q++]=0,nt[0]++;else for(;0<z;)k="138">Z?Z:138,K>Z-3&&K<z&&(k=z-3),10>=K?(it[Q++]=17,it[Q++]=K-3,nt[17]++):(it[Q++]=18,it[Q++]=K-11,nt[18]++),Z-=K;else if(it[Q++]=et[H],nt[et[H]]++,Z--,3>Z)for(;0<z--;)it[q++]=et[h],nt[et[h]]++;else for(;0<z;)k="6">Z?Z:6,K>Z-3&&K<z&&(k=z-3),it[q++]=16,it[q++]=k-3,nt[16]++,z-=k}for(e=t?it.subarray(0,q):it.slice(0,q),k=l(nt,7),w=0;19>W;W++)Y[W]=k[X[W]];for(D=19;4<d&&0===y[d-1];d--);for(z=u(k),j.d(r-257,5,y),j.d(o-1,5,y),j.d(d-4,4,y),w=0;w<d;w++)j.d(y[w],3,y);for(w=0,u=e.length;w<u;w++)if(v=e[w],j.d(z[v],k[v],y),16<=v){switch(w++,v){case 16:g="2;break;case" 17:g="3;break;case" 18:g="7;break;default:t("invalid" code:="" "+v)}j.d(e[w],g,y)}var="" rt,st,ot,at,ct,ht,lt,ut,_t="[L,M],dt=[F,N];for(ct=_t[0],ht=_t[1],lt=dt[0],ut=dt[1],rt=0,st=I.length;rt<st;++rt)if(ot=I[rt],j.d(ct[ot],ht[ot],y),256<ot)j.d(I[++rt],I[++rt],y),at=I[++rt],j.d(lt[at],ut[at],y),j.d(I[++rt],I[++rt],y);else" if(256="==ot)break;this.a=j.finish(),this.b=this.a.length;break;default:t("invalid" compression="" type")}return="" this.a};var="" d,m,l="[];for(D=3;258">=D;D++)M=c(),L[D]=M[2]<<24|m[1]<<16|m[0];var n="T?new" uint32array(l):l,f="O;_.prototype.n=function(){var" e,n,r,s,o,a,c,h="0;switch(c=this.a,e=mt){case" mt:n="Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid" compression="" method"))}switch(r="n<<4|e,c[h++]=r,e){case" mt:switch(this.h){case="" f.none:o="0;break;case" f.r:o="1;break;case" f.j:o="2;break;default:t(Error("unsupported" type"))}break;default:t(error("invalid="" method"))}return="" s="o<<6|0,c[h++]=s|31-(256*r+s)%31,a=i(this.input),this.z.b=h,c=this.z.n(),h=c.length,T&&(c=new" uint8array(c.buffer),c.length<="h+4&&(this.a=new" uint8array(c.length+4),this.a.set(c),c="this.a),c=c.subarray(0,h+4)),c[h++]=a">>24&255,c[h++]=a>>16&255,c[h++]=a>>8&255,c[h++]=255&a,c},e("Zlib.Deflate",_),e("Zlib.Deflate.compress",(function(t,e){return new _(t,e).n()})),e("Zlib.Deflate.CompressionType",F),e("Zlib.Deflate.CompressionType.NONE",F.NONE),e("Zlib.Deflate.CompressionType.FIXED",F.r),e("Zlib.Deflate.CompressionType.DYNAMIC",F.j);var k=0,z=1,V={D:k,C:z};d.prototype.p=function(){for(;!this.s;){var e=f(this,3);switch(1&e&&(this.s=y),e>>>=1){case 0:var i=this.input,n=this.c,r=this.a,s=this.b,o=v,a=v,c=v,h=r.length,l=v;switch(this.e=this.g=0,o=i[n++],o===v&&t(Error("invalid uncompressed block header: LEN (first byte)")),a=o,o=i[n++],o===v&&t(Error("invalid uncompressed block header: LEN (second byte)")),a|=o<<8,o=i[n++],o===v&&t(error("invalid uncompressed="" block="" header:="" nlen="" (first="" byte)")),c="o,o=i[n++],o===v&&t(Error("invalid" (second="" byte)")),c|="o<<8,a===~c&&t(Error("invalid" length="" verify")),n+a="">i.length&&t(Error("input buffer is broken")),this.m){case k:for(;s+a>r.length;){if(l=h-s,a-=l,T)r.set(i.subarray(n,n+l),s),s+=l,n+=l;else for(;l--;)r[s++]=i[n++];this.b=s,r=this.f(),s=this.b}break;case z:for(;s+a>r.length;)r=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(T)r.set(i.subarray(n,n+a),s),s+=a,n+=a;else for(;a--;)r[s++]=i[n++];this.c=n,this.b=s,this.a=r;break;case 1:this.o(it,rt);break;case 2:m(this);break;default:t(Error("unknown BTYPE: "+e))}}return this.t()};var G,W,U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=T?new Uint16Array(U):U,X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],Y=T?new Uint16Array(X):X,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],q=T?new Uint8Array(H):H,Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],J=T?new Uint16Array(Z):Z,Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],K=T?new Uint8Array(Q):Q,$=new(T?Uint8Array:Array)(288);for(G=0,W=$.length;G<w;++g)$[g]=143>=G?8:255>=G?9:279>=G?7:8;var tt,et,it=s($),nt=new(T?Uint8Array:Array)(30);for(tt=0,et=nt.length;tt<et;++tt)nt[tt]=5;var rt="s(nt);d.prototype.o=function(t,e){var" i="this.a,n=this.b;this.u=t;for(var" r,s,o,a,c="i.length-258;256!==(r=p(this,t));)if(256">r)n>=c&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(s=r-257,a=Y[s],0<q[s]&&(a+=f(this,q[s])),r=p(this,e),o=j[r],0<k[r]&&(o+=f(this,k[r])),n>=c&&(this.b=n,i=this.f(),n=this.b);a--;)i[n]=i[n++-o];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.i=function(t,e){var i="this.a,n=this.b;this.u=t;for(var" r,s,o,a,c="i.length;256!==(r=p(this,t));)if(256">r)n>=c&&(i=this.f(),c=i.length),i[n++]=r;else for(s=r-257,a=Y[s],0<q[s]&&(a+=f(this,q[s])),r=p(this,e),o=j[r],0<k[r]&&(o+=f(this,k[r])),n+a>c&&(i=this.f(),c=i.length);a--;)i[n]=i[n++-o];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.f=function(){var t,e,i="new(T?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(T)i.set(r.subarray(32768,i.length));else" for(t="0,e=i.length;t<e;++t)i[t]=r[t+32768];if(this.k.push(i),this.q+=i.length,T)r.set(r.subarray(n,n+32768));else">t;++t)r[t]=r[n+t];return this.b=32768,r},d.prototype.J=function(t){var e,i,n,r,s=this.input.length/this.c+1|0,o=this.input,a=this.a;return t&&("number"==typeof t.v&&(s=t.v),"number"==typeof t.F&&(s+=t.F)),2>s?(i=(o.length-this.c)/this.u[2],r=258*(i/2)|0,n=r<a.length?a.length+r:a.length<<1):n=a.length*s,t?(e=new uint8array(n),e.set(a)):e="a,this.a=e},d.prototype.t=function(){var" t,e,i,n,r,s="0,o=this.a,a=this.k,c=new(T?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return" t?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e="0,i=a.length;e<i;++e)for(t=a[e],n=0,r=t.length;n<r;++n)c[s++]=t[n];for(e=32768,i=this.b;e<i;++e)c[s++]=o[e];return" this.k="[],this.buffer=c},d.prototype.H=function(){var" t,e="this.b;return" t?this.b?(t="new" uint8array(e),t.set(this.a.subarray(0,e))):t="this.a.subarray(0,e):(this.a.length">e&&(this.a.length=e),t=this.a),this.buffer=t},g.prototype.p=function(){var e,n,r=this.input;return e=this.A.p(),this.c=this.A.c,this.M&&(n=(r[this.c++]<<24|r[this.c++]<<16|r[this.c++]<<8|r[this.c++])>>>0,n!==i(e)&&t(Error("invalid adler-32 checksum"))),e},e("Zlib.Inflate",g),e("Zlib.Inflate.BufferType",V),V.ADAPTIVE=V.C,V.BLOCK=V.D,e("Zlib.Inflate.prototype.decompress",g.prototype.p);var st=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];T&&new Uint16Array(st);var ot=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];T&&new Uint16Array(ot);var at=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];T&&new Uint8Array(at);var ct=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];T&&new Uint16Array(ct);var ht=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];T&&new Uint8Array(ht);var lt,ut,_t=new(T?Uint8Array:Array)(288);for(lt=0,ut=_t.length;lt<ut;++lt)_t[lt]=143>=lt?8:255>=lt?9:279>=lt?7:8;s(_t);var dt,ft,pt=new(T?Uint8Array:Array)(30);for(dt=0,ft=pt.length;dt<ft;++dt)pt[dt]=5;s(pt);var mt="8}).call(window);var" n="window;n=window.Zlib=n.Zlib,n.Deflate=n.Deflate,n.Deflate.compress=n.Deflate.compress,n.Inflate=n.Inflate,n.Inflate.BufferType=n.Inflate.BufferType,n.Inflate.prototype.decompress=n.Inflate.prototype.decompress}),{}],34:[(function(t,e,i){cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var" t="this._valueDict;t["cocos2d.x.version"]=cc.ENGINE_VERSION,t["cocos2d.x.compiled_with_profiler"]=!1,t["cocos2d.x.compiled_with_gl_state_cache"]=cc.macro.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return" this._maxtexturesize},getmaxmodelviewstackdepth:function(){return="" this._maxmodelviewstackdepth},getmaxtextureunits:function(){return="" this._maxtextureunits},supportsnpot:function(){return="" this._supportsnpot},supportspvrtc:function(){return="" this._supportspvrtc},supportsetc:function(){return!1},supportss3tc:function(){return!1},supportsatitc:function(){return!1},supportsbgra8888:function(){return="" this._supportsbgra8888},supportsdiscardframebuffer:function(){return="" this._supportsdiscardframebuffer},supportsshareablevao:function(){return="" this._supportsshareablevao},checkforglextension:function(t){return="" this._glextensions.indexof(t)="">-1},getValue:function(t,e){this._inited||this._init();var i=this._valueDict;return i[t]?i[t]:e},setValue:function(t,e){this._valueDict[t]=e},gatherGPUInfo:function(){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS){this._inited||this._init();var t=cc._renderContext,e=this._valueDict;e["gl.vendor"]=t.getParameter(t.VENDOR),e["gl.renderer"]=t.getParameter(t.RENDERER),e["gl.version"]=t.getParameter(t.VERSION),this._GlExtensions="";for(var i=t.getSupportedExtensions(),n=0;n<i.length;n++)this._glextensions+=i[n]+" ";this._maxtexturesize="t.getParameter(t.MAX_TEXTURE_SIZE),e["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),e["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,e["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),e["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),e["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),e["gl.supports_vertex_array_object"]=this._supportsShareableVAO,cc.checkGLErrorDebug()}},loadConfigFile:function(t){this._inited||this._init();var" e="cc.loader.getRes(t);if(!e)throw" new="" error("please="" load="" the="" resource="" first="" :="" "+t);cc.assertid(e,1101,t);var="" i="e.data;if(!i)return" void="" cc.logid(1100,t);for(var="" n="" in="" i)this._valuedict[n]="i[n]}}}),{}],35:[(function(t,e,i){var" t="this;n.call(t),t._landscape=!1,t._nextDeltaTimeZero=!1,t._paused=!1,t._purgeDirectorInNextLoop=!1,t._sendCleanupToScene=!1,t._animationInterval=0,t._oldAnimationInterval=0,t._projection=0,t._projectionDelegate=null,t._contentScaleFactor=1,t._winSizeInPoints=null,t._openGLView=null,t._scenesStack=null,t._nextScene=null,t._loadingScene="",t._runningScene=null,t._scene=null,t._totalFrames=0,t._lastUpdate=Date.now(),t._deltaTime=0,t._dirtyRegion=null,t._scheduler=null,t._compScheduler=null,t._nodeActivator=null,t._actionManager=null,cc.game.on(cc.game.EVENT_SHOW,(function(){t._lastUpdate=Date.now()}))},init:function(){return" this._oldanimationinterval="this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._totalFrames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new" cc.scheduler,cc.actionmanager?(this._actionmanager="new" cc.actionmanager,this._scheduler.scheduleupdate(this._actionmanager,cc.scheduler.priority_system,!1)):this._actionmanager="null,this.sharedInit(),!0},sharedInit:function(){this._compScheduler=new" o,this._nodeactivator="new" a,cc.animationmanager?(this._animationmanager="new" cc.animationmanager,this._scheduler.scheduleupdate(this._animationmanager,cc.scheduler.priority_system,!1)):this._animationmanager="null,cc.CollisionManager?(this._collisionManager=new" cc.collisionmanager,this._scheduler.scheduleupdate(this._collisionmanager,cc.scheduler.priority_system,!1)):this._collisionmanager="null,cc.PhysicsManager?(this._physicsManager=new" cc.physicsmanager,this._scheduler.scheduleupdate(this._physicsmanager,cc.scheduler.priority_system,!1)):this._physicsmanager="null,cc._widgetManager&&cc._widgetManager.init(this)},calculateDeltaTime:function(){var">0&&this._deltaTime>1&&(this._deltaTime=1/60)),this._lastUpdate=t},convertToGL:function(t){var e=document.documentElement,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,s=n.top+window.pageYOffset-e.clientTop,o=i._devicePixelRatio*(t.x-r),a=i._devicePixelRatio*(s+n.height-t.y);return i._isRotated?{x:i._viewPortRect.width-a,y:o}:{x:o,y:a}},convertToUI:function(t){var e=document.documentElement,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,s=n.top+window.pageYOffset-e.clientTop,o={x:0,y:0};return i._isRotated?(o.x=r+t.y/i._devicePixelRatio,o.y=s+n.height-(i._viewPortRect.width-t.x)/i._devicePixelRatio):(o.x=r+t.x/i._devicePixelRatio,o.y=s+n.height-t.y/i._devicePixelRatio),o},_visitScene:function(){if(this._runningScene){var t=cc.renderer;t.childrenOrderDirty?(t.clearRenderCommands(),cc.renderer.assignedZ=0,this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),t.resetFlag()):t.transformDirty()&&t.transform()}},end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assertID(this._runningScene,1204),this._scenesStack.pop();var t=this._scenesStack.length;0===t?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[t-1])},purgeCachedData:function(){cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll(),this._compScheduler.unscheduleAll(),this._nodeActivator.reset(),cc.eventManager&&cc.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),this._runningScene.performRecursive(_ccsg.Node.performType.onExit),this._runningScene.performRecursive(_ccsg.Node.performType.cleanup),cc.renderer.clearRenderCommands()),this._runningScene=null,this._nextScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData(),cc.checkGLErrorDebug()},reset:function(){this.purgeDirector(),cc.eventManager&&cc.eventManager.setEnabled(!0),this._actionManager&&this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._animationManager&&this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._physicsManager&&this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this.startAnimation()},pushScene:function(t){cc.assertID(t,1205),this._sendCleanupToScene=!1,this._scenesStack.push(t),this._nextScene=t},runSceneImmediate:function(t,e,i){var n,r,o=cc.game,a=o._persistRootNodes;t instanceof cc.Scene&&t._load();for(n in a)r=a[n],o._ignoreRemovePersistNode=r,r.parent=null,o._ignoreRemovePersistNode=null;var c=this._scene,h=c&&c.autoReleaseAssets&&c.dependAssets;s.autoRelease(cc.loader,h,t.dependAssets),cc.isValid(c)&&c.destroy(),this._scene=null,cc.Object._deferredDestroy(),e&&e(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t);var l=t;if(t instanceof cc.Scene){this._scene=t,l=t._sgNode;for(n in a){r=a[n];var u=t.getChildByUuid(n);if(u){var _=u.getSiblingIndex();u._destroyImmediate(),r.parent=t,r.setSiblingIndex(_)}else r.parent=t}t._activate()}if(this._runningScene){var d=this._scenesStack.length;this._scenesStack[Math.max(d-1,0)]=l,this._sendCleanupToScene=!0,this._nextScene=l}else this.pushScene(l),this.startAnimation();this._nextScene&&this.setNextScene(),i&&i(null,t),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){cc.assertID(t,1205),t instanceof cc.Scene&&t._load(),this.once(cc.Director.EVENT_AFTER_UPDATE,(function(){this.runSceneImmediate(t,e,i)}))},_getSceneUuid:function(t){var e=cc.game._sceneInfos;if("string"==typeof t){t.endsWith(".fire")||(t+=".fire"),"/"===t[0]||t.startsWith("db://assets/")||(t="/"+t);for(var i=0;i<e.length;i++){var n="e[i];if(n.url.endsWith(t))return" n}}else="" if("number"="=typeof" t){if(0<="t&&t<e.length)return" e[t];cc.errorid(1206,t)}else="" cc.errorid(1207,t);return="" null},loadscene:function(t,e,i){if(this._loadingscene)return="" cc.errorid(1208,t,this._loadingscene),!1;var="" r="n.uuid;this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t;return" this._loadscenebyuuid(r,e,i),!0}return="" cc.errorid(1209,t),!1},preloadscene:function(t,e){var="" i="this._getSceneUuid(t);if(i)this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),cc.loader.load({uuid:i.uuid,type:"uuid"},(function(i,n){i&&cc.errorID(1210,t,i.message),e&&e(i,n)}));else{var" +t+'"="" because="" it="" is="" not="" in="" the="" build="" settings.';e(new="" error(n)),cc.error("preloadscene:="" "+n)}},_loadscenebyuuid:function(t,e,i,n){cc.assetlibrary.loadasset(t,(function(n,r){var="" s="cc.director;if(s._loadingScene="",n)n="Failed" to="" load="" scene:="" "+n,cc.error(n);else{if(r="" instanceof="" cc.sceneasset){var="" o="r.scene;return" o._id="r._uuid,o._name=r._name,void" s.runsceneimmediate(o,i,e)}n="The asset " +t+"="" a="" scene",cc.error(n)}e&&e(n)}))},resume:function(){this._paused&&(this.setanimationinterval(this._oldanimationinterval),this._lastupdate="Date.now(),this._lastUpdate||cc.logID(1200),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(t){t!==this._contentScaleFactor&&(this._contentScaleFactor=t)},setDepthTest:null,setClearColor:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(t){this._nextDeltaTimeZero=t},setNextScene:function(){var" t="!1,e=!1;if(cc.TransitionScene&&(t=!!this._runningScene&&this._runningScene" cc.transitionscene,e="!!this._nextScene&&this._nextScene" cc.transitionscene),!e){var="" this._projectiondelegate},setdelegate:function(t){this._projectiondelegate="t},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,isSendCleanupToScene:function(){return" this._sendcleanuptoscene},getrunningscene:function(){return="" this._runningscene},getscene:function(){return="" this._scene},getanimationinterval:function(){return="" this._animationinterval},isdisplaystats:function(){return!!cc.profiler&&cc.profiler.isshowingstats()},setdisplaystats:function(t){cc.profiler&&(t?cc.profiler.showstats():cc.profiler.hidestats(),cc.game.config[cc.game.config_key.showfps]="!!t)},isNextDeltaTimeZero:function(){return" this._nextdeltatimezero},ispaused:function(){return="" this._paused},gettotalframes:function(){return="" this._totalframes},poptorootscene:function(){this.poptoscenestacklevel(1)},poptoscenestacklevel:function(t){cc.assertid(this._runningscene,1203);var="" e="this._scenesStack,i=e.length;if(0===i)return" void="" this.end();if(!(t="">i)){for(;i>t;){var n=e.pop();n.running&&(n.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),n.performRecursive(_ccsg.Node.performType.onExit)),n.performRecursive(_ccsg.Node.performType.cleanup),i--}this._nextScene=e[e.length-1],this._sendCleanupToScene=!0}},getScheduler:function(){return this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this._scheduler=t)},getActionManager:function(){return this._actionManager},setActionManager:function(t){
this._actionManager!==t&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=t,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},getDeltaTime:function(){return this._deltaTime}}),cc.js.addon(cc.Director.prototype,n.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_VISIT="director_before_visit",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||(this.calculateDeltaTime(),this._paused||(this.emit(cc.Director.EVENT_BEFORE_UPDATE),this._compScheduler.startPhase(),this._compScheduler.updatePhase(this._deltaTime),this._scheduler.update(this._deltaTime),this._compScheduler.lateUpdatePhase(this._deltaTime),this.emit(cc.Director.EVENT_AFTER_UPDATE),cc.Object._deferredDestroy()),this._nextScene&&this.setNextScene(),this.emit(cc.Director.EVENT_BEFORE_VISIT),this._visitScene(),this.emit(cc.Director.EVENT_AFTER_VISIT),cc.g_NumberOfDraws=0,cc.renderer.clear(),cc.renderer.rendering(cc._renderContext),this._totalFrames++,this.emit(cc.Director.EVENT_AFTER_DRAW),cc.eventManager.frameUpdateListeners())},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(t){this._animationInterval=t,this.invalid||(this.stopAnimation(),this.startAnimation())},__fastOn:function(t,e,i){var n=this._bubblingListeners;n||(n=this._bubblingListeners=new c),n.add(t,e,i)},__fastOff:function(t,e,i){var n=this._bubblingListeners;n&&n.remove(t,e,i)}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D}),{"./component-scheduler":71,"./event/event-listeners":111,"./event/event-target":112,"./load-pipeline/auto-release-utils":134,"./node-activator":145,"./platform/_CCClass":185}],36:[(function(t,e,i){t("./CCDirector"),t("./CCGame"),cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var t=cc.Director.prototype;t.getProjection=function(t){return this._projection},t.setProjection=function(t){this._projection=t,this.emit(cc.Director.EVENT_PROJECTION_CHANGED,this)},t.setDepthTest=function(){},t.setClearColor=function(t){cc.renderer._clearColor=t,cc.renderer._clearFillStyle="rgb("+t.r+","+t.g+","+t.b+")"},t.setOpenGLView=function(t){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=t||cc.view,cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this.getWinSize()},t.getVisibleOrigin=function(){return cc.p(0,0)}}}))}),{"./CCDirector":35,"./CCGame":40}],37:[(function(t,e,i){t("./CCDirector"),t("./CCGame"),t("../kazmath");var n=cc.math;cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){cc.DirectorDelegate=cc._Class.extend({updateProjection:function(){}});var t=cc.Director.prototype,e=function(t){if(t&&t._renderCmd){t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty);var i,n=t._children;for(i=0;i<n.length;i++)e(n[i])}};cc.director._getinstance().on(cc.director.event_projection_changed,(function(){for(var t="cc.director._scenesStack,i=0;i<t.length;i++)e(t[i])})),t.setProjection=function(t){var" e="this,i=e._winSizeInPoints;e.setViewport();var" r="e._openGLView,s=r._viewPortRect.x/r._scaleX,o=r._viewPortRect.y/r._scaleY;switch(t){case" cc.director.projection_2d:n.glmatrixmode(n.km_gl_projection),n.glloadidentity();var="" a="n.Matrix4.createOrthographicProjection(0,i.width,0,i.height,-1024,1024);n.glMultMatrix(a),n.glMatrixMode(n.KM_GL_MODELVIEW),n.glLoadIdentity();break;case" cc.director.projection_3d:var="" c="e.getZEye(),h=new" n.matrix4,l="new" n.matrix4;n.glmatrixmode(n.km_gl_projection),n.glloadidentity(),h="n.Matrix4.createPerspectiveProjection(60,i.width/i.height,.1,2*c),n.glMultMatrix(h);var" u="new" n.vec3(-s+i.width="" 2,-o+i.height="" 2,c),_="new" 2,0),d="new" n.vec3(0,1,0);l.lookat(u,_,d),n.glmultmatrix(l),n.glmatrixmode(n.km_gl_modelview),n.glloadidentity();break;case="" cc.director.projection_custom:e._projectiondelegate&&e._projectiondelegate.updateprojection();break;default:cc.logid(1201)}e._projection="t,e.emit(cc.Director.EVENT_PROJECTION_CHANGED,e),cc.gl.setProjectionMatrixDirty(),cc.renderer.childrenOrderDirty=!0},t.setDepthTest=function(t){cc.renderer.setDepthTest(t)},t.setClearColor=function(t){var" i="cc.configuration;i.gatherGPUInfo(),e.setGLDefaultValues(),cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return" this._openglview.getvisiblesize()},t.getvisibleorigin="function(){return" this._openglview.getvisibleorigin()},t.getzeye="function(){return" this._winsizeinpoints.height="" 1.1566},t.setviewport="function(){var" this._openglview},t.getprojection="function(){return" this._projection},t.setalphablending="function(t){t?cc.gl.blendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST):cc.gl.blendFunc(cc.macro.ONE,cc.macro.ZERO)},t.setGLDefaultValues=function(){var" n="this._renderContext.getContext(),r=cc.view.getScaleX(),s=cc.view.getScaleY();n.beginPath();for(var" o="0,a=t.length;o<a;o++)n.arc(t[o].x*r,-t[o].y*s,i*r,0,2*Math.PI,!1);n.closePath(),n.fill()}},drawLine:function(t,e){var" new="" error("polygon's="" point="" must="" greater="" than="" 2");var="" s="this._renderContext.getContext(),o=cc.view.getScaleX(),a=cc.view.getScaleY();s.beginPath();var" r,s,o="1/t.length,a=0;a<i+1;a++){var" h="cc.cardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,r-0),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,s);n.push(h)}this.drawPoly(n,i+1,!1,!1)},drawImage:function(t,e,i,n,r){var" 2:var="" 3:o.drawimage(t,e.x,-(e.y+i.height),i.width,i.height);break;case="" 5:o.drawimage(t,e.x,e.y,i.width,i.height,n.x,-(n.y+r.height),r.width,r.height);break;default:throw="" error("argument="" be="" non-nil")}},drawstar:function(t,e,i){var="" +(0|i.r)+","+(0|i.g)+","+(0|i.b);n.setfillstyle(s+",1)");var="" 1)"),a.addcolorstop(.3,s+",="" 0.8)"),a.addcolorstop(1,s+",="" 0.0)"),n.setfillstyle(a),r.beginpath();var="" +(0|i.r)+","+(0|i.g)+","+(0|i.b),o="e/10,a=r.createRadialGradient(0,0,o,0,0,e);a.addColorStop(0,s+"," 0.8)"),a.addcolorstop(.6,s+",="" 0.4)"),a.addcolorstop(1,s+",="" instanceof="" webglrenderingcontext)throw="" error("can't="" initialise="" drawingprimitivewebgl.="" context="" need="" is="" webglrenderingcontext");this._rendercontext="t,this._colorArray=new" float32array([1,1,1,1])},lazy_init:function(){var="" float32array([t.x,t.y]),e.static_draw),e.vertexattribpointer(n.vertex_attrib_position,2,e.float,!1,0,0),e.drawarrays(e.points,0,1),e.deletebuffer(i),cc.incrementgldraws(1)},drawpoints:function(t,e){if(t&&0!="=t.length){this.lazy_init();var" float32array(2*t.length),i="0;i<t.length;i++)e[2*i]=t[i].x,e[2*i+1]=t[i].y;return" e},drawline:function(t,e){this.lazy_init();var="" float32array(2*(r+2));if(c){for(var="" l="h*a,u=e*Math.cos(l+i)+t.x,_=e*Math.sin(l+i)+t.y;c[2*h]=u,c[2*h+1]=_}c[2*(r+1)]=t.x,c[2*(r+1)+1]=t.y;var" d="this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),d.enableVertexAttribArray(n.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var" f="d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,f),d.bufferData(d.ARRAY_BUFFER,c,d.STATIC_DRAW),d.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0),d.drawArrays(d.LINE_STRIP,0,r+o),d.deleteBuffer(f),cc.incrementGLDraws(1)}},drawQuadBezier:function(t,e,i,r){this.lazy_init();for(var" float32array(2*(r+1)),o="0,a=0;a<r;a++)s[2*a]=Math.pow(1-o,2)*t.x+2*(1-o)*o*e.x+o*o*i.x,s[2*a+1]=Math.pow(1-o,2)*t.y+2*(1-o)*o*e.y+o*o*i.y,o+=1/r;s[2*r]=i.x,s[2*r+1]=i.y;var" float32array(2*(s+1)),a="0,c=0;c<s;c++)o[2*c]=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*e.x+3*(1-a)*a*a*i.x+a*a*a*r.x,o[2*c+1]=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*e.y+3*(1-a)*a*a*i.y+a*a*a*r.y,a+=1/s;o[2*s]=r.x,o[2*s+1]=r.y;var" float32array(2*(i+1)),a="1/t.length,c=0;c<i+1;c++){var" _="u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,_),u.bufferData(u.ARRAY_BUFFER,o,u.STATIC_DRAW),u.vertexAttribPointer(n.VERTEX_ATTRIB_POSITION,2,u.FLOAT,!1,0,0),u.drawArrays(u.LINE_STRIP,0,i+1),u.deleteBuffer(_),cc.incrementGLDraws(1)},setDrawColor:function(t,e,i,n){this._colorArray[0]=t/255,this._colorArray[1]=e/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(t){this._pointSize=t},setLineWidth:function(t){this._renderContext.lineWidth&&this._renderContext.lineWidth(t)}})}),{}],40:[(function(t,e,i){var" n,r="t("./event/event-target");n=t("./platform/CCView"),t("../audio/CCAudioEngine");var" this._paused},restart:function(){cc.director.poptoscenestacklevel(0),cc.audioengine&&cc.audioengine.uncacheall(),s.onstart()},end:function(){close()},prepare:function(t){var="" void="" this._loadconfig((function(){e.prepare(t)}));if(this._prepared)return="" void(t&&t());if(!this._preparecalled){if(cc._engineloaded){this._preparecalled="!0,this._initRenderer(i[r.width],i[r.height]),cc.view=n?n._getInstance():null,cc.director=cc.Director._getInstance(),cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view),cc.winSize=cc.director.getWinSize(),this._initEvents(),this._setAnimFrame(),this._runMainLoop();var" void(s&&s.length="">0?cc.loader.load(s,(function(i){if(i)throw new Error(JSON.stringify(i));e._prepared=!0,t&&t(),e.emit(e.EVENT_GAME_INITED)})):(t&&t(),e.emit(e.EVENT_GAME_INITED)))}cc.initEngine(this.config,(function(){e.prepare(t)}))}},run:function(t,e){"function"==typeof t?s.onStart=t:(t&&(s.config=t),"function"==typeof e&&(s.onStart=e)),this.prepare(s.onStart&&s.onStart.bind(s))},addPersistRootNode:function(t){if(!cc.Node.isNode(t)||!t.uuid)return void cc.warnID(3800);var e=t.uuid;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i)){if(t.parent){if(!(t.parent instanceof cc.Scene))return void cc.warnID(3801);if(t.parent!==i)return void cc.warnID(3802)}else t.parent=i;this._persistRootNodes[e]=t,t._persistNode=!0}}},removePersistRootNode:function(t){if(t!==this._ignoreRemovePersistNode){var e=t.uuid||"";t===this._persistRootNodes[e]&&(delete this._persistRootNodes[e],t._persistNode=!1)}},isPersistRootNode:function(t){return t._persistNode},_setAnimFrame:function(){this._lastTime=new Date;var t=s.config[s.CONFIG_KEY.frameRate];this._frameTime=1e3/t,60!==t&&30!==t?(window.requestAnimFrame=this._stTime,window.cancelAnimFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(t){var e=(new Date).getTime(),i=Math.max(0,s._frameTime-(e-s._lastTime)),n=window.setTimeout((function(){t()}),i);return s._lastTime=e+i,n},_ctTime:function(t){window.clearTimeout(t)},_runMainLoop:function(){var t,e=this,i=e.config,n=e.CONFIG_KEY,r=cc.director,s=!0,o=i[n.frameRate];r.setDisplayStats(i[n.showFPS]),t=function(){if(!e._paused){if(30===o&&(s=!s))return void(e._intervalId=window.requestAnimFrame(t));r.mainLoop(),e._intervalId=window.requestAnimFrame(t)}},e._intervalId=window.requestAnimFrame(t),e._paused=!1},_loadConfig:function(t){if(this.config)return this._initConfig(this.config),void(t&&t());if(document.ccConfig)return this._initConfig(document.ccConfig),void(t&&t());var e=this;cc.loader.load("project.json",(function(i,n){i&&cc.logID(3818),e._initConfig(n||{}),t&&t()}))},_initConfig:function(t){var e=this.CONFIG_KEY;"number"!=typeof t[e.debugMode]&&(t[e.debugMode]=0),t[e.exposeClassName]=!!t[e.exposeClassName],"number"!=typeof t[e.frameRate]&&(t[e.frameRate]=60),"number"!=typeof t[e.renderMode]&&(t[e.renderMode]=0),"boolean"!=typeof t[e.registerSystemEvent]&&(t[e.registerSystemEvent]=!0),t[e.showFPS]=!(e.showFPS in t)||!!t[e.showFPS],t[e.engineDir]=t[e.engineDir]||"frameworks/cocos2d-html5",this._sceneInfos=t[e.scenes]||[],this.collisionMatrix=t.collisionMatrix||[],this.groupList=t.groupList||[],cc._initDebugSetting(t[e.debugMode]),this.config=t,this._configLoaded=!0},_initRenderer:function(t,e){if(!this._rendererInitialized){if(!cc._supportRender)throw new Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode]);var i,n,r=this.config[s.CONFIG_KEY.id],o=window,a=cc.$(r)||cc.$("#"+r);"CANVAS"===a.tagName?(t=t||a.width,e=e||a.height,this.canvas=cc._canvas=i=a,this.container=cc.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==a.tagName&&cc.warnID(3819),t=t||a.clientWidth,e=e||a.clientHeight,this.canvas=cc._canvas=i=document.createElement("CANVAS"),this.container=cc.container=n=document.createElement("DIV"),a.appendChild(n)),n.setAttribute("id","Cocos2dGameContainer"),n.appendChild(i),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,i.addClass("gameCanvas"),i.setAttribute("width",t||480),i.setAttribute("height",e||320),i.setAttribute("tabindex",99),cc._renderType===s.RENDER_TYPE_WEBGL&&(this._renderContext=cc._renderContext=cc.webglContext=cc.create3DContext(i,{stencil:!0,alpha:!0,antialias:cc.sys.isMobile})),this._renderContext?(cc.renderer=cc.rendererWebGL,o.gl=this._renderContext,cc.renderer.init(),cc._drawingUtil=new cc.DrawingPrimitiveWebGL(this._renderContext),cc.textureCache._initializingRenderer(),cc.glExt={},cc.glExt.instanced_arrays=o.gl.getExtension("ANGLE_instanced_arrays"),cc.glExt.element_uint=o.gl.getExtension("OES_element_index_uint")):(cc._renderType=s.RENDER_TYPE_CANVAS,cc.renderer=cc.rendererCanvas,cc.renderer.init(),this._renderContext=cc._renderContext=new cc.CanvasContextWrapper(i.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(this._renderContext):null),cc._gameDiv=n,s.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this.emit(this.EVENT_RENDERER_INITED,!0),this._rendererInitialized=!0}},_initEvents:function(){var t,e=window;this.config[this.CONFIG_KEY.registerSystemEvent]&&cc.inputManager.registerSystemEvent(this.canvas),"undefined"!=typeof document.hidden?t="hidden":"undefined"!=typeof document.mozHidden?t="mozHidden":"undefined"!=typeof document.msHidden?t="msHidden":"undefined"!=typeof document.webkitHidden&&(t="webkitHidden");var i=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],n=function(){s.emit(s.EVENT_HIDE,s)},r=function(){s.emit(s.EVENT_SHOW,s)};if(t)for(var o=0;o<i.length;o++)document.addeventlistener(i[o],(function(e){var i="document[t];i=i||e.hidden,i?n():r()}),!1);else" e.addeventlistener("blur",n,!1),e.addeventlistener("focus",r,!1);navigator.useragent.indexof("micromessenger")="">-1&&(e.onfocus=function(){r()}),"onpageshow"in window&&"onpagehide"in window&&(e.addEventListener("pagehide",n,!1),e.addEventListener("pageshow",r,!1)),this.on(s.EVENT_HIDE,(function(){s.pause()})),this.on(s.EVENT_SHOW,(function(){s.resume()}))}};r.call(s),cc.js.addon(s,r.prototype),cc.game=e.exports=s}),{"../audio/CCAudioEngine":24,"./event/event-target":112,"./platform/CCView":183}],41:[(function(t,e,i){"use strict";function n(t){var e=cc.Mask;if(e)for(var i=0,n=t;n&&cc.Node.isNode(n);n=n._parent,++i)if(n.getComponent(e))return{index:i,node:n};return null}function r(t){t._parent._delaySort(),cc.eventManager._setDirtyForNode(t)}var s=t("./utils/prefab-helper"),o=t("./utils/scene-graph-helper"),a=cc.Object.Flags,c=a.Destroying,h="position-changed",l="size-changed",u="anchor-changed",_="rotation-changed",d="scale-changed",f="child-reorder",p=t("./utils/misc"),m=!!cc.ActionManager,g=function(){},v=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel"}),y=[v.TOUCH_START,v.TOUCH_MOVE,v.TOUCH_END,v.TOUCH_CANCEL],x=[v.MOUSE_DOWN,v.MOUSE_ENTER,v.MOUSE_MOVE,v.MOUSE_LEAVE,v.MOUSE_UP,v.MOUSE_WHEEL],T=null,b=function(t,e){var i=t.getLocation(),n=this.owner;return!!n._hitTest(i,this)&&(e.type=v.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0)},C=function(t,e){var i=this.owner;e.type=v.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},A=function(t,e){var i=t.getLocation(),n=this.owner;n._hitTest(i,this)?e.type=v.TOUCH_END:e.type=v.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},S=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=v.MOUSE_DOWN,i.dispatchEvent(t),t.stopPropagation())},E=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)?(t.stopPropagation(),this._previousIn||(T&&(t.type=v.MOUSE_LEAVE,T.dispatchEvent(t),T._mouseListener._previousIn=!1),T=this.owner,t.type=v.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0),t.type=v.MOUSE_MOVE,i.dispatchEvent(t)):this._previousIn&&(t.type=v.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,T=null)},w=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=v.MOUSE_UP,i.dispatchEvent(t),t.stopPropagation())},I=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=v.MOUSE_WHEEL,i.dispatchEvent(t))},R=cc.Class({name:"cc.Node",extends:t("./utils/base-node"),properties:{_opacity:255,_color:cc.Color.WHITE,_cascadeOpacityEnabled:!0,_anchorPoint:cc.p(.5,.5),_contentSize:cc.size(0,0),_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_localZOrder:0,_globalZOrder:0,_opacityModifyRGB:!1,groupIndex:{default:0,type:cc.Integer},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(t){this.groupIndex=cc.game.groupList.indexOf(t),this.emit("group-changed")}},x:{get:function(){return this._position.x},set:function(t){var e=this._position;if(t!==e.x){e.x=t,this._sgNode.setPositionX(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable[h],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[h];(i&&i.length>0||n&&n.length>0)&&this.emit(h)}}},y:{get:function(){return this._position.y},set:function(t){var e=this._position;if(t!==e.y){e.y=t,this._sgNode.setPositionY(t);var i=this._capturingListeners&&this._capturingListeners._callbackTable[h],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[h];(i&&i.length>0||n&&n.length>0)&&this.emit(h)}}},rotation:{get:function(){return this._rotationX!==this._rotationY&&cc.logID(1602),this._rotationX},set:function(t){this._rotationX===t&&this._rotationY===t||(this._rotationX=this._rotationY=t,this._sgNode.rotation=t,this.emit(_))}},rotationX:{get:function(){return this._rotationX},set:function(t){this._rotationX!==t&&(this._rotationX=t,this._sgNode.rotationX=t,this.emit(_))}},rotationY:{get:function(){return this._rotationY},set:function(t){this._rotationY!==t&&(this._rotationY=t,this._sgNode.rotationY=t,this.emit(_))}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._sgNode.scaleX=t,this.emit(d))}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._sgNode.scaleY=t,this.emit(d))}},skewX:{get:function(){return this._skewX},set:function(t){this._skewX=t,this._sgNode.skewX=t}},skewY:{get:function(){return this._skewY},set:function(t){this._skewY=t,this._sgNode.skewY=t}},opacity:{get:function(){return this._opacity},set:function(t){if(this._opacity!==t&&(this._opacity=t,this._sgNode.setOpacity(t),!this._cascadeOpacityEnabled)){var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacity(t)}},range:[0,255]},cascadeOpacity:{get:function(){return this._cascadeOpacityEnabled},set:function(t){if(this._cascadeOpacityEnabled!==t){this._cascadeOpacityEnabled=t,this._sgNode.cascadeOpacity=t;var e=t?255:this._opacity,i=this._sizeProvider;i instanceof _ccsg.Node&&i.setOpacity(e)}}},color:{get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||(this._color.fromColor(t),this._sizeProvider instanceof _ccsg.Node&&this._sizeProvider.setColor(t))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){var e=this._anchorPoint;if(e.x!==t){e.x=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit(u);
}}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){var e=this._anchorPoint;if(e.y!==t){e.y=t;var i=this._sizeProvider;i instanceof _ccsg.Node&&i.setAnchorPoint(e),this.emit(u)}}},width:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getWidth();return this._contentSize.width=t,t}return this._contentSize.width},set:function(t){if(t!==this._contentSize.width){var e=this._sizeProvider;e&&e.setContentSize(t,e._getHeight());this._contentSize.width=t,this.emit(l)}}},height:{get:function(){if(this._sizeProvider){var t=this._sizeProvider._getHeight();return this._contentSize.height=t,t}return this._contentSize.height},set:function(t){if(t!==this._contentSize.height){var e=this._sizeProvider;e&&e.setContentSize(e._getWidth(),t);this._contentSize.height=t,this.emit(l)}}},_ignoreAnchor:{get:function(){return this.__ignoreAnchor},set:function(t){if(this.__ignoreAnchor!==t){this.__ignoreAnchor=t,this._sgNode.ignoreAnchor=t;var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&(e.ignoreAnchor=t),this.emit(u)}}},zIndex:{get:function(){return this._localZOrder},set:function(t){this._localZOrder!==t&&(this._localZOrder=t,this._sgNode.zIndex=t,this._parent&&r(this))}}},ctor:function(t){var e=this._sgNode=new _ccsg.Node;cc.game._isCloning||(e.cascadeOpacity=!0),this._sizeProvider=null,this.__ignoreAnchor=!1,this._reorderChildDirty=!1,this._widget=null,this._touchListener=null,this._mouseListener=null},statics:{isNode:function(t){return t instanceof R&&(t.constructor===R||!(t instanceof cc.Scene))}},_onSetParent:function(t){var e=this._sgNode;e.parent&&e.parent.removeChild(e,!1),t&&(t._sgNode.addChild(e),t._delaySort())},_onSiblingIndexChanged:function(t){for(var e,i=this._parent,n=i._children,r=0,s=n.length;r<s;r++)e=n[r]._sgnode,e._arrivalorder=r,cc.eventmanager._setdirtyfornode(e);cc.renderer.childrenorderdirty=!0,i._sgnode._reorderchilddirty=!0,i._delaysort()},_onpredestroy:function(){var t="this._onPreDestroyBase();m&&cc.director.getActionManager().removeAllActionsFromTarget(this),T===this&&(T=null),this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this),cc.eventManager.removeListeners(this),t||this._removeSgNode()},_onPostActivated:function(t){var" e="m?cc.director.getActionManager():null;if(t)if(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this),this._touchListener){var" i="this._touchListener.mask=n(this);this._mouseListener&&(this._mouseListener.mask=i)}else" this._mouselistener&&(this._mouselistener.mask="n(this));else" e&&e.pausetarget(this),cc.eventmanager.pausetarget(this)},_onhierarchychanged:function(t){this._onhierarchychangedbase(t),cc._widgetmanager._nodesorderdirty="!0},_onBatchCreated:function(){var" s="!1;return" y.indexof(t)!="=-1?this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:n(this),onTouchBegan:b,onTouchMoved:C,onTouchEnded:A}),cc.eventManager.addListener(this._touchListener,this),s=!0):x.indexOf(t)!==-1&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:n(this),onMouseDown:S,onMouseMove:E,onMouseUp:w,onMouseScroll:I}),cc.eventManager.addListener(this._mouseListener,this),s=!0)),s&&!this._activeInHierarchy&&cc.director.getScheduler().schedule((function(){this._activeInHierarchy||cc.eventManager.pauseTarget(this)}),this,0,0,0,!1),this._EventTargetOn(t,e,i,r)},off:function(t,e,i,n){this._EventTargetOff(t,e,i,n),y.indexOf(t)!==-1?this._checkTouchListeners():x.indexOf(t)!==-1&&this._checkMouseListeners()},targetOff:function(t){this._EventTargetTargetOff(t),this._checkTouchListeners(),this._checkMouseListeners()},pauseSystemEvents:function(t){cc.eventManager.pauseTarget(this,t)},resumeSystemEvents:function(t){cc.eventManager.resumeTarget(this,t)},_checkTouchListeners:function(){if(!(this._objFlags&c)&&this._touchListener){var" o="t.x-r.x,a=r.x+r.width-t.x,c=t.y-r.y,h=r.y+r.height-t.y;if(o">=0&&a>=0&&h>=0&&c>=0){if(e&&e.mask){for(var l=e.mask,u=this,_=0;u&&_<l.index;++_,u=u.parent);if(u===l.node){var d="u.getComponent(cc.Mask);return!d||!d.enabledInHierarchy||d._hitTest(t)}return" e.mask="null,!0}return!0}return!1},_getCapturingTargets:function(t,e){for(var" i="this.parent;i;)i.hasEventListener(t,!0)&&e.push(i),i=i.parent},_getBubblingTargets:function(t,e){for(var" this._activeinhierarchy},runaction:m?function(t){if(this.active)return="" cc.assertid(t,1618),cc.macro.enable_gc_for_native_objects||this._retainaction(t),cc.director.getactionmanager().addaction(t,this,!1),t}:g,pauseallactions:m?function(){cc.director.getactionmanager().pausetarget(this)}:g,resumeallactions:m?function(){cc.director.getactionmanager().resumetarget(this)}:g,stopallactions:m?function(){cc.director.getactionmanager().removeallactionsfromtarget(this)}:g,stopaction:m?function(t){cc.director.getactionmanager().removeaction(t)}:g,stopactionbytag:m?function(t){return="" t="==cc.Action.TAG_INVALID?void" cc.logid(1612):void="" cc.director.getactionmanager().removeactionbytag(t,this)}:g,getactionbytag:m?function(t){return="" null},getnumberofrunningactions:m?function(){return="" cc.director.getactionmanager().getnumberofrunningactionsintarget(this)}:function(){return="" 0},_retainaction:function(t){},_releaseallactions:function(){},settag:function(t){this._tag="t,this._sgNode.tag=t},getPosition:function(){return" new="" cc.vec2(this._position)},setposition:function(t,e){var="" i;"undefined"="=typeof" e?(i="t.x,e=t.y):i=t;var" n="this._position;if(n.x!==i||n.y!==e){n.x=i,n.y=e,this._sgNode.setPosition(i,e);var" r="this._capturingListeners&&this._capturingListeners._callbackTable[h],s=this._bubblingListeners&&this._bubblingListeners._callbackTable[h];(r&&r.length">0||s&&s.length>0)&&this.emit(h)}},getScale:function(){return this._scaleX!==this._scaleY&&cc.logID(1603),this._scaleX},setScale:function(t,e){"object"==typeof t?(e=t.y,t=t.x):e=e||0===e?e:t,this._scaleX===t&&this._scaleY===e||(this._scaleX=t,this._scaleY=e,this._sgNode.setScale(t,e),this.emit(d))},getContentSize:function(t){if(this._sizeProvider&&!t){var e=this._sizeProvider.getContentSize();return this._contentSize=e,cc.size(e)}return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._sizeProvider&&this._sizeProvider.setContentSize(i),this.emit(l)},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB!==t){this._opacityModifyRGB=t,this._sgNode.setOpacityModifyRGB(t);var e=this._sizeProvider;e instanceof _ccsg.Node&&e!==this._sgNode&&e.setOpacityModifyRGB(t)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setGlobalZOrder:function(t){this._globalZOrder=t,this._sgNode.setGlobalZOrder(t)},getGlobalZOrder:function(){return this._globalZOrder=this._sgNode.getGlobalZOrder(),this._globalZOrder},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}var n=this._sizeProvider;n instanceof _ccsg.Node&&n.setAnchorPoint(i),this.emit(u)},getAnchorPointInPoints:function(){return this._sgNode.getAnchorPointInPoints()},getDisplayedOpacity:function(){return this._sgNode.getDisplayedOpacity()},_updateDisplayedOpacity:function(t){this._sgNode.updateDisplayedOpacity(t)},getDisplayedColor:function(){return this._sgNode.getDisplayedColor()},getNodeToParentTransformAR:function(){var t=this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(!this._isSgTransformArToMe(t)){var i=this._anchorPoint.x*t.width,n=this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return e},getBoundingBox:function(){var t=this.getContentSize(),e=cc.rect(0,0,t.width,t.height);return cc._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},getBoundingBoxToWorld:function(){var t;return this.parent&&(t=this.parent.getNodeToWorldTransformAR()),this._getBoundingBoxTo(t)},_getBoundingBoxTo:function(t){var e=this.getContentSize(),i=e.width,n=e.height,r=cc.rect(-this._anchorPoint.x*i,-this._anchorPoint.y*n,i,n),s=cc.affineTransformConcat(this.getNodeToParentTransformAR(),t);if(cc._rectApplyAffineTransformIn(r,s),!this._children)return r;for(var o=this._children,a=0;a<o.length;a++){var 0="==e.width&&0===e.height&&(0!==t.width||0!==t.height)||!!this._sgNode.isIgnoreAnchorPointForPosition()},convertToNodeSpace:function(t){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var" c="o[a];if(c&&c.active){var" h="c._getBoundingBoxTo(s);h&&(r=cc.rectUnion(r,h))}}return" r},getnodetoparenttransform:function(){var="" t="this.getContentSize(),e=this._sgNode.getNodeToParentTransform();if(this._isSgTransformArToMe(t)){var" i="-this._anchorPoint.x*t.width,n=-this._anchorPoint.y*t.height,r=cc.affineTransformMake(1,0,0,1,i,n);e=cc.affineTransformConcatIn(r,e)}return" e},getnodetoworldtransform:function(){var="" e="this._sgNode.getNodeToWorldTransform();if(this._isSgTransformArToMe(t)){var" e},getnodetoworldtransformar:function(){var="" e},getparenttonodetransform:function(){return="" this._sgnode.getparenttonodetransform()},getworldtonodetransform:function(){return="" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene(),this._sgNode.getWorldToNodeTransform()},_isSgTransformArToMe:function(t){var" cc.padd(e,cc.p(this._anchorpoint.x*this._contentsize.width,this._anchorpoint.y*this._contentsize.height))},converttoworldspace:function(t){cc._rendertype="==cc.game.RENDER_TYPE_CANVAS&&cc.director._visitScene();var" cc.v2(this._sgnode.converttoworldspace(cc.v2(e,i)))},converttonodespacear:function(t){return="" this.converttonodespace(t.getlocation())},converttouchtonodespacear:function(t){return="" this.converttonodespacear(t.getlocation())},setnodedirty:function(){this._sgnode.setnodedirty()},addchild:function(t,e,i){e="void" n,r="!1;"undefined"==typeof" i?(i="void" 0,n="t._name):cc.js.isString(i)?(n=i,i=void" 0):cc.js.isnumber(i)&&(r="!0,n=""),cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.parent=this,t.zIndex=e,r?t.setTag(i):t.setName(n)},cleanup:function(){m&&cc.director.getActionManager().removeAllActionsFromTarget(this),cc.eventManager.removeListeners(this);var" t,e,i="this._children.length;for(t=0;t<i;++t)e=this._children[t],e&&e.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var">1){var e,i,n,r=t.length;for(e=1;e<r;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localzorder)t[i+1]=t[i];else{if(!(n._localzorder===t[i]._localzorder&&n._sgnode._arrivalorder<t[i]._sgnode._arrivalorder))break;t[i+1]=t[i]}i--}t[i+1]=n}this.emit(f)}cc.director.__fastoff(cc.director.event_after_update,this.sortallchildren,this)}},_delaysort:function(){this._reorderchilddirty||(this._reorderchilddirty=!0,cc.director.__faston(cc.director.event_after_update,this.sortallchildren,this))},_updatedummysgnode:function(){var t="this,e=t._sgNode;e.setPosition(t._position),e.setRotationX(t._rotationX),e.setRotationY(t._rotationY),e.setScale(t._scaleX,t._scaleY),e.setSkewX(t._skewX),e.setSkewY(t._skewY),e.setIgnoreAnchorPointForPosition(t.__ignoreAnchor);var" i="e._arrivalOrder;e.setLocalZOrder(t._localZOrder),e._arrivalOrder=i,e.setGlobalZOrder(t._globalZOrder),e.setOpacity(t._opacity),e.setOpacityModifyRGB(t._opacityModifyRGB),e.setCascadeOpacityEnabled(t._cascadeOpacityEnabled),e.setTag(t._tag)},_updateSgNode:function(){this._updateDummySgNode();var" e="m?cc.director.getActionManager():null;this._activeInHierarchy?(e&&e.resumeTarget(this),cc.eventManager.resumeTarget(this)):(e&&e.pauseTarget(this),cc.eventManager.pauseTarget(this))},_removeSgNode:o.removeSgNode,onRestore:!1}),P=["parent","tag","skewX","skewY","position","rotation","rotationX","rotationY","scale","scaleX","scaleY","opacity","color"],O={x:["getPositionX","setPositionX"],y:["getPositionY","setPositionY"],zIndex:["getLocalZOrder","setLocalZOrder"],opacityModifyRGB:["isOpacityModifyRGB","setOpacityModifyRGB"],cascadeOpacity:["isCascadeOpacityEnabled","setCascadeOpacityEnabled"]};p.propertyDefine(R,P,O),R.EventType=v,cc.Node=e.exports=R}),{"./utils/base-node":219,"./utils/misc":223,"./utils/prefab-helper":225,"./utils/scene-graph-helper":226}],42:[(function(t,e,i){var" n="function(){};cc.Scene=cc.Class({name:"cc.Scene",extends:t("./CCNode"),properties:{autoReleaseAssets:void" 0},ctor:function(){var="" _ccsg.scene;t.setanchorpoint(0,0),this._anchorpoint.x="0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){this._super(),this._activeInHierarchy=!1},_onHierarchyChanged:n,_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(),this._inited=!0)},_activate:function(t){t=t!==!1,cc.director._nodeActivator.activateNode(this,t)}}),e.exports=cc.Scene}),{"./CCNode":41}],43:[(function(t,e,i){function" n(){this._scheduler="null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0,this._target=null,this._callback=null}var" r="20,s=function(t,e,i,n,r,s,o){this.prev=t,this.next=e,this.callback=i,this.target=n,this.priority=r,this.paused=s,this.markedForDeletion=o,this.isUpdate=!i},o=[];s.get=function(t,e,i,n,r,a,c){var" h="o.pop();return" h?(h.prev="t,h.next=e,h.callback=i,h.target=n,h.priority=r,h.paused=a,h.markedForDeletion=c,h.isUpdate=!i):h=new" s(t,e,i,n,r,a,c),h},s.put="function(t){o.length<r&&(t.prev=t.next=t.callback=t.target=null,o.push(t))};var" a="function(t,e,i,n){this.list=t,this.entry=e,this.target=i,this.callback=n},c=[];a.get=function(t,e,i,n){var" r?(r.list="t,r.entry=e,r.target=i,r.callback=n):r=new" a(t,e,i,n),r},a.put="function(t){c.length<r&&(t.list=t.entry=t.target=t.callback=null,c.push(t))};var" o="this;o.timers=t,o.target=e,o.timerIndex=i,o.currentTimer=n,o.currentTimerSalvaged=r,o.paused=s},l=[];h.get=function(t,e,i,n,r,s){var" o?(o.timers="t,o.target=e,o.timerIndex=i,o.currentTimer=n,o.currentTimerSalvaged=r,o.paused=s):o=new" h(t,e,i,n,r,s),o},h.put="function(t){l.length<r&&(t.timers=t.target=t.currentTimer=null,l.push(t))};var" u="n.prototype;u.initWithCallback=function(t,e,i,n,r,s){return" this._scheduler="t,this._target=i,this._callback=e,this._elapsed=-1,this._interval=n,this._delay=s,this._useDelay=this._delay">0,this._repeat=r,this._runForever=this._repeat===cc.macro.REPEAT_FOREVER,!0},u.getInterval=function(){return this._interval},u.setInterval=function(t){this._interval=t},u.update=function(t){this._elapsed===-1?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=t,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},u.getCallback=function(){return this._callback},u.trigger=function(){this._target&&this._callback&&this._callback.call(this._target,this._elapsed)},u.cancel=function(){this._scheduler.unschedule(this._callback,this._target)};var _=[];n.get=function(){return _.pop()||new n},n.put=function(t){_.length<r&&(t._scheduler=t._target=t._callback=null,_.push(t))};var d="function(t){return" t.__instanceid||t.uuid};cc.scheduler="cc._Class.extend({ctor:function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates={},this._hashForTimers={},this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},_removeHashElement:function(t){delete" this._hashfortimers[d(t.target)];for(var="" e="this._arrayForTimers,i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);break}h.put(t)},_removeUpdateFromHash:function(t){var" r="n.list,o=n.entry,c=0,h=r.length;c<h;c++)if(r[c]===o){r.splice(c,1);break}delete" i._hashforupdates[e],s.put(o),a.put(n)}},_priorityin:function(t,e,i){for(var="" n="0;n<t.length;n++)if(i<t[n].priority)return" void="" t.splice(n,0,e);t.push(e)},_appendin:function(t,e){t.push(e)},settimescale:function(t){this._timescale="t},getTimeScale:function(){return" this._timescale},update:function(t){this._updatehashlocked="!0,1!==this._timeScale&&(t*=this._timeScale);var" e,i,n,r;for(e="0,i=this._updatesNegList,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));for(e=0,i=this._updates0List,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));for(e=0,i=this._updatesPosList,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||(r.isUpdate?r.target.update(t):r.callback.call(r.target,t));var" s,o="this._arrayForTimers;for(e=0;e<o.length;e++){if(s=o[e],this._currentTarget=s,this._currentTargetSalvaged=!1,!s.paused)for(s.timerIndex=0;s.timerIndex<s.timers.length;++s.timerIndex)s.currentTimer=s.timers[s.timerIndex],s.currentTimerSalvaged=!1,s.currentTimer.update(t),s.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&(this._removeHashElement(this._currentTarget),--e)}for(e=0,i=this._updatesNegList;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updates0List;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updatesPosList;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;this._updateHashLocked=!1,this._currentTarget=null},scheduleCallbackForTarget:function(t,e,i,n,r,s){this.schedule(e,t,i,n,r,s)},schedule:function(t,e,i,r,s,o){"use" strict";if("function"!="typeof" t){var="" a="t;t=e,e=a}4!==arguments.length&&5!==arguments.length||(o=r,r=cc.macro.REPEAT_FOREVER,s=0),cc.assertID(e,1502);var" c="d(e);cc.assertID(c,1510);var" l="this._hashForTimers[c];l?cc.assert(l.paused===o,""):(l=h.get(null,e,0,null,null,o),this._arrayForTimers.push(l),this._hashForTimers[c]=l);var" u,_;if(null="=l.timers)l.timers=[];else" for(_="0;_<l.timers.length;++_)if(u=l.timers[_],u&&t===u._callback)return" cc.logid(1507,u.getinterval(),i),void(u._interval="i);u=n.get(),u.initWithCallback(this,t,e,i,r,s),l.timers.push(u)},scheduleUpdate:function(t,e,i,n){var" o="this._hashForUpdates[r];if(o&&o.entry){if(o.entry.priority===e)return" o.entry.markedfordeletion="!1,void(o.entry.paused=i);if(this._updateHashLocked)return" cc.logid(1506),o.entry.markedfordeletion="!1,void(o.entry.paused=i);this.unscheduleUpdate(t)}var" c,h="s.get(null,null,n,t,e,i,!1);0===e?(c=this._updates0List,this._appendIn(c,h)):(c=e<0?this._updatesNegList:this._updatesPosList,this._priorityIn(c,h,e)),this._hashForUpdates[r]=a.get(c,h,t,null)},unschedule:function(t,e){if(e&&t){var" i="d(e);cc.assertID(i,1510);var" h="o[a];if(t===h._callback)return" h!="=s.currentTimer||s.currentTimerSalvaged||(s.currentTimerSalvaged=!0),o.splice(a,1),n.put(h),s.timerIndex">=a&&s.timerIndex--,void(0===o.length&&(r._currentTarget===s?r._currentTargetSalvaged=!0:r._removeHashElement(s)))}}},unscheduleUpdate:function(t){if(t){var e=d(t);cc.assertID(e,1510);var i=this._hashForUpdates[e];i&&(this._updateHashLocked?i.entry.markedForDeletion=!0:this._removeUpdateFromHash(i.entry))}},unscheduleAllForTarget:function(t){if(t){var e=d(t);cc.assertID(e,1510);var i=this._hashForTimers[e];if(i){var r=i.timers;r.indexOf(i.currentTimer)>-1&&!i.currentTimerSalvaged&&(i.currentTimerSalvaged=!0);for(var s=0,o=r.length;s<o;s++)n.put(r[s]);r.length=0,this._currenttarget===i?this._currenttargetsalvaged=!0:this._removehashelement(i)}this.unscheduleupdate(t)}},unscheduleall:function(){this.unscheduleallwithminpriority(cc.scheduler.priority_system)},unscheduleallwithminpriority:function(t){var e,i,n="this._arrayForTimers;for(e=n.length-1;e">=0;e--)i=n[e],this.unscheduleAllForTarget(i.target);var r,s=0;if(t<0)for(e=0;e<this._updatesneglist.length;)s=this._updatesneglist.length,r=this._updatesneglist[e],r&&r.priority>=t&&this.unscheduleUpdate(r.target),s==this._updatesNegList.length&&e++;if(t<=0)for(e=0;e<this._updates0list.length;)s=this._updates0list.length,r=this._updates0list[e],r&&this.unscheduleupdate(r.target),s==this._updates0list.length&&e++;for(e=0;e<this._updatesposlist.length;)s=this._updatesposlist.length,r=this._updatesposlist[e],r&&r.priority>=t&&this.unscheduleUpdate(r.target),s==this._updatesPosList.length&&e++},isScheduled:function(t,e){cc.assertID(t,1508),cc.assertID(e,1509);var i=d(e);cc.assertID(i,1510);var n=this._hashForTimers[i];if(!n)return!1;if(null==n.timers)return!1;for(var r=n.timers,s=0;s<r.length;++s){var o="r[s];if(t===o._callback)return!0}return!1},pauseAllTargets:function(){return" this.pausealltargetswithminpriority(cc.scheduler.priority_system)},pausealltargetswithminpriority:function(t){var="" e,i,n,r="[],s=this,o=s._arrayForTimers;for(i=0,n=o.length;i<n;i++)e=o[i],e&&(e.paused=!0,r.push(e.target));var" a;if(t<0)for(i="0;i<this._updatesNegList.length;i++)a=this._updatesNegList[i],a&&a.priority">=t&&(a.paused=!0,r.push(a.target));if(t<=0)for(i=0;i<this._updates0list.length;i++)a=this._updates0list[i],a&&(a.paused=!0,r.push(a.target));for(i=0;i<this._updatesposlist.length;i++)a=this._updatesposlist[i],a&&a.priority>=t&&(a.paused=!0,r.push(a.target));return r},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)this.resumetarget(t[e])},pausetarget:function(t){cc.assertid(t,1503);var e="d(t);cc.assertID(e,1510);var" i="this,n=i._hashForTimers[e];n&&(n.paused=!0);var" r="i._hashForUpdates[e];r&&(r.entry.paused=!0)},resumeTarget:function(t){cc.assertID(t,1504);var" i.paused;var="" n="this._hashForUpdates[e];return!!n&&n.entry.paused},scheduleUpdateForTarget:function(t,e,i){this.scheduleUpdate(t,e,i)},unscheduleCallbackForTarget:function(t,e){this.unschedule(e,t)},unscheduleUpdateForTarget:function(t){this.unscheduleUpdate(t)},unscheduleAllCallbacksForTarget:function(t){this.unscheduleAllForTarget(t)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(t){this.unscheduleAllWithMinPriority(t)}}),cc.Scheduler.PRIORITY_SYSTEM=1<<31,cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1}),{}],44:[(function(t,e,i){var" cc.assetlibrary.getimporteddir(this._uuid)+"="" "+this._uuid+"="" "+this._rawfiles[0];cc.errorid(6400)}return""},visible:!1},rawurls:{get:function(){if(this._rawfiles){if(cc.assetlibrary){var="" t="cc.AssetLibrary.getImportedDir(this._uuid)+"/"+this._uuid+"/";return" this._rawfiles.map((function(e){return="" t+e}))}cc.errorid(6401)}return[]},visible:!1},_rawfiles:null},statics:{deserialize:function(t){return="" cc.deserialize(t)},preventdeferredloaddependents:!1},serialize:function(){return="" editor.serialize(this)},createnode:null,_setrawfiles:function(t){this._rawfiles="t.length">0?t:null},_preloadRawFiles:null}),e.exports=cc.Asset}),{"./CCRawAsset":50}],45:[(function(t,e,i){var n=cc.Class({name:"cc.AudioClip",extends:cc.RawAsset});cc.AudioClip=n,e.exports=n}),{}],46:[(function(t,e,i){var n=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null}});cc.BitmapFont=n,e.exports=n}),{}],47:[(function(t,e,i){var n=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=n,e.exports=n}),{}],48:[(function(t,e,i){var n=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont});cc.LabelAtlas=n,e.exports=n}),{}],49:[(function(t,e,i){var n=cc.Class({name:"cc.Prefab",extends:cc.Asset,properties:{data:null,asyncLoadAssets:void 0,_createFunction:{default:null,serializable:!1}},createNode:!1,compileCreateFunction:function(){var e=t("../platform/instantiate-jit");this._createFunction=e.compile(this.data)},_doInstantiate:function(t){return this.data._prefab?this.data._prefab._synced=!0:cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(t)},_instantiate:function(){var t=this._doInstantiate();return this.data._instantiate(t),t}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")}),{"../platform/instantiate-jit":191}],50:[(function(t,e,i){var n=t("../platform/CCObject");cc.RawAsset=cc.Class({name:"cc.RawAsset",extends:n,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0})},statics:{createNodeByInfo:null}}),Object.defineProperty(cc.RawAsset,"isRawAssetType",{value:function(t){return cc.isChildClassOf(t,cc.RawAsset)&&!cc.isChildClassOf(t,cc.Asset)}}),e.exports=cc.RawAsset}),{"../platform/CCObject":179}],51:[(function(t,e,i){var n=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=n,e.exports=n}),{}],52:[(function(t,e,i){var n=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=n;var r=cc.Class({name:"cc.JavaScript",extends:n});cc._JavaScript=r;var s=cc.Class({name:"cc.CoffeeScript",extends:n});cc._CoffeeScript=s;var o=cc.Class({name:"cc.TypeScript",extends:n});cc._TypeScript=o}),{}],53:[(function(t,e,i){var n=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}return null},getSpriteFrame:function(t){return this._spriteFrames[t]},getSpriteFrames:function(){var t=[],e=this._spriteFrames;for(var i in e)t.push(e[i]);return t}});cc.SpriteAtlas=n,e.exports=n}),{}],54:[(function(t,e,i){var n=cc.Class({name:"cc.TTFFont",extends:cc.Font});cc.TTFFont=n,e.exports=n}),{}],55:[(function(t,e,i){t("./CCRawAsset"),t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCScripts"),t("./CCSceneAsset"),t("../sprites/CCSpriteFrame"),t("../textures/CCTexture2D"),t("./CCTTFFont"),t("./CCSpriteAtlas"),t("./CCBitmapFont"),t("./CCLabelAtlas")}),{"../sprites/CCSpriteFrame":211,"../textures/CCTexture2D":213,"./CCAsset":44,"./CCAudioClip":45,"./CCBitmapFont":46,"./CCFont":47,"./CCLabelAtlas":48,"./CCPrefab":49,"./CCRawAsset":50,"./CCSceneAsset":51,"./CCScripts":52,"./CCSpriteAtlas":53,"./CCTTFFont":54}],56:[(function(t,e,i){cc._tmp.PrototypeCCNode=function(){var t=_ccsg.Node.prototype;cc.defineGetterSetter(t,"x",t.getPositionX,t.setPositionX),cc.defineGetterSetter(t,"y",t.getPositionY,t.setPositionY),cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight),cc.defineGetterSetter(t,"anchorX",t._getAnchorX,t._setAnchorX),cc.defineGetterSetter(t,"anchorY",t._getAnchorY,t._setAnchorY),cc.defineGetterSetter(t,"skewX",t.getSkewX,t.setSkewX),cc.defineGetterSetter(t,"skewY",t.getSkewY,t.setSkewY),cc.defineGetterSetter(t,"zIndex",t.getLocalZOrder,t.setLocalZOrder),cc.defineGetterSetter(t,"vertexZ",t.getVertexZ,t.setVertexZ),cc.defineGetterSetter(t,"rotation",t.getRotation,t.setRotation),cc.defineGetterSetter(t,"rotationX",t.getRotationX,t.setRotationX),cc.defineGetterSetter(t,"rotationY",t.getRotationY,t.setRotationY),cc.defineGetterSetter(t,"scale",t.getScale,t.setScale),cc.defineGetterSetter(t,"scaleX",t.getScaleX,t.setScaleX),cc.defineGetterSetter(t,"scaleY",t.getScaleY,t.setScaleY),cc.defineGetterSetter(t,"children",t.getChildren),cc.defineGetterSetter(t,"childrenCount",t.getChildrenCount),cc.defineGetterSetter(t,"parent",t.getParent,t.setParent),cc.defineGetterSetter(t,"visible",t.isVisible,t.setVisible),cc.defineGetterSetter(t,"running",t.isRunning),cc.defineGetterSetter(t,"ignoreAnchor",t.isIgnoreAnchorPointForPosition,t.setIgnoreAnchorPointForPosition),cc.defineGetterSetter(t,"scheduler",t.getScheduler,t.setScheduler),cc.defineGetterSetter(t,"shaderProgram",t.getShaderProgram,t.setShaderProgram),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB),cc.defineGetterSetter(t,"cascadeOpacity",t.isCascadeOpacityEnabled,t.setCascadeOpacityEnabled),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),cc.defineGetterSetter(t,"cascadeColor",t.isCascadeColorEnabled,t.setCascadeColorEnabled)}}),{}],57:[(function(t,e,i){var n=!!cc.ActionManager,r=function(){};cc.s_globalOrderOfArrival=1,_ccsg.Node=cc.Class({name:"ccsg.Node",properties:{_running:!1,_localZOrder:0,_globalZOrder:0,_arrivalOrder:0,_reorderChildDirty:!1,_vertexZ:0,_customZ:void 0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:cc.p(0,0),_skewX:0,_skewY:0,_children:[],_visible:!0,_anchorPoint:cc.p(0,0),_contentSize:cc.size(0,0),_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.macro.NODE_TAG_INVALID,_showNode:!1,_name:"",_realOpacity:255,_realColor:cc.Color.WHITE,
_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_isTransitionFinished:!1,_actionManager:null,_scheduler:null,_renderCmd:null},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._renderCmd=this._createRenderCmd()},init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},getSkewX:function(){return this._skewX},setSkewX:function(t){this._skewX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(t){this._skewY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(t){this._parent?this._parent.reorderChild(this,t):this._localZOrder=t,cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(t){this._localZOrder=t},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.logID(1600),this.getLocalZOrder()},setZOrder:function(t){cc.logID(1601),this.setLocalZOrder(t)},setGlobalZOrder:function(t){this._globalZOrder!==t&&(this._globalZOrder=t,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(t){this._customZ=this._vertexZ=t},getRotation:function(){return this._rotationX!==this._rotationY&&cc.logID(1602),this._rotationX},setRotation:function(t){this._rotationX=this._rotationY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(t){this._rotationX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(t){this._rotationY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&cc.logID(1603),this._scaleX},setScale:function(t,e){this._scaleX=t,this._scaleY=e||0===e?e:t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(t){this._scaleX=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(t){this._scaleY=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},setPosition:function(t,e){var i=this._position;if(void 0===e){if(i.x===t.x&&i.y===t.y)return;i.x=t.x,i.y=t.y}else{if(i.x===t&&i.y===e)return;i.x=t,i.y=e}this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getPositionX:function(){return this._position.x},setPositionX:function(t){this._position.x=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(t){this._position.y=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(t){this._visible!==t&&(this._visible=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(t){this._anchorPoint.x!==t&&(this._anchorPoint.x=t,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(t){this._anchorPoint.y!==t&&(this._anchorPoint.y=t,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(t){this._contentSize.width=t,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(t){this._contentSize.height=t,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(t){this._parent=t;var e=_ccsg.Node._dirtyFlags;this._renderCmd.setDirtyFlag(e.transformDirty|e.opacityDirty)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},setIgnoreAnchorPointForPosition:function(t){t!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(t){this.tag=t},setName:function(t){this._name=t},getName:function(){return this._name},updateOrderOfArrival:function(){this._arrivalOrder=++cc.s_globalOrderOfArrival},getScheduler:function(){return this._scheduler||cc.director.getScheduler()},setScheduler:function(t){this._scheduler!==t&&(this.unscheduleAllCallbacks(),this._scheduler=t)},boundingBox:function(){return cc.logID(1608),this.getBoundingBox()},getBoundingBox:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(t,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var 0="==e?t._localZOrder:e;var" n="e[i];if(n&&n.tag===t)return" n}return="" null},getchildbyname:function(t){if(!t)return="" cc.log("invalid="" name"),null;for(var="" e="this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return" e[i];return="" null},addchild:function(t,e,i){e="void" n,r="!1;void" i?(n="i,i=void" 0):"number"="=typeof" i&&(r="!0,n=""),cc.assertID(t,1606),cc.assertID(null===t._parent,1605),this._addChildHelper(t,e,i,n,r)},_addChildHelper:function(t,e,i,n,r){this._children||(this._children=[]),this._insertChild(t,e),r?t.setTag(i):t.setName(n),t.setParent(this),t.updateOrderOfArrival(),this._running&&(t.performRecursive(_ccsg.Node.performType.onEnter),this._isTransitionFinished&&t.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish)),t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty),this._cascadeColorEnabled&&t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&t._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.opacityDirty)},removeFromParent:function(t){this._parent&&(void">-1&&this._detachChild(t,e),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.logID(1609);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.logID(1610,t)},removeAllChildrenWithCleanup:function(t){this.removeAllChildren(t)},removeAllChildren:function(t){var e=this._children;if(null!==e){void 0===t&&(t=!0);for(var i=0;i<e.length;i++){var n="e[i];n&&(this._running&&(n.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),n.performRecursive(_ccsg.Node.performType.onExit)),t&&n.performRecursive(_ccsg.Node.performType.cleanup),n.parent=null,n._renderCmd.detachFromParent())}this._children.length=0,cc.renderer.childrenOrderDirty=!0}},_detachChild:function(t,e){this._running&&(t.performRecursive(_ccsg.Node.performType.onExitTransitionDidStart),t.performRecursive(_ccsg.Node.performType.onExit)),e&&t.performRecursive(_ccsg.Node.performType.cleanup),t.parent=null,t._renderCmd.detachFromParent(),cc.js.array.remove(this._children,t)},_insertChild:function(t,e){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(t),t._setLocalZOrder(e)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.transformDirty)},reorderChild:function(t,e){return" cc.assertid(t,1617),this._children.indexof(t)="==-1?void" cc.logid(1635):void(e!="=t.zIndex&&(cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,t.updateOrderOfArrival(),t._setLocalZOrder(e),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.orderDirty)))},sortAllChildren:function(){if(this._reorderChildDirty){var" t,e,i,n="this._children,r=n.length;for(t=1;t<r;t++){for(i=n[t],e=t-1;e">=0;){if(i._localZOrder<n[e]._localzorder)n[e+1]=n[e];else{if(!(i._localzorder===n[e]._localzorder&&i._arrivalorder<n[e]._arrivalorder))break;n[e+1]=n[e]}e--}n[e+1]=i}this._reorderchilddirty=!1}},draw:function(t){},transformancestors:function(){null!==this._parent&&(this._parent.transformancestors(),this._parent.transform())},onenter:function(){this._istransitionfinished=!1,this._running=!0,this.resume()},performrecursive:function(t){var e="_ccsg.Node.performType;if(!(t">=e.max)){var i,n,r,s,o,a=0,c=_ccsg.Node._performStacks[_ccsg.Node._performing];for(c||(c=[],_ccsg.Node._performStacks.push(c)),c.length=0,_ccsg.Node._performing++,r=c[0]=this;r;){if(i=r._children,i&&i.length>0)for(s=0,o=i.length;s<o;++s)n=i[s],c.push(n);a++,r=c[a]}switch(t){case e.onenter:for(s="c.length-1;s">=0;--s)r=c[s],c[s]=null,r&&r.onEnter();break;case e.onExit:for(s=c.length-1;s>=0;--s)r=c[s],c[s]=null,r&&r.onExit();break;case e.onEnterTransitionDidFinish:for(s=c.length-1;s>=0;--s)r=c[s],c[s]=null,r&&r.onEnterTransitionDidFinish();break;case e.cleanup:for(s=c.length-1;s>=0;--s)r=c[s],c[s]=null,r&&r.cleanup();break;case e.onExitTransitionDidStart:for(s=c.length-1;s>=0;--s)r=c[s],c[s]=null,r&&r.onExitTransitionDidStart()}_ccsg.Node._performing--}},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0},onExitTransitionDidStart:function(){},onExit:function(){this._running=!1,this.pause()},runAction:n?function(t){return cc.assertID(t,1618),cc.director.getActionManager().addAction(t,this,!this._running),t}:r,stopAllActions:n?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:r,stopAction:n?function(t){cc.director.getActionManager().removeAction(t)}:r,stopActionByTag:n?function(t){return t===cc.Action.TAG_INVALID?void cc.logID(1612):void cc.director.getActionManager().removeActionByTag(t,this)}:r,getActionByTag:n?function(t){return t===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(t,this)}:function(){return null},getNumberOfRunningActions:n?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(t){this.scheduler.scheduleUpdate(this,t,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(t,e,i,n,r){var s=arguments.length;"function"==typeof t?1===s?(e=0,i=cc.macro.REPEAT_FOREVER,n=0,r=this.__instanceId):2===s?"number"==typeof e?(i=cc.macro.REPEAT_FOREVER,n=0,r=this.__instanceId):(r=e,e=0,i=cc.macro.REPEAT_FOREVER,n=0):3===s?("string"==typeof i?(r=i,i=cc.macro.REPEAT_FOREVER):r=this.__instanceId,n=0):4===s&&(r=this.__instanceId):1===s?(e=0,i=cc.macro.REPEAT_FOREVER,n=0):2===s&&(i=cc.macro.REPEAT_FOREVER,n=0),cc.assertID(t,1619),cc.assertID(e>=0,1620),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,this.scheduler.schedule(t,this,e,i,n,!this._running,r)},scheduleOnce:function(t,e,i){void 0===i&&(i=this.__instanceId),this.schedule(t,0,0,e,i)},unschedule:function(t){t&&this.scheduler.unschedule(t,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.logID(1614),this.resume()},resume:function(){this.scheduler.resumeTarget(this),n&&cc.director.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.logID(1615),this.pause()},pause:function(){this.scheduler.pauseTarget(this),n&&cc.director.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this)},getParentToNodeTransform:function(){return this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var t=this.getNodeToParentTransform(),e=this._parent;null!==e;e=e.parent)t=cc.affineTransformConcat(t,e.getNodeToParentTransform());return t},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(t){return cc.pointApplyAffineTransform(t,this.getWorldToNodeTransform())},convertToWorldSpace:function(t){return t=t||cc.v2(0,0),cc.pointApplyAffineTransform(t,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(t){return cc.pSub(this.convertToNodeSpace(t),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(t){t=t||cc.v2(0,0);var e=cc.pAdd(t,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(e)},_convertToWindowSpace:function(t){var e=this.convertToWorldSpace(t);return cc.director.convertToUI(e)},convertTouchToNodeSpace:function(t){var e=t.getLocation();return this.convertToNodeSpace(e)},convertTouchToNodeSpaceAR:function(t){var e=cc.director.convertToGL(t.getLocation());return this.convertToNodeSpaceAR(e)},updateTransform:function(){for(var t,e=this._children,i=0;i<e.length;i++){var t="e[i];t&&t.updateTransform()}},retain:function(){},release:function(){},visit:function(t){var" e="this._renderCmd,i=t?t._renderCmd:null;if(!this._visible)return" void="" e._propagateflagsdown(i);var="" n="cc.renderer;e.visit(i);var" r,s,o="this._children,a=o.length;if(a">0){for(this._reorderChildDirty&&this.sortAllChildren(),r=0;r<a&&(s=o[r],s._localzorder<0);r++)s.visit(this);for(n.pushrendercommand(e);r<a;r++)o[r].visit(this)}else 0="==t?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),t);if(cc._rectApplyAffineTransformIn(e,i),!this._children)return" n.pushrendercommand(e);e._dirtyflag="0},transform:function(t,e){this._renderCmd.transform(t,e)},nodeToParentTransform:function(){return" this.getnodetoparenttransform()},getnodetoparenttransform:function(t){var="" e="this._renderCmd.getNodeToParentTransform();if(t){for(var" i="{a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx,ty:e.ty},n=this._parent;null!=n&&n!=t;n=n.getParent())cc.affineTransformConcatIn(i,n.getNodeToParentTransform());return" i}return="" e},getnodetoparentaffinetransform:function(t){return="" this.getnodetoparenttransform(t)},getshaderprogram:function(){return="" this._rendercmd.getshaderprogram()},setshaderprogram:function(t){this._rendercmd.setshaderprogram(t)},getglserverstate:function(){return="" 0},setglserverstate:function(t){},getboundingboxtoworld:function(){var="" t="cc.rect(0,0,this._contentSize.width,this._contentSize.height),e=this.getNodeToWorldTransform();if(cc._rectApplyAffineTransformIn(t,e),!this._children)return" t;for(var="" r="i[n];if(r&&r._visible){var" s="r._getBoundingBoxToCurrentNode(e);s&&(t=cc.rectUnion(t,s))}}return" t},_getboundingboxtocurrentnode:function(t){var="" e;for(var="" n="this._children,r=0;r<n.length;r++){var" o="s._getBoundingBoxToCurrentNode(i);o&&(e=cc.rectUnion(e,o))}}return" e},getopacity:function(){return="" this._realopacity},getdisplayedopacity:function(){return="" this._rendercmd.getdisplayedopacity()},setopacity:function(t){this._realopacity="t,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(t){this._renderCmd._updateDisplayOpacity(t)},isCascadeOpacityEnabled:function(){return" this._cascadeopacityenabled},setcascadeopacityenabled:function(t){this._cascadeopacityenabled!="=t&&(this._cascadeOpacityEnabled=t,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var" cc.color(t.r,t.g,t.b,t.a)},getdisplayedcolor:function(){return="" this._rendercmd.getdisplayedcolor()},setcolor:function(t){var="" this._cascadecolorenabled},setcascadecolorenabled:function(t){this._cascadecolorenabled!="=t&&(this._cascadeColorEnabled=t,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_createRenderCmd:function(){return" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" _ccsg.node.canvasrendercmd(this):new="" _ccsg.node.webglrendercmd(this)}}),_ccsg.node.extend="cc._Class.extend,_ccsg.Node.prototype.ctor=_ccsg.Node,_ccsg.Node.performType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,onExitTransitionDidStart:5,max:6},_ccsg.Node._performStacks=[[]],_ccsg.Node._performing=0,cc.assertID("function"==typeof" cc._tmp.prototypeccnode,3200,"basenodespropertydefine.js"),cc._tmp.prototypeccnode(),delete="" cc._tmp.prototypeccnode}),{}],58:[(function(t,e,i){function="" n(t){var="" e,i,n,r,s,o,a="1,c=_ccsg.Node._performStacks[_ccsg.Node._performing];for(c||(c=[],_ccsg.Node._performStacks.push(c)),c.length=0,_ccsg.Node._performing++,c[0]=t;a;)if(a--,n=c[a],c[a]=null,n&&(e=n._children,e&&e.length">0))for(r=n._renderCmd,s=0,o=e.length;s<o;++s)i=e[s],c[a]=i,a++,i._rendercmd.transform(r);_ccsg.node._performing--}cc.customrendercmd=function(t,e){this._needdraw=!0,this._target=t,this._callback=e},cc.customrendercmd.prototype.rendering=function(t,e,i){this._callback&&this._callback.call(this._target,t,e,i)};var 0="==t){var" r="_ccsg.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,contentDirty:512,COUNT:9};cc.js.get(r,"all",(function(){var" t="r.COUNT;return(1<<t)-1}),!1),_ccsg.Node._requestDirtyFlag=function(t){cc.assertID(!r[t],1622,t);var" e="r.COUNT,i=1<<e;return" r[t]="i,r.COUNT++,i};var" s="Math.PI/180;_ccsg.Node.RenderCmd=function(t){this._node=t,this._anchorPointInPoints=new" cc.vec2(0,0),this._needdraw="!1,this._dirtyFlag=1,this._curLevel=-1,this._displayedColor=new" cc.color(255,255,255,255),this._displayedopacity="255,this._cascadeColorEnabledDirty=!1,this._cascadeOpacityEnabledDirty=!1,this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0},this._transformUpdated=!1,cc.renderer.pushDirtyNode(this)},_ccsg.Node.RenderCmd.prototype={constructor:_ccsg.Node.RenderCmd,_ctor:_ccsg.Node.RenderCmd,getAnchorPointInPoints:function(){return" cc.p(this._anchorpointinpoints)},getdisplayedcolor:function(){var="" cc.color(t.r,t.g,t.b,t.a)},getdisplayedopacity:function(){return="" this._displayedopacity},setcascadecolorenableddirty:function(){this._cascadecolorenableddirty="!0,this.setDirtyFlag(r.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(r.opacityDirty)},getParentToNodeTransform:function(){return" this._dirtyflag&r.transformdirty&&cc.affinetransforminvertout(this.getnodetoparenttransform(),this._inverse),this._inverse},detachfromparent:function(){},_updateanchorpointinpoint:function(){var="" this._node&&this._node._parent&&this._node._parent._rendercmd?this._node._parent._rendercmd:null},transform:function(t,e){var="" i="this._node,r=t?t._worldTransform:null,o=this._transform,a=this._worldTransform;if(!this._transformUpdated){var" c="i._rotationX||i._rotationY,h=i._skewX||i._skewY,l=i._scaleX,u=i._scaleY,_=this._anchorPointInPoints.x,d=this._anchorPointInPoints.y,f=1,p=0,m=0,g=1;if(c||h){if(o.tx=i._position.x,o.ty=i._position.y,c){var" v="i._rotationX*s;if(m=Math.sin(v),g=Math.cos(v),i._rotationY===i._rotationX)f=g,p=-m;else{var" y="i._rotationY*s;f=Math.cos(y),p=-Math.sin(y)}}if(o.a=f*=l,o.b=p*=l,o.c=m*=u,o.d=g*=u,h){var" x="Math.tan(i._skewX*s),T=Math.tan(i._skewY*s);x===1/0&&(x=99999999),T===1/0&&(T=99999999),o.a=f+m*T,o.b=p+g*T,o.c=m+f*x,o.d=g+p*x}(_||d)&&(o.tx-=o.a*_+o.c*d,o.ty-=o.b*_+o.d*d,i._ignoreAnchorPointForPosition&&(o.tx+=_,o.ty+=d))}else" o.a="l,o.b=0,o.c=0,o.d=u,o.tx=i._position.x,o.ty=i._position.y,(_||d)&&(o.tx-=o.a*_,o.ty-=o.d*d,i._ignoreAnchorPointForPosition&&(o.tx+=_,o.ty+=d))}r?(a.a=o.a*r.a+o.b*r.c,a.b=o.a*r.b+o.b*r.d,a.c=o.c*r.a+o.d*r.c,a.d=o.c*r.b+o.d*r.d,a.tx=o.tx*r.a+o.ty*r.c+r.tx,a.ty=o.tx*r.b+o.ty*r.d+r.ty):(a.a=o.a,a.b=o.b,a.c=o.c,a.d=o.d,a.tx=o.tx,a.ty=o.ty),this._currentRegion&&(this._updateCurrentRegions(),this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble)),e&&n(i)},getNodeToParentTransform:function(){return" this._dirtyflag&r.transformdirty&&this.transform(),this._transform},setnodetoparenttransform:function(t){t?(this._transform="t,this._transformUpdated=!0):this._transformUpdated=!1,this.setDirtyFlag(r.transformDirty)},_propagateFlagsDown:function(t){var" e,i,n,s,o="this._node,a=this._displayedColor,c=o._realColor;if(this._notifyRegionStatus&&this._notifyRegionStatus(_ccsg.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){a.r=c.r,a.g=c.g,a.b=c.b;var" h="new" cc.color(255,255,255,255);for(n="o._children,e=0,i=n.length;e<i;e++)s=n[e],s&&s._renderCmd&&s._renderCmd._updateDisplayColor(h);this._cascadeColorEnabledDirty=!1}else{if(void" l="o._parent;t=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.Color.WHITE}if(a.r=0|c.r*t.r/255,a.g=0|c.g*t.g/255,a.b=0|c.b*t.b/255,o._cascadeColorEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)s=n[e],s&&s._renderCmd&&(s._renderCmd._updateDisplayColor(a),s._renderCmd._updateColor())}this._dirtyFlag&=~r.colorDirty},_updateDisplayOpacity:function(t){var" a="o._parent;t=255,a&&a._cascadeOpacityEnabled&&(t=a.getDisplayedOpacity())}if(this._displayedOpacity=o._realOpacity*t/255,o._cascadeOpacityEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)s=n[e],s&&s._renderCmd&&(s._renderCmd._updateDisplayOpacity(this._displayedOpacity),s._renderCmd._updateColor())}this._dirtyFlag&=~r.opacityDirty},_syncDisplayColor:function(t){var" cc.region,this._oldregion="new" cc.region,this._regionflag="0},_ccsg.Node.CanvasRenderCmd.RegionStatus={NotDirty:0,Dirty:1,DirtyDouble:2};var" o="_ccsg.Node.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.RenderCmd.prototype);o.constructor=_ccsg.Node.CanvasRenderCmd,o._rootCtor=_ccsg.Node.CanvasRenderCmd,o._notifyRegionStatus=function(t){this._needDraw&&this._regionFlag<t&&(this._regionFlag=t)};var" cc.rect;o.getlocalbb="function(){var" a.x="a.y=0,a.width=t._contentSize.width,a.height=t._contentSize.height,a},o._updateCurrentRegions=function(){var" t,e="this._node._children,i=0,n=e.length;i<n;i++)t=e[i],t&&t._renderCmd&&t._renderCmd.detachFromParent()},o.setShaderProgram=function(t){},o.getShaderProgram=function(){return" null},_ccsg.node.canvasrendercmd._getcompositeoperationbyblendfunc="function(t){return" t?t.src="==cc.macro.SRC_ALPHA&&t.dst===cc.macro.ONE||t.src===cc.macro.ONE&&t.dst===cc.macro.ONE?"lighter":t.src===cc.macro.ZERO&&t.dst===cc.macro.SRC_ALPHA?"destination-in":t.src===cc.macro.ZERO&&t.dst===cc.macro.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}),{}],59:[(function(t,e,i){_ccsg.Node.WebGLRenderCmd=function(t){this._ctor(t),this._shaderProgram=null};var" n="_ccsg.Node.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.RenderCmd.prototype);n.constructor=_ccsg.Node.WebGLRenderCmd,n._rootCtor=_ccsg.Node.WebGLRenderCmd,n._updateColor=function(){},n.setShaderProgram=function(t){this._shaderProgram=t},n.getShaderProgram=function(){return" this._shaderprogram}}),{}],60:[(function(t,e,i){function="" n(t){return="" instanceof="" cc.scene?cc.visiblerect:!t._sizeprovider||t._sizeprovider="" _ccsg.node?t._contentsize:t.getcontentsize()}function="" r(t,e,i,n){for(var="" i.x="i.y=0,void(n.x=n.y=1);if(c===e)break;var" s(t,e){var="" i,s,o,a="e._target;a?(i=a,s=g,o=v,r(t,i,s,o)):i=t._parent;var" cc.scene,u="t._position.x,_=t._position.y,d=t._anchorPoint;if(e._alignFlags&p){var" f,y,x="c.width;l?(f=cc.visibleRect.left.x,y=cc.visibleRect.right.x):(f=-h.x*x,y=f+x),f+=e._isAbsLeft?e._left:e._left*x,y-=e._isAbsRight?e._right:e._right*x,a&&(f+=s.x,f*=o.x,y+=s.x,y*=o.x);var" t,b="d.x,C=t._scaleX;if(C<0&&(b=1-b,C=-C),e.isStretchWidth)T=y-f,0!==C&&(t.width=T/C),u=f+b*T;else" if(t="t.width*C,e.isAlignHorizontalCenter){var" u="e.isAlignLeft?f+b*T:y+(b-1)*T}if(e._alignFlags&m){var" e,w,i="c.height;l?(w=cc.visibleRect.bottom.y,E=cc.visibleRect.top.y):(w=-h.y*I,E=w+I),w+=e._isAbsBottom?e._bottom:e._bottom*I,E-=e._isAbsTop?e._top:e._top*I,a&&(w+=s.y,w*=o.y,E+=s.y,E*=o.y);var" r,p="d.y,O=t._scaleY;if(O<0&&(P=1-P,O=-O),e.isStretchHeight)R=E-w,0!==O&&(t.height=R/O),_=w+P*R;else" if(r="t.height*O,e.isAlignVerticalCenter){var" b="e._isAbsVerticalCenter?e._verticalCenter:e._verticalCenter*I,D=(.5-h.y)*c.height;a&&(B*=o.y,D+=s.y,D*=o.y),_=D+(P-.5)*R+B}else" _="e.isAlignBottom?w+P*R:E+(P-1)*R}t.setPosition(u,_)}function" o(t){var="" a(){var="" e,i="x._activeWidgetsIterator;for(i.i=0;i.i<y.length;++i.i)e=y[i.i],s(e.node,e)}x.isAligning=!1}}function" c(t){var="" cc.js.array.mutableforwarditerator(y),init:function(t){t.on(cc.director.event_before_visit,a)},add:function(t){t.node._widget="t,this._nodesOrderDirty=!0},remove:function(t){t.node._widget=null,this._activeWidgetsIterator.remove(t)},updateAlignment:c}}),{}],61:[(function(t,e,i){t("./CCSGCameraNode");var" _ccsg.node;return="" t.settransform="t.addTarget=t.removeTarget=function(){},t}return" new="" _ccsg.cameranode},_initsgnode:function(){},_addsgtargetinsg:function(t){t="" cc.node?this._sgnode.addtarget(t._sgnode):t="" _ccsg.node&&this._sgnode.addtarget(t)},_removetargetinsg:function(t){t="" cc.node?this._sgnode.removetarget(t._sgnode):t="" _ccsg.node&&this._sgnode.removetarget(t)},onenable:function(){if(r.main)return="" void="" cc.errorid(8300);r.main="this;for(var" this._targets},calculatecameratransformin:function(t){var="" cc.math.matrix4,this._mat.identity(),this._beforevisitcmd="new" cc.customrendercmd(this,this._onbeforevisit),this._aftervisitcmd="new" cc.customrendercmd(this,this._onaftervisit)},settransform:function(t,e,i,n,r,s){var="" 0)},_visit:function(t){="" var="" this._offset},set:function(t){this._offset="t},type:cc.Vec2},size:{tooltip:!1,get:function(){return" this._size},set:function(t){this._size.width="t.width<0?0:t.width,this._size.height=t.height<0?0:t.height},type:cc.Size}},resetInEditor:!1});var" this._radius},set:function(t){this._radius="t<0?0:t}}},resetInEditor:!1});var" e,i,n="this._colliders;for(e=0,i=n.length;e<i;e++)this.updateCollider(n[e]);var" i;switch(t){case="" r.collisionenter:i="onCollisionEnter" ;break;case="" r.collisionstay:i="onCollisionStay" r.collisionexit:i="onCollisionExit" }var="" n,s,o,a="e.collider1,c=e.collider2,h=a.node._components,l=c.node._components;for(n=0,s=h.length;n<s;n++)o=h[n],o[i]&&o[i](c,a);for(n=0,s=l.length;n<s;n++)o=l[n],o[i]&&o[i](a,c)},shouldCollide:function(t,e){var" i!="=n&&r[i.groupIndex][n.groupIndex]},initCollider:function(t){if(!t.world){var" cc.boxcollider?(e.position="null,e.points=[cc.v2(),cc.v2(),cc.v2(),cc.v2()]):t" cc.polygoncollider?(e.position="null,e.points=t.points.map((function(t){return" cc.v2(t.x,t.y)}))):t="" cc.circlecollider&&(e.position="cc.v2(),e.points=null)}},updateCollider:function(t){var" cc.boxcollider){var="" f="Math.min(l.x,u.x,_.x,d.x),p=Math.min(l.y,u.y,_.y,d.y),m=Math.max(l.x,u.x,_.x,d.x),g=Math.max(l.y,u.y,_.y,d.y);n.x=f,n.y=p,n.width=m-f,n.height=g-p}else" cc.circlecollider){var="" cc.polygoncollider){var="">m&&(m=v.x),v.x<f&&(f=v.x),v.y>g&&(g=v.y),v.y<p&&(p=v.y)}n.x=f,n.y=p,n.width=m-f,n.height=g-p}},addcollider:function(t){var e="this._colliders,i=e.indexOf(t);if(i===-1){for(var" r="0,s=e.length;r<s;r++){var" o="e[r];if(this.shouldCollide(t,o)){var" a="new" n(t,o);this._contacts.push(a)}}e.push(t),this.initcollider(t)}t.node.on("group-changed",this.onnodegroupchanged,this)},removecollider:function(t){var="">=0){e.splice(i,1);for(var n=this._contacts,s=n.length-1;s>=0;s--){var o=n[s];o.collider1!==t&&o.collider2!==t||(o.touching&&this._doCollide(r.CollisionExit,o),n.splice(s,1))}t.node.off("group-changed",this.onNodeGroupChanged,this)}else cc.errorID(6600)},attachDebugDrawToCamera:function(t){this._debugDrawer&&t.addTarget(this._debugDrawer)},detachDebugDrawFromCamera:function(t){this._debugDrawer&&t.removeTarget(this._debugDrawer)},onNodeGroupChanged:function(t){for(var e=t.currentTarget,i=e.getComponents(cc.Collider),n=0,r=i.length;n<r;n++)this.removecollider(i[n]),this.addcollider(i[n])},drawcolliders:function(){var t="this._debugDrawer;if(this._enabledDebugDraw&&t){t.clear();for(var" e="this._colliders,i=0,n=e.length;i<n;i++){var" r="e[i];if(r" instanceof="" cc.boxcollider||r="" cc.polygoncollider){var="" s="r.world.points;if(s.length">0){t.strokeColor=cc.Color.WHITE,t.moveTo(s[0].x,s[0].y);for(var o=1;o<s.length;o++)t.lineto(s[o].x,s[o].y);t.close(),t.stroke()}}else r="" instanceof="" cc.circlecollider&&(t.circle(r.world.position.x,r.world.position.y,r.world.radius),t.stroke());if(this.enableddrawboundingbox){var="" a="r.world.aabb;t.strokeColor=cc.Color.BLUE,t.moveTo(a.xMin,a.yMin),t.lineTo(a.xMin,a.yMax),t.lineTo(a.xMax,a.yMax),t.lineTo(a.xMax,a.yMin),t.close(),t.stroke()}}}},onSceneLaunched:function(){this._enabledDebugDraw&&this._debugDrawer&&(this._debugDrawer.removeFromParent(),cc.director.getScene()._sgNode.addChild(this._debugDrawer))}});cc.js.getset(a.prototype,"enabledDebugDraw",(function(){return" this._enableddebugdraw}),(function(t){t&&!this._enableddebugdraw?(this._debugdrawer||(this._debugdrawer="new" _ccsg.graphicsnode,this._debugdrawer.retain()),cc.director.getscene()._sgnode.addchild(this._debugdrawer),cc.director.on(cc.director.event_after_scene_launch,this.onscenelaunched,this)):!t&&this._enableddebugdraw&&(this._debugdrawer.clear(),this._debugdrawer.removefromparent(!1),cc.director.off(cc.director.event_after_scene_launch,this.onscenelaunched,this)),this._enableddebugdraw="t})),cc.CollisionManager=e.exports=a}),{"./CCContact":67}],67:[(function(t,e,i){function" n(t,e){this.collider1="t,this.collider2=e,this.touching=!1;var" i="t" cc.boxcollider||t="" cc.polygoncollider,n="e" cc.boxcollider||e="" cc.polygoncollider,s="t" cc.circlecollider,o="e" cc.circlecollider;i&&n?this.testfunc="r.polygonPolygon:s&&o?this.testFunc=r.circleCircle:i&&o?this.testFunc=r.polygonCircle:s&&n?(this.testFunc=r.polygonCircle,this.collider1=e,this.collider2=t):cc.errorID(6601,cc.js.getClassName(t),cc.js.getClassName(e))}var" t="this.collider1.world,e=this.collider2.world;return!!t.aabb.intersects(e.aabb)&&(this.testFunc===r.polygonPolygon?this.testFunc(t.points,e.points):this.testFunc===r.circleCircle?this.testFunc(t,e):this.testFunc===r.polygonCircle&&this.testFunc(t.points,e))},n.prototype.updateState=function(){var" t&&!this.touching?(this.touching="!0,e=s.CollisionEnter):t&&this.touching?e=s.CollisionStay:!t&&this.touching&&(this.touching=!1,e=s.CollisionExit),e},n.CollisionType=s,e.exports=n}),{"./CCIntersection":68}],68:[(function(t,e,i){function" n(t,e,i,n){var="" r(t,e,i){var="" cc.vec2(i.x,i.y),s="new" cc.vec2(i.x,i.ymax),o="new" cc.vec2(i.xmax,i.ymax),a="new" cc.vec2(i.xmax,i.y);return!!n(t,e,r,s)||(!!n(t,e,s,o)||(!!n(t,e,o,a)||!!n(t,e,a,r)))}function="" s(t,e,i){for(var="" o="i[s],a=i[(s+1)%r];if(n(t,e,o,a))return!0}return!1}function" o(t,e){var="" i<="c&&r">=o&&n<=h&&s>=a}function a(t,e){var i,n,r=new cc.Vec2(t.x,t.y),o=new cc.Vec2(t.x,t.yMax),a=new cc.Vec2(t.xMax,t.yMax),c=new cc.Vec2(t.xMax,t.y);if(s(r,o,e))return!0;if(s(o,a,e))return!0;if(s(a,c,e))return!0;if(s(c,r,e))return!0;for(i=0,n=e.length;i<n;++i)if(u(e[i],t))return!0;return!!u(r,e)||(!!u(o,e)||(!!u(a,e)||!!u(c,e)))}function c(t,e){var="" i,n;for(i="0,n=t.length;i<n;++i){var" r="t[i],o=t[(i+1)%n];if(s(r,o,e))return!0}for(i=0,n=e.length;i<n;++i)if(u(e[i],t))return!0;for(i=0,n=t.length;i<n;++i)if(u(t[i],e))return!0;return!1}function" h(t,e){var="" i="t.position.sub(e.position).mag();return" i<t.radius+e.radius}function="" l(t,e){var="" n="0,r=t.length;n<r;n++){var" s="0===n?t[t.length-1]:t[n-1],o=t[n];if(_(i,s,o,!0)<e.radius)return!0}return!1}function" u(t,e){for(var="" c="e[o].x,h=e[o].y,l=e[a].x,u=e[a].y,_=h">r!=u>r&&n<(l-c)*(r-h) (u-h)+c;_&&(i="!i)}return" i}function="" _(t,e,i,n){var="" r,s="i.x-e.x,o=i.y-e.y,a=s*s+o*o,c=((t.x-e.x)*s+(t.y-e.y)*o)/a;return" r="n?a?c<0?e:c">1?i:cc.v2(e.x+c*s,e.y+c*o):e:cc.v2(e.x+c*s,e.y+c*o),s=t.x-r.x,o=t.y-r.y,Math.sqrt(s*s+o*o)}var d={};d.lineLine=n,d.lineRect=r,d.linePolygon=s,d.rectRect=o,d.rectPolygon=a,d.polygonPolygon=c,d.circleCircle=h,d.polygonCircle=l,d.pointInPolygon=u,d.pointLineDistance=_,cc.Intersection=e.exports=d}),{}],69:[(function(t,e,i){cc.Collider.Polygon=cc.Class({properties:{threshold:{default:1,serializable:!1,visible:!1},_offset:cc.v2(0,0),offset:{get:function(){return this._offset},set:function(t){this._offset=t},type:cc.Vec2},points:{tooltip:!1,default:function(){return[cc.v2(-50,-50),cc.v2(50,-50),cc.v2(50,50),cc.v2(-50,50)]},type:[cc.Vec2]}},resetInEditor:!1,resetPointsByContour:!1});var n=cc.Class({name:"cc.PolygonCollider",extends:cc.Collider,mixins:[cc.Collider.Polygon],editor:!1});cc.PolygonCollider=e.exports=n}),{}],70:[(function(t,e,i){t("./CCCollisionManager"),t("./CCCollider"),t("./CCBoxCollider"),t("./CCCircleCollider"),t("./CCPolygonCollider")}),{"./CCBoxCollider":63,"./CCCircleCollider":64,"./CCCollider":65,"./CCCollisionManager":66,"./CCPolygonCollider":69}],71:[(function(t,e,i){function n(t,e){for(var i=e.constructor._executionOrder,n=e.__instanceId,r=0,s=t.length-1,o=s>>>1;r<=s;o=r+s>>>1){var a=t[o],c=a.constructor._executionOrder;if(c>i)s=o-1;else if(c<i)r=o+1;else{var h="a.__instanceId;if(h">n)s=o-1;else{if(!(h<n))return o;r="o+1}}}return~r}function" r(t,e){for(var="" i="t.array,n=t.i+1;n<i.length;){var" r="i[n];r._enabled&&r.node._activeInHierarchy?++n:(t.removeAt(n),e&&(r._objFlags&=~e))}}function" s(t,e){return="" t.constructor._executionorder-e.constructor._executionorder}function="" o(t,e){var="" +t+"}";return="" e?function("it","dt",i):function("it",i)}function="" a(){this.startinvoker="new" d(o("c.start();c._objflags|="+l)),this.updateInvoker=new f(o(" c.update(dt)",!0)),this.lateupdateinvoker="new" f(o("c.lateupdate(dt)",!0)),this.scheduleinnextframe="[],this._updating=!1}t("./platform/CCClass");var" c="t("./platform/CCObject").Flags,h=t("./platform/js").array,l=c.IsStartCalled,u=c.IsOnEnableCalled,_=(c.IsEditorOnEnableCalled,cc.Class({__ctor__:function(t){var" e="h.MutableForwardIterator;this._zero=new" e([]),this._neg="new" e([]),this._pos="new" e([]),this._invoke="t},statics:{stableRemoveInactive:r},add:null,remove:null,invoke:null})),d=cc.Class({extends:_,add:function(t){var" t="this._neg;t.array.length">0&&(t.array.sort(s),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort(s),this._invoke(e),e.array.length=0)}}),f=cc.Class({extends:_,add:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var i=e<0?this._neg.array:this._pos.array,r=n(i,t);r<0&&i.splice(~r,0,t)}},remove:function(t){var e="t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var" i="e<0?this._neg:this._pos,r=n(i.array,t);r">=0&&i.removeAt(r)}},invoke:function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)}}),p=cc.Class({ctor:a,unscheduleAll:a,statics:{LifeCycleInvoker:_,OneOffInvoker:d,createInvokeImpl:o,invokeOnEnable:function(t){var e=cc.director._compScheduler,i=t.array;for(t.i=0;t.i<i.length;++t.i){var n="i[t.i];if(n._enabled){n.onEnable();var" r="!n.node._activeInHierarchy;r||e._onEnabled(n)}}}},_onEnabled:function(t){return" cc.director.getscheduler().resumetarget(t),t._objflags|="u,this._updating?void" this.scheduleinnextframe.push(t):void="" this._scheduleimmediate(t)},_ondisabled:function(t){cc.director.getscheduler().pausetarget(t),t._objflags&="~u;var" e="this.scheduleInNextFrame.indexOf(t);return">=0?void h.fastRemoveAt(this.scheduleInNextFrame,e):(!t.start||t._objFlags&l||this.startInvoker.remove(t),t.update&&this.updateInvoker.remove(t),void(t.lateUpdate&&this.lateUpdateInvoker.remove(t)))},enableComp:function(t,e){if(!(t._objFlags&u)){if(t.onEnable){if(e)return void e.add(t);t.onEnable();var i=!t.node._activeInHierarchy;if(i)return}this._onEnabled(t)}},disableComp:function(t){t._objFlags&u&&(t.onDisable&&t.onDisable(),this._onDisabled(t))},_scheduleImmediate:function(t){!t.start||t._objFlags&l||this.startInvoker.add(t),t.update&&this.updateInvoker.add(t),t.lateUpdate&&this.lateUpdateInvoker.add(t)},_deferredSchedule:function(){for(var t=this.scheduleInNextFrame,e=0,i=t.length;e<i;e++){var n="t[e];this._scheduleImmediate(n)}t.length=0},startPhase:function(){this._updating=!0,this.scheduleInNextFrame.length">0&&this._deferredSchedule(),this.startInvoker.invoke()},updatePhase:function(t){this.updateInvoker.invoke(t)},lateUpdatePhase:function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1}});e.exports=p}),{"./platform/CCClass":173,"./platform/CCObject":179,"./platform/js":193,"./utils/misc":223}],72:[(function(t,e,i){function n(t,e){return t===e||t&&e&&(t.name===e.name||t._uuid===e._uuid)}var r=t("../../animation/animation-animator"),s=t("../../animation/animation-clip"),o=cc.Class({name:"cc.Animation",extends:t("./CCComponent"),mixins:[cc.EventTarget],editor:!1,ctor:function(){this._animator=null,this._nameToState={},this._didInit=!1,this._currentClip=null,this._listeners=[]},properties:{_defaultClip:{default:null,type:s},defaultClip:{type:s,get:function(){return this._defaultClip},set:function(t){return},tooltip:!1},currentClip:{get:function(){return this._currentClip},set:function(t){this._currentClip=t},type:s,visible:!1},_clips:{default:[],type:[s],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip){var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}},onEnable:function(){this._animator&&this._animator.resume()},onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(t,e){var i=this.playAdditive(t,e);return this._animator.stopStatesExcept(i),i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip&&this._defaultClip.name);if(i){this.enabled=!0;var n=this._animator;n.isPlaying&&i.isPlaying?i.isPaused?n.resumeState(i):(n.stopState(i),n.playState(i,e)):n.playState(i,e),this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.pauseState(e)}else this.enabled=!1},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.resumeState(e)}else this.enabled=!0},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];i&&this._animator.setStateTime(i,t)}else this._animator.setStateTime(t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];return e&&!e.curveLoaded&&this._animator._reloadClip(e),e||null},addClip:function(t,e){if(!t)return void cc.warnID(3900);this._init(),cc.js.array.contains(this._clips,t)||this._clips.push(t),e=e||t.name;var i=this._nameToState[e];if(i){if(i.clip===t)return i;var n=this._clips.indexOf(i.clip);n!==-1&&this._clips.splice(n,1)}var r=new cc.AnimationState(t,e);return this._nameToState[e]=r,r},removeClip:function(t,e){if(!t)return void cc.warnID(3901);this._init();var i;for(var n in this._nameToState){i=this._nameToState[n];var r=i.clip;if(r===t)break}if(t===this._defaultClip){if(!e)return void cc.warnID(3902);this._defaultClip=null}if(i&&i.isPlaying){if(!e)return void cc.warnID(3903);this.stop(i.name)}this._clips=this._clips.filter((function(e){return e!==t})),i&&delete this._nameToState[i.name]},sample:function(t){if(this._init(),t){var e=this._nameToState[t];e&&e.sample()}else this._animator.sample()},on:function(t,e,i,n){this._init();for(var r=this._listeners,s=0,o=r.length;s<o;s++){var a="r[s];if(a[0]===t&&a[1]===e&&a[2]===i&&a[3]===n)return}return" this._animator.on(t,e,i,n),r.push([t,e,i,n]),e},off:function(t,e,i,n){this._init();for(var="" r="this._listeners,s=this._nameToState,o=r.length-1;o">=0;o--){var a=r[o];if(a[0]===t&&a[1]===e&&a[2]===i&&a[3]===n){for(var c in s){var h=s[c];h.off(t,e,i,n)}r.splice(o,1)}}},_init:function(){this._didInit||(this._didInit=!0,this._animator=new r(this.node,this),this._createStates())},_createStates:function(){this._nameToState={};for(var t=null,e=!1,i=0;i<this._clips.length;++i){var r="this._clips[i];r&&(t=new" cc.animationstate(r),this._nametostate[t.name]="t,n(this._defaultClip,r)&&(e=t))}this._defaultClip&&!e&&(t=new" cc.animationstate(this._defaultclip),this._nametostate[t.name]="t)}});cc.Animation=e.exports=o}),{"../../animation/animation-animator":11,"../../animation/animation-clip":12,"./CCComponent":76}],73:[(function(t,e,i){var" n="cc.Class({name:"cc.AudioSource",extends:t("./CCComponent"),editor:!1,ctor:function(){this.audio=new" cc.audio(this._clip)},properties:{_clip:{default:"",url:cc.audioclip},_volume:1,_mute:!1,_loop:!1,_pausedflag:{default:!1,serializable:!1},isplaying:{get:function(){if(!this.audio)return!1;var="" t="this.audio.getState();return" this._clip},set:function(t){this._clip="t,this.audio.stop(),this.audio.src=this._clip,this.audio.preload&&this.audio.preload()},url:cc.AudioClip,tooltip:!1,animatable:!1},volume:{get:function(){return" this._volume},set:function(t){t="cc.clamp01(t),this._volume=t;var" e="this.audio;return" e&&!this._mute&&(e.setvolume(t),e._loaded||e.on("load",(function(){e.setvolume(t)}))),t},tooltip:!1},mute:{get:function(){return="" this._mute},set:function(t){return="" this._mute="t,this.audio&&this.audio.setVolume(t?0:this._volume),t},animatable:!1,tooltip:!1},loop:{get:function(){return" this._loop},set:function(t){return="" this._loop="t,this.audio&&this.audio.setLoop(t),t},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_pausedCallback:function(){var" e.stop(),e.setcurrenttime(0),void="" e.play();e.src="this._clip,e.once("load",(function(){e.setLoop(i),e.setVolume(t),e.play()})),e.preload()}},stop:function(){this.audio&&this.audio.stop()},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.resume()},rewind:function(){this.audio&&this.audio.setCurrentTime(0)},getCurrentTime:function(){var" this.audio&&(t="this.audio.getCurrentTime()),t},setCurrentTime:function(t){var" e?e._loaded?(e.setcurrenttime(t),t):(e.once("load",(function(){e.setcurrenttime(t)})),t):t},getduration:function(){var="" i="1;this.duration">0&&(i=this.time/this.duration),i>=1&&(i=1,this._transitionFinished=!0),this.transition===n.COLOR?e.color=this._fromColor.lerp(this._toColor,i):this.transition===n.SCALE&&(e.scale=cc.lerp(this._fromScale,this._toScale,i))}},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getTargetSprite:function(t){var e=null;return t&&(e=t.getComponent(cc.Sprite)),e},_applyTarget:function(){this._sprite=this._getTargetSprite(this.target),this.target&&(this._originalScale=this.target.scale)},_onTouchBegan:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t.stopPropagation())},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var e=t.touch,i=this.node._hitTest(e.getLocation());if(this.transition===n.SCALE&&this.target)i?(this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,this.target.scale=this._originalScale);else{var r;r=i?"pressed":"normal",this._applyTransition(r)}t.stopPropagation()}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState(),t.stopPropagation())},_zoomUp:function(){this._fromScale=this._originalScale,this._toScale=this._originalScale*this.zoomScale,this.time=0,this._transitionFinished=!1},_zoomBack:function(){this._fromScale=this.target.scale,this._toScale=this._originalScale,this.time=0,this._transitionFinished=!1},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==n.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var t=this._getButtonState();this._applyTransition(t),this._updateDisabledState()},onDisable:function(){this._hovered=!1,this._pressed=!1,this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_getButtonState:function(){var t;return t=this.interactable?this._pressed?"pressed":this._hovered?"hover":"normal":"disabled"},_updateColorTransition:function(t){var e=this[t+"Color"],i=this.target;this._fromColor=i.color.clone(),this._toColor=e,this.time=0,this._transitionFinished=!1},_updateSpriteTransition:function(t){var e=this[t+"Sprite"];this._sprite&&e&&(this._sprite.spriteFrame=e)},_updateScaleTransition:function(t){"pressed"===t?this._zoomUp():this._zoomBack()},_applyTransition:function(t){var e=this.transition;e===n.COLOR?this._updateColorTransition(t):e===n.SPRITE?this._updateSpriteTransition(t):e===n.SCALE&&this._updateScaleTransition(t)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(){this._sprite&&this._sprite._sgNode.setState(0),this.enableAutoGrayEffect&&this.transition!==n.COLOR&&(this.transition===n.SPRITE&&this.disabledSprite||this._sprite&&!this.interactable&&this._sprite._sgNode.setState(1))}});cc.Button=e.exports=r}),{"./CCComponent":76}],75:[(function(t,e,i){var n={getContentSize:function(){return cc.visibleRect},setContentSize:function(t){},_getWidth:function(){return this.getContentSize().width},_getHeight:function(){return this.getContentSize().height}},r=cc.Class({name:"cc.Canvas",extends:t("./CCComponent"),editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){this._fitHeight!==t&&(this._fitHeight=t,this.applySettings())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(t){this._fitWidth!==t&&(this._fitWidth=t,this.applySettings())},tooltip:!1}},ctor:function(){this._thisOnResized=this.onResized.bind(this)},__preload:function(){if(r.instance)return cc.errorID(6700,this.node.name,r.instance.node.name);if(r.instance=this,this.node._sizeProvider);else this.node._sizeProvider=n;cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.sys.isMobile?window.addEventListener("resize",this._thisOnResized):cc.eventManager.addCustomListener("canvas-resize",this._thisOnResized),this.applySettings(),this.onResized()},onDestroy:function(){this.node._sizeProvider===n&&(this.node._sizeProvider=null),cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this.alignWithScreen,this),cc.sys.isMobile?window.removeEventListener("resize",this._thisOnResized):cc.eventManager.removeCustomListeners("canvas-resize",this._thisOnResized),r.instance===this&&(r.instance=null)},alignWithScreen:function(){var t,e=cc.visibleRect,i=!this.fitHeight&&!this.fitWidth,n=0,r=0;i&&(t=cc.view.getDesignResolutionSize(),n=.5*(t.width-e.width),r=.5*(t.height-e.height)),this.node.setPosition(.5*e.width+n,.5*e.height+r)},onResized:function(){this.alignWithScreen()},applySettings:function(){var t,e=cc.ResolutionPolicy;t=this.fitHeight&&this.fitWidth?e.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?e.FIXED_WIDTH:e.FIXED_HEIGHT:e.NO_BORDER;var i=this._designResolution;cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=r}),{"./CCComponent":76}],76:[(function(t,e,i){var n=t("../platform/CCObject"),r=t("../platform/js"),s=new(t("../platform/id-generater"))("Comp"),o=n.Flags.IsOnEnableCalled,a=n.Flags.IsOnLoadCalled,c=cc.Class({name:"cc.Component",extends:n,ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");return e>=0&&(t=t.slice(e+1)),this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},_id:{default:"",serializable:!1},uuid:{get:function(){var t=this._id;return t||(t=this._id=s.getNewId()),t},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){if(this._enabled!==t&&(this._enabled=t,this.node._activeInHierarchy)){var e=cc.director._compScheduler;t?e.enableComp(this):e.disableComp(this)}},visible:!1},enabledInHierarchy:{get:function(){return(this._objFlags&o)>0},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&a}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){this.unscheduleAllCallbacks();for(var t=this.__eventTargets,e=0,i=t.length;e<i;++e){var n="t[e];n&&n.targetOff(this)}t.length=0,cc.director._nodeActivator.destroyComp(this),this.node._removeComponent(this)},_instantiate:function(t){return" t||(t="cc.instantiate._clone(this,this)),t.node=null,t},isRunning:function(){return" this.enabledinhierarchy;="" },schedule:function(t,e,i,n){cc.assertid(t,1619),cc.assertid(e="">=0,1620),e=e||0,i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0,cc.director.getScheduler().schedule(t,this,e,i,n,!this.enabledInHierarchy)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){t&&cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});c._requireComponent=null,c._executionOrder=0,r.value(c,"_registerEditorProps",(function(t,e){var i=e.requireComponent;i&&(t._requireComponent=i);var n=e.executionOrder;n&&"number"==typeof n&&(t._executionOrder=n)})),c.prototype.__scriptUuid="",cc.Component=e.exports=c}),{"../platform/CCObject":179,"../platform/id-generater":189,"../platform/js":193}],77:[(function(t,e,i){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:{default:""},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(t){"use strict";var e,i,n;if(arguments.length>0)for(e=new Array(arguments.length-1),i=0,n=e.length;i<n;i++)e[i]=arguments[i+1];for(i=0,n=t.length;i<n;i++){var r="t[i];r" instanceof="" cc.component.eventhandler&&r.emit(e)}}},emit:function(t){var="" e="this.target;if(cc.isValid(e)){var" i="e.getComponent(this.component);if(cc.isValid(i)){var" n="i[this.handler];"function"==typeof" n&&(null!="this.customEventData&&""!==this.customEventData&&(t=t.slice(),t.push(this.customEventData)),n.apply(i,t))}}}})}),{}],78:[(function(t,e,i){t("../editbox/CCSGEditBox.js");var" this._sgnode.string},set:function(t){this._sgnode.string="this._string=t}},backgroundImage:{tooltip:!1,default:null,type:cc.SpriteFrame,notify:function(){var" t="this._sgNode,e=t.getBackgroundSprite();if(this.backgroundImage){var" e.removefromparent()}},returntype:{default:n.default,tooltip:!1,displayname:"keyboardreturntype",type:n,notify:function(){this._sgnode.returntype="this.returnType}},inputFlag:{tooltip:!1,default:s.DEFAULT,type:s,notify:function(){this._sgNode.inputFlag=this.inputFlag}},inputMode:{tooltip:!1,default:r.ANY,type:r,notify:function(){this._sgNode.inputMode=this.inputMode}},fontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.fontSize=this.fontSize}},lineHeight:{tooltip:!1,default:40,notify:function(){this._sgNode.setLineHeight(this.lineHeight)}},fontColor:{tooltip:!1,default:cc.Color.WHITE,notify:function(){this._sgNode.fontColor=this.fontColor}},placeholder:{tooltip:!1,default:"Enter" text="" here...",notify:function(){this._sgnode.placeholder="this.placeholder}},placeholderFontSize:{tooltip:!1,default:20,notify:function(){this._sgNode.placeholderFontSize=this.placeholderFontSize}},placeholderFontColor:{tooltip:!1,default:cc.Color.GRAY,notify:function(){this._sgNode.placeholderFontColor=this.placeholderFontColor}},maxLength:{tooltip:!1,default:20,notify:function(){this._sgNode.maxLength=this.maxLength}},stayOnTop:{tooltip:!1,default:!1,notify:function(){this._sgNode.stayOnTop(this.stayOnTop),this._sgNode.fontSize=this.fontSize,this._sgNode.fontColor=this.fontColor}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return" this._tabindex},set:function(t){this._tabindex="t,this._sgNode.setTabIndex(t)}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{KeyboardReturnType:n,InputFlag:s,InputMode:r},_applyCapInset:function(t){var" new="" _ccsg.editbox(cc.size(160,40))},_createbackgroundsprite:function(){var="" cc.scale9sprite;return="" e.setrenderingtype(cc.scale9sprite.renderingtype.sliced),this.backgroundimage&&(this.backgroundimage.ensureloadtexture(),e.setspriteframe(this.backgroundimage),this._applycapinset(e)),t.initwithsizeandbackgroundsprite(cc.size(160,40),e),e},_initsgnode:function(){var="" this._sgnode&&(t="this._sgNode.isFocused()),t}});cc.EditBox=e.exports=o}),{"../editbox/CCSGEditBox.js":104}],79:[(function(t,e,i){t("../label/CCSGLabel.js"),t("../label/CCSGLabelCanvasRenderCmd.js"),t("../label/CCSGLabelWebGLRenderCmd.js");var" font="" size",animatable:!1,readonly:!0,get:function(){return="" this._sgnode&&(this._actualfontsize="this._sgNode.getFontSize()),this._actualFontSize}},_fontSize:40,fontSize:{get:function(){return" this._fontsize},set:function(t){this._fontsize="t,this._updateSgNodeFontSize()},tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(){this._sgNode&&this._sgNode.setFontFileOrFamily(this.fontFamily)},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return" this._sgnode&&(this._lineheight="this._sgNode.getLineHeight()),this._lineHeight},set:function(t){this._lineHeight=t,this._sgNode&&(this._sgNode.setLineHeight(t),this._updateNodeSize())},tooltip:!1},overflow:{default:s.NONE,type:s,tooltip:!1,notify:function(){this._sgNode&&(this._sgNode.setOverflow(this.overflow),this._updateNodeSize())},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return" this._sgnode&&(this._enablewraptext="this._sgNode.isWrapTextEnabled()),this._enableWrapText},set:function(t){this._enableWrapText=t,this._sgNode&&this._sgNode.enableWrapText(t)},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return" this._n$file},set:function(t){if(t||(this._issystemfontused="!0),this._N$file=t,this._bmFontOriginalSize=-1,t&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this._sgNode){"string"==typeof" t&&cc.warnid(4e3);var="" cc.bitmapfont)e.spriteframe?this._sgnode.setfontfileorfamily(e.fntdatastr,e.spriteframe,e):(cc.warnid(4011,e.name),this._sgnode.setfontfileorfamily(""));else{var="" cc.font,n="i?t.rawUrl:"";this._sgNode.setFontFileOrFamily(n)}}t" cc.bitmapfont&&(this._bmfontoriginalsize="t.fontSize)},type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return" this._issystemfontused},set:function(t){this._issystemfontused="!!t,t&&(this.font=null,this._sgNode&&this._sgNode.setFontFileOrFamily(this.fontFamily))},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont" original="" size",default:-1,serializable:!1,readonly:!0,visible:!0,animatable:!1},_spacingx:0,spacingx:{get:function(){return="" this._spacingx},set:function(t){this._spacingx="t,this._sgNode&&(this._sgNode.setSpacingX(this.spacingX),this._updateNodeSize())}}},statics:{HorizontalAlign:n,VerticalAlign:r,Overflow:s},__preload:function(){this._super();var" null},_initsgnode:function(){var="" e;if(t="" cc.bitmapfont)t.spriteframe?e="this._sgNode=new" _ccsg.label(this.string,t.fntdatastr,t.spriteframe,t):(cc.warnid(4011,t.name),e="this._sgNode=new" _ccsg.label(this.string));else{var="" _ccsg.label(this.string,n)}t="" cc.bitmapfont&&e.setspacingx(this.spacingx),e.setcontentsize(this.node.getcontentsize()),e.setcolor(this.node.color)},_updatenodesize:function(){var="" this._color},set:function(t){this._color="cc.color(t),this._labelSGNode&&this._labelSGNode.setOutlineColor(cc.color(this._color))}},width:{get:function(){return" this._width},set:function(t){this._width="t,this._labelSGNode&&(this._labelSGNode.setOutlineWidth(t),this._labelSGNode.setMargin(t))}}},onEnable:function(){var" this._n$layouttype},set:function(t){this._n$layouttype="t;this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:r,tooltip:!1,animatable:!1,get:function(){return" this._resize},set:function(t){if(this.type!="=n.NONE||t!==r.CHILDREN){this._resize=t;this._doLayoutDirty()}}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:s.HORIZONTAL,tooltip:!1,type:s,notify:function(){this._doLayoutDirty()},animatable:!1},_N$padding:{default:0},paddingLeft:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:o.TOP_TO_BOTTOM,type:o,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},horizontalDirection:{default:a.LEFT_TO_RIGHT,type:a,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1}},statics:{Type:n,VerticalDirection:o,HorizontalDirection:a,ResizeMode:r,AxisDirection:s},_migratePaddingData:function(){this.paddingLeft=this._N$padding,this.paddingRight=this._N$padding,this.paddingTop=this._N$padding,this.paddingBottom=this._N$padding,this._N$padding=0},__preload:function(){cc.sizeEqualToSize(this.node.getContentSize(),cc.size(0,0))&&this.node.setContentSize(this._layoutSize),0!==this._N$padding&&this._migratePaddingData(),this.node.on("size-changed",this._resized,this),this.node.on("anchor-changed",this._doLayoutDirty,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-removed",this._childRemoved,this),this.node.on("child-reorder",this._doLayoutDirty,this),this._updateChildrenEventListener()},_doLayoutDirty:function(){this._layoutDirty=!0},_updateChildrenEventListener:function(){var" c="this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingLeft,_=-c.x*t;this.horizontalDirection===a.RIGHT_TO_LEFT&&(l=-1,_=(1-c.x)*t,u=this.paddingRight);var" d="_+l*u-l*this.spacingX,f=0,p=0,m=0,g=0,v=0,y=0,x=this.cellSize.width;return" this.type!="=n.GRID&&this.resizeMode===r.CHILDREN&&(x=(t-(this.paddingLeft+this.paddingRight)-(h.length-1)*this.spacingX)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this._resize===r.CHILDREN&&(h.width=x,this.type===n.GRID&&(h.height=this.cellSize.height));var">p&&(p=m),h.height>=p&&(m=p,p=h.height,y=h.getAnchorPoint().y),this.horizontalDirection===a.RIGHT_TO_LEFT&&(T=1-h.anchorX),d=d+l*T*h.width+l*this.spacingX;var b=l*(1-T)*h.width;if(e){var C=d+b+l*(l>0?this.paddingRight:this.paddingLeft),A=this.horizontalDirection===a.LEFT_TO_RIGHT&&C>(1-c.x)*t,S=this.horizontalDirection===a.RIGHT_TO_LEFT&&C<-c.x*t;(a||s)&&(h.height>=p?(0===m&&(m=p),f+=m,m=p):(f+=p,m=h.height,p=0),d=_+l*(u+T*h.width),g++)}var E=i(h,f,g);t>=h.width+this.paddingLeft+this.paddingRight&&s&&h.setPosition(cc.p(d,E));var w,I=1,R=0===p?h.height:p;this.verticalDirection===o.TOP_TO_BOTTOM?(v=v||this.node._contentSize.height,I=-1,w=E+I*(R*y+this.paddingBottom),w<v&&(v=w)):(v=v||-this.node._contentsize.height,w=e+i*(r*y+this.paddingtop),w>v&&(v=w)),d+=b}}.bind(this)),v},_getVerticalBaseHeight:function(t){var e=0,i=0;return this.resizeMode===r.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.height)})),e+=(i-1)*this.spacingY+this.paddingBottom+this.paddingTop):e=this.node.getContentSize().height,e},_doLayoutVertically:function(t,e,i,s){var c=this.node.getAnchorPoint(),h=this.node.children,l=1,u=this.paddingBottom,_=-c.y*t;this.verticalDirection===o.TOP_TO_BOTTOM&&(l=-1,_=(1-c.y)*t,u=this.paddingTop);var d=_+l*u-l*this.spacingY,f=0,p=0,m=0,g=0,v=0,y=0,x=this.cellSize.height;return this.type!==n.GRID&&this.resizeMode===r.CHILDREN&&(x=(t-(this.paddingTop+this.paddingBottom)-(h.length-1)*this.spacingY)/h.length),h.forEach(function(h){if(h.activeInHierarchy){this.resizeMode===r.CHILDREN&&(h.height=x,this.type===n.GRID&&(h.width=this.cellSize.width));var T=h.anchorY;m>p&&(p=m),h.width>=p&&(m=p,p=h.width,y=h.getAnchorPoint().x),this.verticalDirection===o.TOP_TO_BOTTOM&&(T=1-h.anchorY),d=d+l*T*h.height+l*this.spacingY;var b=l*(1-T)*h.height;if(e){var C=d+b+l*(l>0?this.paddingTop:this.paddingBottom),A=this.verticalDirection===o.BOTTOM_TO_TOP&&C>(1-c.y)*t,S=this.verticalDirection===o.TOP_TO_BOTTOM&&C<-c.y*t;(a||s)&&(h.width>=p?(0===m&&(m=p),f+=m,m=p):(f+=p,m=h.width,p=0),d=_+l*(u+T*h.height),g++)}var E=i(h,f,g);t>=h.height+(this.paddingTop+this.paddingBottom)&&s&&h.setPosition(cc.p(E,d));var w,I=1,R=0===p?h.width:p;this.horizontalDirection===a.RIGHT_TO_LEFT?(I=-1,v=v||this.node._contentSize.width,w=E+I*(R*y+this.paddingLeft),w<v&&(v=w)):(v=v||-this.node._contentsize.width,w=e+i*(r*y+this.paddingright),w>v&&(v=w)),d+=b}}.bind(this)),v},_doLayoutBasic:function(){var t=this.node.children,e=null;if(t.forEach((function(t){t.activeInHierarchy&&(e=e?cc.rectUnion(e,t.getBoundingBoxToWorld()):t.getBoundingBoxToWorld())})),e){var i=this.node.parent.convertToNodeSpaceAR(cc.p(e.x,e.y));i=cc.pAdd(i,cc.p(-this.paddingLeft,-this.paddingBottom));var n=this.node.parent.convertToNodeSpaceAR(cc.p(e.x+e.width,e.y+e.height));n=cc.pAdd(n,cc.p(this.paddingRight,this.paddingTop));var r=cc.size(parseFloat((n.x-i.x).toFixed(2)),parseFloat((n.y-i.y).toFixed(2))),s=this.node.getPosition(),o=(s.x-i.x)/r.width,a=(s.y-i.y)/r.height,c=cc.p(parseFloat(o.toFixed(2)),parseFloat(a.toFixed(2)));this.node.setAnchorPoint(c),this.node.setContentSize(r)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,s=-t.y*e.height,a=this.paddingBottom;this.verticalDirection===o.TOP_TO_BOTTOM&&(n=-1,s=(1-t.y)*e.height,a=this.paddingTop);var c=function(t,e,i){return s+n*(e+t.anchorY*t.height+a+i*this.spacingY)}.bind(this),h=0;if(this.resizeMode===r.CONTAINER){var l=this._doLayoutHorizontally(i,!0,c,!1);h=s-l,h<0&&(h*=-1),s=-t.y*h,this.verticaldirection===o.top_to_bottom&&(n=-1,s=(1-t.y)*h)}this._dolayouthorizontally(i,!0,c,!0),this.resizemode===r.container&&this.node.setcontentsize(i,h)},_dolayoutgridaxisvertical:function(t,e){var i="e.height,n=1,s=-t.x*e.width,o=this.paddingLeft;this.horizontalDirection===a.RIGHT_TO_LEFT&&(n=-1,s=(1-t.x)*e.width,o=this.paddingRight);var" c="function(t,e,i){return" s+n*(e+t.anchorx*t.width+o+i*this.spacingx)}.bind(this),h="0;if(this.resizeMode===r.CONTAINER){var" l="this._doLayoutVertically(i,!0,c,!1);h=s-l,h<0&&(h*=-1),s=-t.x*h,this.horizontalDirection===a.RIGHT_TO_LEFT&&(n=-1,s=(1-t.x)*h)}this._doLayoutVertically(i,!0,c,!0),this.resizeMode===r.CONTAINER&&this.node.setContentSize(h,i)},_doLayoutGrid:function(){var" t="this.node.getAnchorPoint(),e=this.node.getContentSize();this.startAxis===s.HORIZONTAL?this._doLayoutGridAxisHorizontal(t,e):this.startAxis===s.VERTICAL&&this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var" e="0,i=0;return" this.resizemode="==r.CONTAINER?(t.forEach((function(t){t.activeInHierarchy&&(i++,e+=t.width)})),e+=(i-1)*this.spacingX+this.paddingLeft+this.paddingRight):e=this.node.getContentSize().width,e},_doLayout:function(){if(this.type===n.HORIZONTAL){var" t.y};this._dolayouthorizontally(t,!1,e,!0),this.node.width="t}else" if(this.type="==n.VERTICAL){var" t.x};this._dolayoutvertically(i,!1,s,!0),this.node.height="i}else" this.type="==n.NONE?this.resizeMode===r.CONTAINER&&this._doLayoutBasic():this.type===n.GRID&&this._doLayoutGrid()},onEnable:function(){cc.director.on(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this)},onDisable:function(){cc.director.off(cc.Director.EVENT_BEFORE_VISIT,this._updateLayout,this)},_updateLayout:function(){this._layoutDirty&&this.node.children.length">0&&(this._doLayout(),this._layoutDirty=!1)}});Object.defineProperty(c.prototype,"padding",{get:function(){return cc.warnID(4100),this.paddingLeft},set:function(t){this._N$padding=t,this._migratePaddingData(),this._doLayoutDirty()}}),cc.Layout=e.exports=c}),{"./CCComponent":76}],82:[(function(t,e,i){t("../../clipping-nodes/CCClippingNode.js"),t("../../clipping-nodes/CCClippingNodeCanvasRenderCmd.js"),t("../../clipping-nodes/CCClippingNodeWebGLRenderCmd.js");var n=cc._RendererInSG,r=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2}),s=cc.Class({name:"cc.Mask",extends:n,editor:!1,properties:{_clippingStencil:{default:null,serializable:!1},_type:r.RECT,type:{get:function(){return this._type},set:function(t){this._type=t,this._refreshStencil()},type:r,tooltip:!1},spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1,notify:function(){this._refreshStencil()}},alphaThreshold:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?void cc.warnID(4201):void this._sgNode.setAlphaThreshold(this.alphaThreshold)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?void cc.warnID(4202):void this._sgNode.setInverted(this.inverted)}},_segements:64,segements:{get:function(){return this._segements},set:function(t){this._segements=t<3?3:t,this._refreshstencil()},type:cc.integer,tooltip:!1},_resizetotarget:{animatable:!1,set:function(t){t&&this._resizenodetotargetnode()}}},statics:{type:r},_resizenodetotargetnode:!1,_createsgnode:function(){return new="" cc.clippingnode},_initsgnode:function(){},_hittest:function(t){var="" e="this.node.getContentSize(),i=e.width,n=e.height,s=this.node.getNodeToWorldTransform();if(this.type===r.RECT||this.type===r.IMAGE_STENCIL){var" o="cc.rect(0,0,i,n);cc._rectApplyAffineTransformIn(o,s);var" a="t.x-o.x,c=o.x+o.width-t.x,h=t.y-o.y,l=o.y+o.height-t.y;return">=0&&c>=0&&l>=0&&h>=0}if(this.type===r.ELLIPSE){var u=i/2,_=n/2,d=s.a*u+s.c*_+s.tx,f=s.b*u+s.d*_+s.ty,p=t.x-d,m=t.y-f;return p*p/(u*u)+m*m/(_*_)<1}},__preload:function(){this._refreshstencil()},onenable:function(){this._super(),this.node.on("size-changed",this._refreshstencil,this),this.node.on("anchor-changed",this._refreshstencil,this)},ondisable:function(){this._super(),this.node.off("size-changed",this._refreshstencil,this),this.node.off("anchor-changed",this._refreshstencil,this)},_calculatecircle:function(t,e,i){for(var n="[],r=2*Math.PI/i,s=0;s<i;++s)n.push(cc.v2(e.x*Math.cos(r*s)+t.x,e.y*Math.sin(r*s)+t.y));return" n},_refreshstencil:function(){if(this.type="==r.IMAGE_STENCIL&&cc._renderType!==cc.game.RENDER_TYPE_WEBGL)return" void="" cc.warnid(4200);var="" t="this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this._clippingStencil;if(this._type===r.IMAGE_STENCIL){var" instanceof="" cc.scale9sprite;n&&i._spriteframe="==this.spriteFrame||(i=new" cc.scale9sprite,i.setspriteframe(this.spriteframe),this._sgnode.setstencil(i)),i.setcontentsize(t),i.setanchorpoint(e),this._sgnode.setalphathreshold(this.alphathreshold)}else{var="" s="i" cc.drawnode;s||(i="new" cc.drawnode,this._sgnode.setstencil(i));var="" o="t.width,a=t.height,c=-o*e.x,h=-a*e.y,l=cc.color(255,255,255,0);if(i.clear(),this._type===r.RECT){var" u="[cc.v2(c,h),cc.v2(c+o,h),cc.v2(c+o,h+a),cc.v2(c,h+a)];i.drawPoly(u,l,0,l)}else" if(this._type="==r.ELLIPSE){var" _="cc.v2(c+o/2,h+a/2),d={x:o/2,y:a/2};i.drawPoly(this._calculateCircle(_,d,this._segements),l,0,l)}}this._sgNode.setInverted(this.inverted),this._clippingStencil=i,cc.renderer.childrenOrderDirty=!0}});cc.Mask=e.exports=s}),{"../../clipping-nodes/CCClippingNode.js":26,"../../clipping-nodes/CCClippingNodeCanvasRenderCmd.js":27,"../../clipping-nodes/CCClippingNodeWebGLRenderCmd.js":28}],83:[(function(t,e,i){var" this._curpageidx},setcurrentpageindex:function(t){this.scrolltopage(t,!0)},getpages:function(){return="" this._pages},addpage:function(t){t&&this._pages.indexof(t)="==-1&&this.content&&(this.content.addChild(t),this._pages.push(t),this._updatePageView())},insertPage:function(t,e){if(!(e<0)&&t&&this._pages.indexOf(t)===-1&&this.content){var" i="this._pages.length;e">=i?this.addPage(t):(this._pages.splice(e,0,t),this.content.addChild(t),this._updatePageView())}},removePage:function(t){if(t&&this.content){var e=this._pages.indexOf(t);return e===-1?void cc.warnID(4300,t.name):void this.removePageAtIndex(e)}},removePageAtIndex:function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removechild(t[e]);this._pages.length=0,this._updatepageview()}},scrolltopage:function(t,e){t<0||t>this._pages.length||(e=void 0!==e?e:.3,this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===r.Horizontal,this.vertical=this.direction===r.Vertical},_syncSizeMode:function(){if(this.content){var t=this.content.getComponent(cc.Layout);if(t){if(0===this._pages.length)t.padding=0;else{var e=this._pages[this._pages.length-1];this.sizeMode===n.Free&&(this.direction===r.Horizontal?(t.paddingLeft=(this.node.width-this._pages[0].width)/2,t.paddingRight=(this.node.width-e.width)/2):this.direction===r.Vertical&&(t.paddingTop=(this.node.height-this._pages[0].height)/2,t.paddingBottom=(this.node.height-e.height)/2))}t._updateLayout()}}},_updatePageView:function(){var t=this._pages.length,e=this.content.getComponent(cc.Layout);e&&e.enabled&&e._updateLayout(),this._curPageIdx>=t&&(this._curPageIdx=0===t?0:t-1,this._lastPageIdx=this._curPageIdx);for(var i=0;i<t;++i)this._pages[i].setsiblingindex(i),this.direction===r.horizontal?this._scrollcenteroffsetx[i]=math.abs(this.content.x+this._pages[i].x):this._scrollcenteroffsety[i]=math.abs(this.content.y+this._pages[i].y);this.indicator&&this.indicator._refresh()},_updateallpagessize:function(){if(this.sizemode===n.unified)for(var t="this._pages,e=this.node.getContentSize(),i=0,r=t.length;i<r;i++)t[i].setContentSize(e)},_initPages:function(){if(this.content){for(var" i="t[e];this._pages.indexOf(i)">=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,s.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(t,e,i){if(this.sizeMode===n.Free){var s,o;if(this.direction===r.Horizontal)return s=this._scrollCenterOffsetX[e],o=this._scrollCenterOffsetX[i],Math.abs(t.x)>=Math.abs(s-o)*this.scrollThreshold;if(this.direction===r.Vertical)return s=this._scrollCenterOffsetY[e],o=this._scrollCenterOffsetY[i],Math.abs(t.y)>=Math.abs(s-o)*this.scrollThreshold}else{if(this.direction===r.Horizontal)return Math.abs(t.x)>=this.node.width*this.scrollThreshold;if(this.direction===r.Vertical)return Math.abs(t.y)>=this.node.height*this.scrollThreshold}},_isQuicklyScrollable:function(t){if(this.direction===r.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===r.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(t){var e=cc.p(0,0);return this.sizeMode===n.Free?this.direction===r.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===r.Vertical&&(e.y=this._scrollCenterOffsetY[t]):this.direction===r.Horizontal?e.x=t*this.node.width:this.direction===r.Vertical&&(e.y=t*this.node.height),e},_getDragDirection:function(t){return this.direction===r.Horizontal?0===t.x?0:t.x>0?1:-1:this.direction===r.Vertical?0===t.y?0:t.y<0?1:-1:void 0},_handlereleaselogic:function(t){var="" e="this._startBounceBackIfNeeded(),i=cc.pSub(this._touchBeganPosition,this._touchEndPosition);if(e){var" n="this._getDragDirection(i);if(0===n)return;n">0?this._curPageIdx=this._pages.length-1:this._curPageIdx=0,this.indicator&&this.indicator._changedState()}else{var r=this._curPageIdx,s=r+this._getDragDirection(i);if(s<this._pages.length){if(this._isscrollable(i,r,s))return void="" this.scrolltopage(s);var="" o="this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(o))return" this.scrolltopage(s)}this.scrolltopage(r)}},_ontouchbegan:function(t,e){this._touchbeganposition="t.touch.getLocation(),this._super(t,e)},_onTouchMoved:function(t,e){this._super(t,e)},_onTouchEnded:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onTouchCancelled:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onMouseWheel:function(){}});cc.PageView=e.exports=o}),{}],84:[(function(t,e,i){var" n="cc.Enum({HORIZONTAL:0,VERTICAL:1}),r=cc.Class({name:"cc.PageViewIndicator",extends:t("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:n},onLoad:function(){this._updateLayout()},setPageView:function(t){this._pageView=t,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===n.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===n.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL," this._layout.spacingy="this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var" t="new" cc.node,e="t.addComponent(cc.Sprite);return" e.spriteframe="this.spriteFrame,t.parent=this.node,t.width=this.cellSize.width,t.height=this.cellSize.height,t},_changedState:function(){var" e="this._pageView._curPageIdx;if(!(e">=t.length)){for(var i=0;i<t.length;++i){var n="t[i];n.opacity=127.5}t[e].opacity=255}}},_refresh:function(){if(this._pageView){var" t="this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var" i="0;if(e.length">t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createindicator());else{var n="t.length-e.length;for(i=n;i">0;--i){var r=t[i-1];this.node.removeChild(r),t.splice(i-1,1)}}this._layout&&this._layout.enabledInHierarchy&&this._layout._updateLayout(),this._changedState()}}}});cc.PageViewIndicator=e.exports=r}),{"./CCComponent":76}],85:[(function(t,e,i){var n=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),r=cc.Class({name:"cc.ProgressBar",extends:t("./CCComponent"),editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),r=t.getContentSize();t.parent===this.node&&this.node.setContentSize(r),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=n.FILLED);var s=t.getContentSize();if(this.mode===n.HORIZONTAL?this.totalLength=s.width:this.mode===n.VERTICAL?this.totalLength=s.height:this.totalLength=this.barSprite.fillRange,t.parent===this.node){var o=-e.width*i.x,a=0;t.setPosition(cc.p(o,a))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,i,r,s=t.getAnchorPoint(),o=t.getContentSize(),a=t.getPosition(),c=cc.p(0,.5),h=cc.clamp01(this.progress),l=this.totalLength*h;switch(this.mode){case n.HORIZONTAL:this.reverse&&(c=cc.p(1,.5)),e=cc.size(l,o.height),i=this.totalLength,r=o.height;break;case n.VERTICAL:c=this.reverse?cc.p(.5,1):cc.p(.5,0),e=cc.size(o.width,l),i=o.width,r=this.totalLength}if(this.mode===n.FILLED)this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(l*=-1),this.barSprite.fillRange=l);else if(this.barSprite.type!==cc.Sprite.Type.FILLED){var u=c.x-s.x,_=c.y-s.y,d=cc.p(i*u,r*_);t.setPosition(cc.pAdd(a,d)),t.setAnchorPoint(c),t.setContentSize(e)}else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();this.mode===n.HORIZONTAL?this.totalLength=e.width:this.mode===n.VERTICAL?this.totalLength=e.height:this.mode===n.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(t){this.mode===n.FILLED&&(t=cc.clamp01(t)),this._N$totalLength=t,this._updateBarStatus()}},progress:{default:1,type:"Float",range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:n}});cc.ProgressBar=e.exports=r}),{"./CCComponent":76}],86:[(function(t,e,i){var n=cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererInSG",ctor:function(){var t=this._sgNode=this._createSgNode();t.setVisible(!1),this._plainNode=new _ccsg.Node},__preload:function(){this._initSgNode()},onEnable:function(){this._replaceSgNode(this._sgNode)},onDisable:function(){this._replaceSgNode(this._plainNode)},onDestroy:function(){this._removeSgNode()},_replaceSgNode:function(t){var e=this.node,i=e._sgNode;i._entity=null;var n=i.getChildren().slice();i.removeAllChildren(!1),t.getChildrenCount()>0&&t.removeAllChildren(!1);for(var r=0,s=n.length;r<s;++r)t.addchild(n[r]);var o="i.getParent();o&&(o.removeChild(i,!1),o.addChild(t),t._arrivalOrder=i._arrivalOrder,cc.renderer.childrenOrderDirty=o._reorderChildDirty=!0),e._sgNode=t,e._sgNode._entity=e,e._updateSgNode()}});cc._RendererInSG=e.exports=n}),{"./CCSGComponent":89}],87:[(function(t,e,i){var" n="cc.Class({extends:t("./CCSGComponent"),name:"cc._RendererUnderSG",ctor:function(){var" t="this._sgNode=this._createSgNode();t&&t.setVisible(!1)},__preload:function(){this._initSgNode(),this._registSizeProvider(),this._appendSgNode(this._sgNode)},onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),this._removeSgNode()},_appendSgNode:function(t){if(t){var" e="this.node;t.setColor(e._color),e._cascadeOpacityEnabled||t.setOpacity(e._opacity),t.setAnchorPoint(e._anchorPoint),t.setIgnoreAnchorPointForPosition(e.__ignoreAnchor),t.setOpacityModifyRGB(e._opacityModifyRGB),t.setLocalZOrder(-1);var" i="e._sgNode;i.addChild(t)}}});cc._RendererUnderSG=e.exports=n}),{"./CCSGComponent":89}],88:[(function(t,e,i){t("../label/CCHtmlTextParser.js"),t("../label/CCTextUtils.js");var">Rich<color=#0fffff>Text",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:n.LEFT,type:n,tooltip:!1,animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(t){this.font!==t&&(this._layoutDirty=!0,this.font&&this._onTTFLoaded(),this._updateRichTextStatus())}},maxWidth:{default:0,tooltip:!1,notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}}},statics:{HorizontalAlign:n,VerticalAlign:r},__preload:function(){this._super(),this._registerEvents()},_createSgNode:function(){var t=new _ccsg.Node;t.setCascadeOpacityEnabled(!0);var e=this;return t.setColor=function(){e._updateLabelSegmentTextAttributes()},t._setContentSize=t.setContentSize,t.setContentSize=function(){},t},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t)}.bind(this))},_initSgNode:function(){this._updateRichText(),this._onTTFLoaded()},_createFontLabel:function(t){return new _ccsg.Label(t,this._getFontRawUrl())},_getFontRawUrl:function(){var t=this.font instanceof cc.TTFFont,e=t?this.font.rawUrl:"";return e},_onTTFLoaded:function(){var t=this._getFontRawUrl();if(t){var e=this,i=function(){e._layoutDirty=!0,e._updateRichText()};cc.CustomFontLoader.loadTTF(t,i)}},_measureText:function(t,e){var i=this,n=function(e){var n;0===i._labelSegmentsCache.length?(n=i._createFontLabel(e),i._labelSegmentsCache.push(n)):(n=i._labelSegmentsCache[0],n.setString(e)),n._styleIndex=t,i._applyTextAttribute(n);var r=n.getContentSize();return r.width};return e?n(e):n},_onTouchEnded:function(t){if(this.enabledInHierarchy)for(var e=this.node.getComponents(cc.Component),i=0;i<this._labelsegments.length;++i){var n="this._labelSegments[i],r=n._clickHandler;r&&this._containsTouchLocation(n,t.touch.getLocation())&&e.forEach((function(e){e.enabledInHierarchy&&e[r]&&e[r](t)}))}},_containsTouchLocation:function(t,e){var" i="t.getBoundingBoxToWorld();return" cc.rectcontainspoint(i,e)},_registerevents:function(){this.node.on(cc.node.eventtype.touch_end,this._ontouchended,this)},_resetstate:function(){var="" t="this._sgNode;t&&t.removeAllChildren(),this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},_addLabelSegment:function(t,e){var" i;0="==this._labelSegmentsCache.length?i=this._createFontLabel(t):(i=this._labelSegmentsCache.pop(),i.setString(t)),i._styleIndex=e,i._lineCount=this._lineCount,this._applyTextAttribute(i),i.setAnchorPoint(0,0),this._sgNode.addChild(i),this._labelSegments.push(i);return" i},_updaterichtextwithmaxwidth:function(t,e,i){var="" n,r="e;if(this._lineOffsetX">0&&r+this._lineOffsetX>this.maxWidth)for(var s=0;this._lineOffsetX<=this.maxwidth;){var o="this._getFirstWordLen(t,s,t.length),a=t.substr(s,o),c=this._measureText(i,a);if(!(this._lineOffsetX+c<=this.maxWidth)){if(s">0){var h=t.substr(0,s);this._addLabelSegment(h,i),t=t.substr(s,t.length),r=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=c,s+=o}if(r>this.maxWidth)for(var l=cc.TextUtils.fragmentText(t,r,this.maxWidth,this._measureText(i)),u=0;u<l.length;++u){var _="l[u];n=this._addLabelSegment(_,i);var" d="n.getContentSize();this._lineOffsetX+=d.width,l.length">1&&u<l.length-1&&this._updatelineinfo()}else this._lineoffsetx+="r,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return" t.length-1="==t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var" e="0;e<this._textArray.length;++e){var" i="this._textArray[e],n=t[e];if(i.text!=n.text)return!0;if(i.style){if(n.style){if(i.style.size!==n.style.size||i.style.italic!==n.style.italic||i.style.isImage!==n.style.isImage)return!0;if(i.style.isImage===n.style.isImage&&i.style.src!==n.style.src)return!0}else" if(i.style.size||i.style.italic||i.style.isimage)return!0}else="" if(n.style&&(n.style.size||n.style.italic||n.style.isimage))return!0}return!1},_onspriteframeloaded:function(t,e){var="" i;i="e?e:t.target;var" n="i.__sprite;n.setSpriteFrame(i)},_applySpriteFrame:function(t){t&&(t.textureLoaded()?this._onSpriteFrameLoaded(null,t):(t.once("load",this._onSpriteFrameLoaded,this),t.ensureLoadTexture()))},_addRichTextImageElement:function(t){var" cc.scale9sprite;n.setanchorpoint(0,0),i.__sprite="n,this._sgNode.addChild(n),this._labelSegments.push(n);var" r="i.getRect(),s=1;r.height">this.lineHeight&&(s=this.lineHeight/r.height),this.maxWidth>0?(this._lineOffsetX+r.width*s>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=r.width*s):(this._lineOffsetX+=r.width*s,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),this._applySpriteFrame(i),n.setContentSize(r.width*s,r.height*s),n._lineCount=this._lineCount,t.style.event&&t.style.event.click&&(n._clickHandler=t.style.event.click)}else cc.warnID(4400)},_updateRichText:function(){if(this.enabled){var t=cc.htmlTextParser.parse(this.string);if(!this._needsUpdateTextLayout(t))return this._textArray=t,void this._updateLabelSegmentTextAttributes();this._textArray=t;var e=this._sgNode;this._resetState();for(var i,n,r=!1,s=0;s<this._textarray.length;++s){var o="this._textArray[s],a=o.text;if(""===a){if(o.style&&o.style.newline){this._updateLineInfo();continue}if(o.style&&o.style.isImage&&this.imageAtlas){this._addRichTextImageElement(o);continue}}for(var" c="a.split("\n"),h=0;h<c.length;++h){var" l="c[h];if(""!==l)if(r=!1,this.maxWidth">0){var u=this._measureText(s,l);this._updateRichTextWithMaxWidth(l,u,s),c.length>1&&h<c.length-1&&this._updatelineinfo()}else i="this._addLabelSegment(l,s),n=i.getContentSize(),this._lineOffsetX+=n.width,this._lineOffsetX">this._labelWidth&&(this._labelWidth=this._lineOffsetX),c.length>1&&h<c.length-1&&this._updatelineinfo();else{if(this._islastcomponentcr(a)&&h==c.length-1)continue;this._updatelineinfo(),r=!0}}}r||this._lineswidth.push(this._lineoffsetx),this.maxwidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=this._lineCount*this.lineHeight,e._setContentSize(this._labelWidth,this._labelHeight),this.node.emit("size-changed"),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||cc.TextUtils.isUnicodeSpace(n))return 1;for(var r=1,s=e+1;s<i&&(n=t.charat(s),!cc.textutils.isunicodespace(n)&&!cc.textutils.isunicodecjk(n));++s)r++;return r},_updaterichtextposition:function(){for(var="" t="0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var" r="this._labelSegments[n],s=r._lineCount;s">e&&(t=0,e=s);var o=0;switch(this.horizontalAlign){case cc.TextAlignment.LEFT:o=0;break;case cc.TextAlignment.CENTER:o=(this._labelWidth-this._linesWidth[s-1])/2;break;case cc.TextAlignment.RIGHT:o=this._labelWidth-this._linesWidth[s-1]}r.setPositionX(t+o);var a=r.getContentSize(),c=(i-s)*this.lineHeight;r instanceof cc.Scale9Sprite&&(c+=(this.lineHeight-r.getContentSize().height)/2),r.setPositionY(c),s===e&&(t+=a.width)}},_convertLiteralColorValue:function(t){var e=t.toUpperCase();return cc.Color[e]?cc.Color[e]:cc.hexToColor(t)},_applyTextAttribute:function(t){if(!(t instanceof cc.Scale9Sprite)){var e=t._styleIndex;t.setLineHeight(this.lineHeight),t.setVerticalAlign(r.CENTER);var i=null;this._textArray[e]&&(i=this._textArray[e].style),i&&i.color?t.setColor(this._convertLiteralColorValue(i.color)):t.setColor(this.node.color),i&&i.bold?t.enableBold(!0):t.enableBold(!1),i&&i.italic?t.enableItalics(!0):t.enableItalics(!1),i&&i.underline?t.enableUnderline(!0):t.enableUnderline(!1),i&&i.outline?(t.setOutlined(!0),t.setOutlineColor(this._convertLiteralColorValue(i.outline.color)),t.setOutlineWidth(i.outline.width),t.setMargin(i.outline.width)):(t.setOutlined(!1),t.setMargin(0)),i&&i.size?t.setFontSize(i.size):t.setFontSize(this.fontSize),i&&i.event&&i.event.click&&(t._clickHandler=i.event.click)}}});cc.RichText=e.exports=s}),{"../label/CCHtmlTextParser.js":125,"../label/CCTextUtils.js":129}],89:[(function(t,e,i){var n=t("../utils/scene-graph-helper"),r=cc.Class({extends:t("./CCComponent"),name:"cc._SGComponent",editor:!1,properties:{_sgNode:{default:null,serializable:!1}},_createSgNode:null,_initSgNode:null,_removeSgNode:n.removeSgNode,_registSizeProvider:function(){if(this.node._sizeProvider);else this.node._sizeProvider=this._sgNode}});cc._SGComponent=e.exports=r}),{"../utils/scene-graph-helper":226,"./CCComponent":76}],90:[(function(t,e,i){var n=20,r=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Class({name:"cc.Scrollbar",extends:t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},direction:{default:r.HORIZONTAL,type:r,tooltip:!1,notify:function(){this._onScroll(cc.p(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:r},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=this._scrollView.node.convertToNodeSpace(e);return i},_setOpacity:function(t){this.handle&&this.node.setOpacity(t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),n=this._scrollView.node.getContentSize(),s=this.node.getContentSize();if(this._conditionalDisableScrollBar(i,n))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var o=0,a=0,c=0,h=0,l=0;this.direction===r.HORIZONTAL?(o=i.width,a=n.width,l=s.width,c=t.x,h=-this._convertToScrollViewSpace(e).x):this.direction===r.VERTICAL&&(o=i.height,a=n.height,l=s.height,c=t.y,h=-this._convertToScrollViewSpace(e).y);var u=this._calculateLength(o,a,l,c),_=this._calculatePosition(o,a,l,h,c,u);this._updateLength(u),this._updateHanlderPosition(_)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(cc.pAdd(t,e))}},_fixupHandlerPosition:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this.handle.node.getContentSize(),n=this.handle.node.parent,s=this.node.convertToWorldSpaceAR(cc.p(-t.width*e.x,-t.height*e.y)),o=n.convertToNodeSpaceAR(s);return this.direction===r.HORIZONTAL?o=cc.pAdd(o,cc.p(0,(t.height-i.height)/2)):this.direction===r.VERTICAL&&(o=cc.pAdd(o,cc.p((t.width-i.width)/2,0))),this.handle.node.setPosition(o),o},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(t,e){return t.width<=e.width&&this.direction===r.horizontal||t.height<=e.height&&this.direction===r.vertical},_ontouchended:function(){if(this.enableautohide&&(this._touching=!1,!(this.autohidetime<=0))){if(this._scrollview){var t="this._scrollView.content;if(t){var" e="t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i,r){var" s="t;r&&(s+=(r">0?r:-r)*n);var o=e/s;return i*o},_calculatePosition:function(t,e,i,n,s,o){var a=t-e;s&&(a+=Math.abs(s));var c=0;a&&(c=n/a,c=cc.clamp01(c));var h=(i-o)*c;return this.direction===r.VERTICAL?cc.p(0,h):cc.p(h,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=e.getContentSize();e.setAnchorPoint(cc.p(0,0)),this.direction===r.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autohideremainingtime-=t,this._autohideremainingtime<=this.autohidetime)){this._autohideremainingtime=math.max(0,this._autohideremainingtime);var e="this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=s}),{"./CCComponent":76}],91:[(function(t,e,i){var" n="5,r=.05,s=1e-4,o=.7,a=function(t){return" t-="1,t*t*t*t*t+1},c=function(){var" t="new" date;return="" t.getmilliseconds()},h="cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,AUTOSCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11}),l={"scroll-to-top":h.SCROLL_TO_TOP,"scroll-to-bottom":h.SCROLL_TO_BOTTOM,"scroll-to-left":h.SCROLL_TO_LEFT,"scroll-to-right":h.SCROLL_TO_RIGHT,scrolling:h.SCROLLING,"bounce-bottom":h.BOUNCE_BOTTOM,"bounce-left":h.BOUNCE_LEFT,"bounce-right":h.BOUNCE_RIGHT,"bounce-top":h.BOUNCE_TOP,"scroll-ended":h.AUTOSCROLL_ENDED,"touch-up":h.TOUCH_UP,"scroll-ended-with-threshold":h.AUTOSCROLL_ENDED_WITH_THRESHOLD},u=cc.Class({name:"cc.ScrollView",extends:t("./CCViewGroup"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._outOfBoundaryAmount=cc.p(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedWithThresholdEventFired=!1,this._scrollEventEmitMask=0,this._isBouncing=!1},properties:{content:{default:void" 0,type:cc.node,tooltip:!1},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:"float",range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceduration:{default:1,range:[0,10],tooltip:!1},horizontalscrollbar:{default:void="" 0,type:cc.scrollbar,tooltip:!1,notify:function(){this.horizontalscrollbar&&(this.horizontalscrollbar.settargetscrollview(this),this._updatescrollbar(0))},animatable:!1},verticalscrollbar:{default:void="" 0,type:cc.scrollbar,tooltip:!1,notify:function(){this.verticalscrollbar&&(this.verticalscrollbar.settargetscrollview(this),this._updatescrollbar(0))},animatable:!1},scrollevents:{default:[],type:cc.component.eventhandler,tooltip:!1},cancelinnerevents:{default:!0,animatable:!1,tooltip:!1}},statics:{eventtype:h},scrolltobottom:function(t,e){var="" i="this._calculateMovePercentDelta({anchor:cc.p(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,e!==!1):this._moveContent(i,!0)},scrollToTop:function(t,e){var" cc.p(e,t)},getmaxscrolloffset:function(){var="">=0?i:0,n=n>=0?n:0,cc.p(i,n)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:t,applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.p(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,i!==!1):this._moveContent(n)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(t){cc.pFuzzyEqual(t,this.getContentPosition(),s)||(this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=cc.p(0,0),n=-.1;this.vertical?i=cc.p(0,t.getScrollY()*n):this.horizontal&&(i=cc.p(t.getScrollY()*n,0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},_checkMouseWheel:function(t){var e=this._getHowMuchOutOfBoundary(),i=.1;return cc.pFuzzyEqual(e,cc.p(0,0),s)?(this._mouseWheelEventElapsedTime+=t,void(this._mouseWheelEventElapsedTime>i&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=!1))):(this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1))},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=cc.pClamp(e,cc.p(0,0),cc.p(1,1));var r=this.node.getContentSize(),s=this.content.getContentSize(),o=this._getContentBottomBoundary()-this._bottomBoundary;o=-o;var a=this._getContentLeftBoundary()-this._leftBoundary;a=-a;var c=cc.p(0,0),h=0;return i&&(h=s.width-r.width,c.x=a-h*e.x),n&&(h=s.height-r.height,c.y=o-h*e.y),c},_moveContentToTopLeft:function(t){var e=this.content.getContentSize(),i=this._getContentBottomBoundary()-this._bottomBoundary;i=-i;var n=cc.p(0,0),r=0,s=this._getContentLeftBoundary()-this._leftBoundary;s=-s,e.height<t.height?(r=e.height-t.height,n.y=i-r,this.verticalscrollbar&&this.verticalscrollbar.hide()):this.verticalscrollbar&&this.verticalscrollbar.show(),e.width<t.width?(r=e.width-t.width,n.x=s,this.horizontalscrollbar&&this.horizontalscrollbar.hide()):this.horizontalscrollbar&&this.horizontalscrollbar.show(),this._movecontent(n),this._adjustcontentoutofboundary()},_calculateboundary:function(){if(this.content){var t="this.content.getComponent(cc.Layout);t&&t.enabledInHierarchy&&t._updateLayout();var" e="this.node.getContentSize(),i=this._convertToContentParentSpace(cc.p(0,0));this._leftBoundary=i.x,this._bottomBoundary=i.y;var" n="this._convertToContentParentSpace(cc.p(e.width,e.height));this._rightBoundary=n.x,this._topBoundary=n.y,this._moveContentToTopLeft(e)}},_convertToContentParentSpace:function(t){var" i.converttonodespacear(e)},_hasnestedviewgroup:function(t,e){if(t.eventphase="==cc.Event.CAPTURING_PHASE){if(e)for(var" i="0;i<e.length;++i){var">7&&!this._touchMoved&&t.target!==this.node){var r=new cc.Event.EventTouch(t.getTouches(),t.bubbles);r.type=cc.Node.EventType.TOUCH_CANCEL,r.touch=t.touch,r.simulate=!0,t.target.dispatchEvent(r),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},_onTouchEnded:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent("touch-up");var i=t.touch;this.content&&this._handleReleaseLogic(i),this._touchMoved?t.stopPropagation():this._stopPropagationIfTargetIsMe(t)}},_onTouchCancelled:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){if(!t.simulate){var i=t.touch;this.content&&this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_handleMoveLogic:function(t){var e=t.getDelta();this._processDeltaMove(e)},_scrollChildren:function(t){t=this._clampDelta(t);var e,i=t;this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i=cc.pAdd(i,e));var n=-1;if(i.y>0){var r=this.content.y-this.content.anchorY*this.content.height;r+i.y>this._bottomBoundary&&(n="scroll-to-bottom")}else if(i.y<0){var s="this.content.y-this.content.anchorY*this.content.height+this.content.height;s+i.y<=this._topBoundary&&(n="scroll-to-top")}else" if(i.x<0){var="" o="this.content.x-this.content.anchorX*this.content.width+this.content.width;o+i.x<=this._rightBoundary&&(n="scroll-to-right")}else" if(i.x="">0){var a=this.content.x-this.content.anchorX*this.content.width;a+i.x>=this._leftBoundary&&(n="scroll-to-left")}this._moveContent(i,!1),0===i.x&&0===i.y||this._dispatchEvent("scrolling"),n!==-1&&this._dispatchEvent(n)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended"),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=c(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gathertouchmove:function(t){for(t=this._clampdelta(t);this._touchmovedisplacements.length>=n;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=c();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if(t=this._clampDelta(t),cc.pFuzzyEqual(t,cc.p(0,0),s))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent("bounce-top"),t.y<0&&this._dispatchevent("bounce-bottom"),t.x>0&&this._dispatchEvent("bounce-right"),t.x<0&&this._dispatchevent("bounce-left"),this._isbouncing=!0),!0},_processinertiascroll:function(){var t="this._startBounceBackIfNeeded();if(!t&&this.inertia){var" e="this._calculateTouchMoveVelocity();!cc.pFuzzyEqual(e,cc.p(0,0),s)&&this.brake<1&&this._startInertiaScroll(e)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var" this._autoscrollcurrentlyoutofboundary="!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else" s},_processautoscrolling:function(t){var="" n="Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n=a(n));var" o="cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n)),c=Math.abs(n-1)<=s,h=Math.abs(n-1)<=this.getScrollEndedEventTiming();if(h&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold")," this._isscrollendedwiththresholdeventfired="!0),this.elastic){var" l="cc.pSub(o,this._autoScrollBrakingStartPosition);e&&(l=cc.pMult(l,i)),o=cc.pAdd(this._autoScrollBrakingStartPosition,l)}else{var" u="cc.pSub(o,this.getContentPosition()),_=this._getHowMuchOutOfBoundary(u);cc.pFuzzyEqual(_,cc.p(0,0),s)||(o=cc.pAdd(o,_),c=!0)}c&&(this._autoScrolling=!1);var" d="cc.pSub(o,this.getContentPosition());this._moveContent(d,c),this._dispatchEvent("scrolling"),this._autoScrolling||(this._isBouncing=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(t){var" 1-this.brake;var="" e},_startattenuatingautoscroll:function(t,e){var="" i="this._calculateAutoScrollTimeByInitalSpeed(cc.pLength(e)),n=cc.pNormalize(t),r=this.content.getContentSize(),s=this.node.getContentSize(),o=r.width-s.width,a=r.height-s.height,c=this._calculateAttenuatedFactor(o),h=this._calculateAttenuatedFactor(a);n=cc.p(n.x*o*(1-this.brake)*c,n.y*a*h*(1-this.brake));var">0&&u>7&&(u=Math.sqrt(u),n=cc.pAdd(cc.pMult(t,u),t)),this.brake>0&&u>3&&(u=3,i*=u),0===this.brake&&u>1&&(i*=u),this._startAutoScroll(n,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){var e=Math.sqrt(Math.sqrt(t/5));return e},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var r=this._getHowMuchOutOfBoundary();if(!cc.pFuzzyEqual(r,cc.p(0,0),s)){this._autoScrollCurrentlyOutOfBoundary=!0;var o=this._getHowMuchOutOfBoundary(n);(r.x*o.x>0||r.y*o.y>0)&&(this._autoScrollBraking=!0)}},_calculateTouchMoveVelocity:function(){var t=0;if(t=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),t),t<=0||t>=.5)return cc.p(0,0);var e=cc.p(0,0);return e=this._touchMoveDisplacements.reduce((function(t,e){return cc.pAdd(t,e)}),e),cc.p(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=cc.pAdd(this.getContentPosition(),i);this.setContentPosition(n);var r=this._getHowMuchOutOfBoundary();this._updateScrollBar(r),this.elastic&&e&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){var t=this.getContentPosition(),e=t.x-this.content.getAnchorPoint().x*this.content.getContentSize().width;return e},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){var t=this.getContentPosition(),e=t.y-this.content.getAnchorPoint().y*this.content.getContentSize().height;return e},_getHowMuchOutOfBoundary:function(t){if(t=t||cc.p(0,0),cc.pFuzzyEqual(t,cc.p(0,0),s)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightboundary&&(e.x=this._rightboundary-(this._getcontentrightboundary()+t.x)),this._getcontenttopboundary()+t.y<this._topboundary?e.y=this._topboundary-(this._getcontenttopboundary()+t.y):this._getcontentbottomboundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),cc.pFuzzyEqual(t,cc.p(0,0),s)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e=this._clampDelta(e)},_updateScrollBar:function(t){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(t),this.verticalScrollBar&&this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(t){if("scroll-ended"===t)this._scrollEventEmitMask=0;else if("scroll-to-top"===t||"scroll-to-bottom"===t||"scroll-to-left"===t||"scroll-to-right"===t){var e=1<<l[t];if(this._scrolleventemitmask&e)return;this._scrolleventemitmask|=e}cc.component.eventhandler.emitevents(this.scrollevents,this,l[t]),this.node.emit(t,this)},_adjustcontentoutofboundary:function(){if(this._outofboundaryamountdirty=!0,this._isoutofboundary()){var t="this._getHowMuchOutOfBoundary(cc.p(0,0)),e=cc.pAdd(this.getContentPosition(),t);this.content&&(this.content.setPosition(e),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_AFTER_VISIT,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},_showScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.show(),this.verticalScrollBar&&this.verticalScrollBar.show()},onDisable:function(){this._unregisterEvent(),this.node.off("size-changed",this._calculateBoundary,this),this.content&&this.content.off("size-changed",this._calculateBoundary,this),this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._registerEvent(),this.node.on("size-changed",this._calculateBoundary,this),this.content&&this.content.on("size-changed",this._calculateBoundary,this),this._showScrollbar()},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)}});cc.ScrollView=e.exports=u}),{"./CCViewGroup":99}],92:[(function(t,e,i){var" n="cc.Enum({Horizontal:0,Vertical:1}),r=cc.Class({name:"cc.Slider",extends:t("./CCComponent"),editor:!1,ctor:function(){this._dragging=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){}},direction:{default:n.Horizontal,type:n,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:n},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(t){this._dragging=!0,t.stopPropagation()},_onTouchBegan:function(t){this.handle&&(this._dragging=!0,this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchMoved:function(t){this._dragging&&(this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchEnded:function(t){this._dragging=!1,t.stopPropagation()},_onTouchCancelled:function(t){this._dragging=!1,t.stopPropagation()},_handleSliderLogic:function(t){this._updateProgress(t),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(t){if(this.handle){var" e="null,i=0,r=this.node.convertTouchToNodeSpaceAR(t);this.direction===n.Horizontal?(e=this.node.width/2-this.handle.node.width*this.handle.node.anchorX,i=cc.clamp01((r.x+e)/(2*e),0,1)):this.direction===n.Vertical&&(e=this.node.height/2-this.handle.node.height*this.handle.node.anchorY,i=cc.clamp01((r.y+e)/(2*e),0,1)),this.progress=i}},_updateHandlePosition:function(){if(this.handle){var" t;t="this.direction===n.Horizontal?cc.p(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.p(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var" cc.blendfunc(this._srcblendfactor,this._dstblendfactor)},properties:{_spriteframe:{default:null,type:cc.spriteframe},_type:r.simple,_sizemode:a.trimmed,_filltype:0,_fillcenter:cc.v2(0,0),_fillstart:0,_fillrange:0,_istrimmedmode:!0,_srcblendfactor:o.src_alpha,_dstblendfactor:o.one_minus_src_alpha,_atlas:{default:null,type:cc.spriteatlas,tooltip:!1,editoronly:!0,visible:!0,animatable:!1},spriteframe:{get:function(){return="" this._spriteframe},set:function(t,e){var="" i="this._spriteFrame;i!==t&&(this._spriteFrame=t,this._applySpriteFrame(i))},type:cc.SpriteFrame},type:{get:function(){return" this._type},set:function(t){this._type="t,this._sgNode.setRenderingType(t)},type:r,animatable:!1,tooltip:!1},fillType:{get:function(){return" this._filltype},set:function(t){this._filltype="t,this._sgNode&&this._sgNode.setFillType(t)},type:s,tooltip:!1},fillCenter:{get:function(){return" this._fillcenter},set:function(t){this._fillcenter="cc.v2(t),this._sgNode&&this._sgNode.setFillCenter(this._fillCenter)},tooltip:!1},fillStart:{get:function(){return" this._fillstart},set:function(t){this._fillstart="cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillStart(t)},tooltip:!1},fillRange:{get:function(){return" this._fillrange},set:function(t){this._fillrange="cc.clampf(t,-1,1),this._sgNode&&this._sgNode.setFillRange(t)},tooltip:!1},trim:{get:function(){return" this._istrimmedmode},set:function(t){this._istrimmedmode!="=t&&(this._isTrimmedMode=t,this._sgNode.enableTrimmedContentSize(t))},animatable:!1,tooltip:!1},srcBlendFactor:{get:function(){return" this._srcblendfactor},set:function(t){this._srcblendfactor="t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:o,tooltip:!1},dstBlendFactor:{get:function(){return" this._dstblendfactor},set:function(t){this._dstblendfactor="t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:o,tooltip:!1},sizeMode:{get:function(){return" this._sizemode},set:function(t){this._sizemode="t,t!==a.CUSTOM&&this._applySpriteSize()},animatable:!1,type:a,tooltip:!1}},statics:{FillType:s,Type:r,SizeMode:a},setVisible:function(t){this.enabled=t},setInsetLeft:function(t){this._sgNode.setInsetLeft(t)},getInsetLeft:function(){return" this._sgnode.getinsetleft()},setinsettop:function(t){this._sgnode.setinsettop(t)},getinsettop:function(){return="" this._sgnode.getinsettop()},setinsetright:function(t){this._sgnode.setinsetright(t)},getinsetright:function(){return="" this._sgnode.getinsetright()},setinsetbottom:function(t){this._sgnode.setinsetbottom(t)},getinsetbottom:function(){return="" this._sgnode.getinsetbottom()},onenable:function(){this._sgnode&&this._spriteframe&&this._spriteframe.textureloaded()&&this._sgnode.setvisible(!0)},_applyatlas:!1,_applyspriteframeinsets:function(){var="" if(a.trimmed="==this._sizeMode){var" this.node.setcontentsize(this.node.getcontentsize(!0));else="" this.node.setcontentsize(this.node.getcontentsize(!0))},_ontextureloaded:function(t){var="" new="" cc.scale9sprite},_initsgnode:function(){var="" this._distortionoffset},set:function(t){this._distortionoffset.x="t.x,this._distortionOffset.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionOffset(this._distortionOffset)}},_distortionTiling:cc.v2(1,1),tiling:{get:function(){return" this._distortiontiling},set:function(t){this._distortiontiling.x="t.x,this._distortionTiling.y=t.y,this._spriteSGNode&&this._spriteSGNode.setDistortionTiling(this._distortionTiling)}}},onEnable:function(){var" this._toggleitems}}},updatetoggles:function(t){this.enabledinhierarchy&&this._toggleitems.foreach((function(e){t.ischecked&&e!="=t&&e.isChecked&&e.enabled&&(e.isChecked=!1)}))},addToggle:function(t){var">-1&&this._toggleItems.splice(e,1),this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var t=!1;return this._toggleItems.forEach((function(e){t&&e.enabled&&(e.isChecked=!1),e.isChecked&&e.enabled&&(t=!0)})),t},_makeAtLeastOneToggleChecked:function(){var t=this._allowOnlyOneToggleChecked();t||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}});cc.ToggleGroup=e.exports=n}),{}],98:[(function(t,e,i){t("../videoplayer/CCSGVideoPlayer.js");var n=_ccsg.VideoPlayer.EventType,r=cc.Enum({REMOTE:0,LOCAL:1}),s=cc.Class({name:"cc.VideoPlayer",extends:cc._RendererUnderSG,editor:!1,properties:{_resourceType:r.REMOTE,resourceType:{tooltip:!1,type:r,set:function(t){this._resourceType=t,this._updateVideoSource()},get:function(){return this._resourceType}},_remoteURL:"",remoteURL:{tooltip:!1,type:cc.String,set:function(t){this._remoteURL=t,this._updateVideoSource()},get:function(){return this._remoteURL}},_clip:{default:null,url:cc.RawAsset},clip:{tooltip:!1,get:function(){return this._clip},set:function(t){"string"!=typeof t&&(t=""),this._clip=t,this._updateVideoSource()},url:cc.RawAsset},currentTime:{tooltip:!1,type:cc.Float,set:function(t){this._sgNode&&this._sgNode.seekTo(t)},get:function(){return this._sgNode?this._sgNode.currentTime():-1}},keepAspectRatio:{tooltip:!1,default:!0,type:cc.Boolean,notify:function(){this._sgNode.setKeepAspectRatioEnabled(this.keepAspectRatio)}},isFullscreen:{tooltip:!1,default:!1,type:cc.Boolean,notify:function(){this._sgNode.setFullScreenEnabled(this.isFullscreen)}},videoPlayerEvent:{default:[],type:cc.Component.EventHandler}},statics:{EventType:n,ResourceType:r},onLoad:function(){},_createSgNode:function(){return new _ccsg.VideoPlayer},_updateVideoSource:function(){var t=this._sgNode;this.resourceType===r.REMOTE?t.setURL(this.remoteURL):t.setURL(this._clip||"")},_initSgNode:function(){var t=this._sgNode;t&&(t.createDomElementIfNeeded(),this._updateVideoSource(),t.seekTo(this.currentTime),t.setKeepAspectRatioEnabled(this.keepAspectRatio),t.setFullScreenEnabled(this.isFullscreen),t.setContentSize(this.node.getContentSize()),this.pause(),t.setEventListener(n.PLAYING,this.onPlaying.bind(this)),t.setEventListener(n.PAUSED,this.onPasued.bind(this)),t.setEventListener(n.STOPPED,this.onStopped.bind(this)),t.setEventListener(n.COMPLETED,this.onCompleted.bind(this)),t.setEventListener(n.META_LOADED,this.onMetaLoaded.bind(this)),t.setEventListener(n.CLICKED,this.onClicked.bind(this)),t.setEventListener(n.READY_TO_PLAY,this.onReadyToPlay.bind(this)))},onReadyToPlay:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.READY_TO_PLAY),this.node.emit("ready-to-play",this)},onMetaLoaded:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.META_LOADED),this.node.emit("meta-loaded",this)},onClicked:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.CLICKED),this.node.emit("clicked",this)},onPlaying:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.PLAYING),this.node.emit("playing",this)},onPasued:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.PAUSED),this.node.emit("paused",this)},onStopped:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.STOPPED),this.node.emit("stopped",this)},onCompleted:function(){cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,n.COMPLETED),this.node.emit("completed",this)},play:function(){this._sgNode&&this._sgNode.play()},resume:function(){this._sgNode&&this._sgNode.resume()},pause:function(){this._sgNode&&this._sgNode.pause()},stop:function(){this._sgNode&&this._sgNode.stop()},getDuration:function(){return this._sgNode?this._sgNode.duration():-1},isPlaying:function(){return!!this._sgNode&&this._sgNode.isPlaying()}});cc.VideoPlayer=e.exports=s}),{"../videoplayer/CCSGVideoPlayer.js":237}],99:[(function(t,e,i){var n=cc.Class({name:"cc.ViewGroup",extends:t("./CCComponent")});cc.ViewGroup=e.exports=n}),{"./CCComponent":76}],100:[(function(t,e,i){t("../webview/CCSGWebView.js");var n=_ccsg.WebView.EventType,r=cc.Class({name:"cc.WebView",extends:cc._RendererUnderSG,editor:!1,properties:{_useOriginalSize:!0,_url:"",url:{type:String,tooltip:!1,get:function(){return this._url},set:function(t){this._url=t;var e=this._sgNode;e&&e.loadURL(t)}},webviewEvents:{default:[],type:cc.Component.EventHandler}},statics:{EventType:n},onLoad:!1,_createSgNode:function(){return new _ccsg.WebView},_initSgNode:function(){var t=this._sgNode;t&&(t.createDomElementIfNeeded(),t.setEventListener(n.LOADED,this._onWebViewLoaded.bind(this)),t.setEventListener(n.LOADING,this._onWebViewLoading.bind(this)),t.setEventListener(n.ERROR,this._onWebViewLoadError.bind(this)),t.loadURL(this._url),t.setContentSize(this.node.getContentSize()))},_onWebViewLoaded:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADED),this.node.emit("loaded",this)},_onWebViewLoading:function(){return cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.LOADING),this.node.emit("loading",this),!0},_onWebViewLoadError:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,n.ERROR),this.node.emit("error",this)}});cc.WebView=e.exports=r}),{"../webview/CCSGWebView.js":238}],101:[(function(t,e,i){var n=t("../base-ui/CCWidgetManager"),r=n._AlignFlags,s=r.TOP,o=r.MID,a=r.BOT,c=r.LEFT,h=r.CENTER,l=r.RIGHT,u=s|a,_=c|l,d=cc.Class({name:"cc.Widget",extends:t("./CCComponent"),editor:!1,properties:{target:{get:function(){return this._target},set:function(t){this._target=t},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return(this._alignFlags&s)>0},set:function(t){this._setAlign(s,t)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return(this._alignFlags&o)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=o):this._alignFlags&=~o},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return(this._alignFlags&c)>0},set:function(t){this._setAlign(c,t)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&h)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=h):this._alignFlags&=~h},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return(this._alignFlags&l)>0},set:function(t){this._setAlign(l,t)},animatable:!1,tooltip:!1},isStretchWidth:{get:function(){return(this._alignFlags&_)===_},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&u)===u},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:!1},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:!1},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter=t},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter=t},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},isAlignOnce:{default:!0,tooltip:!1,displayName:"AlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},onEnable:function(){n.add(this)},onDisable:function(){n.remove(this)},_setAlign:function(t,e){var i=(this._alignFlags&t)>0;if(e!=i){var n=(t&_)>0;e?(this._alignFlags|=t,n?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(n?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~t)}},updateAlignment:function(){n.updateAlignment(this.node)}});cc.Widget=e.exports=d}),{"../base-ui/CCWidgetManager":60,"./CCComponent":76}],102:[(function(t,e,i){t("./CCComponent"),t("./CCRendererInSG"),t("./CCRendererUnderSG"),t("./CCComponentEventHandler"),t("./missing-script"),e.exports=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCPageViewIndicator"),t("./CCPageView"),t("./CCSlider"),t("./CCLayout"),t("./CCEditBox"),t("./CCVideoPlayer"),t("./CCWebView"),t("./CCSpriteDistortion"),t("./CCLabelOutline"),t("./CCRichText"),t("./CCToggleGroup"),t("./CCToggle")]}),{"./CCAnimation":72,"./CCAudioSource":73,"./CCButton":74,"./CCCanvas":75,"./CCComponent":76,"./CCComponentEventHandler":77,"./CCEditBox":78,"./CCLabel":79,"./CCLabelOutline":80,"./CCLayout":81,"./CCMask":82,"./CCPageView":83,"./CCPageViewIndicator":84,"./CCProgressBar":85,"./CCRendererInSG":86,"./CCRendererUnderSG":87,"./CCRichText":88,"./CCScrollBar":90,"./CCScrollView":91,"./CCSlider":92,"./CCSprite":93,"./CCSpriteDistortion":94,"./CCToggle":96,"./CCToggleGroup":97,"./CCVideoPlayer":98,"./CCWebView":100,"./CCWidget":101,"./missing-script":103}],103:[(function(t,e,i){var n=cc.js,r=t("../utils/misc").isBuiltinClassId,s=cc.Class({name:"cc.MissingClass",properties:{_$erialized:{default:null,visible:!1,editorOnly:!0}}}),o=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t,e){var i=n._getClassById(t);return i?i:t?(cc.deserialize.reportMissingClass(t),o.getMissingWrapper(t,e)):null},getMissingWrapper:function(t,e){return e.node&&(/^[0-9a-zA-Z+\/]{23}$/.test(t)||r(t))?o:s}},onLoad:function(){cc.warnID(4600,this.node.name)}});cc._MissingScript=e.exports=o}),{"../utils/misc":223}],104:[(function(t,e,i){function n(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=cc.visibleRect.height,n=cc.visibleRect.width,r=.5;n>i&&(r=.7),setTimeout((function(){if(window.scrollY<s&&e.y<i*r){var t="i*r-e.y-window.scrollY;t<35&&(t=35),t">320&&(t=320),window.scrollTo(t,t)}}),o)}function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}var s=40,o=400,a=2,c=t("../platform/utils"),h=function(t){return t.replace(/(?:^|\s)\S/g,(function(t){return t.toUpperCase()}))},l=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4}),u=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),_=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});cc.EditBoxDelegate=cc._Class.extend({editBoxEditingDidBegan:function(t){},editBoxEditingDidEnded:function(t){},editBoxTextChanged:function(t,e){},editBoxEditingReturn:function(t){}}),_ccsg.EditBox=_ccsg.Node.extend({_backgroundSprite:null,_delegate:null,_editBoxInputMode:u.ANY,_editBoxInputFlag:_.DEFAULT,_keyboardReturnType:l.DEFAULT,_maxLength:50,_text:"",_placeholderText:"",_alwaysOnTop:!1,_placeholderFontName:"",_placeholderFontSize:14,__fullscreen:!1,__autoResize:!1,_placeholderColor:null,_className:"EditBox",ctor:function(t,e){_ccsg.Node.prototype.ctor.call(this),this._textColor=cc.Color.WHITE,this._placeholderColor=cc.Color.GRAY,this.initWithSizeAndBackgroundSprite(t,e),this._renderCmd._createLabels()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.EditBox.CanvasRenderCmd(this):new _ccsg.EditBox.WebGLRenderCmd(this)},setContentSize:function(t,e){void 0!==t.width&&void 0!==t.height&&(e=t.height,t=t.width),_ccsg.Node.prototype.setContentSize.call(this,t,e),this._updateEditBoxSize(t,e)},setVisible:function(t){_ccsg.Node.prototype.setVisible.call(this,t),this._renderCmd.updateVisibility()},createDomElementIfNeeded:function(){this._renderCmd._edTxt||this._renderCmd._createDomTextArea()},setTabIndex:function(t){this._renderCmd._edTxt&&(this._renderCmd._edTxt.tabIndex=t)},getTabIndex:function(){return this._renderCmd._edTxt?this._renderCmd._edTxt.tabIndex:(cc.warnID(4700),-1)},setFocus:function(){this._renderCmd._edTxt&&this._renderCmd._edTxt.focus()},isFocused:function(){return this._renderCmd._edTxt?document.activeElement===this._renderCmd._edTxt:(cc.warnID(4700),!1)},stayOnTop:function(t){this._alwaysOnTop!==t&&(this._alwaysOnTop=t,this._renderCmd.stayOnTop(this._alwaysOnTop))},cleanup:function(){this._super(),this._renderCmd.removeDom()},_onTouchBegan:function(t){var e=t.getLocation(),i=cc.rect(0,0,this._contentSize.width,this._contentSize.height),n=cc.rectContainsPoint(i,this.convertToNodeSpace(e));return!!n||(this._renderCmd._endEditing(),!1)},_onTouchEnded:function(){this._renderCmd._beginEditing()},_updateBackgroundSpriteSize:function(t,e){this._backgroundSprite&&this._backgroundSprite.setContentSize(t,e)},_updateEditBoxSize:function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e;this._updateBackgroundSpriteSize(i,n),this._renderCmd.updateSize(i,n)},setLineHeight:function(t){
this._renderCmd.setLineHeight(t)},setFont:function(t,e){this._renderCmd.setFont(t,e)},_setFont:function(t){this._renderCmd._setFont(t)},getBackgroundSprite:function(){return this._backgroundSprite},setFontName:function(t){this._renderCmd.setFontName(t)},setFontSize:function(t){this._renderCmd.setFontSize(t)},setString:function(t){t.length>=this._maxLength&&(t=t.slice(0,this._maxLength)),this._text=t,this._renderCmd.setString(t)},setFontColor:function(t){this._textColor=t,this._renderCmd.setFontColor(t)},setMaxLength:function(t){isNaN(t)||(t<0&&(t=65535),this._maxlength=t,this._rendercmd.setmaxlength(t))},getmaxlength:function(){return this._maxlength},setplaceholder:function(t){null!="=t&&(this._renderCmd.setPlaceHolder(t),this._placeholderText=t)},setPlaceholderFont:function(t,e){this._placeholderFontName=t,this._placeholderFontSize=e,this._renderCmd._updateDOMPlaceholderFontStyle()},_setPlaceholderFont:function(t){var" e="cc.LabelTTF._fontStyleRE.exec(t);e&&(this._placeholderFontName=e[2],this._placeholderFontSize=parseInt(e[1]),this._renderCmd._updateDOMPlaceholderFontStyle())},setPlaceholderFontName:function(t){this._placeholderFontName=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontSize:function(t){this._placeholderFontSize=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontColor:function(t){this._placeholderColor=t,this._renderCmd.setPlaceholderFontColor(t)},setInputFlag:function(t){this._editBoxInputFlag=t,this._renderCmd.setInputFlag(t)},getString:function(){return" this._text},initwithsizeandbackgroundsprite:function(t,e){return="" this._backgroundsprite&&this._backgroundsprite.removefromparent(),this._backgroundsprite="e,_ccsg.Node.prototype.setContentSize.call(this,t),this._backgroundSprite&&!this._backgroundSprite.parent&&(this._backgroundSprite.setAnchorPoint(cc.p(0,0)),this.addChild(this._backgroundSprite),this._updateBackgroundSpriteSize(t.width,t.height)),this.x=0,this.y=0,!0},setDelegate:function(t){this._delegate=t},getPlaceHolder:function(){return" this._placeholdertext},setinputmode:function(t){if(this._editboxinputmode!="=t){var" d="_ccsg.EditBox.prototype;cc.defineGetterSetter(d,"font",null,d._setFont),cc.defineGetterSetter(d,"fontName",null,d.setFontName),cc.defineGetterSetter(d,"fontSize",null,d.setFontSize),cc.defineGetterSetter(d,"fontColor",null,d.setFontColor),cc.defineGetterSetter(d,"string",d.getString,d.setString),cc.defineGetterSetter(d,"maxLength",d.getMaxLength,d.setMaxLength),cc.defineGetterSetter(d,"placeholder",d.getPlaceHolder,d.setPlaceHolder),cc.defineGetterSetter(d,"placeholderFont",null,d._setPlaceholderFont),cc.defineGetterSetter(d,"placeholderFontName",null,d.setPlaceholderFontName),cc.defineGetterSetter(d,"placeholderFontSize",null,d.setPlaceholderFontSize),cc.defineGetterSetter(d,"placeholderFontColor",null,d.setPlaceholderFontColor),cc.defineGetterSetter(d,"inputFlag",null,d.setInputFlag),cc.defineGetterSetter(d,"delegate",null,d.setDelegate),cc.defineGetterSetter(d,"inputMode",null,d.setInputMode),cc.defineGetterSetter(d,"returnType",null,d.setReturnType),d=null,_ccsg.EditBox.InputMode=u,_ccsg.EditBox.InputFlag=_,_ccsg.EditBox.KeyboardReturnType=l,(function(t){t._polyfill={zoomInvalid:!1},cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(t._polyfill.zoomInvalid=!0)})(_ccsg.EditBox),(function(t){var" o="cc.game.container,a=s.a*i,c=s.b,h=s.c,l=s.d*n,u=o&&o.style.paddingLeft&&parseInt(o.style.paddingLeft),_=o&&o.style.paddingBottom&&parseInt(o.style.paddingBottom),d=s.tx*i+u,f=s.ty*n+_;t.zoomInvalid&&(this.updateSize(e._contentSize.width*a,e._contentSize.height*l),a=1,l=1);var" p="matrix(" +a+","+-c+","+-h+","+l+","+d+","+-f+")";this._edtxt.style.transform="p,this._edTxt.style["-webkit-transform"]=p,this._edTxt.style["transform-origin"]="0px" 100%="" 0px",this._edtxt.style["-webkit-transform-origin"]="0px 100% 0px" }},i.updatevisibility="function(){this._edTxt&&(this._node.visible?this._edTxt.style.visibility="visible":this._edTxt.style.visibility="hidden")},i.stayOnTop=function(t){t?(this._removeLabels(),this._edTxt.style.display=""):(this._createLabels(),this._edTxt.style.display="none",this._showLabels())},i._beginEditingOnMobile=function(t){this.__orientationChanged=function(){n(t)},window.addEventListener("orientationchange",this.__orientationChanged),cc.view.isAutoFullScreenEnabled()?(this.__fullscreen=!0,cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()):this.__fullscreen=!1,this.__autoResize=cc.view.__resizeWithBrowserSize,cc.view.resizeWithBrowserSize(!1)},i._endEditingOnMobile=function(){if(this.__rotateScreen){cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)";var" t="cc.view,e=t._originalDesignResolutionSize.width,i=t._originalDesignResolutionSize.height;e">0&&t.setDesignResolutionSize(e,i,t._resolutionPolicy),this.__rotateScreen=!1}window.removeEventListener("orientationchange",this.__orientationChanged),window.scrollTo(0,0),this.__fullscreen&&cc.view.enableAutoFullScreen(!0),this.__autoResize&&cc.view.resizeWithBrowserSize(!0)},i._onFocusOnMobile=function(t){if(cc.view._isRotated){cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",cc.view._isRotated=!1;var e=cc.view.getResolutionPolicy();e.apply(cc.view,cc.view.getDesignResolutionSize()),cc.view._isRotated=!0,window.scrollTo(35,35),this.__rotateScreen=!0}else this.__rotateScreen=!1;n(t)},i._createDomInput=function(){this.removeDom();var t=this,e=this._edTxt=document.createElement("input");return e.type="text",e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.textTransform="uppercase",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left=a+"px",e.style.className="cocosEditBox",e.addEventListener("input",(function(){var e=t._editBox;this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength)),e._delegate&&e._delegate.editBoxTextChanged&&e._text!==this.value&&(e._text=this.value,t._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))})),e.addEventListener("keypress",(function(e){var i=t._editBox;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),e.preventDefault(),""===this.value&&(this.style.fontSize=i._placeholderFontSize+"px",this.style.color=cc.colorToHex(i._placeholderColor)),i._text=this.value,t._updateDomTextCases(),t._endEditing(),i._delegate&&i._delegate.editBoxEditingReturn&&i._delegate.editBoxEditingReturn(i),cc._canvas.focus())})),e.addEventListener("focus",(function(){var e=t._editBox;this.style.fontSize=t._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),t._hiddenLabels(),cc.sys.isMobile&&t._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegan&&e._delegate.editBoxEditingDidBegan(e)})),e.addEventListener("blur",(function(){var e=t._editBox;e._text=this.value,t._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnded&&e._delegate.editBoxEditingDidEnded(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),t._endEditing()})),this._addDomToGameContainer(),e},i._createDomTextArea=function(){this.removeDom();var t=this,e=this._edTxt=document.createElement("textarea");return e.type="text",e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.resize="none",e.style.textTransform="uppercase",e.style.overflow_y="scroll",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left=a+"px",e.style.className="cocosEditBox",e.addEventListener("input",(function(){this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength));var e=t._editBox;e._delegate&&e._delegate.editBoxTextChanged&&e._text.toLowerCase()!==this.value.toLowerCase()&&(e._text=this.value,t._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))})),e.addEventListener("focus",(function(){var e=t._editBox;t._hiddenLabels(),this.style.fontSize=t._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),cc.sys.isMobile&&t._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegan&&e._delegate.editBoxEditingDidBegan(e)})),e.addEventListener("keypress",(function(e){var i=t._editBox;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),i._delegate&&i._delegate.editBoxEditingReturn&&i._delegate.editBoxEditingReturn(i))})),e.addEventListener("blur",(function(){var e=t._editBox;e._text=this.value,t._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnded&&e._delegate.editBoxEditingDidEnded(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),t._endEditing()})),this._addDomToGameContainer(),e},i._createLabels=function(){var t=this._editBox.getContentSize();this._textLabel||(this._textLabel=new _ccsg.Label,this._textLabel.setAnchorPoint(cc.p(0,1)),this._textLabel.setOverflow(_ccsg.Label.Overflow.CLAMP),this._editBox.addChild(this._textLabel,100)),this._placeholderLabel||(this._placeholderLabel=new _ccsg.Label,this._placeholderLabel.setAnchorPoint(cc.p(0,1)),this._placeholderLabel.setColor(cc.Color.GRAY),this._editBox.addChild(this._placeholderLabel,100)),this._updateLabelPosition(t)},i._removeLabels=function(){this._textLabel&&(this._editBox.removeChild(this._textLabel),this._textLabel=null)},i._updateLabelPosition=function(t){if(this._textLabel&&this._placeholderLabel){var e=cc.size(t.width-a,t.height);this._textLabel.setContentSize(e),this._placeholderLabel.setLineHeight(t.height);var i=this._placeholderLabel.getContentSize();this._editBox._editBoxInputMode===u.ANY?(this._textLabel.setPosition(a,t.height),this._placeholderLabel.setPosition(a,t.height),this._placeholderLabel.setVerticalAlign(cc.VerticalTextAlignment.TOP),this._textLabel.setVerticalAlign(cc.VerticalTextAlignment.TOP),this._textLabel.enableWrapText(!0)):(this._textLabel.enableWrapText(!1),this._textLabel.setPosition(a,t.height),this._placeholderLabel.setPosition(a,(t.height+i.height)/2),this._placeholderLabel.setVerticalAlign(cc.VerticalTextAlignment.CENTER),this._textLabel.setVerticalAlign(cc.VerticalTextAlignment.CENTER))}},i.setLineHeight=function(t){this._textLabel&&this._textLabel.setLineHeight(t)},i._hiddenLabels=function(){this._textLabel&&this._textLabel.setVisible(!1),this._placeholderLabel&&this._placeholderLabel.setVisible(!1)},i._updateDomTextCases=function(){var t=this._editBox._editBoxInputFlag;t===_.INITIAL_CAPS_ALL_CHARACTERS?this._editBox._text=this._editBox._text.toUpperCase():t===_.INITIAL_CAPS_WORD?this._editBox._text=h(this._editBox._text):t===_.INITIAL_CAPS_SENTENCE&&(this._editBox._text=r(this._editBox._text))},i._updateLabelStringStyle=function(){if("password"===this._edTxt.type){for(var t="",e=this._editBox._text.length,i=0;i<e;++i)t+="●";this._textlabel&&this._textlabel.setstring(t)}else 0="==this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(t){0===t._getFixedPriority()?this._sceneGraphListeners.push(t):this._fixedListeners.push(t)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return" this._updatedomtextcases(),this._textlabel&&this._textlabel.setstring(this._editbox._text)},i._showlabels="function(){this._hiddenLabels(),""===this._edTxt.value?this._placeholderLabel&&(this._placeholderLabel.setVisible(!0),this._placeholderLabel.setString(this._editBox._placeholderText)):this._textLabel&&(this._textLabel.setVisible(!0),this._textLabel.setString(this._editBox._text)),this._updateLabelStringStyle()},i._beginEditing=function(){this._editBox._alwaysOnTop||"none"===this._edTxt.style.display&&(this._edTxt.style.display="",this._edTxt.focus()),cc.sys.isMobile&&!this._editingMode&&this._beginEditingOnMobile(this._editBox),this._editingMode=!0},i._endEditing=function(){if(this._editBox._alwaysOnTop||(this._edTxt.style.display="none"),this._showLabels(),cc.sys.isMobile&&this._editingMode){var" t="this;setTimeout((function(){t._endEditingOnMobile()}),o)}this._editingMode=!1},i._setFont=function(t){var" e="cc.LabelTTF._fontStyleRE.exec(t),i=e[2],n=parseInt(e[1]);e&&this.setFont(i,n)},i.setFont=function(t,e){this._edFontName=t||this._edFontName,this._edFontSize=e||this._edFontSize,this._updateDOMFontStyle()},i.setFontName=function(t){this._edFontName=t||this._edFontName,this._updateDOMFontStyle()},i.setFontSize=function(t){this._edFontSize=t||this._edFontSize,this._updateDOMFontStyle()},i.setFontColor=function(t){this._edTxt&&(this._edTxt.value!==this._editBox._placeholderText&&(this._edTxt.style.color=cc.colorToHex(t)),this._textLabel&&this._textLabel.setColor(t))},i.setPlaceHolder=function(t){this._placeholderLabel.setString(t)},i.setMaxLength=function(t){this._edTxt&&(this._edTxt.maxLength=t)},i._updateDOMPlaceholderFontStyle=function(){this._placeholderLabel.setFontFileOrFamily(this._editBox._placeholderFontName),this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)},i.setPlaceholderFontColor=function(t){this._placeholderLabel.setColor(t)},i._updateDomInputType=function(){var" i="this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px",this._updateLabelPosition(cc.size(t,e)))},i._addDomToGameContainer=function(){cc.game.container.appendChild(this._edTxt)},i.removeDom=function(){var" s="_ccsg.EditBox.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);cc.js.mixin(s,i),s.constructor=_ccsg.EditBox.CanvasRenderCmd,s.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()},_ccsg.EditBox.WebGLRenderCmd=function(t){this._rootCtor(t),this.initializeRenderCmd(t)};var" d="_ccsg.EditBox.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);cc.js.mixin(d,i),d.constructor=_ccsg.EditBox.WebGLRenderCmd,d.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()}})(_ccsg.EditBox._polyfill)}),{"../platform/utils":198}],105:[(function(t,e,i){var" n="cc.js,r=cc.Event,s=function(t,e){cc.Event.call(this,cc.Event.MOUSE,e),this._eventType=t,this._button=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this._scrollX=0,this._scrollY=0};n.extend(s,cc.Event);var" o="s.prototype;o.setScrollData=function(t,e){this._scrollX=t,this._scrollY=e},o.getScrollX=function(){return" this._scrollx},o.getscrolly="function(){return" this._scrolly},o.setlocation="function(t,e){this._x=t,this._y=e},o.getLocation=function(){return{x:this._x,y:this._y}},o.getLocationInView=function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},o._setPrevCursor=function(t,e){this._prevX=t,this._prevY=e},o.getPreviousLocation=function(){return{x:this._prevX,y:this._prevY}},o.getDelta=function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},o.getDeltaX=function(){return" this._x-this._prevx},o.getdeltay="function(){return" this._y-this._prevy},o.setbutton="function(t){this._button=t},o.getButton=function(){return" this._button},o.getlocationx="function(){return" this._x},o.getlocationy="function(){return" this._y},s.none="0,s.DOWN=1,s.UP=2,s.MOVE=3,s.SCROLL=4,s.BUTTON_LEFT=0,s.BUTTON_RIGHT=2,s.BUTTON_MIDDLE=1,s.BUTTON_4=3,s.BUTTON_5=4,s.BUTTON_6=5,s.BUTTON_7=6,s.BUTTON_8=7;var" a="function(t,e){cc.Event.call(this,cc.Event.TOUCH,e),this._eventCode=0,this._touches=t||[],this.currentTouch=null};n.extend(a,cc.Event),o=a.prototype,o.getEventCode=function(){return" this._eventcode},o.gettouches="function(){return" this._touches},o._seteventcode="function(t){this._eventCode=t},o._setTouches=function(t){this._touches=t},o.setLocation=function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},o.getLocation=function(){return" this.touch?this.touch.getlocation():cc.v2()},o.getlocationinview="function(){return" this.touch?this.touch.getlocationinview():cc.v2()},o.getpreviouslocation="function(){return" this.touch?this.touch.getpreviouslocation():cc.v2()},o.getstartlocation="function(){return" this.touch?this.touch.getstartlocation():cc.v2()},o.getid="function(){return" this.touch?this.touch.getid():null},o.getdelta="function(){return" this.touch?this.touch.getdelta():cc.v2()},o.getdeltax="function(){return" this.touch?this.touch.getdelta().x:0},o.getdeltay="function(){return" this.touch?this.touch.getdelta().y:0},o.getlocationx="function(){return" this.touch?this.touch.getlocationx():0},o.getlocationy="function(){return" this.touch?this.touch.getlocationy():0},a.max_touches="5,a.BEGAN=0,a.MOVED=1,a.ENDED=2,a.CANCELED=3;var" c="function(t,e){cc.Event.call(this,r.ACCELERATION,e),this.acc=t};n.extend(c,cc.Event);var" h="function(t,e,i){cc.Event.call(this,r.KEYBOARD,i),this.keyCode=t,this.isPressed=e};n.extend(h,cc.Event),cc.Event.EventMouse=s,cc.Event.EventTouch=a,cc.Event.EventAcceleration=c,cc.Event.EventKeyboard=h,e.exports=r}),{}],106:[(function(t,e,i){cc.EventListener=cc._Class.extend({ctor:function(t,e,i){this._onEvent=i,this._type=t||0,this._listenerID=e||"",this._registered=!1,this._fixedPriority=0,this._node=null,this._target=null,this._paused=!0,this._isEnabled=!0},_setPaused:function(t){this._paused=t},_isPaused:function(){return" this._paused},_setregistered:function(t){this._registered="t},_isRegistered:function(){return" this._registered},_gettype:function(){return="" this._type},_getlistenerid:function(){return="" this._listenerid},_setfixedpriority:function(t){this._fixedpriority="t},_getFixedPriority:function(){return" this._fixedpriority},_setscenegraphpriority:function(t){this._target="t,this._node=t},_getSceneGraphPriority:function(){return" this._node},checkavailable:function(){return="" null!="=this._onEvent},clone:function(){return" null},setenabled:function(t){this._isenabled="t},isEnabled:function(){return" this._isenabled},retain:function(){},release:function(){}}),cc.eventlistener.unknown="0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(t,e){this._onCustomEvent=e,cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,t,this._callback)},_callback:function(t){null!==this._onCustomEvent&&this._onCustomEvent(t)},checkAvailable:function(){return" cc.eventlistener.prototype.checkavailable.call(this)&&null!="=this._onCustomEvent},clone:function(){return" new="" cc._eventlistenercustom(this._listenerid,this._oncustomevent)}}),cc._eventlistenermouse="cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,this._callback)},_callback:function(t){var" e.down:this.onmousedown&&this.onmousedown(t);break;case="" e.up:this.onmouseup&&this.onmouseup(t);break;case="" e.move:this.onmousemove&&this.onmousemove(t);break;case="" e.scroll:this.onmousescroll&&this.onmousescroll(t)}},clone:function(){var="" cc._eventlistenermouse;return="" t.onmousedown="this.onMouseDown,t.onMouseUp=this.onMouseUp,t.onMouseMove=this.onMouseMove,t.onMouseScroll=this.onMouseScroll,t},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(t){this.swallowTouches=t},isSwallowTouches:function(){return" this.swallowtouches},clone:function(){var="" cc._eventlistenertouchonebyone;return="" t.ontouchbegan="this.onTouchBegan,t.onTouchMoved=this.onTouchMoved,t.onTouchEnded=this.onTouchEnded,t.onTouchCancelled=this.onTouchCancelled,t.swallowTouches=this.swallowTouches,t},checkAvailable:function(){return!!this.onTouchBegan||(cc.logID(1801),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var" cc._eventlistenertouchallatonce;return="" t.ontouchesbegan="this.onTouchesBegan,t.onTouchesMoved=this.onTouchesMoved,t.onTouchesEnded=this.onTouchesEnded,t.onTouchesCancelled=this.onTouchesCancelled,t},checkAvailable:function(){return" t.event;var="" cc._eventlistenertouchonebyone:e="==cc.EventListener.TOUCH_ALL_AT_ONCE?i=new" cc._eventlistenertouchallatonce:e="==cc.EventListener.MOUSE?i=new" cc._eventlistenermouse:e="==cc.EventListener.CUSTOM?(i=new" cc._eventlistenercustom(t.eventname,t.callback),delete="" t.eventname,delete="" t.callback):e="==cc.EventListener.KEYBOARD?i=new" cc._eventlistenerkeyboard:e="==cc.EventListener.ACCELERATION&&(i=new" cc._eventlisteneracceleration(t.callback),delete="" t.callback);for(var="" in="" t)i[n]="t[n];return" i},cc._eventlisteneracceleration="cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(t){this._onAccelerationEvent=t,cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,this._callback)},_callback:function(t){this._onAccelerationEvent(t.acc,t)},checkAvailable:function(){return" cc.assertid(this._onaccelerationevent,1803),!0},clone:function(){return="" cc._eventlisteneracceleration(this._onaccelerationevent)}}),cc._eventlisteneracceleration.listener_id="__cc_acceleration" ,cc._eventlistenerkeyboard="cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,this._callback)},_callback:function(t){t.isPressed?this.onKeyPressed&&this.onKeyPressed(t.keyCode,t):this.onKeyReleased&&this.onKeyReleased(t.keyCode,t)},clone:function(){var" cc._eventlistenerkeyboard;return="" t.onkeypressed="this.onKeyPressed,t.onKeyReleased=this.onKeyReleased,t},checkAvailable:function(){return" this._fixedlisteners.length+this._scenegraphlisteners.length},empty:function(){return="" this._fixedlisteners},getscenegraphprioritylisteners:function(){return="" this._scenegraphlisteners}}),r="function(t){var" 0!="=this._nodeListenersMap[t.__instanceId]&&this._dirtyNodes.push(t),t.getChildren)for(var" instanceof="" cc._basenode||t="" _ccsg.node))return="" void="" cc.warnid(3506);var="" i,n,r="this._nodeListenersMap[t.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!0);if(e===!0){var" n,this._listenersmap[e]="i),i.push(t),0===t._getFixedPriority()){this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY);var" r="t._getSceneGraphPriority();null===r&&cc.logID(3507),this._associateNodeAndEventListener(r,t),r.isRunning()&&this.resumeTarget(r)}else" this._setdirty(e,this.dirty_fixed_priority)},_getlisteners:function(t){return="" this._listenersmap[t]},_updatedirtyflagforscenegraph:function(){if(0!="=this._dirtyNodes.length){for(var" t,e,i="this._dirtyNodes,n=this._nodeListenersMap,r=0,s=i.length;r<s;r++)if(t=n[i[r].__instanceId])for(var" e,i="0;i<t.length;)e=t[i],e._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.remove(t,e):++i},_removeListenersForListenerID:function(t){var" this._prioritydirtyflagmap[t],this._indispatch||(i.clear(),delete="" this._listenersmap[t])}var="" s,o="this._toAddedListeners;for(e=0;e<o.length;)s=o[e],s&&s._getListenerID()===t?cc.js.array.remove(o,s):++e},_sortEventListeners:function(t){var" e&&r&&i[r.__instanceid]?t&&n&&i[n.__instanceid]?i[r.__instanceid]-i[n.__instanceid]:1:-1},_sortlistenersoffixedpriority:function(t){var="">=0);)++n;e.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(t,e){return t._getFixedPriority()-e._getFixedPriority()},_onUpdateListeners:function(t){var e,i,n,r=t.getFixedPriorityListeners(),s=t.getSceneGraphPriorityListeners(),o=this._toRemovedListeners;if(s)for(e=0;e<s.length;)i=s[e],i._isregistered()?++e:(cc.js.array.remove(s,i),n=o.indexof(i),n!==-1&&o.splice(n,1));if(r)for(e=0;e<r.length;)i=r[e],i._isregistered()?++e:(cc.js.array.remove(r,i),n=o.indexof(i),n!==-1&&o.splice(n,1));s&&0===s.length&&t.clearscenegraphlisteners(),r&&0===r.length&&t.clearfixedlisteners()},frameupdatelisteners:function(){var t="this._listenersMap,e=this._priorityDirtyFlagMap;for(var" i="" in="" t)t[i].empty()&&(delete="" e[i],delete="" t[i]);var="" n="this._toAddedListeners;if(0!==n.length){for(var" r="0,s=n.length;r<s;r++)this._forceAddEventListener(n[r]);n.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(t){var" e="this._inDispatch;if(cc.assertID(e">0,3508),!(e>1)){var i;i=this._listenersMap[cc._EventListenerTouchOneByOne.LISTENER_ID],i&&this._onUpdateListeners(i),i=this._listenersMap[cc._EventListenerTouchAllAtOnce.LISTENER_ID],i&&this._onUpdateListeners(i),cc.assertID(1===e,3509);var n=this._toAddedListeners;if(0!==n.length){for(var r=0,s=n.length;r<s;r++)this._forceaddeventlistener(n[r]);this._toaddedlisteners.length=0}0!==this._toremovedlisteners.length&&this._cleantoremovedlisteners(); }},_cleantoremovedlisteners:function(){for(var="" t="this._toRemovedListeners,e=0;e<t.length;e++){var" i="t[e],n=this._listenersMap[i._getListenerID()];if(n){var" r,s="n.getFixedPriorityListeners(),o=n.getSceneGraphPriorityListeners();o&&(r=o.indexOf(i),r!==-1&&o.splice(r,1)),s&&(r=s.indexOf(i),r!==-1&&s.splice(r,1))}}t.length=0},_onTouchEventCallback:function(t,e){if(!t._isRegistered)return!1;var" o="==a.BEGAN?t.onTouchBegan&&(s=t.onTouchBegan(n,i),s&&t._registered&&t._claimedTouches.push(n)):t._claimedTouches.length">0&&(r=t._claimedTouches.indexOf(n))!==-1&&(s=!0,o===a.MOVED&&t.onTouchMoved?t.onTouchMoved(n,i):o===a.ENDED?(t.onTouchEnded&&t.onTouchEnded(n,i),t._registered&&t._claimedTouches.splice(r,1)):o===a.CANCELLED&&(t.onTouchCancelled&&t.onTouchCancelled(n,i),t._registered&&t._claimedTouches.splice(r,1))),i.isStopped()?(cc.eventManager._updateTouchListeners(i),!0):!!(s&&t._registered&&t.swallowTouches)&&(e.needsMutableSet&&e.touches.splice(n,1),!0)},_dispatchTouchEvent:function(t){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var e=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==e||null!==i){var n=t.getTouches(),r=cc.js.array.copy(n),s={event:t,needsMutableSet:e&&i,touches:r,selTouch:null};if(e)for(var o=0;o<n.length;o++)if(t.currenttouch=n[o],this._dispatcheventtolisteners(e,this._ontoucheventcallback,s),t.isstopped())return;i&&r.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:t,touches:r}),t.isStopped())||this._updateTouchListeners(t)}},_onTouchesEventCallback:function(t,e){if(!t._registered)return!1;var i=cc.Event.EventTouch,n=e.event,r=e.touches,s=n.getEventCode();return n.currentTarget=t._node,s===i.BEGAN&&t.onTouchesBegan?t.onTouchesBegan(r,n):s===i.MOVED&&t.onTouchesMoved?t.onTouchesMoved(r,n):s===i.ENDED&&t.onTouchesEnded?t.onTouchesEnded(r,n):s===i.CANCELLED&&t.onTouchesCancelled&&t.onTouchesCancelled(r,n),!!n.isStopped()&&(cc.eventManager._updateTouchListeners(n),!0)},_associateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i||(i=[],this._nodeListenersMap[t.__instanceId]=i),i.push(e)},_dissociateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i&&(cc.js.array.remove(i,e),0===i.length&&delete this._nodeListenersMap[t.__instanceId])},_dispatchEventToListeners:function(t,e,i){var n,r,s=!1,o=t.getFixedPriorityListeners(),a=t.getSceneGraphPriorityListeners(),c=0;if(o&&0!==o.length)for(;c<t.gt0index;++c)if(r=o[c],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}if(a&&!s)for(n=0;n<a.length;n++)if(r=a[n],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}if(o&&!s)for(;c<o.length;++c)if(r=o[c],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}},_setdirty:function(t,e){var i="this._priorityDirtyFlagMap;null==i[t]?i[t]=e:i[t]=e|i[t]},_visitTarget:function(t,e){t._reorderChildDirty&&t.sortAllChildren();var">0){for(var a;n<r&&(a=i[n],a&&a.getlocalzorder()<0);n++)this._visittarget(a,!1);for(void 0="==e?(this._point.x=t.x,this._point.y=t.y):(this._point.x=t,this._point.y=e)},_setPrevPoint:function(t,e){void" 0!="=o[t.__instanceId]&&(s[t.getGlobalZOrder()]||(s[t.getGlobalZOrder()]=[]),s[t.getGlobalZOrder()].push(t.__instanceId));n<r;n++)a=i[n],a&&this._visitTarget(a,!1)}else" void="" c="[];for(var" h="" in="" s)c.push(h);c.sort(this._sortnumberasc);var="" l,u,_="c.length,d=this._nodePriorityMap;for(n=0;n<_;n++)for(l=s[c[n]],u=0;u<l.length;u++)d[l[u]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(t,e){return" t-e},haseventlistener:function(t){return!!this._getlisteners(t)},addlistener:function(t,e){if(cc.assertid(t&&e,3503),!(cc.js.isnumber(e)||e="" instanceof="" cc._basenode||e="" _ccsg.node))return="" cc.warnid(3506);if(t="" cc.eventlistener){if(t._isregistered())return="" cc.logid(3505)}else="" cc.assertid(!cc.js.isnumber(e),3504),t="cc.EventListener.create(t);if(t.checkAvailable()){if(cc.js.isNumber(e)){if(0===e)return" cc.logid(3500);t._setscenegraphpriority(null),t._setfixedpriority(e),t._setregistered(!0),t._setpaused(!1),this._addlistener(t)}else="" t._setscenegraphpriority(e),t._setfixedpriority(0),t._setregistered(!0),this._addlistener(t);return="" t}},addcustomlistener:function(t,e){var="" i="new" cc._eventlistenercustom(t,e);return="" this.addlistener(i,1),i},removelistener:function(t){if(null!="t){var" e,i="this._listenersMap;for(var" n="" i){var="" r="i[n],s=r.getFixedPriorityListeners(),o=r.getSceneGraphPriorityListeners();if(e=this._removeListenerInVector(o,t),e?this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(e=this._removeListenerInVector(s,t),e&&this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)),r.empty()&&(delete" this._prioritydirtyflagmap[t._getlistenerid()],delete="" i[n]),e)break}if(!e)for(var="" a="this._toAddedListeners,c=0,h=a.length;c<h;c++){var" l="a[c];if(l===t){cc.js.array.remove(a,l),l._setRegistered(!1);break}}}},_removeListenerInCallback:function(t,e){if(null==t)return!1;for(var" r._setregistered(!1),null!="r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.remove(t,r):this._toRemovedListeners.push(r),!0}return!1},_removeListenerInVector:function(t,e){if(null==t)return!1;for(var" i,n="this;if(!(cc.js.isNumber(t)||t" cc._basenode||t="" cc.warnid(3506);if(void="" n._nodeprioritymap[t.__instanceid],cc.js.array.remove(n._dirtynodes,t);var="" i,r="n._nodeListenersMap[t.__instanceId];if(r){var" s="cc.js.array.copy(r);for(i=0;i<s.length;i++)n.removeListener(s[i]);delete" n._nodelistenersmap[t.__instanceid]}var="" o="n._toAddedListeners;for(i=0;i<o.length;){var" c,h="t.getChildren();for(i=0,c=h.length;i<c;i++)n.removeListeners(h[i],!0)}}else" t="==cc.EventListener.TOUCH_ONE_BY_ONE?n._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):t===cc.EventListener.TOUCH_ALL_AT_ONCE?n._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):t===cc.EventListener.MOUSE?n._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):t===cc.EventListener.ACCELERATION?n._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):t===cc.EventListener.KEYBOARD?n._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.logID(3501)},removeCustomListeners:function(t){this._removeListenersForListenerID(t)},removeAllListeners:function(){var" t)e.indexof(i)="==-1&&this._removeListenersForListenerID(i)},setPriority:function(t,e){if(null!=t){var" null!="t._getSceneGraphPriority()&&cc.logID(3502),void(t._getFixedPriority()!==e&&(t._setFixedPriority(e),this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}}},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return" this._isenabled},dispatchevent:function(t){if(this._isenabled){if(this._updatedirtyflagforscenegraph(),this._indispatch++,!t||!t.gettype)throw="" new="" error("event="" is="" undefined");if(t.gettype().startswith(cc.event.touch))return="" this._dispatchtouchevent(t),void="" this._indispatch--;var="" e="r(t);this._sortEventListeners(e);var" e.currenttarget="t._target,t._onEvent(e),e.isStopped()},dispatchCustomEvent:function(t,e){var" cc.event.eventcustom(t);i.setuserdata(e),this.dispatchevent(i)}}}),{}],108:[(function(t,e,i){var="" cc.systemevent}),{"..="" event="" event-target":112}],109:[(function(t,e,i){cc.touch="cc._Class.extend({ctor:function(t,e,i){this._lastModified=0,this.setTouchInfo(i,t,e)},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return" this._point.x},getlocationy:function(){return="" this._point.y},getpreviouslocation:function(){return{x:this._prevpoint.x,y:this._prevpoint.y}},getstartlocation:function(){return{x:this._startpoint.x,y:this._startpoint.y}},getdelta:function(){return="" cc.psub(this._point,this._prevpoint)},getlocationinview:function(){return{x:this._point.x,y:cc.view._designresolutionsize.height-this._point.y}},getpreviouslocationinview:function(){return{x:this._prevpoint.x,y:cc.view._designresolutionsize.height-this._prevpoint.y}},getstartlocationinview:function(){return{x:this._startpoint.x,y:cc.view._designresolutionsize.height-this._startpoint.y}},getid:function(){return="" this._id},settouchinfo:function(t,e,i){this._prevpoint="this._point,this._point=cc.p(e||0,i||0),this._id=t,this._startPointCaptured||(this._startPoint=cc.p(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(t,e){void" n(){s.call(this)}var="" i,n,r,s,a,c="t.type,h=this._callbackTable[c];if(this._invoking[c]=!0,h)if(1===h.length)r=h[0],r!==o&&r.call(t.currentTarget,t,e);else" for(n="h.length-1,i=0;i<=n;){r=h[i];var" s,a?(r.call(s,t,e),l="2):r.call(t.currentTarget,t,e),t._propagationImmediateStopped||i+l">n))break;i+=l}this._invoking[c]=!1,this._clearToRemove(c)},e.exports=n}),{"../platform/callbacks-invoker":187}],112:[(function(t,e,i){function n(){this._capturingListeners=null,this._bubblingListeners=null}var r=t("./event-listeners");t("./event");var s=cc.js,o=s.array.fastRemove,a=new Array(16);a.length=0;var c=function(t,e){var i,n;for(e.target=t,a.length=0,t._getCapturingTargets(e.type,a),e.eventPhase=1,n=a.length-1;n>=0;--n)if(i=a[n],i._isTargetActive(e.type)&&i._capturingListeners&&(e.currentTarget=i,i._capturingListeners.invoke(e,a),e._propagationStopped))return void(a.length=0);if(a.length=0,t._isTargetActive(e.type)&&(e.eventPhase=2,e.currentTarget=t,t._capturingListeners&&t._capturingListeners.invoke(e),!e._propagationImmediateStopped&&t._bubblingListeners&&t._bubblingListeners.invoke(e)),!e._propagationStopped&&e.bubbles)for(t._getBubblingTargets(e.type,a),e.eventPhase=3,n=0;n<a.length;++n)if(i=a[n],i._istargetactive(e.type)&&i._bubblinglisteners&&(e.currenttarget=i,i._bubblinglisteners.invoke(e),e._propagationstopped))return void(a.length="0);a.length=0},h=n.prototype;h.hasEventListener=function(t,e){return!!(e&&this._capturingListeners&&this._capturingListeners.has(t))||!(e||!this._bubblingListeners||!this._bubblingListeners.has(t))},h.on=function(t,e,i,n){if("boolean"==typeof" i?(n="i,i=void" 0):n="!!n,!e)return" void="" cc.errorid(6800);var="" s="null;return" r:this._bubblinglisteners="this._bubblingListeners||new" r,s.has(t,e,i)||(s.add(t,e,i),i&&i.__eventtargets&&i.__eventtargets.push(this)),e},h.off="function(t,e,i,n){if("boolean"==typeof" r="n?this._capturingListeners:this._bubblingListeners;r&&(r.remove(t,e,i),i&&i.__eventTargets&&o(i.__eventTargets,this))}},h.targetOff=function(t){this._capturingListeners&&this._capturingListeners.removeAll(t),this._bubblingListeners&&this._bubblingListeners.removeAll(t)},h.once=function(t,e,i,n){var" i="this._capturingListeners&&this._capturingListeners._callbackTable[t],n=this._bubblingListeners&&this._bubblingListeners._callbackTable[t];if(i&&0!==i.length||n&&0!==n.length){var" n="t("../platform/js");cc.Event=function(t,e){this.type=t,this.bubbles=!!e,this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1},cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return" this._propagationstopped||this._propagationimmediatestopped},getcurrenttarget:function(){return="" this.currenttarget},gettype:function(){return="" this.type}},cc.event.no_type="no_type" ,cc.event.touch="touch" ,cc.event.mouse="mouse" ,cc.event.keyboard="keyboard" ,cc.event.acceleration="acceleration" ,cc.event.none="0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3;var" this.detail},r.prototype.geteventname="cc.Event.prototype.getType;var" n.pool(s);r.put="function(t){o.put(t)},r.get=function(t,e){var" i?i.reset(t,e):i="new" r(t,e),i},cc.event.eventcustom="r,e.exports=cc.Event}),{"../platform/js":193}],114:[(function(t,e,i){t("./event.js"),t("./event-listeners.js"),t("./event-target.js")}),{"./event-listeners.js":111,"./event-target.js":112,"./event.js":113}],115:[(function(t,e,i){"use" strict";function="" n(t,e,i){i="i||2;var" c;var="" h,l,_,d,f,p,m;if(n&&(a="u(t,e,a,i)),t.length">80*i){h=_=t[0],l=d=t[1];for(var g=i;g<s;g+=i)f=t[g],p=t[g+1],f<h&&(h=f),p<l&&(l=p),f>_&&(_=f),p>d&&(d=p);m=Math.max(_-h,d-l)}return o(a,c,i,h,l,m),c}function r(t,e,i,n,r){var s,o;if(r===O(t,e,i,n)>0)for(s=e;s<i;s+=n)o=i(s,t[s],t[s+1],o);else for(s="i-n;s">=e;s-=n)o=I(s,t[s],t[s+1],o);return o&&b(o,o.next)&&(R(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var i,n=t;do if(i=!1,n.steiner||!b(n,n.next)&&0!==T(n.prev,n,n.next))n=n.next;else{if(R(n),n=e=n.prev,n===n.next)return null;i=!0}while(i||n!==e);return e}function o(t,e,i,n,r,u,_){if(t){!_&&u&&p(t,n,r,u);for(var d,f,m=t;t.prev!==t.next;)if(d=t.prev,f=t.next,u?c(t,n,r,u):a(t))e.push(d.i/i),e.push(t.i/i),e.push(f.i/i),R(t),t=f.next,m=f.next;else if(t=f,t===m){_?1===_?(t=h(t,e,i),o(t,e,i,n,r,u,2)):2===_&&l(t,e,i,n,r,u):o(s(t),e,i,n,r,u,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(T(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(y(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&T(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function c(t,e,i,n){var r=t.prev,s=t,o=t.next;if(T(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,u=g(a,c,e,i,n),_=g(h,l,e,i,n),d=t.nextZ;d&&d.z<=_;){if(d!==t.prev&&d!==t.next&&y(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&t(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&y(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&T(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function h(t,e,i){var n=t;do{var r=n.prev,s=n.next.next;!b(r,s)&&C(r,n,n.next,s)&&S(r,s)&&S(s,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(s.i/i),R(n),R(n.next),n=t=s),n=n.next}while(n!==t);return n}function l(t,e,i,n,r,a){var c=t;do{for(var h=c.next.next;h!==c.prev;){if(c.i!==h.i&&x(c,h)){var l=w(c,h);return c=s(c,c.next),l=s(l,l.next),o(c,e,i,n,r,a),void o(l,e,i,n,r,a)}h=h.next}c=c.next}while(c!==t)}function u(t,e,i,n){var o,a,c,h,l,u=[];for(o=0,a=e.length;o<a;o++)c=e[o]*n,h=o<a-1?e[o+1]*n:t.length,l=r(t,c,h,n,!1),l===l.next&&(l.steiner=!0),u.push(v(l));for(u.sort(_),o=0;o<u.length;o++)d(u[o],i),i=s(i,i.next);return i}function="" _(t,e){return="" t.x-e.x}function="" d(t,e){if(e="f(t,e)){var" i="w(e,t);s(i,i.next)}}function" f(t,e){var="" i,n="e,r=t.x,s=t.y,o=-(1/0);do{if(s<=n.y&&s">=n.next.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o){if(o=a,a===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r="==o)return" i.prev;var="" c,h="i,l=i.x,u=i.y,_=1/0;for(n=i.next;n!==h;)r">=n.x&&n.x>=l&&y(s<u?r:o,s,l,u,s<u?o:r,s,n.x,n.y)&&(c=math.abs(s-n.y) (r-n.x),(c<_||c="==_&&n.x">i.x)&&S(n,t)&&(i=n,_=c)),n=n.next;return i}function p(t,e,i,n){var r=t;do null===r.z&&(r.z=g(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,i,n,r,s,o,a,c,h=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<h&&(a++,n=n.nextz,n);e++);for(c=h;a>0||c>0&&n;)0===a?(r=n,n=n.nextZ,c--):0!==c&&n?i.z<=n.z?(r=i,i=i.nextz,a--):(r=n,n=n.nextz,c--):(r=i,i=i.nextz,a--),s?s.nextz=r:t=r,r.prevz=s,s=r;i=n}s.nextz=null,h*=2}while(o>1);return t}function g(t,e,i,n,r){return t=32767*(t-i)/r,e=32767*(e-n)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function v(t){var="" e="t,i=t;do" e.x<i.x&&(i="e),e=e.next;while(e!==t);return" i}function="" y(t,e,i,n,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)="">=0&&(t-o)*(n-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!A(t,e)&&S(t,e)&&S(e,t)&&E(t,e)}function T(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function C(t,e,i,n){return!!(b(t,e)&&b(i,n)||b(t,n)&&b(i,e))||T(t,e,i)>0!=T(t,e,n)>0&&T(i,n,t)>0!=T(i,n,e)>0}function A(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&C(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function S(t,e){return T(t.prev,t,t.next)<0?t(t,e,t.next)>=0&&T(t,t.prev,e)>=0:T(t,e,t.prev)<0||t(t,t.next,e)<0}function e(t,e){var="" i="t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do" i.y="">s!=i.next.y>s&&r<(i.next.x-i.x)*(s-i.y) 0="==o&&0===u?0:Math.abs((u-o)/o)},n.flatten=function(t){for(var" (i.next.y-i.y)+i.x&&(n="!n),i=i.next;while(i!==t);return" n}function="" w(t,e){var="" i="new" p(t.i,t.x,t.y),n="new" p(e.i,e.x,e.y),r="t.next,s=e.prev;return" t.next="e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function" i(t,e,i,n){var="" r="new" p(t,e,i);return="" n?(r.next="n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function" r(t){t.next.prev="t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function" p(t,e,i){this.i="t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function" o(t,e,i,n){for(var="" r}e.exports="n,n.deviation=function(t,e,i,n){var" a="0,c=e.length;a<c;a++){var" h="e[a]*i,l=a<c-1?e[a+1]*i:t.length;o-=Math.abs(O(t,h,l,i))}var" u="0;for(a=0;a<n.length;a+=3){var" _="n[a]*i,d=n[a+1]*i,f=n[a+2]*i;u+=Math.abs((t[_]-t[f])*(t[d+1]-t[_+1])-(t[_]-t[d])*(t[f+1]-t[_+1]))}return" e="t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var" s="0;s<t[r].length;s++)for(var" o="0;o<e;o++)i.vertices.push(t[r][s][o]);r">0&&(n+=t[r-1].length,i.holes.push(n))}return i}}),{}],116:[(function(t,e,i){var n=(cc.js,t("./types").LineCap),r=t("./types").LineJoin,s=t("./helper"),o=function(t){this._rootCtor(t),this._needDraw=!0,this.cmds=[],this.style={strokeStyle:"black",fillStyle:"white",lineCap:"butt",lineJoin:"miter",miterLimit:10}},a=o.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);a.constructor=o,a._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,this._currentRegion.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height)},a.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext();n.setTransform(this._worldTransform,e,i),r.save(),r.scale(1,-1);var s=this.style;r.strokeStyle=s.strokeStyle,r.fillStyle=s.fillStyle,r.lineWidth=s.lineWidth,r.lineJoin=s.lineJoin,r.miterLimit=s.miterLimit;for(var o=!0,a=this.cmds,c=0,h=a.length;c<h;c++){var l="a[c],u=l[0],_=l[1];"moveTo"===u&&o?(r.beginPath(),o=!1):"fill"!==u&&"stroke"!==u&&"fillRect"!==u||(o=!0),"function"==typeof" r[u]?r[u].apply(r,_):r[u]="_}r.restore()},a.setStrokeColor=function(t){var" e="rgba(" +(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a="" 255+")";this.cmds.push(["strokestyle",e]),this.style.strokestyle="e},a.setFillColor=function(t){var" 255+")";this.cmds.push(["fillstyle",e]),this.style.fillstyle="e},a.setLineWidth=function(t){this.cmds.push(["lineWidth",t]),this.style.lineWidth=t},a.setLineCap=function(t){var" ;t="==n.BUTT?e="butt":t===n.ROUND?e="round":t===n.SQUARE&&(e="square"),this.cmds.push(["lineCap",e]),this.style.lineCap=e},a.setLineJoin=function(t){var" n="t("./graphics-canvas-cmd"),r=t("./graphics-webgl-cmd"),s=t("./types").LineCap,o=t("./types").LineJoin,a=(cc.js,_ccsg.Node.extend({ctor:function(){this._super(),this.strokeColor=cc.Color.BLACK,this.fillColor=cc.Color.WHITE},clear:function(t){this._renderCmd.clear(t)},_createRenderCmd:function(){return" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" n(this):new="" r(this)}})),c="a.prototype;c._strokeColor=null,c._fillColor=null,c._lineWidth=1,c._lineCap=s.BUTT,c._lineJoin=o.MITER,c._miterLimit=10,c.setStrokeColor=function(t){this._strokeColor=t,this._renderCmd.setStrokeColor(t)},c.getStrokeColor=function(){return" this._strokecolor},c.setfillcolor="function(t){this._fillColor=t,this._renderCmd.setFillColor(t)},c.getFillColor=function(){return" this._fillcolor},c.setlinewidth="function(t){this._lineWidth=t,this._renderCmd.setLineWidth(t)},c.getLineWidth=function(){return" this._linewidth},c.setlinecap="function(t){this._lineCap=t,this._renderCmd.setLineCap(t)},c.getLineCap=function(){return" this._linecap},c.setlinejoin="function(t){this._lineJoin=t,this._renderCmd.setLineJoin(t)},c.getLineJoin=function(){return" this._linejoin},c.setmiterlimit="function(t){this._miterLimit=t,this._renderCmd.setMiterLimit(t)},c.getMiterLimit=function(){return" this._miterlimit},c.beginpath="function(){this._renderCmd.beginPath()},c.moveTo=function(t,e){this._renderCmd.moveTo(t,e)},c.lineTo=function(t,e){this._renderCmd.lineTo(t,e)},c.bezierCurveTo=function(t,e,i,n,r,s){this._renderCmd.bezierCurveTo(t,e,i,n,r,s)},c.quadraticCurveTo=function(t,e,i,n){this._renderCmd.quadraticCurveTo(t,e,i,n)},c.arc=function(t,e,i,n,r,s){this._renderCmd.arc(t,e,i,n,r,s)},c.ellipse=function(t,e,i,n){this._renderCmd.ellipse(t,e,i,n)},c.circle=function(t,e,i){this._renderCmd.circle(t,e,i)},c.rect=function(t,e,i,n){this._renderCmd.rect(t,e,i,n)},c.roundRect=function(t,e,i,n,r){this._renderCmd.roundRect(t,e,i,n,r)},c.fillRect=function(t,e,i,n){this._renderCmd.fillRect(t,e,i,n)},c.close=function(){this._renderCmd.close()},c.stroke=function(){this._renderCmd.stroke()},c.fill=function(){this._renderCmd.fill()},e.exports=a}),{"./graphics-canvas-cmd":116,"./graphics-webgl-cmd":118,"./types":123}],118:[(function(t,e,i){function" n(t,e,i){return="" t<e?e:t="">i?i:t}function r(t,e){_.call(this,t,e),this.reset()}function s(){this.reset()}function o(t){this._rootCtor(t),this._needDraw=!0;var e=cc._renderContext;this._vertsOffset=0,this._vertsVBO=e.createBuffer(),this._vertsBuffer=null,this._vertsDirty=!1,this._indicesOffset=0,this._indicesVBO=e.createBuffer(),this._indicesBuffer=null,this._indicesDirty=!1,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._paths=[],this._points=[],this._cmds=[],this._blendFunc=new cc.BlendFunc(cc.macro.BLEND_SRC,cc.macro.BLEND_DST),this._shader=new cc.GLProgram,this._shader.initWithVertexShaderByteArray(a.vert,a.frag),this._shader.retain(),this._shader.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._shader.link(),this._shader.updateUniforms(),this._allocVerts(f)}var a=t("./shader"),c=t("./types").LineCap,h=t("./types").LineJoin,l=t("./earcut"),u=t("./helper"),_=cc.Vec2,d=cc.js,f=32,p=2,m=8,g=Math.PI,v=Math.min,y=Math.max,x=Math.ceil,T=Math.acos,b=Math.cos,C=Math.sin,A=Math.atan2,S=Math.abs,E=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});d.extend(r,_),r.prototype.reset=function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0},s.prototype.reset=function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},o.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype),o.prototype.constructor=o;var w=o.prototype;w._tessTol=.25,w._distTol=.01,w.lineWidth=1,w.lineCap=c.BUTT,w.lineJoin=h.MITER,w.miterLimit=10,w.beginPath=function(){this._pathOffset=this._pathLength},w.moveTo=function(t,e){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(t,e,E.PT_CORNER),this._commandx=t,this._commandy=e},w.lineTo=function(t,e){this._addPoint(t,e,E.PT_CORNER),this._commandx=t,this._commandy=e},w.bezierCurveTo=function(t,e,i,n,r,s){var o=this._curPath,a=o.points[o.points.length-1];return a.x===t&&a.y===e&&i===r&&n===s?void this.lineTo(r,s):(this._tesselateBezier(a.x,a.y,t,e,i,n,r,s,0,E.PT_CORNER),this._commandx=r,void(this._commandy=s))},w.quadraticCurveTo=function(t,e,i,n){var r=this._commandx,s=this._commandy;this.bezierCurveTo(r+2/3*(t-r),s+2/3*(e-s),i+2/3*(t-i),n+2/3*(e-n),i,n)},w.arc=function(t,e,i,n,r,s){u.arc(this,t,e,i,n,r,s)},w.ellipse=function(t,e,i,n){u.ellipse(this,t,e,i,n),this._curPath.complex=!1},w.circle=function(t,e,i){u.ellipse(this,t,e,i,i),this._curPath.complex=!1},w.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.close(),this._curPath.complex=!1},w.roundRect=function(t,e,i,n,r){u.roundRect(this,t,e,i,n,r),this._curPath.complex=!1},w.fillRect=function(t,e,i,n){this.rect(t,e,i,n),this.fill()},w.close=function(){this._curPath.closed=!0},w.stroke=function(){this._flattenPaths(),this._expandStroke(),this._vertsDirty=!0,this._updatePathOffset=!0},w.fill=function(){this._expandFill(),this._vertsDirty=!0,this._updatePathOffset=!0,this._filling=!1},w._strokeColor=null,w._fillColor=null,w.setStrokeColor=function(t){this._strokeColor=t},w.getStrokeColor=function(){return this._strokeColor},w.setFillColor=function(t){this._fillColor=t},w.getFillColor=function(){return this._fillColor},w.setLineWidth=function(t){this.lineWidth=t},w.setLineJoin=function(t){this.lineJoin=t},w.setLineCap=function(t){this.lineCap=t},w.setMiterLimit=function(t){this.miterLimit=t},d.getset(w,"strokeColor",w.getStrokeColor,w.setStrokeColor),d.getset(w,"fillColor",w.getFillColor,w.setFillColor),w._render=function(){var t=this._vertsBuffer;if(t&&0!==t.length&&0!==this._cmds.length){var e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._vertsVBO),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indicesVBO),this._vertsDirty&&(e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW),this._vertsDirty=!1),this._indicesDirty&&this._indicesBuffer&&(e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indicesBuffer,e.STREAM_DRAW),this._indicesDirty=!1),this._vertsOffset>65536&&cc.warnID(2401),e.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),e.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,m,0);for(var i=this._shader,n=i.getUniformLocationForName("color"),r=this._cmds,s=0,o=r.length;s<o;s++){var a="r[s];if(a.nIndices){var" c="a.color;e.uniform4f(n,c.r/255,c.g/255,c.b/255,c.a/255),e.drawElements(e.TRIANGLES,a.nIndices,e.UNSIGNED_SHORT,2*a.indicesOffset),cc.incrementGLDraws(a.nverts)}}cc.checkGLErrorDebug()}},w.rendering=function(){cc.gl.blendFunc(this._blendFunc.src,this._blendFunc.dst);" var="" t="this._worldTransform,e=this._matrix.mat;e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty;var" i="this._shader;i.use(),i._setUniformForMVPMatrixWithMat4(this._matrix),this._render()},w.clear=function(t){this._vertsOffset=0,this._indicesOffset=0,this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,this._cmds.length=0,t&&(this._paths.length=0,this._points.length=0,this._vertsBuffer=null,this._indicesBuffer=null)},w._updatePathOffset=!1,w._paths=null,w._pathLength=0,w._pathOffset=0,w._points=null,w._pointsOffset=0,w._commandx=0,w._commandy=0,w._addPath=function(){var" e?e.reset():(e="new" s,this._paths.push(e)),this._pathlength++,this._curpath="e,e},w._addPoint=function(t,e,i){var" n="this._curPath;if(n){var" s,o="this._points,a=n.points,c=this._pointsOffset++;s=o[c],s?(s.x=t,s.y=e):(s=new" r(t,e),o.push(s)),s.flags="i,a.push(s)}},w._flattenPaths=function(){for(var" h="o.sub(s);s.len=h.mag(),(h.x||h.y)&&h.normalizeSelf(),s.dx=h.x,s.dy=h.y,s=o,o=r[a+1]}}},w._allocVerts=function(t){var" e="this._vertsOffset+t,i=this._vertsBuffer,n=i?i.length/p:0;if(e">n){for(0===n&&(n=f);e>n;)n*=2;var r=new Float32Array(n*p);if(i)for(var s=0,o=i.length;s<o;s++)r[s]=i[s];this._vertsbuffer=r}},w._allocindices=function(t){var e="this._indicesBuffer,i=this._indicesOffset+t,n=e?e.length:0;if(i">n){for(0===n&&(n=3*f);i>n;)n*=2;var r=new Uint16Array(n);if(e)for(var s=0,o=e.length;s<o;s++)r[s]=e[s];this._indicesbuffer=r}},w._pushcmd=function(t){var e="this._cmds,i=e[e.length-1];if(i){var" n="i.color,r=t.color;n.r===r.r&&n.g===r.g&&n.b===r.b&&n.a===r.a&&i.indicesOffset+i.nIndices===t.indicesOffset?(i.nIndices+=t.nIndices,i.nverts+=t.nverts):e.push(t)}else" e.push(t)},w._expandstroke="function(){var" t=".5*this.lineWidth,e=this.lineCap,i=this.lineJoin,n=this.miterLimit,r=this._curveDivs(t,g,this._tessTol),s=this._paths;this._calculateJoins(t,i,n);for(var" o="0,a=this._pathOffset,l=this._pathLength;a<l;a++){var" u="s[a],_=u.points.length;o+=i===h.ROUND?2*(_+u.nbevel*(r+2)+1):2*(_+5*u.nbevel+1),u.closed||(o+=e===c.ROUND?2*(2*r+2):12)}this._allocVerts(o),this._allocIndices(3*(o-2*(this._pathLength-this._pathOffset)));for(var" a="this._pathOffset,l=this._pathLength;a<l;a++){var" d,f,p,m,v,u="s[a],y=u.points,_=u.points.length;v=u.closed;var" x="this._vertsOffset;if(v?(d=y[_-1],f=y[0],p=0,m=_):(d=y[0],f=y[1],p=1,m=_-1),!v){var" b="T.x,C=T.y;e===c.BUTT?this._buttCap(d,b,C,t,0):e===c.SQUARE?this._buttCap(d,b,C,t,t):e===c.ROUND&&this._roundCapStart(d,b,C,t,r)}for(var" s="this._vget(x),w=this._vget(x+1);this._vset(S.x,S.y),this._vset(w.x,w.y)}else{var" i="this._indicesOffset,R=this._indicesBuffer,P=x+2,O=this._vertsOffset;P<O;P++)R[I++]=P-2,R[I++]=P-1,R[I++]=P;this._pushCmd({color:this._strokeColor,indicesOffset:this._indicesOffset,nIndices:I-this._indicesOffset,vertsOffset:x,nverts:this._vertsOffset-x}),this._indicesOffset=I,this._indicesDirty=!0}},w._expandFill=function(){for(var" r="t[i],s=r.points.length;e+=s}this._allocVerts(e),this._allocIndices(3*(e-2*(this._pathLength-this._pathOffset)));for(var" h="r.indicesOffset=this._indicesOffset,u=this._indicesBuffer,_=0;if(r.complex){var" d="new" float32array(this._vertsbuffer.buffer,8*a,2*(this._vertsoffset-a)),f="l(d,null,2);if(!f||0===f.length)continue;_=f.length;for(var" c="0,p=_;c<p;c++)u[h+c]=f[c]+a}else{for(var" m="a,g=a+2,v=this._vertsOffset;g<v;g++)u[h++]=m,u[h++]=g-1,u[h++]=g;_=h-this._indicesOffset}this._pushCmd({color:this._fillColor,indicesOffset:this._indicesOffset,nIndices:_,vertsOffset:a,nverts:this._vertsOffset-a}),this._indicesOffset+=_,this._indicesDirty=!0}}},w._curveDivs=function(t,e,i){var" y(2,x(e="" n))},w._calculatejoins="function(t,e,i){var">0&&(n=1/t);for(var r=this._paths,s=this._pathOffset,o=this._pathLength;s<o;s++){var a="r[s],c=a.points,l=c.length,u=c[l-1],_=c[0],d=0;a.nbevel=0;for(var" f="0;f<l;f++){var" p,m,g,x="u.dy,T=-u.dx,b=_.dy,C=-_.dx;if(_.dmx=.5*(x+b),_.dmy=.5*(T+C),p=_.dmx*_.dmx+_.dmy*_.dmy,p">1e-6){var A=1/p;A>600&&(A=600),_.dmx*=A,_.dmy*=A}m=_.dx*u.dy-u.dx*_.dy,m>0&&(d++,_.flags|=E.PT_LEFT),g=y(11,v(u.len,_.len)*n),p*g*g<1&&(_.flags|=e.pt_innerbevel),_.flags&e.pt_corner&&(p*i*i<1||e===h.bevel||e===h.round)&&(_.flags|=e.pt_bevel),0!==(_.flags&(e.pt_bevel|e.pt_innerbevel))&&a.nbevel++,u=_,_=c[f+1]}}},w._vset=function(t,e){var i="this._vertsOffset*p,n=this._vertsBuffer;n[i]=t,n[i+1]=e,this._vertsOffset++},w._vget=function(t){var" e="this._vertsBuffer,i=t*p;return{x:e[i],y:e[i+1]}},w._chooseBevel=function(t,e,i,n){var" r,s,o,a,c="i.x,h=i.y;return" 0!="=t?(r=c+e.dy*n,s=h-e.dx*n,o=c+i.dy*n,a=h-i.dx*n):(r=o=c+i.dmx*n,s=a=h+i.dmy*n),[r,s,o,a]},w._buttCap=function(t,e,i,n,r){var" s="t.x-e*r,o=t.y-i*r,a=i,c=-e;this._vset(s+a*n,o+c*n),this._vset(s-a*n,o-c*n)},w._roundCapStart=function(t,e,i,n,r){for(var" l="h/(r-1)*g,u=b(l)*n,_=C(l)*n;this._vset(s-a*u-e*_,o-c*u-i*_),this._vset(s,o)}this._vset(s+a*n,o+c*n),this._vset(s-a*n,o-c*n)},w._roundCapEnd=function(t,e,i,n,r){var" h="0;h<r;h++){var" o="t.dy,a=-t.dx,c=e.dy,h=-e.dx,l=e.x,u=e.y;if(0!==(e.flags&E.PT_LEFT)){var" _="this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,i),d=_[0],f=_[1],p=_[2],m=_[3],v=A(-a,-o),y=A(-h,-c);y">v&&(y-=2*g),this._vset(d,f),this._vset(l-o*r,e.y-a*r);for(var T=n(x((v-y)/g)*s,2,s),S=0;S<t;s++){var w="S/(T-1),I=v+w*(y-v),R=l+b(I)*r,P=u+C(I)*r;this._vset(l,u),this._vset(R,P)}this._vset(p,m),this._vset(l-c*r,u-h*r)}else{var" _="this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,-r),O=_[0],B=_[1],D=_[2],M=_[3],v=A(a,o),y=A(h,c);y<v&&(y+=2*g),this._vset(l+o*r,u+a*r),this._vset(O,B);for(var" t="n(x((y-v)/g)*s,2,s),S=0;S<T;S++){var" r,s,o,a,c,h,l,u,_="t.dy,d=-t.dx,f=e.dy,p=-e.dx;if(e.flags&E.PT_LEFT){var" m="this._chooseBevel(e.flags&E.PT_INNERBEVEL,t,e,i);c=m[0],h=m[1],l=m[2],u=m[3],this._vset(c,h),this._vset(e.x-_*n,e.y-d*n),this._vset(l,u),this._vset(e.x-f*n,e.y-p*n)}else{var" l,u,_,d,f,p,m,g,v,y,x,t,b,c,a,w;if(!(c="">10)){if(l=.5*(t+i),u=.5*(e+n),_=.5*(i+r),d=.5*(n+s),f=.5*(r+o),p=.5*(s+a),m=.5*(l+_),g=.5*(u+d),b=o-t,C=a-e,A=S((i-o)*C-(n-a)*b),w=S((r-o)*C-(s-a)*b),(A+w)*(A+w)<this._tesstol*(b*b+c*c))return void="" this._addpoint(o,a,0="==h?h|E.PT_BEVEL:h);v=.5*(_+f),y=.5*(d+p),x=.5*(m+v),T=.5*(g+y),this._tesselateBezier(t,e,l,u,m,g,x,T,c+1,0),this._tesselateBezier(x,T,v,y,f,p,o,a,c+1,h)}},e.exports=o}),{"./earcut":115,"./helper":120,"./shader":122,"./types":123}],119:[(function(t,e,i){var" n="t("./types").LineCap,r=t("./types").LineJoin,s=cc.Class({name:"cc.Graphics",extends:cc._RendererUnderSG,editor:!1,properties:{_lineWidth:1,_strokeColor:cc.Color.BLACK,_lineJoin:r.MITER,_lineCap:n.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return" this._linewidth},set:function(t){this._sgnode.linewidth="this._lineWidth=t}},lineJoin:{get:function(){return" this._linejoin},set:function(t){this._sgnode.linejoin="this._lineJoin=t},type:r},lineCap:{get:function(){return" this._linecap},set:function(t){this._sgnode.linecap="this._lineCap=t},type:n},strokeColor:{get:function(){return" this._strokecolor},set:function(t){this._sgnode.strokecolor="this._strokeColor=t}},fillColor:{get:function(){return" this._fillcolor},set:function(t){this._sgnode.fillcolor="this._fillColor=t}},miterLimit:{get:function(){return" this._miterlimit},set:function(t){this._sgnode.miterlimit="this._miterLimit=t}}},statics:{LineJoin:r,LineCap:n},_createSgNode:function(){return" new="" _ccsg.graphicsnode},_initsgnode:function(){var="" t="this._sgNode;t.lineWidth=this._lineWidth,t.lineJoin=this._lineJoin,t.lineCap=this._lineCap,t.strokeColor=this._strokeColor,t.fillColor=this._fillColor,t.miterLimit=this._miterLimit,t.setContentSize(this.node.getContentSize(!0))},moveTo:function(t,e){this._sgNode.moveTo(t,e)},lineTo:function(t,e){this._sgNode.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,r,s){this._sgNode.bezierCurveTo(t,e,i,n,r,s)},quadraticCurveTo:function(t,e,i,n){this._sgNode.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,r,s){s=s||!1,this._sgNode.arc(t,e,i,n,r,s)},ellipse:function(t,e,i,n){this._sgNode.ellipse(t,e,i,n)},circle:function(t,e,i){this._sgNode.circle(t,e,i)},rect:function(t,e,i,n){this._sgNode.rect(t,e,i,n)},roundRect:function(t,e,i,n,r){this._sgNode.roundRect(t,e,i,n,r)},fillRect:function(t,e,i,n){this._sgNode.fillRect(t,e,i,n)},clear:function(){this._sgNode.clear()},close:function(){this._sgNode.close()},stroke:function(){this._sgNode.stroke()},fill:function(){this._sgNode.fill()}});cc.Graphics=e.exports=s}),{"./types":123}],120:[(function(t,e,i){function" n(t,e,i,n,r,s,_){_="_||!1;var" d,f,p="0,m=0,g=0,v=0,y=0,x=0,T=0,b=0,C=0,A=0,S=0,E=0,w=0,I=0;if(m=s-r,_)if(u(m)">=2*o)m=2*o;else for(;m<0;)m+=2*o;else if(u(m)="">=2*o)m=2*-o;else for(;m>0;)m-=2*o;for(f=0|c(1,a(u(m)/(.5*o)+.5,5)),g=m/f/2,v=u(4/3*(1-h(g))/l(g)),_||(v=-v),d=0;d<=f;d++)p=r+m*(d f),y="h(p),x=l(p),T=e+y*n,b=i+x*n,C=-x*n*v,A=y*n*v,0===d?t.moveTo(T,b):t.bezierCurveTo(S+w,E+I,T-C,b-A,T,b),S=T,E=b,w=C,I=A}function" r(t,e,i,n,r){t.moveto(e-n,i),t.beziercurveto(e-n,i+r*d,e-n*d,i+r,e,i+r),t.beziercurveto(e+n*d,i+r,e+n,i+r*d,e+n,i),t.beziercurveto(e+n,i-r*d,e+n*d,i-r,e,i-r),t.beziercurveto(e-n*d,i-r,e-n,i-r*d,e-n,i),t.close()}function="" s(t,e,i,n,r,s){if(s<.1)return="" void="" t.rect(e,i,n,r);var="" o="a(s,.5*u(n))*_(n),c=a(s,.5*u(r))*_(r);t.moveTo(e,i+c),t.lineTo(e,i+r-c),t.bezierCurveTo(e,i+r-c*(1-d),e+o*(1-d),i+r,e+o,i+r),t.lineTo(e+n-o,i+r),t.bezierCurveTo(e+n-o*(1-d),i+r,e+n,i+r-c*(1-d),e+n,i+r-c),t.lineTo(e+n,i+c),t.bezierCurveTo(e+n,i+c*(1-d),e+n-o*(1-d),i,e+n-o,i),t.lineTo(e+o,i),t.bezierCurveTo(e+o*(1-d),i,e,i+c*(1-d),e,i+c),t.close()}var" strict";var="" n;if(n="cc.sys.isNative?_ccsg.GraphicsNode=cc.GraphicsNode:_ccsg.GraphicsNode=t("./graphics-node")){var" r="t("../utils/misc");r.propertyDefine(n,["lineWidth","lineCap","lineJoin","miterLimit","strokeColor","fillColor"],{})}t("./graphics")}),{"../utils/misc":223,"./graphics":119,"./graphics-node":117}],122:[(function(t,e,i){var" n="["attribute" vec4="" a_position;","","void="" main()","{","gl_position="(CC_PMatrix" *="" cc_mvmatrix)="" a_position;","}"],r="["#ifdef" gl_es","precision="" mediump="" float;","#endif","","uniform="" color;","","void="" main(void)="" {","gl_fragcolor="color;","}"];e.exports={vert:n.join("" \n"),frag:r.join("="" \n")}}),{}],123:[(function(t,e,i){"use="">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])},cc.HtmlTextParser.prototype={constructor:cc.HtmlTextParser,parse:function(t){this._resultObjectArray=[],this._stack=[];for(var e=0,i=t.length;e<i;){var n="t.indexOf("<",e);if(n<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{this._processResult(t.substring(e,n));var" r="t.indexOf("">",e);r===-1?r=n:"/"===t.charAt(n+1)?this._stack.pop():this._addToStack(t.substring(n+1,r)),e=r+1}}return this._resultObjectArray},_attributeToObject:function(t){t=t.trim();var e,i,r,s,o={},a=t.match(/^(color|size)(\s)*=/);if(a){if(e=a[0],t=t.substring(e.length).trim(),""===t)return o;switch(i=t.indexOf(" "),e[0]){case"c":i>-1?o.color=t.substring(0,i).trim():o.color=t;break;case"s":o.size=parseInt(t)}return i>-1&&(s=t.substring(i+1).trim(),r=this._processEventHandler(s),o.event=r),o}if(a=t.match(/^(br(\s)*\/)/),a&&a[0].length>0&&(e=a[0].trim(),e.startsWith("br")&&"/"===e[e.length-1]))return o.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),o;if(a=t.match(/^(img(\s)*src(\s)*=[^>]+\/)/),a&&a[0].length>0&&(e=a[0].trim(),e.startsWith("img")&&"/"===e[e.length-1])){var c,h=e.indexOf("="),l=e.substring(h+1).trim(),u=-1,_=!1;switch(l[0]){case"'":u=l.indexOf("'",1),u>-1&&(c=l.substring(1,u),_=!0);break;case'"':u=l.indexOf('"',1),u>-1&&(c=l.substring(1,u),_=!0)}return _&&(o.isImage=!0,o.src=c,s=l.substring(u+1).trim(),s.match(n)&&(r=this._processEventHandler(s),o.event=r),this._resultObjectArray.push({text:"",style:o})),{}}if(a=t.match(/^(outline(\s)*[^>]*)/)){t=a[0].substring("outline".length).trim();var d={color:"#ffffff",width:1};if(t){var f=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=/;a=t.match(f);for(var p;a;)t=t.substring(t.indexOf(a[0])),e=t.substr(0,a[0].length),l=t.substring(e.length).trim(),i=l.indexOf(" "),p=i>-1?l.substr(0,i):l,e=e.replace(/[^a-zA-Z]/g,"").trim(),e=e.toLocaleLowerCase(),t=l.substring(i).trim(),"click"===e?o.event=this._processEventHandler(e+"="+p):"color"===e?d.color=p:"width"===e&&(d.width=parseInt(p)),a=t.match(f)}o.outline=d}if(a=t.match(/^(on|u|b|i)(\s)*/),a&&a[0].length>0){switch(e=a[0],t=t.substring(e.length).trim(),e[0]){case"u":o.underline=!0;break;case"i":o.italic=!0;break;case"b":o.bold=!0}if(""===t)return o;r=this._processEventHandler(t),o.event=r}return o},_processEventHandler:function(t){for(var e=0,i={},r=t.match(n),s=!1;r;){var o=r[0],a="";if(s=!1,t=t.substring(o.length).trim(),'"'===t.charAt(0))e=t.indexOf('"',1),e>-1&&(a=t.substring(1,e).trim(),s=!0),e++;else if("'"===t.charAt(0))e=t.indexOf("'",1),e>-1&&(a=t.substring(1,e).trim(),s=!0),e++;else{var c=t.match(/(\S)+/);a=c?c[0]:"",e=a.length}s&&(o=o.substring(0,o.length-1).trim(),i[o]=a),t=t.substring(e).trim(),r=t.match(n)}return i},_addToStack:function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},_processResult:function(t){""!==t&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},_escapeSpecialSymbol:function(t){for(var e=0;e<this._specialsymbolarray.length;++e){var i="this._specialSymbolArray[e][0],n=this._specialSymbolArray[e][1];t=t.replace(i,n)}return" t}},cc.htmltextparser="new" cc.htmltextparser}),{}],126:[(function(t,e,i){t(".="" cctextutils.js");var="" n="t("../event/event-target"),r={INFO_EXP:/info" [^\n]*(\n|$)="" gi,common_exp:="" common="" gi,page_exp:="" page="" gi,char_exp:="" char="" gi,kerning_exp:="" kerning="" gi,item_exp:="" \w+="[^" \r\n]+="" gi,int_exp:="" ^[\-]?\d+$="" ,_parsestrtoobj:function(t){var="" e="t.match(this.ITEM_EXP),i={};if(e)for(var" s="e[n],o=s.indexOf("="),a=s.substring(0,o),c=s.substring(o+1);c.match(this.INT_EXP)?c=parseInt(c):'"'===c[0]&&(c=c.substring(1,c.length-1)),i[a]=c}return" i},parsefnt:function(t){var="" i;var="" r="e._parseStrToObj(n[0]),s=r.padding.split(","),o=({left:parseInt(s[0]),top:parseInt(s[1]),right:parseInt(s[2]),bottom:parseInt(s[3])},e._parseStrToObj(t.match(e.COMMON_EXP)[0]));if(i.commonHeight=o.lineHeight,i.fontSize=r.size,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var" a="cc.configuration.getMaxTextureSize();(o.scaleW">a.width||o.scaleH>a.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==o.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var c=e._parseStrToObj(t.match(e.PAGE_EXP)[0]);0!==c.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),i.atlasName=c.file;for(var h=t.match(e.CHAR_EXP),l=i.fontDefDictionary={},u=0,_=h.length;u<_;u++){var 0="==e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e)},getBlendFunc:function(){return" d="e._parseStrToObj(h[u]),f=d.id;l[f]={rect:{x:d.x,y:d.y,width:d.width,height:d.height},xOffset:d.xoffset,yOffset:d.yoffset,xAdvance:d.xadvance}}var" p="i.kerningDict={},m=t.match(e.KERNING_EXP);if(m)for(u=0,_=m.length;u<_;u++){var" g="e._parseStrToObj(m[u]);p[g.first<<16|65535&g.second]=g.amount}return" i}},s="function(){this._u=0,this._v=0,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._textureID=0,this._validDefinition=!1,this._xAdvance=0};cc.FontAtlas=function(t){this._lineHeight=t.commonHeight,this._fontSize=t.fontSize,this._letterDefinitions={},this._fntConfig=t},cc.FontAtlas.prototype={constructor:cc.FontAtlas,setFontSize:function(t){this._fontSize=t},getOriginalFontSize:function(){return" this._fntconfig.fontsize},addletterdefinitions:function(t,e){this._letterdefinitions[t]="e},cloneLetterDefinition:function(){var" t="{};for(var" e="" in="" this._letterdefinitions){var="" i="new" s;cc.js.mixin(i,this._letterdefinitions[e]),t[e]="i}return" t},assignletterdefinitions:function(t){for(var="" e,i="this._letterDefinitions.hasOwnProperty(t.charCodeAt(0));return" o="function(){this._char="",this._valid=!0,this._positionX=0,this._positionY=0,this._atlasIndex=0,this._lineIndex=0};_ccsg.Label=_ccsg.Node.extend({_hAlign:cc.TextAlignment.LEFT,_vAlign:cc.VerticalTextAlignment.TOP,_string:"",_fontSize:40,_drawFontsize:40,_overFlow:0,_isWrapText:!0,_spacingX:0,_blendFunc:null,_labelType:0,_fontHandle:"",_lineSpacing:0,_maxLineWidth:0,_labelDimensions:cc.size(0,0),_labelWidth:0,_labelHeight:0,_lineHeight:40,_outlined:!1,_outlineColor:null,_outlineWidth:1,_gradientEnabled:!1,_gradientStartColor:cc.color(255,255,255,255),_gradientEndColor:cc.color(255,255,255,255),_gradientDirection:0,_className:"Label",_margin:0,_isBold:!1,_isItalic:!1,_isUnderline:!1,_fontAsset:null,ctor:function(t,e,i,r){n.call(this),e=e||"",this._fontHandle=e,"string"!=typeof" t&&(t="" +t),this._string="t,_ccsg.Node.prototype.ctor.call(this),this.setAnchorPoint(cc.p(.5,.5)),_ccsg.Node.prototype.setContentSize.call(this,cc.size(128,128)),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this.setFontFileOrFamily(e,i,r),this.setString(this._string)},_resetBMFont:function(){this._imageOffset=cc.p(0,0),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._fontAtlas=null,this._config=null,this._numberOfLines=0,this._lettersInfo=[],this._linesWidth=[],this._linesOffsetX=[],this._textDesiredHeight=0,this._letterOffsetY=0,this._tailoredTopY=0,this._tailoredBottomY=0,this._bmfontScale=1,this._horizontalKernings=[],this._lineBreakWithoutSpaces=!1,this._reusedRect=cc.rect(0,0,0,0),this._textureLoaded=!1,this._spriteBatchNode&&(this.removeChild(this._spriteBatchNode),this._spriteBatchNode=null)},setHorizontalAlign:function(t){this._hAlign!==t&&(this._hAlign=t,this._notifyLabelSkinDirty())},getHorizontalAlign:function(){return" this._halign},setverticalalign:function(t){this._valign!="=t&&(this._vAlign=t,this._notifyLabelSkinDirty())},getVerticalAlign:function(){return" this._valign},setstring:function(t){"string"!="typeof" +t),this._string!="=t&&(this._string=t,this._notifyLabelSkinDirty())},setMargin:function(t){this._margin!==t&&(this._margin=t,this._notifyLabelSkinDirty())},getString:function(){return" this._string},getstringlength:function(){return="" this._string.length},enablewraptext:function(t){this._iswraptext!="=t&&this._overFlow!==_ccsg.Label.Overflow.RESIZE_HEIGHT&&this._overFlow!==_ccsg.Label.Overflow.NONE&&(this._isWrapText=t,this._rescaleWithOriginalFontSize(),this._notifyLabelSkinDirty())},enableItalics:function(t){this._isItalic=t,t?this.setSkewX(12):this.setSkewX(0)},enableBold:function(t){this._isBold!==t&&(this._isBold=t,this._notifyLabelSkinDirty())},enableUnderline:function(t){this._isUnderline!==t&&(this._isUnderline=t,this._notifyLabelSkinDirty())},isWrapTextEnabled:function(){return" this._iswraptext},getfontname:function(){return="" this._fonthandle},setfontsize:function(t){this._fontsize!="=t&&(this._fontSize=t,this._drawFontsize=t,this._notifyLabelSkinDirty())},getFontSize:function(){return" this._fontsize},isoutlined:function(){return="" this._outlined},setoutlined:function(t){this._outlined!="=t&&(this._outlined=!!t,this._notifyLabelSkinDirty())},setFillColorGradientEnabled:function(t){this._gradientEnabled!==t&&(this._gradientEnabled=!!t,this._notifyLabelSkinDirty())},getFillColorGradientEnabled:function(){return" this._gradientenabled},setgradientstartcolor:function(t){this._gradientstartcolor!="=t&&(this._gradientStartColor=t,this._notifyLabelSkinDirty())},getGradientStartColor:function(){return" this._gradientstartcolor},setgradientendcolor:function(t){this._gradientendcolor!="=t&&(this._gradientEndColor=t,this._notifyLabelSkinDirty())},getGradientEndColor:function(){return" this._gradientendcolor},setfillcolorgradientdirection:function(t){this._gradientdirection="t,this._notifyLabelSkinDirty()},getFillColorGradientDirection:function(){return" this._gradientdirection},getoutlinecolor:function(){return="" this._outlinecolor},setoutlinecolor:function(t){this._outlinecolor!="=t&&(this._outlineColor=cc.color(t),this._notifyLabelSkinDirty())},setOutlineWidth:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,this._notifyLabelSkinDirty())},getOutlineWidth:function(){return" this._outlinewidth},_updatewraptext:function(t){t="==_ccsg.Label.Overflow.RESIZE_HEIGHT&&(this._isWrapText=!0),t===_ccsg.Label.Overflow.NONE&&(this._isWrapText=!1)},_setOverflowBMFont:function(){this._labelType===_ccsg.Label.Type.BMFont&&(this._overFlow===_ccsg.Label.Overflow.RESIZE_HEIGHT&&this._setDimensions(this._labelDimensions.width,0),this._overFlow===_ccsg.Label.Overflow.NONE&&this._setDimensions(0,0),this._rescaleWithOriginalFontSize())},setOverflow:function(t){this._overFlow!==t&&(this._overFlow=t,this._updateWrapText(this._overFlow),this._setOverflowBMFont(),this._notifyLabelSkinDirty())},getOverflow:function(){return" this._overflow},setspacingx:function(t){this._spacingx!="=t&&(this._spacingX=t,this._notifyLabelSkinDirty())},setLineHeight:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._notifyLabelSkinDirty())},setLineBreakWithoutSpace:function(t){this._lineBreakWithoutSpaces!==t&&(this._lineBreakWithoutSpaces=t,this._notifyLabelSkinDirty())},getSpacingX:function(){return" this._spacingx},getlineheight:function(){return="" this._lineheight},getbmfontlineheight:function(){if(this._fontatlas)return="" this._fontatlas._lineheight},setfontfileorfamily:function(t,e,i){t="t||"Arial",this._fontAsset=i;var" n="cc.path.extname(t);return" this._resetbmfont(),n||e?(".ttf"="==n?(this._labelType=_ccsg.Label.Type.TTF,this._blendFunc=cc.BlendFunc._alphaPremultiplied(),this._renderCmd._needDraw=!0,this._fontHandle=this._loadTTFFont(t)):e&&(this._labelType=_ccsg.Label.Type.BMFont,this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this._renderCmd._needDraw=!1,this._initBMFontWithString(this._string,t,e)),void" this._notifylabelskindirty()):(this._fonthandle="t,this._labelType=_ccsg.Label.Type.SystemFont,this._blendFunc=cc.BlendFunc._alphaPremultiplied(),this._renderCmd._needDraw=!0,this._notifyLabelSkinDirty(),void" this.emit("load"))},_loadttffont:function(t){var="" cc.customfontloader.loadttf(t,n),i},setcontentsize:function(t,e){this._overflow!="=_ccsg.Label.Overflow.NONE&&this._setDimensions(t,e)},setBlendFunc:function(t,e){var" new="" cc.blendfunc(this._blendfunc.src,this._blendfunc.dst)},_setupbmfontoverflowmetrics:function(t,e){this._overflow="==_ccsg.Label.Overflow.RESIZE_HEIGHT&&(e=0),this._overFlow===_ccsg.Label.Overflow.NONE&&(t=0,e=0),this._labelWidth=t,this._labelHeight=e,this._labelDimensions.width=t,this._labelDimensions.height=e,this._maxLineWidth=t},_updateLabel:function(){if(this._labelType===_ccsg.Label.Type.BMFont){var" this._labeltype!="=_ccsg.Label.Type.TTF&&this._labelType!==_ccsg.Label.Type.SystemFont||this._renderCmd._bakeLabel()},_notifyLabelSkinDirty:function(){this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.textDirty|_ccsg.Node._dirtyFlags.contentDirty)},_createRenderCmd:function(){return" cc._rendertype="==cc.game.RENDER_TYPE_WEBGL?new" _ccsg.label.webglrendercmd(this):new="" _ccsg.label.canvasrendercmd(this)},getcontentsize:function(){var="" t&_ccsg.node._dirtyflags.textdirty&&(this._updatelabel(),this._rendercmd._dirtyflag&="~_ccsg.Node._dirtyFlags.textDirty),_ccsg.Node.prototype.getContentSize.call(this)},_getWidth:function(){var">0&&this._isVerticalClamp()&&this._shrinkLabelToContentSize(this._isVerticalClamp.bind(this))}if(!this._updateQuads()){t=!1,this._overFlow===_ccsg.Label.Overflow.SHRINK&&this._shrinkLabelToContentSize(this._isHorizontalClamp.bind(this));break}}while(0);return t},_isHorizontalClamped:function(t,e){var i=this._linesWidth[e],n=t>this._contentSize.width||t<0;return this._iswraptext?i="">this._contentSize.width&&n:n},_updateQuads:function(){var t=!0;this._spriteBatchNode.removeAllChildren();for(var e=0;e<this._string.length;++e)if(this._lettersinfo[e]._valid){var i="this._fontAtlas._letterDefinitions[this._lettersInfo[e]._char];this._reusedRect.height=i._height,this._reusedRect.width=i._width,this._reusedRect.x=i._u,this._reusedRect.y=i._v;var" n="this._lettersInfo[e]._positionY+this._letterOffsetY;if(this._labelHeight">0){if(n>this._tailoredTopY){var r=n-this._tailoredTopY;this._reusedRect.y+=r,this._reusedRect.height-=r,n-=r}n-i._height*this._bmfontScale<this._tailoredbottomy&&(this._reusedrect.height=n<this._tailoredbottomy?0:n-this._tailoredbottomy)}var s="this._lettersInfo[e]._lineIndex,o=this._lettersInfo[e]._positionX+i._width/2*this._bmfontScale+this._linesOffsetX[s];if(this._labelWidth">0&&this._isHorizontalClamped(o,s))if(this._overFlow===_ccsg.Label.Overflow.CLAMP)this._reusedRect.width=0;else if(this._overFlow===_ccsg.Label.Overflow.SHRINK){if(this._contentSize.width>i._width){t=!1;break}this._reusedRect.width=0}if(this._reusedRect.height>0&&this._reusedRect.width>0){var a=this.getChildByTag(e),c=this._spriteBatchNode._texture,h=this._spriteFrame,l=this._spriteFrame.isRotated(),u=h._originalSize,_=h._rect,d=h._offset,f=d.x+(u.width-_.width)/2,p=d.y-(u.height-_.height)/2;if(l){var m=this._reusedRect.x;this._reusedRect.x=_.x+_.height-this._reusedRect.y-this._reusedRect.height-p,this._reusedRect.y=m+_.y-f,this._reusedRect.y<0&&(this._reusedrect.height=this._reusedrect.height+p)}else this._reusedrect.x+="_.x-f,this._reusedRect.y+=_.y+p;a?a.setTextureRect(this._reusedRect,l):(a=new" _ccsg.sprite,a.initwithtexture(c,this._reusedrect,l),a.setanchorpoint(cc.p(0,1)));var="" g="this._lettersInfo[e]._positionX+this._linesOffsetX[this._lettersInfo[e]._lineIndex];a.setPosition(g,n);var" v="this._spriteBatchNode.getChildrenCount();this._lettersInfo[e]._atlasIndex=v,this._updateLetterSpriteScale(a),this._spriteBatchNode.addChild(a)}}return" t},_updateletterspritescale:function(t){this._labeltype="==_ccsg.Label.Type.BMFont&&this._fontSize">0&&t.setScale(this._bmfontScale)},_recordPlaceholderInfo:function(t,e){if(t>=this._lettersInfo.length){var i=new o;this._lettersInfo.push(i)}this._lettersInfo[t]._char=e,this._lettersInfo[t]._valid=!1},_recordLetterInfo:function(t,e,i,n){if(i>=this._lettersInfo.length){var r=new o;this._lettersInfo.push(r)}e=e.charCodeAt(0),this._lettersInfo[i]._lineIndex=n,this._lettersInfo[i]._char=e,this._lettersInfo[i]._valid=this._fontAtlas._letterDefinitions[e]._validDefinition,this._lettersInfo[i]._positionX=t.x,this._lettersInfo[i]._positionY=t.y},_setDimensions:function(t,e){var i="number"==typeof t.width?t.width:t,n="number"==typeof t.height?t.height:e,r=this.getContentSize();_ccsg.Node.prototype.setContentSize.call(this,t,e),n===r.height&&i===r.width||(this._setupBMFontOverflowMetrics(i,n),this._drawFontsize>0&&this._restoreFontSize(),this._notifyLabelSkinDirty())},_restoreFontSize:function(){this._fontSize=this._drawFontsize},_multilineTextWrap:function(t){var e=this.getStringLength(),i=0,n=0,r=0,s=0,o=0,a=this._lineSpacing,c=0,h=0,l=null,u=cc.p(0,0);this._updateBMFontScale();for(var _=0;_<e;){var d="this._string.charAt(_);if("\n"!==d){for(var" f="t(this._string,_,e),p=c,m=h,g=o,v=n,y=!1,x=0;x<f;++x){var" t="_+x;if(d=this._string.charAt(T),"\r"!==d)if(l=this._fontAtlas.getLetterDefinitionForChar(d)){var" b="v+l._offsetX*this._bmfontScale;if(this._isWrapText&&this._maxLineWidth">0&&n>0&&b+l._width*this._bmfontScale>this._maxLineWidth&&!cc.TextUtils.isUnicodeSpace(d)){this._linesWidth.push(o),o=0,i++,n=0,r-=this._lineHeight*this._bmfontScale+a,y=!0;break}u.x=b,u.y=r-l._offsetY*this._bmfontScale,this._recordLetterInfo(u,d,T,i),T+1<this._horizontalkernings.length&&t<e-1&&(v+=this._horizontalkernings[t+1]),v+=l._xadvance*this._bmfontscale+this._spacingx,g=u.x+l._width*this._bmfontscale,p<u.y&&(p=u.y),m>u.y-l._height*this._bmfontScale&&(m=u.y-l._height*this._bmfontScale)}else this._recordPlaceholderInfo(T,d),console.log("Can't find letter definition in texture atlas "+this._config.atlasName+" for letter:"+d);else this._recordPlaceholderInfo(T,d)}y||(n=v,o=g,c<p&&(c=p),h>m&&(h=m),s<o&&(s=o),_+=f)}else this._lineswidth.push(o),o="0,i++,n=0,r-=this._lineHeight*this._bmfontScale+a,this._recordPlaceholderInfo(_,d),_++}this._linesWidth.push(o),this._numberOfLines=i+1,this._textDesiredHeight=this._numberOfLines*this._lineHeight*this._bmfontScale,this._numberOfLines">1&&(this._textDesiredHeight+=(this._numberOfLines-1)*this._lineSpacing);
var C=cc.size(this._labelWidth,this._labelHeight);return this._labelWidth<=0&&(c.width=parsefloat(s.tofixed(2))),this._labelheight<=0&&(c.height=parsefloat(this._textdesiredheight.tofixed(2))),_ccsg.node.prototype.setcontentsize.call(this,c),this._tailoredtopy=c.height,this._tailoredbottomy=0,c>0&&(this._tailoredTopY=C.height+c),h<-this._textdesiredheight&&(this._tailoredbottomy=this._textdesiredheight+h),!0},_multilinetextwrapbyword:function(){return this._multilinetextwrap(this._getfirstwordlen.bind(this))},_multilinetextwrapbychar:function(){return="" this._multilinetextwrap(this._getfirstcharlen.bind(this))},_isverticalclamp:function(){return="" this._textdesiredheight="">this._contentSize.height},_isHorizontalClamp:function(){for(var t=!1,e=0;e<this.getstringlength();++e)if(this._lettersinfo[e]._valid){var i="this._fontAtlas._letterDefinitions[this._lettersInfo[e]._char],n=this._lettersInfo[e]._positionX+i._width/2*this._bmfontScale,r=this._lettersInfo[e]._lineIndex;if(this._labelWidth">0)if(this._isWrapText){var s=this._linesWidth[r];if(s>this._contentSize.width&&(n>this._contentSize.width||n<0)){t=!0;break}}else if(n="">this._contentSize.width){t=!0;break}}return t},_shrinkLabelToContentSize:function(t){for(var e=this.getFontSize(),i=0,n=this._fontAtlas.cloneLetterDefinition(),r=this._lineHeight,s=!0;t();){++i;var o=e-i;if(s=!1,o<=0)break;var a="o/e;this._fontAtlas.assignLetterDefinitions(n),this._fontAtlas.scaleFontLetterDefinition(a),this._lineHeight=r*a,this._lineBreakWithoutSpaces?this._multilineTextWrapByChar():this._multilineTextWrapByWord(),this._computeAlignmentOffset()}this._lineHeight=r,this._fontAtlas.assignLetterDefinitions(n),s||e-i">=0&&this._scaleFontSizeDown(e-i)},_scaleFontSizeDown:function(t){var e=!0;this._labelType===_ccsg.Label.Type.BMFont&&(t||(t=.1,e=!1),this._fontSize=t,e&&this._updateContent())},_updateContent:function(){this._fontAtlas&&(this._computeHorizontalKerningForText(this._string),this._alignText())},_computeAlignmentOffset:function(){switch(this._linesOffsetX=[],this._hAlign){case cc.TextAlignment.LEFT:for(var t=0;t<this._numberoflines;++t)this._linesoffsetx.push(0);break;case cc.textalignment.center:this._lineswidth.foreach(function(t){this._linesoffsetx.push((this._contentsize.width-t)="" 2)}.bind(this));break;case="" cc.textalignment.right:this._lineswidth.foreach(function(t){this._linesoffsetx.push(this._contentsize.width-t)}.bind(this))}switch(this._valign){case="" cc.verticaltextalignment.top:this._letteroffsety="this._contentSize.height;break;case" cc.verticaltextalignment.center:this._letteroffsety="(this._contentSize.height+this._textDesiredHeight)/2;break;case" cc.verticaltextalignment.bottom:this._letteroffsety="this._textDesiredHeight}},_getFirstCharLen:function(){return" 1},_getfirstwordlen:function(t,e,i){var="" n="t.charAt(e);if(cc.TextUtils.isUnicodeCJK(n)||"\n"===n||cc.TextUtils.isUnicodeSpace(n))return" 1;var="" r="1;if(s=this._fontAtlas.getLetterDefinitionForChar(n),!s)return" r;for(var="" s,o,a="s._xAdvance*this._bmfontScale+this._spacingX,c=e+1;c<i&&(n=t.charAt(c),s=this._fontAtlas.getLetterDefinitionForChar(n),s);++c){if(o=a+s._offsetX*this._bmfontScale,o+s._width*this._bmfontScale">this._maxLineWidth&&!cc.TextUtils.isUnicodeSpace(n)&&this._maxLineWidth>0)return r;if(a+=s._xAdvance*this._bmfontScale+this._spacingX,"\n"===n||cc.TextUtils.isUnicodeSpace(n)||cc.TextUtils.isUnicodeCJK(n))break;r++}return r},_updateBMFontScale:function(){if(this._labelType===_ccsg.Label.Type.BMFont){var t=this._fontAtlas._fontSize;this._bmfontScale=this._fontSize/t}else this._bmfontScale=1},_initBMFontWithString:function(t,e,i){var n=this;return n._config?(cc.logID(4002),!1):(this._string=t,void this._setBMFontFile(e,i))},_createSpriteBatchNode:function(t){this._spriteBatchNode=new cc.SpriteBatchNode(t,this._string.length),this._spriteBatchNode.setCascadeColorEnabled(!0),this._spriteBatchNode.setCascadeOpacityEnabled(!0),this.addChild(this._spriteBatchNode),this._updateContent(),this.setColor(this.color)},_createFontChars:function(){if(this._config){this._fontAtlas=new cc.FontAtlas(this._config),this._lineHeight||(this._lineHeight=this._fontAtlas._lineHeight);var t=this._config,e=t.fontDefDictionary;for(var i in e){var n=new s,r=e[i].rect;n._offsetX=e[i].xOffset,n._offsetY=e[i].yOffset,n._width=r.width,n._height=r.height,n._u=r.x+this._imageOffset.x,n._v=r.y+this._imageOffset.y,n._textureID=0,n._validDefinition=!0,n._xAdvance=e[i].xAdvance,this._fontAtlas.addLetterDefinitions(i,n)}}},_rescaleWithOriginalFontSize:function(){var t=this.getFontSize();this._drawFontsize-t>=1&&this._overFlow===_ccsg.Label.Overflow.SHRINK&&(this._labelType===_ccsg.Label.Type.BMFont?this._scaleFontSizeDown(this._drawFontsize):this._fontSize=this._drawFontsize)},_computeHorizontalKerningForText:function(){for(var t=this.getStringLength(),e=this._config.kerningDict,i=-1,n=0;n<t;++n){var r="this._string.charCodeAt(n),s=e[i<<16|65535&r]||0;n<t-1?this._horizontalKernings[n]=s:this._horizontalKernings[n]=0,i=r}},_setBMFontFile:function(t,e){if(t&&(this._fontHandle=t,this._labelType===_ccsg.Label.Type.BMFont)){var" i="this;this._resetBMFont();var" n="this._fontAsset._fntConfig;n?i._config=n:(i._config=r.parseFnt(t),this._fontAsset._fntConfig=i._config),i._createFontChars(),i._spriteFrame=e;var" s="function(){var" t="e.getTexture();i._textureLoaded=t.isLoaded(),i._createSpriteBatchNode(t),i.emit("load")};e.textureLoaded()?s():(e.once("load",s),e.ensureLoadTexture())}}});var" a="_ccsg.Label.prototype;cc.js.addon(a,n.prototype),_ccsg.Label.Type=cc.Enum({TTF:0,BMFont:1,SystemFont:2}),_ccsg.Label.Overflow=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3});var" c="_ccsg.Label.prototype;Object.defineProperty(c,"width",{get:c._getWidth,set:_ccsg.Node.prototype._setWidth}),Object.defineProperty(c,"height",{get:c._getHeight,set:_ccsg.Node.prototype._setHeight})}),{"../event/event-target":112,"./CCTextUtils.js":129}],127:[(function(t,e,i){!(function(){_ccsg.Label.TTFLabelBaker=function(){};var" e="_ccsg.Node._dirtyFlags,i=this._dirtyFlag,n=t?t._node:null;n&&n._cascadeColorEnabled&&t._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),n&&n._cascadeOpacityEnabled&&t._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty);var" i},t._constructfontdesc="function(){var" ",i="0===t._fontHandle.length?"serif":t._fontHandle;return" e+="i,t._isBold&&(e="bold" "+e),e},t._measuretext="function(t){return" function(e){return="" t.measuretext(e).width}},t._calculatelabelfont="function(){var" h="this._drawFontsize+1,l="",u=!0,_=0|h;s">c||o>a;){if(u?h=_/2|0:(h=_-1,_=h),h<=0){cc.logid(4003);break}for(t._fontsize=h,i=this._constructfontdesc(),this._labelcontext.font=i,this._splitedstrings=[],s=0,r=0;r<e.length;++r){var d="0,f=this._labelContext.measureText(e[r]).width;for(l=cc.TextUtils.fragmentText(e[r],f,a,this._measureText(this._labelContext));d<l.length;){var" p="this._labelContext.measureText(l[d]).width;o=p,s+=this._getLineHeight(),++d}this._splitedStrings=this._splitedStrings.concat(l)}u&&(s">c?_=0|h:(u=!1,s=c+1))}}else{for(s=e.length*this._getLineHeight(),r=0;r<e.length;++r)o<n[r]&&(o=n[r]);var m="(this._canvasSize.width-2*this._getMargin())/o,g=this._canvasSize.height/s;t._fontSize=this._drawFontsize*Math.min(1,m,g)|0,i=this._constructFontDesc(),this._labelContext.font=i}}return" i},t._getmargin="function(){return" this._node&&this._node._margin||0},t._calculateparagraphlength="function(t,e){for(var" i="[],n=0;n<t.length;++n){var" r="e.measureText(t[n]);i.push(r.width)}return" i},t._calculatecanvassize="function(){var" t="this._node,e=t._contentSize.width,i=t._contentSize.height;return" e<="0&&(e=1),i<=0&&(i=1),cc.size(e,i)},t._calculateSplitedStrings=function(){var" t,e="this._node,i=e._string.split("\n");if(e._isWrapText){this._splitedStrings=[];var" n="this._canvasSize.width-2*this._getMargin();for(t=0;t<i.length;++t){var" this._splitedstrings="i},t._updateLabelDimensions=function(){var" if(_ccsg.label.overflow.none="==e._overFlow){this._splitedStrings=i;var" o="n.measureText(i[t]).width;r=r">o?r:o}s=this._splitedStrings.length*this._getLineHeight(),this._canvasSize.width=parseFloat(r.toFixed(2))+2*this._getMargin(),this._canvasSize.height=parseFloat(s.toFixed(2)),e._isItalic&&(this._canvasSize.width+=e._drawFontsize*Math.tan(.20943951)),_ccsg.Node.prototype.setContentSize.call(e,this._canvasSize)}this._labelCanvas.width=this._canvasSize.width,this._labelCanvas.height=this._canvasSize.height},t._calculateFillTextStartPosition=function(){var t,e,i=this._node,n=this._getLineHeight(),r=this._splitedStrings.length;return t=cc.TextAlignment.RIGHT===i._hAlign?this._canvasSize.width-this._getMargin():cc.TextAlignment.CENTER===i._hAlign?this._canvasSize.width/2:0+this._getMargin(),e=cc.VerticalTextAlignment.TOP===i._vAlign?0:cc.VerticalTextAlignment.CENTER===i._vAlign?this._canvasSize.height/2-n*(r-1)/2:this._canvasSize.height-n*(r-1),cc.p(t,e)},t._calculateTextBaseline=function(){var t,e,i=this._node;t=cc.TextAlignment.RIGHT===i._hAlign?"right":cc.TextAlignment.CENTER===i._hAlign?"center":"left",this._labelContext.textAlign=t,e=cc.VerticalTextAlignment.TOP===i._vAlign?"top":cc.VerticalTextAlignment.CENTER===i._vAlign?"middle":"bottom",this._labelContext.textBaseline=e},t._bakeLabel=function(){var t=this._node;this._drawFontsize=t._drawFontsize,this._canvasSize=this._calculateCanvasSize(),this._fontDesc=this._calculateLabelFont(),this._calculateSplitedStrings(),this._updateLabelDimensions(),this._calculateTextBaseline(),this._updateTexture()},t._calculateUnderlineStartPosition=function(){var t,e,i=this._node,n=this._getLineHeight(),r=this._splitedStrings.length;return t=0+this._getMargin(),e=cc.VerticalTextAlignment.TOP===i._vAlign?i._fontSize:cc.VerticalTextAlignment.CENTER===i._vAlign?this._canvasSize.height/2-n*(r-1)/2+i._fontSize/2:this._canvasSize.height-n*(r-1),cc.p(t,e)},t._updateTexture=function(){this._labelContext.clearRect(0,0,this._labelCanvas.width,this._labelCanvas.height),this._labelContext.font=this._fontDesc;var t=this._calculateFillTextStartPosition(),e=this._getLineHeight();this._labelContext.lineJoin="round";var i=this._displayedColor;this._labelContext.fillStyle="rgb("+i.r+","+i.g+","+i.b+")";for(var n,r=0;r<this._splitedstrings.length;++r){if(this._node.isoutlined()){var s="this._node.getOutlineColor()||cc.color(255,255,255,255);this._labelContext.globalCompositeOperation="source-over",this._labelContext.strokeStyle="rgb("+s.r+","+s.g+","+s.b+")",this._labelContext.lineWidth=2*this._node.getOutlineWidth(),this._labelContext.strokeText(this._splitedStrings[r],t.x,t.y+r*e)}if(this._node.getFillColorGradientEnabled()){var" o="this._node.getGradientStartColor()||cc.color(255,255,255,255),a=this._node.getGradientEndColor()||cc.color(255,255,255,255),c=this._getGradientArgs(),h=this._labelContext.createLinearGradient(c.left,c.top,c.right,c.bottom);h.addColorStop(0,cc.colorToHex(o)),h.addColorStop(1,cc.colorToHex(a)),this._labelContext.fillStyle=h}this._labelContext.fillText(this._splitedStrings[r],t.x,t.y+r*e),this._node._isUnderline&&(n=this._calculateUnderlineStartPosition(),this._labelContext.save(),this._labelContext.beginPath(),this._labelContext.lineWidth=this._node._fontSize/8,this._labelContext.strokeStyle="rgb("+i.r+","+i.g+","+i.b+")",this._labelContext.moveTo(n.x,n.y+r*e-1),this._labelContext.lineTo(n.x+this._labelCanvas.width,n.y+r*e-1),this._labelContext.stroke(),this._labelContext.restore())}this._texture._textureLoaded=!1,this._texture._htmlElementObj=this._labelCanvas,this._texture.handleLoadedTexture(!0)},t._getGradientArgs=function(){this._gradientArgument={},this._gradientArgument.left=0,this._gradientArgument.top=0;var" t="this._node._contentSize;switch(this._node.getFillColorGradientDirection()){case" 0:this._gradientargument.right="t.width,this._gradientArgument.bottom=0;break;case" 1:this._gradientargument.right="0,this._gradientArgument.bottom=t.height;break;case" 2:this._gradientargument.right="t.width,this._gradientArgument.bottom=t.height}return" this._gradientargument},t._rebuildlabelskin="function(){this._dirtyFlag&=~_ccsg.Node._dirtyFlags.textDirty;var" cc.texture2d,this._labelcanvas="document.createElement("canvas"),this._labelCanvas.width=1,this._labelCanvas.height=1,this._labelContext=this._labelCanvas.getContext("2d"),this._texture.initWithElement(this._labelCanvas),this._splitedStrings=null};var" i="this._currentRegion,n=i._minX,r=i._maxX,s=i._minY,o=i._maxY,a=cc.visibleRect,c=a.left.x,h=a.right.x,l=a.top.y,u=a.bottom.y;r<c||n">h||o<u||s>l?this._needDraw=!1:this._needDraw=!0},t.rendering=function(t,e,i){var n=this._node;if(n._labelType===_ccsg.Label.Type.TTF||n._labelType===_ccsg.Label.Type.SystemFont){var r=this._displayedOpacity,s=r/255;if(0===r)return;var o=t||cc._renderContext,a=o.getContext();if(o.setTransform(this._worldTransform,e,i),o.setCompositeOperation(_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(n._blendFunc)),o.setGlobalAlpha(s),this._texture){var c,h,l,u,_,d,f,p;_=0,d=-this._node._contentSize.height,f=this._node._contentSize.width,p=this._node._contentSize.height;var m=this._texture.getPixelWidth(),g=this._texture.getPixelHeight();c=0,h=0,l=m,u=g;var v=this._texture._htmlElementObj;""!==this._texture._pattern?(o.setFillStyle(a.createPattern(v,this._texture._pattern)),a.fillRect(_,d,f,p)):0!==l&&0!==u&&0!==f&&0!==p&&a.drawImage(v,c,h,l,u,_,d,f,p)}cc.g_NumberOfDraws=cc.g_NumberOfDraws+1}}})()}),{}],128:[(function(t,e,i){_ccsg.Label.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._texture=new cc.Texture2D,this._labelCanvas=document.createElement("canvas"),this._texture.initWithElement(this._labelCanvas),this._labelContext=this._labelCanvas.getContext("2d"),this._labelCanvas.width=1,this._labelCanvas.height=1,this._splitedStrings=null,this._drawFontsize=0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:1},{x:0,y:0,u:1,v:0},{x:0,y:0,u:1,v:1}],this._color=new Uint32Array(1),this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var n=_ccsg.Label.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);cc.js.mixin(n,_ccsg.Label.TTFLabelBaker.prototype),n.constructor=_ccsg.Label.WebGLRenderCmd,n.transform=function(t,e){this.originTransform(t,e);var i=this._node,n=0,r=this._labelCanvas.width,s=0,o=this._labelCanvas.height,a=this._worldTransform,c=this._vertices;if(c[0].x=n*a.a+o*a.c+a.tx,c[0].y=n*a.b+o*a.d+a.ty,c[1].x=n*a.a+s*a.c+a.tx,c[1].y=n*a.b+s*a.d+a.ty,c[2].x=r*a.a+o*a.c+a.tx,c[2].y=r*a.b+o*a.d+a.ty,c[3].x=r*a.a+s*a.c+a.tx,c[3].y=r*a.b+s*a.d+a.ty,i._string&&(i._labelType===_ccsg.Label.Type.TTF||i._labelType===_ccsg.Label.Type.SystemFont)){var h=cc.visibleRect,l=h.left.x,u=h.right.x,_=h.top.y,d=h.bottom.y;(c[0].x-l&c[1].x-l&c[2].x-l&c[3].x-l)>>31||(u-c[0].x&u-c[1].x&u-c[2].x&u-c[3].x)>>31||(c[0].y-d&c[1].y-d&c[2].y-d&c[3].y-d)>>31||(_-c[0].y&_-c[1].y&_-c[2].y&_-c[3].y)>>31?this._needDraw=!1:this._needDraw=!0}},n.uploadData=function(t,e,i){var n=this._node;if(!n._string||n._labelType!==_ccsg.Label.Type.TTF&&n._labelType!==_ccsg.Label.Type.SystemFont)return 0;var r=this._displayedOpacity;this._color[0]=r<<24|r<<16|r<<8|r;var s,o,a="n._vertexZ,c=this._vertices,h=c.length,l=i;for(s=0;s<h;++s)o=c[s],t[l]=o.x,t[l+1]=o.y,t[l+2]=a,e[l+3]=this._color[0],t[l+4]=o.u,t[l+5]=o.v,l+=6;return" h}}),{}],129:[(function(t,e,i){var="" n="function(){this._status="unloaded",this._observers=[],this._isLoadWithCSS=!1};n.prototype.onLoaded=function(){this._status="loaded",this._observers.forEach((function(t){t()}))},n.prototype.isLoaded=function(){return"loaded"===this._status},n.prototype.addHandler=function(t){this._observers.indexOf(t)===-1&&this._observers.push(t)};var" r="{_fontCache:{},_fontWidthCache:{},_canvasContext:null,_testString:"BESbswy",_allFontsLoaded:!1,_intervalId:0,loadTTF:function(t,e){var" i="cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU_APP&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ;window.FontFace&&i?this._loadWithFontFace(t,e):this._loadWithCSS(t,e),0===this._intervalId&&(this._intervalId=setInterval(this._checkFontLoaded.bind(this),100))},_checkFontLoaded:function(){this._allFontsLoaded=!0;for(var" t="" in="" this._fontcache){var="" e="this._fontCache[t];if(!e.isLoaded()&&e._isLoadWithCSS){var" "+t;var="" s="new" fontface(i,"url('"+t+"')");document.fonts.add(s),r="new" n,r.addhandler(e),this._fontcache[i]="r,s.loaded.then((function(){r.onLoaded()}))}},_loadWithCSS:function(t,e){var" a="" ;a+="isNaN(i-0)?"@font-face" {="" font-family:"+i+";="" src:":"@font-face="" font-family:'"+i+"';="" src:",a+="url('" +t+"');",o.textcontent="a+"}";var" c="document.createElement("div"),h=c.style;if(h.fontFamily=i,c.innerHTML=".",h.position="absolute",h.left="-100px",h.top="-100px",s.body.appendChild(c),r=new" l="document.createElement("canvas");l.width=100,l.height=100,this._canvasContext=l.getContext("2d")}var" u="40px " +i;this._canvascontext.font="u;var" _="this._canvasContext.measureText(this._testString).width;this._fontWidthCache[i]=_;var" d="this;o.onload=function(){setTimeout((function(){d._allFontsLoaded||(cc.logID(4004),r.onLoaded(),cc.director.getScheduler().unschedule(this._checkFontLoaded,this))}),2e4)}}},_getFontFamily:function(t){var" t;var="" i,n="t.lastIndexOf("/");return">、‘“》？。，！]/,label_lastWordRex:/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+$/,label_firsrEnglish:/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]/,label_wrapinspection:!0,isUnicodeCJK:function(t){var e=/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,i=/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,n=/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/;return e.test(t)||i.test(t)||n.test(t)},isUnicodeSpace:function(t){return t=t.charCodeAt(0),t>=9&&t<=13||32===t||133===t||160===t||5760===t||t>=8192&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},fragmenttext:function(t,e,i,n){var r="[];if(0===t.length||i<0)return" r.push(""),r;for(var="" s="t;e">i&&s.length>1;){for(var o=s.length*(i/e)|0,a=s.substr(o),c=e-n(a),h=a,l=0,u=0,_=10;c>i&&u++<_;)o*=i c,o|="0,a=s.substr(o),c=e-n(a);for(u=0;c<i&&u++<_;){if(a){var" d="this.label_wordRex.exec(a);l=d?d[0].length:1,h=a}o+=l,a=s.substr(o),c=e-n(a)}o-=l,0===o&&(o=1,h=h.substr(1));var" f,p="s.substr(0,o);this.label_wrapinspection&&this.label_symbolRex.test(h||a)&&(f=this.label_lastWordRex.exec(p),o-=f?f[0].length:0,0===o&&(o=1),h=s.substr(o),p=s.substr(0,o)),this.label_firsrEnglish.test(h)&&(f=this.label_lastEnglish.exec(p),f&&p!==f[0]&&(o-=f[0].length,h=s.substr(o),p=s.substr(0,o))),p.trim().length">0&&r.push(p),s=h||a,e=n(s)}return s.length>0&&r.push(s),r}};cc.TextUtils=e.exports=s,cc.CustomFontLoader=e.exports=r}),{}],130:[(function(t,e,i){function n(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")}function r(t){var e,i,n;if("object"==typeof t){if(i=t,t.url)return i;e=t.uuid}else i={},e=t;return n=i.type?"uuid"===i.type:cc.AssetLibrary._getAssetUrl(e),m.url=null,m.raw=!1,cc.AssetLibrary._getAssetInfoInRuntime(e,m),i.url=n?m.url:e,m.url&&"uuid"===i.type&&m.raw?(i.type=null,i.isRawAsset=!0):n||(i.isRawAsset=!0),i}function s(){var t=new h,e=new l,i=new u;a.call(this,[t,e,i]),this.assetLoader=t,this.downloader=e,this.loader=i,this.onProgress=null,this._autoReleaseSetting={}}var o=t("../platform/js"),a=t("./pipeline"),c=t("./loading-items"),h=t("./asset-loader"),l=t("./downloader"),u=t("./loader"),_=t("./asset-table"),d=t("../platform/utils").callInNextTick,f=t("./auto-release-utils"),p=new _,m={url:null,raw:!1},g=[],v=[];o.extend(s,a);var y=s.prototype;y.getXMLHttpRequest=n,y.addDownloadHandlers=function(t){this.downloader.addHandlers(t)},y.addLoadHandlers=function(t){this.loader.addHandlers(t)},y.load=function(t,e,i){void 0===i&&(i=e,e=this.onProgress||null);var n=this,s=!1;t instanceof Array||(s=!0,t=t?[t]:[]),g.length=0;for(var o=0;o<t.length;++o){var 0="==i){var" a="t[o];a&&a.id&&(cc.warnID(4920,a.id),a.uuid||a.url||(a.url=a.id));var" h="r(a);if(h.url||h.uuid){var" l="this.getItem(h.url);g.push(l||h)}}var" u="c.create(this,e,(function(t,e){d((function(){if(i){if(s){var" r="h.url;i.call(n,e.getError(r),e.getContent(r))}else" i.call(n,t,e);i="null;var" r;e.destroy()}}))}));c.initqueuedeps(u),u.append(g),g.length="0},y.flowInDeps=function(t,e,i){t&&!t.deps&&(t.deps=[]),v.length=0;for(var" n="0;n<e.length;++n){var" s="r(e[n]);if(s.url||s.uuid){var" o="this.getItem(s.url);o?(v.push(o),t&&t.deps.push(o)):v.push(s)}}var" v.length="0,l},y._resources=p,y._getResUuid=function(t,e,i){if(!t)return" null;var="" r},y._getreferencekey="function(t){var" e;return"object"="=typeof" t?e="t._uuid||null:"string"==typeof" t&&(e="this._getResUuid(t,null,!0)||t),e?(m.url=null,m.raw=!1,cc.AssetLibrary._getAssetInfoInRuntime(e,m),this._cache[m.url]?m.url:e):(cc.warnID(4800,t),e)},y._urlNotFound=function(t,e,i){d((function(){t=cc.url.normalize(t);var" in="" "resources="" '+t+'"="" does="" not="" exist.';i&&i(new="" error(n),[])}))},y._parseloadresargs="function(t,e,i){if(void" 0!="=e||n||(i=t,e=this.onProgress||null,t=null),void">0){var r=this,s=t.map((function(t){return{type:"uuid",uuid:t}}));this.load(s,e,(function(t,e){if(i){for(var o=[],a=n&&[],c=0;c<s.length;++c){var h="s[c].uuid,l=this._getReferenceKey(h),u=e.getContent(l);u&&(r.setAutoReleaseRecursively(h,!1),o.push(u),a&&a.push(n[c]))}n?i(t,o,a):i(t,o)}}))}else" i&&d((function(){n?i(null,[],[]):i(null,[])}))},y.loadresarray="function(t,e,i,n){var" r="this._parseLoadResArgs(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete;for(var" s="[],o=0;o<t.length;o++){var" a="t[o],c=this._getResUuid(a,e);if(!c)return" void="" this._urlnotfound(a,e,n);s.push(c)}this._loadresuuids(s,i,n)},y.loadresdir="function(t,e,i,n){var" i="this._cache[t];if(!i){var" n="this._getResUuid(t,e,!0);if(!n)return" null;var="" i&&i.alias&&(i="this._cache[i.alias]),i&&i.complete?i.content:null},y.getResCount=function(){return" object.keys(this._cache).length},y.getdependsrecursively="function(t){if(t){var" e="this._getReferenceKey(t),i=f.getDependsRecursively(e);return" i.push(e),i}return[]},y.release="function(t){if(Array.isArray(t))for(var" if(t){var="" instanceof="" cc.asset)for(var="" t="" cc.texture2d&&cc.texturecache.removetextureforkey(r.url)}}},y.releaseasset="function(t){var" in="" this._cache)this.release(t)},y.removeitem="function(t){var" delete="" this._autoreleasesetting[t],e},y.setautorelease="function(t,e){var" s,e.exports="cc.loader}),{"../platform/js":193,"../platform/utils":198,"./asset-loader":131,"./asset-table":132,"./auto-release-utils":134,"./downloader":135,"./loader":138,"./loading-items":139,"./pipeline":141}],131:[(function(t,e,i){var" c="[];a.prototype.handle=function(t,e){var" t.content?t.content:null;cc.assetlibrary.queryassetinfo(i,(function(r,o,a){if(r)e(r);else="" if(t.url="o,t.isRawAsset=a,a){var" e(new="" error("download="" uuid:="" can="" not="" find="" type="" of="" raw="" asset["+i+"]:="" "+o));h="h.substr(1);var" l="s.getQueue(t);c[0]={queueId:t.queueId,id:o,url:o,type:h,error:null,alias:t.id,complete:!0},l.append(c),t.type=h,e(null,t.content)}else" t.type="uuid" ,e(null,t.content)}))},r.assetloader="e.exports=a}),{"../utils/CCPath":217,"./loading-items":139,"./pipeline":141}],132:[(function(t,e,i){function" n(t,e){this.uuid="t,this.type=e}function" r(){this._pathtouuid="{}}function" s(t,e){if(t.length="">e.length){var i=t.charCodeAt(e.length);return 46===i||47===i}return!0}var o=r.prototype;o.getUuid=function(t,e){t=cc.url.normalize(t);var i=this._pathToUuid[t];if(i)if(Array.isArray(i)){if(!e)return i[0].uuid;for(var n=0;n<i.length;n++){var 0="==c.length?new" r="i[n];if(cc.isChildClassOf(r.type,e))return" r.uuid}}else="" if(!e||cc.ischildclassof(i.type,e))return="" i.uuid;return""},o.getuuidarray="function(t,e,i){t=cc.url.normalize(t),"/"===t[t.length-1]&&(t=t.slice(0,-1));var" n="this._pathToUuid,r=[],o=cc.isChildClassOf;for(var" a="" in="" n)if(a.startswith(t)&&s(a,t)||!t){var="" c="n[a];if(Array.isArray(c))for(var" h="0;h<c.length;h++){var" l="c[h];e&&!o(l.type,e)||(r.push(l.uuid),i&&i.push(a))}else" e&&!o(c.type,e)||(r.push(c.uuid),i&&i.push(a))}return="" r},o.getallpaths="function(){return" object.keys(this._pathtouuid)},o.add="function(t,e,i,r){t=t.substring(0,t.length-cc.path.extname(t).length);var" s="new" n(e,i),o="this._pathToUuid,a=o[t];a?Array.isArray(a)?r?a.unshift(s):a.push(s):r?o[t]=[s,a]:o[t]=[a,s]:o[t]=s},o.reset=function(){this._pathToUuid={}},e.exports=r}),{}],133:[(function(t,e,i){function" n(t,e){var="" i="document.createElement("audio");i.src=t.url;var" +t.url;cc.log(i),e(i,t.url)};i.addeventlistener("canplaythrough",s,!1),i.addeventlistener("error",o,!1),a.use_loader_event&&i.addeventlistener(a.use_loader_event,s,!1)}function="" r(t,e){h||e(new="" error("audio="" downloader:="" no="" web="" audio="" context."));var="" error="" -="" "+t.url,null)}))},i.onerror="function(){e("request" "+t.url,null)},i.send()}function="" s(t,e){return="" not="" supported="" on="" this="" browser!"):(t.content="t.url,void(!a.WEB_AUDIO||t.urlParam&&t.urlParam.useDom?n(t,e):r(t,e)))}var" o="(t("../utils/CCPath"),t("../platform/CCSys")),a=(t("./pipeline"),t("../../audio/CCAudioEngine"),o.__audioSupport),c=a.format,h=a.context;e.exports=s}),{"../../audio/CCAudioEngine":24,"../platform/CCSys":182,"../utils/CCPath":217,"./pipeline":141}],134:[(function(t,e,i){function" r(t,e,i){i&&i.indexof(e)!="=-1||t.release(e)}e.exports={autoRelease:function(t,e,i){var" n,s,o="t._autoReleaseSetting;if(e)for(n=0;n<e.length;n++)s=e[n],o[s]!==!1&&r(t,s,i);var" e="{};return" n(t,e),object.keys(e)}}}),{}],135:[(function(t,e,i){function="" n(t,e,i){function="" n(){a.parentnode.removechild(a),a.removeeventlistener("load",n,!1),a.removeeventlistener("error",r,!1),e(null,s)}function="" r(){a.parentnode.removechild(a),a.removeeventlistener("load",n,!1),a.removeeventlistener("error",r,!1),e(new="" error("load="" "+s+"="" failed!"),s)}var="" a.async="i,a.src=m(s),a.addEventListener("load",n,!1),a.addEventListener("error",r,!1),o.body.appendChild(a)}function" r(t,e,i,n){return="" cc.sys.capabilities.webp?s(t,e,i,n):new="" webp="" (="" "+t.url+"="" )="" failed")}function="" s(t,e,i,n){void="">0&&n.src===r?n:void!(function(){function i(){n.removeEventListener("load",i),n.removeEventListener("error",o),e(null,n)}function o(){n.removeEventListener("load",i),n.removeEventListener("error",o),"https:"!==window.location.protocol&&n.crossOrigin&&"anonymous"===n.crossOrigin.toLowerCase()?s(t,e,!1,n):e(new Error("Load image ("+r+") failed"))}n.addEventListener("load",i),n.addEventListener("error",o),n.src=r})()}function o(t,e,i){var n=document,r=document.createElement("style");r.type="text/css",n.body.appendChild(r);var s="";if(s+=isNaN(t-0)?"@font-face { font-family:"+t+"; src:":"@font-face { font-family:'"+t+"'; src:",e instanceof Array)for(var o=0,a=e.length;o<a;o++){var 0="==i?this.extMap.json(t,e):i?i:void" c="e[o];i=u.extname(c).toLowerCase(),s+="url('"+e[o]+"')" format('"+g[i]+"')",s+="o===a-1?";":","}else" i="i.toLowerCase(),s+="url('"+e+"')" format('"+g[i]+"');";r.textcontent+="s+"}";var" h="document.createElement("div"),l=h.style;l.fontFamily=t,h.innerHTML=".",l.position="absolute",l.left="-100px",l.top="-100px",n.body.appendChild(h)}function" a(t,e){var="" r&&s?(s.indexof(i)="==-1&&s.push(i),o(r,s)):(n=u.extname(i),r=u.basename(i,n),o(r,i,n)),document.fonts?void" document.fonts.load("1em="" "+r).then((function(){e(null,null)}),(function(t){e(t)})):null}function="" c(t,e){var="" void="" 0}var="" h,l="t("../platform/js"),u=t("../utils/CCPath"),_=t("../utils/misc"),d=t("./pipeline"),f=t("./pack-downloader"),p=t("./text-downloader"),m=t("./utils").urlAppendTimestamp;h=t("./audio-downloader");var" g="{".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},v={js:n,png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:r,image:s,mp3:h,ogg:h,wav:h,m4a:h,txt:p,xml:p,vsh:p,fsh:p,atlas:p,tmx:p,tsx:p,json:p,ExportJson:p,plist:p,fnt:p,font:a,eot:a,ttf:a,woff:a,svg:a,ttc:a,uuid:c,default:p},y="Downloader",x=function(t){this.id=y,this.async=!0,this.pipeline=null,this._curConcurrent=0,this._loadQueue=[],this.extMap=l.mixin(t,v)};x.ID=y,x.prototype.addHandlers=function(t){l.mixin(this.extMap,t)},x.prototype._handleLoadQueue=function(){for(;this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT;){var" t="this._loadQueue.shift();if(!t)break;var" e="this.handle(t.item,t.callback);void" 0!="=e&&(e" instanceof="" error?t.callback(e):t.callback(null,e))}},x.prototype.handle="function(t,e){var" 0;if(this._curconcurrent<cc.macro.download_max_concurrent){if(this._curconcurrent++,r="n.call(this,t,(function(t,n){i._curConcurrent=Math.max(0,i._curConcurrent-1),i._handleLoadQueue(),e&&e(t,n)})),void" this._curconcurrent="Math.max(0,this._curConcurrent-1),this._handleLoadQueue(),r}else" if(t.ignoremaxconcurrency){if(r="n.call(this,t,e),void" r}else="" this._loadqueue.push({item:t,callback:e})},d.downloader="e.exports=x}),{"../platform/js":193,"../utils/CCPath":217,"../utils/misc":223,"./audio-downloader":133,"./pack-downloader":140,"./pipeline":141,"./text-downloader":142,"./utils":143}],136:[(function(t,e,i){t("./downloader"),t("./loader"),t("./json-unpacker"),t("./loading-items"),t("./pipeline"),t("./CCLoader")}),{"./CCLoader":130,"./downloader":135,"./json-unpacker":137,"./loader":138,"./loading-items":139,"./pipeline":141}],137:[(function(t,e,i){function" n(){this.jsons="{},this.state=-1}n.prototype.read=function(t,e){var" =="typeof" e?json.parse(e):e;i.length!="=t.length&&cc.errorID(4915);for(var" n="0;n<t.length;n++){var" r="t[n],s=i[n];this.jsons[r]=s}},n.prototype.retrieve=function(t){return" this.jsons[t]||null},e.exports="n}),{}],138:[(function(t,e,i){function" n(t,e){return="" null}function="" r(t,e){if("string"!="typeof" t.content)return="" new="" error("json="" loader:="" input="" item="" doesn't="" contain="" string="" content");try{var="" i}catch(e){return="" parse="" json="" ["+t.id+"]="" failed="" :="" "+e)}}function="" s(t,e){if(!(t.content="" image))return="" error("image="" image="" content");var="" h;return="" n.url="i,n.initWithElement(t.content),n.handleLoadedTexture(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&u.imagePool.put(t.content),cc.textureCache.cacheImage(i,n),n}function" o(t,e){if("string"!="typeof" error("plist="" i?i:new="" failed")}var="" a="t("../platform/js"),c=t("./pipeline"),h=t("../textures/CCTexture2D"),l=t("./uuid-loader"),u=t("../utils/misc"),_={png:s,jpg:s,bmp:s,jpeg:s,gif:s,ico:s,tiff:s,webp:s,image:s,json:r,ExportJson:r,plist:o,uuid:l,prefab:l,fire:l,scene:l,default:n},d="Loader",f=function(t){this.id=d,this.async=!0,this.pipeline=null,this.extMap=a.mixin(t,_)};f.ID=d,f.prototype.addHandlers=function(t){this.extMap=a.mixin(this.extMap,t)},f.prototype.handle=function(t,e){var" i.call(this,t,e)},c.loader="e.exports=f}),{"../platform/js":193,"../textures/CCTexture2D":213,"../utils/misc":223,"./pipeline":141,"./uuid-loader":144}],139:[(function(t,e,i){function" n(t){var="" e}function="" r(t,e){var="" i,n;if("object"="=typeof" t?(t.url&&!t.type&&(t.type="a.extname(t.url).toLowerCase().substr(1)),n=p(t.url),i={queueId:e,id:t.url,url:n.url,urlParam:n.param,error:null,content:null,complete:!1,states:{},deps:null},c.mixin(i,t)):"string"==typeof" t&&(n="p(t),i={queueId:e,id:t,url:n.url,urlParam:n.param,type:a.extname(t).toLowerCase().substr(1),error:null,content:null,complete:!1,states:{},deps:null}),i.skips)for(var" o="i.skips[r];i.states[o]=d.COMPLETE}return" i}function="" s(t,e,i){if(!t||!e)return!1;var="" r,o,a="e.deps;for(r=0;r<a.length;r++){if(o=a[r],o.id===t.id){n=!0;break}if(!(m.indexOf(o.id)">=0)&&o.deps&&s(t,o,!0)){n=!0;break}}}return i||(m.length=0),n}var o=t("../platform/callbacks-invoker"),a=t("../utils/CCPath"),c=t("../platform/js"),h=0|998*Math.random(),l={},u=[],_=10,d={WORKING:1,COMPLETE:2,ERROR:3},f={},p=function(t){var e={};if(!t)return e;var i=t.split("?");return i&&i[0]?(e.url=i[0],i[1]?(e.param={},i=i[1].split("&"),i.forEach((function(t){var i=t.split("=");e.param[i[0]]=i[1]})),e):e):e},m=[],g=function(t,e,i,n){o.call(this),this._id=++h,l[this._id]=this,this._pipeline=t,this._errorUrls=[],this._appending=!1,this._ownerQueue=null,this.onProgress=i,this.onComplete=n,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,this._pipeline?this.active=!0:this.active=!1,e&&(e.length>0?this.append(e):this.allComplete())};g.ItemState=new cc.Enum(d),g.create=function(t,e,i,n){void 0===i?"function"==typeof e&&(n=e,e=i=null):void 0===n&&("function"==typeof e?(n=i,i=e,e=null):(n=i,i=null));var r=u.pop();return r?(r._pipeline=t,r.onProgress=i,r.onComplete=n,l[r._id]=r,r._pipeline&&(r.active=!0),e&&r.append(e)):r=new g(t,e,i,n),r},g.getQueue=function(t){return t.queueId?l[t.queueId]:null},g.itemComplete=function(t){var e=l[t.queueId];e&&e.itemComplete(t.id)},g.initQueueDeps=function(t){var e=f[t._id];e?(e.completed.length=0,e.deps.length=0):e=f[t._id]={completed:[],deps:[]}},g.registerDep=function(t,e){var i=t.queueId||t;if(!i)return!1;var n=f[i];if(n)n.deps.indexOf(e)===-1&&n.deps.push(e);else if(t.id)for(var r in f){var s=f[r];s.deps.indexOf(t.id)!==-1&&s.deps.indexOf(e)===-1&&s.deps.push(e)}},g.finishDep=function(t){for(var e in f){var i=f[e];i.deps.indexOf(t)!==-1&&i.completed.indexOf(t)===-1&&i.completed.push(t)}};var v=g.prototype;c.mixin(v,o.prototype),v.append=function(t,e){if(!this.active)return[];this._appending=!0;var i,o,a,c=[];for(i=0;i<t.length;++i)if(o=t[i],!o.queueid||this.map[o.id]){if(n(o)){a=r(o,this._id);var h="a.id;this.map[h]||(this.map[h]=a,this.totalCount++,g.registerDep(e||this._id,h),c.push(a))}}else{if(this.map[o.id]=o,o.complete||s(e,o)){this.totalCount++,this.itemComplete(o.id);continue}var" u="this,_=l[o.queueId];_&&(this.totalCount++,g.registerDep(e||this._id,o.id),_.addListener(o.id,(function(t){u.itemComplete(t.id)})))}return" this._appending="!1,this.completedCount===this.totalCount?this.allComplete():this._pipeline.flowIn(c),c},v._childOnProgress=function(t){if(this.onProgress){var" e="f[this._id];this.onProgress(e?e.completed.length:this.completedCount,e?e.deps.length:this.totalCount,t)}},v.allComplete=function(){var" t="0===this._errorUrls.length?null:this._errorUrls;this.onComplete&&this.onComplete(t,this)},v.isCompleted=function(){return" this.completedcount="">=this.totalCount},v.isItemCompleted=function(t){return!!this.completed[t]},v.exists=function(t){return!!this.map[t]},v.getContent=function(t){var e=this.map[t],i=null;return e&&(e.content?i=e.content:e.alias&&(i=this.getContent(e.alias))),i},v.getError=function(t){var e=this.map[t],i=null;return e&&(e.error?i=e.error:e.alias&&(i=this.getError(e.alias))),i},v.addListener=o.prototype.add,v.hasListener=o.prototype.has,v.removeListener=o.prototype.remove,v.removeAllListeners=o.prototype.removeAll,v.removeItem=function(t){var e=this.map[t];e&&this.completed[e.alias||t]&&(delete this.completed[t],delete this.map[t],e.alias&&(delete this.completed[e.alias],delete this.map[e.alias]),this.completedCount--,this.totalCount--)},v.itemComplete=function(t){var e=this.map[t];if(e){var i=this._errorUrls.indexOf(t);if(e.error&&i===-1?this._errorUrls.push(t):e.error||i===-1||this._errorUrls.splice(i,1),this.completed[t]=e,this.completedCount++,g.finishDep(e.id),this.onProgress){var n=f[this._id];this.onProgress(n?n.completed.length:this.completedCount,n?n.deps.length:this.totalCount,e)}this.invokeAndRemove(t,e),!this._appending&&this.completedCount>=this.totalCount&&this.allComplete()}},v.destroy=function(){this.active=!1,this._appending=!1,this._pipeline=null,this._ownerQueue=null,this._errorUrls.length=0,this.onProgress=null,this.onComplete=null,this.map={},this.completed={},this.totalCount=0,this.completedCount=0,o.call(this),l[this._id]=null,f[this._id]&&(f[this._id].completed.length=0,f[this._id].deps.length=0),u.indexOf(this)===-1&&u.length<_&&u.push(this)},cc.loadingitems=e.exports=g}),{".. platform="" callbacks-invoker":187,"..="" js":193,"..="" utils="" ccpath":217}],140:[(function(t,e,i){function="" n(t,e){return="" new="" error("can="" not="" retrieve="" "+t+"="" from="" packer="" "+e)}var="" r="t("./json-unpacker"),s={},o={},a={},c={Invalid:0,Removed:1,Downloading:2,Loaded:3};e.exports={initPacks:function(t){o=t;for(var" e="" in="" t)for(var="" i="t[e],n=0;n<i.length;n++){var" c="a[0];a[0]=a[a.length-1],a[a.length-1]=c}}else" s[r]="e}},_loadNewPack:function(t,e,i){var" cc.errorid(4916,t),i(s);var="" a="r._doLoadNewPack(t,e,o);a?i(null,a):i(n(t,e))}))},_doLoadNewPack:function(t,e,i){var" n="a[e];return" n.state!="=c.Loaded&&(n.read(o[e],i),n.state=c.Loaded),n.retrieve(t)},_selectLoadedPack:function(t){for(var" o="s.state;if(o===c.Loaded)return" r;o="">e&&(e=o,i=r)}}return e!==c.Invalid?i:t[0]},load:function(t,e){var i=t.uuid,o=s[i];if(o){Array.isArray(o)&&(o=this._selectLoadedPack(o));var h=a[o];if(h&&h.state===c.Loaded){var l=h.retrieve(i);return l?l:n(i,o)}return h||(console.log("Create unpacker %s for %s",o,i),h=a[o]=new r,h.state=c.Downloading),this._loadNewPack(i,o,e),null}}}}),{"./json-unpacker":137}],141:[(function(t,e,i){function n(t,e){var i=t.id,r=e.states[i],o=t.next,a=t.pipeline;if(!e.error&&r!==s.WORKING&&r!==s.ERROR)if(r===s.COMPLETE)o?n(o,e):a.flowOut(e);else{e.states[i]=s.WORKING;var c=t.handle(e,(function(t,r){t?(e.error=t,e.states[i]=s.ERROR,a.flowOut(e)):(r&&(e.content=r),e.states[i]=s.COMPLETE,o?n(o,e):a.flowOut(e))}));c instanceof Error?(e.error=c,e.states[i]=s.ERROR,a.flowOut(e)):void 0!==c&&(null!==c&&(e.content=c),e.states[i]=s.COMPLETE,o?n(o,e):a.flowOut(e))}}var r=(t("../platform/js"),t("./loading-items")),s=r.ItemState,o=function(t){this._pipes=t,this._cache={};for(var e=0;e<t.length;++e){var 0="==h.length?(cc.deserialize.Details.pool.put(n),s(null,i)):(e.content=i,void" i="t[e];i.handle&&i.id&&(i.pipeline=this,i.next=e<t.length-1?t[e+1]:null)}};o.ItemState=s;var" a="o.prototype;a.insertPipe=function(t,e){t.handle&&t.id&&(t.pipeline=this,e<this._pipes.length?(t.next=this._pipes[e],this._pipes.splice(e,0,t)):(t.next=null,this._pipes.push(t)))},a.appendPipe=function(t){t.handle&&t.id&&(t.pipeline=this,t.next=null,this._pipes.push(t))},a.flowIn=function(t){var" e,i,r="this._pipes[0];if(r){for(e=0;e<t.length;e++)i=t[e],this._cache[i.id]=i;for(e=0;e<t.length;e++)i=t[e],n(r,i)}else" for(e="0;e<t.length;e++)this.flowOut(t[e])},a.flowInDeps=function(t,e,i){var" n="r.create(this,(function(t,e){i(t,e),e.destroy()}));return" n.append(e,t)},a.flowout="function(t){t.error?delete" this._cache[t.id]:this._cache[t.id]||(this._cache[t.id]="t),t.complete=!0,r.itemComplete(t)},a.copyItemStates=function(t,e){if(!(e" instanceof="" array))return="" void(e.states="t.states);for(var" null},a.getitem="function(t){var" e="this._cache[t];return" e?(e.alias&&(e="this._cache[e.alias]),e):e},a.removeItem=function(t){var" e&&e.complete&&delete="" this._cache[t],e},a.clear="function(){for(var" t="" in="" this._cache){var="" this._cache[t],e.complete||(e.error="new" error("canceled="" manually"),this.flowout(e))}},cc.pipeline="e.exports=o}),{"../platform/js":193,"./loading-items":139}],142:[(function(t,e,i){var" "+i+"="" failed!",o="window.navigator;i=n(i),r.open("GET",i,!0),/msie/i.test(o.userAgent)&&!/opera/i.test(o.userAgent)?(r.setRequestHeader("Accept-Charset","utf-8"),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status?e(null,r.responseText):e({status:r.status,errorMessage:s}))}):(r.overrideMimeType&&r.overrideMimeType("text/plain;" charset="utf-8"),r.onload=function(){4===r.readyState&&(200===r.status||0===r.status?e(null,r.responseText):e({status:r.status,errorMessage:s}))},r.onerror=function(){e({status:r.status,errorMessage:s})}),r.send(null)}}),{"./utils":143}],143:[(function(t,e,i){var" cc.game.config.nocache&&"string"="=typeof" t&&(t+="n.test(t)?"&_t="+(new" date-0):"?_t="+(new Date-0)),t}}}),{}],144:[(function(t,e,i){function n(t){var e=" cc.scene",i="cc.Prefab" ;return="" t&&(t[0]&&t[0].__type__="==e||t[1]&&t[1].__type__===e||t[0]&&t[0].__type__===i)}function" r(t,e,i,n,r,s){var="" o,a,h,l,u,_="n.uuidList,d=e.dependKeys=[];if(r)for(o=[],a=[],h=[],l=0;l<_.length;l++){u=_[l];var" f="n.uuidObjList[l],p=n.uuidPropList[l],m=cc.AssetLibrary._getAssetInfoInRuntime(u);if(m.raw){var" g="m.url;f[p]=g,d.push(g)}else" o.push(f),a.push(p),h.push({type:"uuid",uuid:u,deferredloadraw:!0})}else="" for(o="n.uuidObjList,a=n.uuidPropList,h=new" array(_.length),l="0;l<_.length;l++)u=_[l],h[l]={type:"uuid",uuid:u};if(n.rawProp&&(o.push(i),a.push(n.rawProp),h.push(e.url)),i._preloadRawFiles){var" v="s;s=function(){i._preloadRawFiles((function(t){v(t||null,i)}))}}return" t.flowindeps(e,h,(function(t,e){function="" r(t){var="" l;for(var="" u="" e.map)l="e.map[u],l.uuid&&l.content&&(l.content._uuid=l.uuid);for(var" _="0;_<h.length;_++){var" r.call(v,l);else{var="" y="c.getQueue(l),x=y._callbackTable[f];x?x.unshift(r,v):y.addListener(f,r,v)}}}cc.deserialize.Details.pool.put(n),s(null,i)})))}function" s(t,e,i){var="" n?t="" cc.asset&&t.constructor.preventdeferredloaddependents&&(n="!1):i&&(t" cc.sceneasset||t="" cc.prefab)&&(n="t.asyncLoadAssets),n}function" o(t,e){var="" i;if("string"="=typeof" t.content)try{i="JSON.parse(t.content)}catch(e){return" new="" error("uuid="" loader:="" parse="" asset="" ["+t.id+"]="" failed="" :="" "+e.stack)}else{if("object"!="typeof" t.content)return="" error("json="" input="" item="" doesn't="" contain="" string="" content");i="t.content}var" o,c="n(i);o=c?cc._MissingScript.safeFindClass:function(t){var" e?e:(cc.warnid(4903,t),object)};var="" h,l="cc.deserialize.Details.pool.get();try{h=cc.deserialize(i,l,{classFinder:o,target:t.existingAsset,customEnv:t})}catch(e){cc.deserialize.Details.pool.put(l);var" deserialize="" "+u)}h._uuid="t.uuid;var" c="t("./loading-items");e.exports=o,o.isSceneObj=n}),{"../platform/deserialize":188,"../platform/js":193,"./loading-items":139}],145:[(function(t,e,i){function" n(t,e,i){e?t._removecomponent(e):a.array.removeat(t._components,i)}function="" r(){this._activatingstack="[]}var" s="t("./component-scheduler"),o=t("./platform/CCObject").Flags,a=t("./platform/js"),c=4,h=o.IsPreloadStarted,l=o.IsOnLoadStarted,u=o.IsOnLoadCalled,_=o.Deactivating,d=cc.Class({extends:s.LifeCycleInvoker,add:function(t){this._zero.array.push(t)},remove:function(t){this._zero.fastRemove(t)},cancelInactive:function(t){s.LifeCycleInvoker.stableRemoveInactive(this._zero,t)},invoke:function(){this._invoke(this._zero),this._zero.array.length=0}}),f=s.createInvokeImpl("c.__preload();"),p=s.createInvokeImpl("c.onLoad();c._objFlags|="+u),m=new" a.pool(c);m.get="function(){var" d(f),onload:new="" s.oneoffinvoker(p),onenable:new="" s.oneoffinvoker(s.invokeonenable)};t.preload._zero.i="-1;var" e._zero.i="-1,e._neg.i=-1,e._pos.i=-1,e=t.onEnable,e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,t};var" void="" cc.errorid(3816,t.name);t._activeinhierarchy="!0;for(var" cc.component?this.activatecomp(a,e,i,r):(n(t,a,o),--o,--s)}for(var="" l="t._children[c];l._active&&this._activateNodeRecursively(l,e,i,r)}t._onPostActivated(!0)},_deactivateNodeRecursively:function(t){t._objFlags|=_,t._activeInHierarchy=!1;for(var" void(t._objflags&="~_)}for(var" r="0,s=t._children.length;r<s;++r){var" o="t._children[r];if(o._activeInHierarchy&&(this._deactivateNodeRecursively(o),t._activeInHierarchy))return" t.__preload&&(e?e.add(t):t.__preload())),t._objflags&l||(t._objflags|="l,t.onLoad?i?i.add(t):(t.onLoad(),t._objFlags|=u):t._objFlags|=u),t._enabled){var" n(){this.localpoint="cc.v2(),this.normalImpulse=0,this.tangentImpulse=0}function" r(){}var="" s,o="t("./CCPhysicsTypes").PTM_RATIO,a=t("./CCPhysicsTypes").ContactType,c=[],h=[cc.v2(),cc.v2()];s=new" b2.worldmanifold;var="" l,u="{points:[],separations:[],normal:cc.v2()},_=[new" n,new="" n];l="new" b2.manifold;var="" d="{type:0,localPoint:cc.v2(),localNormal:cc.v2(),points:[]},f={normalImpulses:[],tangentImpulses:[]};r.prototype.init=function(t){this.colliderA=t.GetFixtureA().collider,this.colliderB=t.GetFixtureB().collider,this.disabled=!1,this.disabledOnce=!1,this._impulse=null,this._inverted=!1,this._b2contact=t,t._contact=this},r.prototype.reset=function(){this.colliderA=null,this.colliderB=null,this.disabled=!1,this._impulse=null,this._b2contact._contact=null,this._b2contact=null},r.prototype.getWorldManifold=function(){var" t,e,i="u.points,n=u.separations,r=u.normal;this._b2contact.GetWorldManifold(s);var" r.x="s.normal.x,r.y=s.normal.y,this._inverted&&(r.x*=-1,r.y*=-1),u},r.prototype.getManifold=function(){for(var" t,e,i,n="d.points,r=d.localNormal,s=d.localPoint,a=this._b2contact.GetManifold(),c=a.points,t=n.length=a.pointCount,e=0;e<t;e++){var" s.x="a.localPoint.x*o,s.y=a.localPoint.y*o,r.x=a.localNormal.x,r.y=a.localNormal.y,d.type=a.type,this._inverted&&(r.x*=-1,r.y*=-1),d},r.prototype.getImpulse=function(){var" null;var="" e,i,n="f.normalImpulses,r=f.tangentImpulses;e=t.count;for(var" r.length="n.length=e,f},r.prototype.emit=function(t){var" e;switch(t){case="" a.begin_contact:e="onBeginContact" ;break;case="" a.end_contact:e="onEndContact" a.pre_solve:e="onPreSolve" a.post_solve:e="onPostSolve" }var="" i,n,r,s,o="this.colliderA,c=this.colliderB,h=o.body,l=c.body;if(h.enabledContactListener)for(i=h.node._components,this._inverted=!1,n=0,r=i.length;n<r;n++)s=i[n],s[e]&&s[e](this,o,c);if(l.enabledContactListener)for(i=l.node._components,this._inverted=!0,n=0,r=i.length;n<r;n++)s=i[n],s[e]&&s[e](this,c,o);(this.disabled||this.disabledOnce)&&(this.setEnabled(!1),this.disabledOnce=!1)},r.get=function(t){var" e;return="" cc.physicscontact:c.pop(),e.init(t),e},r.put="function(t){var" p="r.prototype;p.setEnabled=function(t){this._b2contact.SetEnabled(t)},p.isTouching=function(){return" this._b2contact.istouching()},p.settangentspeed="function(t){this._b2contact.SetTangentSpeed(t/o)},p.getTangentSpeed=function(){return" this._b2contact.gettangentspeed()*o},p.setfriction="function(t){this._b2contact.SetFriction(t)},p.getFriction=function(){return" this._b2contact.getfriction()},p.resetfriction="function(){return" this._b2contact.resetfriction()},p.setrestitution="function(t){this._b2contact.SetRestitution(t)},p.getRestitution=function(){return" this._b2contact.getrestitution()},p.resetrestitution="function(){return" this._b2contact.resetrestitution()},r.contacttype="a,cc.PhysicsContact=e.exports=r}),{"./CCPhysicsTypes":148}],147:[(function(t,e,i){var" b2.aabb),c="new" b2.vec2,h="new" b2.vec2,l="cc.Class({mixins:[cc.EventTarget],statics:{DrawBits:b2.Draw,PTM_RATIO:o},ctor:function(){this.__instanceId=cc.ClassManager.getNewInstanceId(),this._debugDrawFlags=0,this._debugDrawer=null,this._world=null,this._bodies=[],this._contactMap={},this._contactID=0,this._delayEvents=[]},pushDelayEvent:function(t,e,i){this._steping?this._delayEvents.push({target:t,func:e,args:i}):t[e].apply(t,i)},update:function(t){var" s?s.collider:null},testaabb:function(t){a.lowerbound.x="t.xMin/o,a.lowerBound.y=t.yMin/o,a.upperBound.x=t.xMax/o,a.upperBound.y=t.yMax/o;var" t.collider}));return="" n},raycast:function(t,e,i){if(t.equals(e))return[];i="i||s.Closest,c.x=t.x/o,c.y=t.y/o,h.x=e.x/o,h.y=e.y/o;var">0){for(var a=n.getPoints(),l=n.getNormals(),u=n.getFractions(),_=[],d=0,f=r.length;d<f;d++){var p="r[d],m=p.collider;if(i===s.AllClosest){var" g="_.find((function(t){return" t.collider="==m}));if(g){u[d]<g.fraction&&(g.fixtureIndex=m._getFixtureIndex(p),g.point.x=a[d].x*o,g.point.y=a[d].y*o,g.normal.x=l[d].x,g.normal.y=l[d].y,g.fraction=u[d]);continue}}_.push({collider:m,fixtureIndex:m._getFixtureIndex(p),point:cc.v2(a[d].x*o,a[d].y*o),normal:cc.v2(l[d]),fraction:u[d]})}return" _}return[]},syncposition:function(){for(var="" t="this._bodies,e=0;e<t.length;e++)t[e].syncPosition()},syncRotation:function(){for(var" i="this._world,n=t.node;i&&n&&(t._b2Body=i.CreateBody(e),t._b2Body.body=t,this._utils.addB2Body(t._b2Body),this._bodies.push(t))},_removeBody:function(t){var" e="this._world;if(e){t._b2Body.body=null,this._utils.removeB2Body(t._b2Body),e.DestroyBody(t._b2Body),t._b2Body=null;var" void="" cc.warn("please="" init="" physicsmanager="" first");if(!this._contactlistener){var="" cc.physicscontactlistener;t.setbegincontact(this._onbegincontact),t.setendcontact(this._onendcontact),t.setpresolve(this._onpresolve),t.setpostsolve(this._onpostsolve),this._world.setcontactlistener(t),this._contactlistener="t,this._aabbQueryCallback=new" cc.physicsaabbquerycallback,this._raycastquerycallback="new" cc.physicsraycastcallback}},_init:function(){this.enabled="!0,this.debugDrawFlags=b2.Draw.e_shapeBit},_getWorld:function(){return" this._world},_syncnode:function(){this._utils.syncnode();for(var="" n="t[e];n.type===r.Animated&&n.resetVelocity()}},_onSceneLaunched:function(){this._debugDrawer.AddDrawerToNode(cc.director.getScene()._sgNode)},_onBeginContact:function(t){var" this._enabled}),(function(t){if(t&&!this._world){var="" b2.world(new="" b2.vec2(0,-10));e.setallowsleeping(!0),this._world="e,this._utils=new" cc.physicsutils,this._initcallback()}this._enabled="t})),cc.js.getset(l.prototype,"debugDrawFlags",(function(){return" this._debugdrawflags}),(function(t){if(t&&!this._debugdrawflags){this._debugdrawer||(this._debugdrawer="new" cc.physicsdebugdraw(o),this._world.setdebugdraw(this._debugdrawer));var="" cc.v2(t.x*o,t.y*o)}return="" cc.v2()}),(function(t){this._world&&this._world.setgravity(new="" b2.vec2(t.x="" o,t.y="" o))})),cc.physicsmanager="e.exports=l}),{"./CCPhysicsTypes":148}],148:[(function(t,e,i){var" s="cc.Enum({Closest:0,Any:1,AllClosest:2,All:3});cc.RayCastType=s,e.exports={BodyType:r,ContactType:n,RayCastType:s,PTM_RATIO:32,ANGLE_TO_PHYSICS_ANGLE:-Math.PI/180,PHYSICS_ANGLE_TO_ANGLE:-180/Math.PI}}),{}],149:[(function(t,e,i){function" n(t){var="" e,i,n,s,c,u,_,d,f,p,m,g,v,y,x,t,b,c,a,s,e,w,i,r,p,o,b="[],D=[];for(D.push(t);D.length;){for(e=D[0],n=e.length,O=!0,i=0;i<n;i++)if(p=i,m=i<n-1?i+1:i+1-n,g=i<n-2?i+2:i+2-n,v=e[p],y=e[m],x=e[g],c=h(v.x,v.y,y.x,y.y,x.x,x.y),c<0){for(O=!1,f=Number.MAX_VALUE,s=0;s<n;s++)s!=p&&s!=m&&(T=s,b=s<n-1?s+1:0,C=e[T],A=e[b],R=r(v.x,v.y,y.x,y.y,C.x,C.y,A.x,A.y),R&&(_=y.x-R.x,d=y.y-R.y,u=_*_+d*d,u<f&&(E=T,S=b,P=R,f=u)));for(f==Number.MAX_VALUE&&l(),w=new" array,i="new" array,t="E,b=S,C=e[T],A=e[b],a(P.x,P.y,A.x,A.y)||w.push(P),a(P.x,P.y,C.x,C.y)||I.push(P),E=-1,S=p;;){if(S==b){(E<0||E">=n)&&l(),o(A.x,A.y,e[E].x,e[E].y,v.x,v.y)||w.push(e[S]);break}w.push(e[S]),E=S,S-1<0?s=n-1:s--}for(w=w.reverse(),e=-1,s=m;;){if(s==t){(e<0||e>=n)&&l(),S!=T||o(C.x,C.y,e[E].x,e[E].y,y.x,y.y)||I.push(e[S]);break}I.push(e[S]),E=S,S+1>n-1?S=0:S++}D.push(w,I),D.shift();break}O&&B.push(D.shift())}return B}function r(t,e,i,n,r,s,a,c){var h,l=r-t,u=s-e,_=i-t,d=n-e,f=a-r,p=c-s,m=d*f-_*p;h=(f*u-p*l)/m;var g=t+h*_,v=e+h*d,y=o(i,n,t,e,g,v),x=o(g,v,r,s,a,c);return y&&x?cc.v2(g,v):null}function s(t,e,i,n,r,s,a,c){var h,l=r-t,u=s-e,_=i-t,d=n-e,f=a-r,p=c-s,m=d*f-_*p;h=(f*u-p*l)/m;var g=t+h*_,v=e+h*d,y=o(g,v,t,e,i,n),x=o(g,v,r,s,a,c);return y&&x?cc.v2(g,v):null}function o(t,e,i,n,r,s){var o=i+.1>=t&&t>=r-.1||i-.1<=t&&t<=r+.1,a=n+.1>=e&&e>=s-.1||n-.1<=e&&e<=s+.1;return o&&a&&c(t,e,i,n,r,s)}function="" a(t,e,i,n){var="" r="i">=t?i-t:t-i,s=n>=e?n-e:e-n;return r<.1&&s<.1}function c(t,e,i,n,r,s){if(r-i="">.1||i-r>.1){var o=(s-n)/(r-i),a=o*(t-i)+n,c=a>e?a-e:e-a;return c<.1}return t-i<.1||i-t<.1}function="" h(t,e,i,n,r,s){return="" t*n+i*s+r*e-e*i-n*r-s*t}function="" l(){throw="" new="" error("a="" problem="" has="" occurred.="" use="" the="" validate()="" method="" to="" see="" where="" is.")}var="" u="function(t){var" e,i,n,r,o,a,c,l="t.length,u=0,_=!1;for(e=0;e<l;e++){for(r=e<l-1?e+1:0,o=e">0?e-1:l-1,c=!1,i=0;i<l;i++)i!=e&&i!=r&&(c||(a=h(t[e].x,t[e].y,t[r].x,t[r].y,t[i].x,t[i].y),a>0&&(c=!0)),i!=o&&(n=i<l-1?i+1:0,s(t[e].x,t[e].y,t[r].x,t[r].y,t[i].x,t[i].y,t[n].x,t[n].y)&&(u=1)));c||(_=!0)}return _&&(u="1==u?3:2),u};i.calcShapes=n,i.validate=u}),{}],150:[(function(t,e,i){var" n="t("./CCPhysicsTypes").PTM_RATIO,r=t("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,s=t("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,o=t("./utils").getWorldRotation,a=t("./CCPhysicsTypes").BodyType,c=new" b2.vec2,h="new" b2.vec2,l="cc.Vec2.ZERO,u=cc.Class({name:"cc.RigidBody",extends:cc.Component,editor:!1,properties:{_type:a.Dynamic,_allowSleep:!0,_gravityScale:1,_linearDamping:0,_angularDamping:0,_linearVelocity:cc.v2(0,0),_angularVelocity:0,_fixedRotation:!1,enabled:{get:function(){return" this._enabled},set:function(){cc.warnid("8200");="" },visible:!1,override:!0},enabledcontactlistener:{default:!1,tooltip:!1},bullet:{default:!1,tooltip:!1},type:{type:a,tooltip:!1,get:function(){return="" this._type},set:function(t){this._type="t,this._b2Body&&(t===a.Animated?this._b2Body.SetType(a.Kinematic):this._b2Body.SetType(t))}},allowSleep:{tooltip:!1,get:function(){return" this._b2body?this._b2body.issleepingallowed():this._allowsleep},set:function(t){this._allowsleep="t,this._b2Body&&this._b2Body.SetAllowSleeping(t)}},gravityScale:{tooltip:!1,get:function(){return" this._gravityscale},set:function(t){this._gravityscale="t,this._b2Body&&this._b2Body.SetGravityScale(t)}},linearDamping:{tooltip:!1,get:function(){return" this._lineardamping},set:function(t){this._lineardamping="t,this._b2Body&&this._b2Body.SetLinearDamping(this._linearDamping)}},angularDamping:{tooltip:!1,get:function(){return" this._angulardamping},set:function(t){this._angulardamping="t,this._b2Body&&this._b2Body.SetAngularDamping(t)}},linearVelocity:{tooltip:!1,type:cc.Vec2,get:function(){var" t="this._linearVelocity;if(this._b2Body){var" e="this._b2Body.GetLinearVelocity();t.x=e.x*n,t.y=e.y*n}return" t},set:function(t){this._linearvelocity="t;var" i="e.m_linearVelocity;i.Set(t.x/n,t.y/n),e.SetLinearVelocity(i)}}},angularVelocity:{tooltip:!1,get:function(){return" this._b2body?this._b2body.getangularvelocity()*s:this._angularvelocity},set:function(t){this._angularvelocity="t,this._b2Body&&this._b2Body.SetAngularVelocity(t*r)}},fixedRotation:{tooltip:!1,get:function(){return" this._fixedrotation},set:function(t){this._fixedrotation="t,this._b2Body&&this._b2Body.SetFixedRotation(t)}},awake:{tooltip:!1,get:function(){return!!this._b2Body&&this._b2Body.IsAwake()},set:function(t){this._b2Body&&this._b2Body.SetAwake(t)}},active:{visible:!1,get:function(){return!!this._b2Body&&this._b2Body.IsActive()},set:function(t){this._b2Body&&this._b2Body.SetActive(t)}}},getLocalPoint:function(t,e){if(e=e||cc.v2(),this._b2Body){c.Set(t.x/n,t.y/n);var" e},getworldpoint:function(t,e){if(e="e||cc.v2(),this._b2Body){c.Set(t.x/n,t.y/n);var" e},getworldvector:function(t,e){if(e="e||cc.v2(),this._b2Body){c.Set(t.x/n,t.y/n);var" e},getlocalvector:function(t,e){if(e="e||cc.v2(),this._b2Body){c.Set(t.x/n,t.y/n);var" e},getworldposition:function(t){if(t="t||cc.v2(),this._b2Body){var" t},getworldrotation:function(){return="" this._b2body?this._b2body.getangle()*s:0},getlocalcenter:function(t){if(t="t||cc.v2(),this._b2Body){var" t},getworldcenter:function(t){if(t="t||cc.v2(),this._b2Body){var" t},getlinearvelocityfromworldpoint:function(t,e){if(e="e||cc.v2(),this._b2Body){c.Set(t.x/n,t.y/n);var" e},getmass:function(){return="" this._b2body?this._b2body.getmass():0},getinertia:function(){return="" this._b2body?this._b2body.getinertia()*n*n:0},getjointlist:function(){if(!this._b2body)return[];var="" t,t="[],e=this._b2Body.GetJointList();if(!e)return[];t.push(e.joint._joint);for(var" t},applyforce:function(t,e,i){this._b2body&&(c.set(t.x="" n,t.y="" n),h.set(e.x="" n,e.y="" n),this._b2body.applyforce(c,h,i))},applyforcetocenter:function(t,e){this._b2body&&(c.set(t.x="" n),this._b2body.applyforcetocenter(c,e))},applytorque:function(t,e){this._b2body&&this._b2body.applytorque(t="" n,e)},applylinearimpulse:function(t,e,i){this._b2body&&(c.set(t.x="" n),this._b2body.applylinearimpulse(c,h,i))},applyangularimpulse:function(t,e){this._b2body&&this._b2body.applyangularimpulse(t="" n,e)},syncposition:function(t){var="" i,r="this.node.convertToWorldSpaceAR(l);if(i=this.type===a.Animated?e.GetLinearVelocity():e.GetPosition(),i.x=r.x/n,i.y=r.y/n,this.type===a.Animated&&t){var" s="e.GetPosition(),o=cc.game.config.frameRate;i.x=(i.x-s.x)*o,i.y=(i.y-s.y)*o,e.SetAwake(!0),e.SetLinearVelocity(i)}else" e.settransform(i,e.getangle())}},syncrotation:function(t){var="" e.settransform(e.getposition(),i)}},resetvelocity:function(){var="" b2.bodydef;this.type="==a.Animated?t.type=a.Kinematic:t.type=this.type,t.allowSleep=this.allowSleep,t.gravityScale=this.gravityScale,t.linearDamping=this.linearDamping,t.angularDamping=this.angularDamping;var" b2.vec2(e.x="" n),t.angularvelocity="this.angularVelocity*r,t.fixedRotation=this.fixedRotation,t.bullet=this.bullet;var" b2.vec2(s.x="" n,s.y="" n),t.angle="-(Math.PI/180)*o(i),cc.director.getPhysicsManager()._addBody(this,t),this._inited=!0}},__destroy:function(){this._inited&&(cc.director.getPhysicsManager()._removeBody(this),this._unregisterNodeEvents(),this._inited=!1)},_getBody:function(){return" this._b2body}});cc.rigidbody="e.exports=u}),{"./CCPhysicsTypes":148,"./utils":171}],151:[(function(t,e,i){var" b2.polygonshape;return="" c.setasbox(r,s,new="" b2.vec2(o,a),0),c}});cc.physicsboxcollider="e.exports=r}),{"../CCPhysicsTypes":148}],152:[(function(t,e,i){var" b2.chainshape,i="this.points,r=[],s=0;s<i.length;s++){var" o="i[s];r.push(new" b2.vec2(o.x="" n*t.x,o.y="" n*t.y))}return="" this.loop?e.createloop(r,r.length):e.createchain(r,r.length),e},resetineditor:!1,resetpointsbycontour:!1});cc.physicschaincollider="e.exports=r}),{"../CCPhysicsTypes":148}],153:[(function(t,e,i){var" b2.circleshape;return="" o.m_radius="this.radius/n*e,o.m_p=new" b2.vec2(r,s),o}});cc.physicscirclecollider="e.exports=r}),{"../CCPhysicsTypes":148}],154:[(function(t,e,i){var" this._density},set:function(t){this._density="t}},sensor:{tooltip:!1,get:function(){return" this._sensor},set:function(t){this._sensor="t}},friction:{tooltip:!1,get:function(){return" this._friction},set:function(t){this._friction="t}},restitution:{tooltip:!1,get:function(){return" this._restitution},set:function(t){this._restitution="t}},body:{default:null,type:cc.RigidBody,visible:!1}},onDisable:function(){this._destroy()},onEnable:function(){this._init()},start:function(){this._init()},_getFixtureIndex:function(t){return" this._fixtures.indexof(t)},_init:function(){cc.director.getphysicsmanager().pushdelayevent(this,"__init",[])},_destroy:function(){cc.director.getphysicsmanager().pushdelayevent(this,"__destroy",[])},__init:function(){if(!this._inited){var="" instanceof="" array||(s="[s]);for(var" l="{categoryBits:o,maskBits:a,groupIndex:0},u=cc.director.getPhysicsManager(),_=0;_<s.length;_++){var" d="s[_],f=new" b2.fixturedef;f.density="this.density,f.isSensor=this.sensor,f.friction=this.friction,f.restitution=this.restitution,f.shape=d,f.filter=l;var" p="e.CreateFixture(f);p.collider=this,t.enabledContactListener&&u._registerContactFixture(p),this._shapes.push(d),this._fixtures.push(p)}this.body=t,this._inited=!0}}}},__destroy:function(){if(this._inited){for(var">=0;n--){var r=t[n];r.collider=null,i._unregisterContactFixture(r),e&&e.DestroyFixture(r)}this.body=null,this._fixtures.length=0,this._shapes.length=0,this._inited=!1}},_createShape:function(){},apply:function(){this._destroy(),this._init()},getAABB:function(){for(var t=1e7,e=t,i=t,r=-t,s=-t,o=this._fixtures,a=0;a<o.length;a++)for(var c="o[a],h=c.GetShape().GetChildCount(),l=0;l<h;l++){var" u="c.GetAABB(l);u.lowerBound.x<e&&(e=u.lowerBound.x),u.lowerBound.y<i&&(i=u.lowerBound.y),u.upperBound.x">r&&(r=u.upperBound.x),u.upperBound.y>s&&(s=u.upperBound.y)}e*=n,i*=n,r*=n,s*=n;var _=this._rect;return _.x=e,_.y=i,_.width=r-e,_.height=s-i,_}});cc.PhysicsCollider=e.exports=s}),{"../CCPhysicsTypes":148,"../utils":171}],155:[(function(t,e,i){var n=t("../CCPhysicsTypes").PTM_RATIO,r=t("../CCPolygonSeprator"),s=cc.Class({name:"cc.PhysicsPolygonCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Polygon],editor:{menu:!1,inspector:!1,requireComponent:cc.RigidBody},_createShape:function(t){var e=[],i=this.points;i.length>0&&i[0].equals(i[i.length-1])&&(i.length-=1);var s=r.validate(i);if(2===s&&(i=i.reverse(),s=r.validate(i)),0===s)for(var o=r.calcShapes(i),a=this.offset,c=0;c<o.length;c++){for(var 0="==this._type?(this._fixtures[0]=t,this._points[0]=e,this._normals[0]=i,this._fractions[0]=n,n):(this._fixtures.push(t),this._points.push(e),this._normals.push(i),this._fractions.push(n),1===this._type?0:this._type" h,l="o[c],u=null,_=[],d=0,f=l.length;d<f;d++){u||(u=new" b2.polygonshape);var="" p="l[d],m=(p.x+a.x)/n*t.x,g=(p.y+a.y)/n*t.y,v=new" b2.vec2(m,g);_.push(v),h||(h="v),_.length===b2.maxPolygonVertices&&(u.Set(_,_.length),e.push(u),u=null,d<f-1&&(_=[h,_[_.length-1]]))}u&&(u.Set(_,_.length),e.push(u))}else" console.log("failed="" to="" create="" convex="" polygon="" :="" "+s);return="" e}});cc.physicspolygoncollider="e.exports=s}),{"../CCPhysicsTypes":148,"../CCPolygonSeprator":149}],156:[(function(t,e,i){window.b2=t("../../../external/box2d/box2d"),t("./CCPhysicsManager"),t("./CCRigidBody"),t("./CCPhysicsContact"),t("./collider/CCPhysicsCollider"),t("./collider/CCPhysicsChainCollider"),t("./collider/CCPhysicsCircleCollider"),t("./collider/CCPhysicsBoxCollider"),t("./collider/CCPhysicsPolygonCollider"),t("./joint/CCJoint"),t("./joint/CCDistanceJoint"),t("./joint/CCRevoluteJoint"),t("./joint/CCMouseJoint"),t("./joint/CCMotorJoint"),t("./joint/CCPrismaticJoint"),t("./joint/CCWeldJoint"),t("./joint/CCWheelJoint"),t("./joint/CCRopeJoint"),t("./platform/CCPhysicsDebugDraw"),t("./platform/CCPhysicsUtils"),t("./platform/CCPhysicsContactListner"),t("./platform/CCPhysicsAABBQueryCallback"),t("./platform/CCPhysicsRayCastCallback")}),{"../../../external/box2d/box2d":310,"./CCPhysicsContact":146,"./CCPhysicsManager":147,"./CCRigidBody":150,"./collider/CCPhysicsBoxCollider":151,"./collider/CCPhysicsChainCollider":152,"./collider/CCPhysicsCircleCollider":153,"./collider/CCPhysicsCollider":154,"./collider/CCPhysicsPolygonCollider":155,"./joint/CCDistanceJoint":157,"./joint/CCJoint":158,"./joint/CCMotorJoint":159,"./joint/CCMouseJoint":160,"./joint/CCPrismaticJoint":161,"./joint/CCRevoluteJoint":162,"./joint/CCRopeJoint":163,"./joint/CCWeldJoint":164,"./joint/CCWheelJoint":165,"./platform/CCPhysicsAABBQueryCallback":166,"./platform/CCPhysicsContactListner":167,"./platform/CCPhysicsDebugDraw":168,"./platform/CCPhysicsRayCastCallback":169,"./platform/CCPhysicsUtils":170}],157:[(function(t,e,i){var" n="t("../CCPhysicsTypes").PTM_RATIO,r=cc.Class({name:"cc.DistanceJoint",extends:cc.Joint,editor:!1,properties:{_distance:1,_frequency:0,_dampingRatio:0,distance:{tooltip:!1,get:function(){return" this._distance},set:function(t){this._distance="t,this._joint&&this._joint.SetLength(t)}},frequency:{tooltip:!1,get:function(){return" this._frequency},set:function(t){this._frequency="t,this._joint&&this._joint.SetFrequency(t)}},dampingRatio:{tooltip:!1,get:function(){return" this._dampingratio},set:function(t){this._dampingratio="t,this._joint&&this._joint.SetDampingRatio(t)}}},_createJointDef:function(){var" t="new" b2.distancejointdef;return="" t.localanchora="new" b2.vec2(this.anchor.x="" n,this.anchor.y="" n),t.localanchorb="new" b2.vec2(this.connectedanchor.x="" n,this.connectedanchor.y="" n),t.length="this.distance/n,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t}});cc.DistanceJoint=e.exports=r}),{"../CCPhysicsTypes":148}],158:[(function(t,e,i){var" cc.v2(t.x*n,t.y*n)}return="" cc.vec2.zero},getworldconnectedanchor:function(){if(this._joint){var="" cc.vec2.zero},getreactionforce:function(t){return="" this._joint?this._joint.getreactionforce(t):0},getreactiontorque:function(t){return="" this._joint?this._joint.getreactiontorque(t):0},_init:function(){cc.director.getphysicsmanager().pushdelayevent(this,"__init",[])},_destroy:function(){cc.director.getphysicsmanager().pushdelayevent(this,"__destroy",[])},__init:function(){if(!this._inited&&(this.body="this.getComponent(cc.RigidBody),this.body&&this.body._getBody()&&this.connectedBody&&this.connectedBody._getBody())){var" null}});cc.joint="e.exports=r}),{"../CCPhysicsTypes":148}],159:[(function(t,e,i){var" this._linearoffset},set:function(t){this._linearoffset="t,this._joint&&this._joint.SetLinearOffset(new" b2.vec2(t.x="" n,t.y="" n))}},angularoffset:{tooltip:!1,get:function(){return="" this._angularoffset},set:function(t){this._angularoffset="t,this._joint&&this._joint.SetAngularOffset(t)}},maxForce:{tooltip:!1,get:function(){return" this._maxforce},set:function(t){this._maxforce="t,this._joint&&this._joint.SetMaxForce(t)}},maxTorque:{tooltip:!1,get:function(){return" this._maxtorque},set:function(t){this._maxtorque="t,this._joint&&this._joint.SetMaxTorque(t)}},correctionFactor:{tooltip:!1,get:function(){return" this._correctionfactor},set:function(t){this._correctionfactor="t,this._joint&&this._joint.SetCorrectionFactor(t)}}},_createJointDef:function(){var" b2.motorjointdef;return="" t.linearoffset="new" b2.vec2(this.linearoffset.x="" n,this.linearoffset.y="" n),t.angularoffset="this.angularOffset*r,t.maxForce=this.maxForce,t.maxTorque=this.maxTorque,t.correctionFactor=this.correctionFactor,t}});cc.MotorJoint=e.exports=s}),{"../CCPhysicsTypes":148}],160:[(function(t,e,i){var" b2.vec2,s="cc.Class({name:"cc.MouseJoint",extends:cc.Joint,editor:!1,properties:{_target:1,_frequency:5,_dampingRatio:.7,_maxForce:0,connectedBody:{default:null,type:cc.RigidBody,visible:!1,override:!0},collideConnected:{default:!0,visible:!1,override:!0},anchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},connectedAnchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},mouseRegion:{tooltip:!1,default:null,type:cc.Node},target:{tooltip:!1,visible:!1,get:function(){return" this._target},set:function(t){this._target="t,this._joint&&(r.x=t.x/n,r.y=t.y/n,this._joint.SetTarget(r))}},frequency:{tooltip:!1,get:function(){return" e="cc.director.getPhysicsManager(),i=t.touch.getLocation(),n=e.testPoint(i);if(n){var" r="this.connectedBody=n.body;r.awake=!0,this.maxForce=1e3*this.connectedBody.getMass(),this.target=i,this._init()}},onTouchMove:function(t){this.target=t.touch.getLocation()},onTouchEnd:function(t){this._destroy()},_createJointDef:function(){var" b2.mousejointdef;return="" r.x="this.target.x/n,r.y=this.target.y/n,t.target=r,t.maxForce=this.maxForce,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t}});cc.MouseJoint=e.exports=s}),{"../CCPhysicsTypes":148}],161:[(function(t,e,i){var" this._maxmotorforce},set:function(t){this._maxmotorforce="t,this._joint&&this._joint.SetMaxMotorForce(t)}},motorSpeed:{tooltip:!1,get:function(){return" this._motorspeed},set:function(t){this._motorspeed="t,this._joint&&this._joint.SetMotorSpeed(t)}}},_createJointDef:function(){var" b2.prismaticjointdef;return="" n),t.localaxisa="new" b2.vec2(this.localaxisa.x,this.localaxisa.y),t.referenceangle="this.referenceAngle*r,t.enableLimit=this.enableLimit,t.lowerTranslation=this.lowerLimit/n,t.upperTranslation=this.upperLimit/n,t.enableMotor=this.enableMotor,t.maxMotorForce=this.maxMotorForce,t.motorSpeed=this.motorSpeed,t}});cc.PrismaticJoint=e.exports=s}),{"../CCPhysicsTypes":148}],162:[(function(t,e,i){var" this._maxmotortorque},set:function(t){this._maxmotortorque="t,this._joint&&this._joint.SetMaxMotorTorque(t)}},motorSpeed:{tooltip:!1,get:function(){return" this._enablelimit},set:function(t){this._enablelimit="t,this._joint&&this._joint.EnableLimit(t)}},enableMotor:{tooltip:!1,get:function(){return" this._enablemotor},set:function(t){this._enablemotor="t,this._joint&&this._joint.EnableMotor(t)}}},getJointAngle:function(){return" this._joint?this._joint.getjointangle()*s:0},_createjointdef:function(){var="" b2.revolutejointdef;return="" n),t.lowerangle="(this.upperAngle+90)*r,t.upperAngle=(this.lowerAngle+90)*r,t.maxMotorTorque=this.maxMotorTorque,t.motorSpeed=this.motorSpeed*r,t.enableLimit=this.enableLimit,t.enableMotor=this.enableMotor,t.referenceAngle=this.referenceAngle*r,t}});cc.RevoluteJoint=e.exports=o}),{"../CCPhysicsTypes":148}],163:[(function(t,e,i){var" this._maxlength},set:function(t){this._maxlength="t,this._joint&&this._joint.SetMaxLength(t)}}},_createJointDef:function(){var" b2.ropejointdef;return="" n),t.maxlength="this.maxLength/n,t}});cc.RopeJoint=e.exports=r}),{"../CCPhysicsTypes":148}],164:[(function(t,e,i){var" b2.weldjointdef;return="" n),t.referenceangle="this.referenceAngle*r,t.frequencyHz=this.frequency,t.dampingRatio=this.dampingRatio,t}});cc.WeldJoint=e.exports=s}),{"../CCPhysicsTypes":148}],165:[(function(t,e,i){var" b2.wheeljointdef;return="" b2.vec2(this.localaxisa.x,this.localaxisa.y),t.maxmotortorque="this.maxMotorTorque,t.motorSpeed=this.motorSpeed*r,t.enableMotor=this.enableMotor,t.dampingRatio=this.dampingRatio,t.frequencyHz=this.frequency,t}});cc.WheelJoint=e.exports=s}),{"../CCPhysicsTypes":148}],166:[(function(t,e,i){function" n(){this._point="new" b2.vec2,this._fixtures="[]}n.prototype.init=function(t){this._point.x=t.x,this._point.y=t.y,this._fixtures.length=0},n.prototype.ReportFixture=function(t){var" this._fixtures.push(t),!1}else="" this._fixtures.push(t);return!0},n.prototype.getfixture="function(){return" this._fixtures[0]},n.prototype.getfixtures="function(){return" this._fixtures},cc.physicsaabbquerycallback="e.exports=n}),{}],167:[(function(t,e,i){function" n(){this._contactfixtures="[]}n.prototype.setBeginContact=function(t){this._BeginContact=t},n.prototype.setEndContact=function(t){this._EndContact=t},n.prototype.setPreSolve=function(t){this._PreSolve=t},n.prototype.setPostSolve=function(t){this._PostSolve=t},n.prototype.BeginContact=function(t){if(this._BeginContact){var" _ccsg.graphicsnode,this._drawer.retain()},getdrawer:function(){return="" this._drawer},adddrawertonode:function(t){this._drawer.removefromparent(),t.addchild(this._drawer)},cleardraw:function(){this._drawer.clear()},_drawpolygon:function(t,e){for(var="" i="this._drawer,r=0;r<e;r++)0===r?i.moveTo(t[r].x*n,t[r].y*n):i.lineTo(t[r].x*n,t[r].y*n);i.close()},DrawPolygon:function(t,e,i){this._applyStrokeColor(i),this._DrawPolygon(t,e),this._drawer.stroke()},DrawSolidPolygon:function(t,e,i){this._applyFillColor(i),this._DrawPolygon(t,e),this._drawer.fill()},_DrawCircle:function(t,e){this._drawer.circle(t.x*n,t.y*n,e*n)},DrawCircle:function(t,e,i){this._applyStrokeColor(i),this._DrawCircle(t,e),this._drawer.stroke()},DrawSolidCircle:function(t,e,i,n){this._applyFillColor(n),this._DrawCircle(t,e),this._drawer.fill()},DrawSegment:function(t,e,i){var" t.x="==e.x&&t.y===e.y?(this._applyFillColor(i),this._DrawCircle(t,2/n),void" r.fill()):(this._applystrokecolor(i),r.moveto(t.x*n,t.y*n),r.lineto(e.x*n,e.y*n),void="" r.stroke())},drawpoint:function(t,e,i){},_applystrokecolor:function(t){this._drawer.setstrokecolor(cc.color(255*t.r,255*t.g,255*t.b,150))},_applyfillcolor:function(t){this._drawer.setfillcolor(cc.color(255*t.r,255*t.g,255*t.b,150))}});cc.physicsdebugdraw="e.exports=r}),{"../CCPhysicsTypes":148}],169:[(function(t,e,i){function" n(){this._type="0,this._fixtures=[],this._points=[],this._normals=[],this._fractions=[]}n.prototype.init=function(t){this._type=t,this._fixtures.length=0,this._points.length=0,this._normals.length=0,this._fractions.length=0},n.prototype.ReportFixture=function(t,e,i,n){return">=2?1:n)},n.prototype.getFixtures=function(){return this._fixtures},n.prototype.getPoints=function(){return this._points},n.prototype.getNormals=function(){return this._normals},n.prototype.getFractions=function(){return this._fractions},cc.PhysicsRayCastCallback=e.exports=n}),{}],170:[(function(t,e,i){function n(){}var r=t("../CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,s=t("../CCPhysicsTypes").PTM_RATIO,o=t("../utils").convertToNodeRotation,a=cc.v2();n.prototype.addB2Body=function(t){},n.prototype.removeB2Body=function(t){},n.prototype.syncNode=function(){for(var t=cc.director.getPhysicsManager()._bodies,e=0,i=t.length;e<i;e++){var n="t[e],c=n.node,h=n._b2Body,l=h.GetPosition();a.x=l.x*s,a.y=l.y*s;var" u="h.GetAngle()*r;null!==c.parent.parent&&(a=c.parent.convertToNodeSpaceAR(a),u=o(c.parent,u));var" _="c._sgNode,d=c._position;d.x=a.x,d.y=a.y,_.setPosition(d),c._rotationX=c._rotationY=u,_.rotation=u}},cc.PhysicsUtils=e.exports=n}),{"../CCPhysicsTypes":148,"../utils":171}],171:[(function(t,e,i){function" n(t){for(var="" e="t.rotationX,i=t.parent;i.parent;)e+=i.rotationX,i=i.parent;return" e}function="" r(t){for(var="" cc.v2(e,i)}function="" s(t,e){e-="t.rotationX;for(var" i="t.parent;i.parent;)e-=i.rotationX,i=i.parent;return" e}e.exports="{getWorldRotation:n,getWorldScale:r,convertToNodeRotation:s}}),{}],172:[(function(t,e,i){function" n(t){return="" t&&(t.constructor="==cc.SceneAsset||t" instanceof="" cc.scene)}var="" r="t("../assets/CCAsset"),s=t("./utils").callInNextTick,o=t("../load-pipeline/CCLoader"),a=t("../load-pipeline/pack-downloader"),c=t("../load-pipeline/auto-release-utils"),h="",l="",u={},_={loadAsset:function(t,e,i){if("string"!=typeof" t)return="" s(e,new="" error("[assetlibrary]="" uuid="" must="" be="" string"),null);var="" loading="" json="" or="" dependencies="" failed:="" "+(i?i.message:"unknown="" error"));else{if(r.constructor="==cc.SceneAsset){var" s="cc.loader._getReferenceKey(t);r.scene.dependAssets=c.getDependsRecursively(s)}if(n(r)){var" a="cc.loader._getReferenceKey(t);o.removeItem(a)}}e&&e(i,r)}))},getImportedDir:function(t){return" h+t.slice(0,2)},_queryassetinfoineditor:function(t,e){},_getassetinfoinruntime:function(t,e){e||(e="{url:null,raw:!1});var" i&&!cc.ischildclassof(i.type,cc.asset)?(e.url="l+i.url,e.raw=!0):e.url=this.getImportedDir(t)+"/"+t+".json",e},_getAssetUrl:function(t){var" e?l+e.url:null},queryassetinfo:function(t,e){var="" +((new="" date).gettime()+math.random()),r="{uuid:i,type:"uuid",content:t,skips:[o.assetLoader.id,o.downloader.id]};o.load(r,(function(t,r){if(t)t=new" "+t.message);else{if(r.constructor="==cc.SceneAsset){var" _._uuidtoasset[t]||null},="" init:function(t){var="" ;for(var="" c="" in="" n){var="" d="" _){var="" f="_[d],p=f[0],m=f[1],g=cc.js._getClassById(m);if(g){if(u[d]={url:c+"/"+p,type:g},"assets"===c&&p.startsWith(s)){if(cc.isChildClassOf(g,r)){var" v="cc.path.extname(p);p=v?p.slice(s.length,-v.length):p.slice(s.length)}else" p="p.slice(s.length);var" y="1===f[2];i.add(p,d,g,!y)}}else" cc.error("cannot="" get",m)}}}t.packedassets&&a.initpacks(t.packedassets);var="" x="t.mountPaths;x||(x={assets:l+"assets",internal:l+"internal"}),cc.url._init(x)}};_._uuidToAsset={},e.exports=cc.AssetLibrary=_}),{"../assets/CCAsset":44,"../load-pipeline/CCLoader":130,"../load-pipeline/auto-release-utils":134,"../load-pipeline/pack-downloader":140,"./utils":198}],173:[(function(t,e,i){function" n(t,e){t.indexof(e)<0&&t.push(e)}function="" r(t,e){n(t.__props__,e)}function="" s(t,e,i,n,s){var="" o="n.default;C.setClassAttr(t,i,"default",o),r(t,i);var" l="a[h];C.attr(t,i,l),l._onAfterProp&&c.push(l._onAfterProp)}for(var" o(t,e,i,n,s){var="" a(t){return"function"="=typeof" t?t():t}function="" c(t,e,i){for(var="" e)t.hasownproperty(n)||i&&!i(n)||object.defineproperty(t,n,x.getpropertydescriptor(e,n))}function="" h(t,e,i,n){var="" r,s,o="n.__ctor__,a=n.ctor,h=n.__ES6__;h?(r=[a],s=a):(r=o?[o]:p(e,i,n),s=f(r,e,t,n),x.value(s,"extend",(function(t){return" t.extends="this,v(t)}),!0)),x.value(s,"__ctors__",r.length">0?r:null,!0);var l=s.prototype;if(e&&(h||(x.extend(s,e),l=s.prototype),x.value(s,"$super",e)),i){for(var u=i.length-1;u>=0;u--){var _=i[u];c(l,_.prototype),c(s,_,(function(t){return _.hasOwnProperty(t)&&!0})),v._isCCClass(_)&&c(C.getClassAttrs(s).constructor.prototype,C.getClassAttrs(_).constructor.prototype)}l.constructor=s}return h||(l.__initProps__=d),x.setClassName(t,s),s}function l(t,e,i,n){var r=cc.Component,s=cc._RF.peek();if(s&&cc.isChildClassOf(e,r)){if(cc.isChildClassOf(s.cls,r))return cc.errorID(3615),null;t=t||s.script}var o=h(t,e,i,n);if(s)if(cc.isChildClassOf(e,r)){var a=s.uuid;a&&x._setClassId(a,o),s.cls=o}else cc.isChildClassOf(s.cls,r)||(s.cls=o);return o}function u(t){var e,i=x.getClassName(t),n=t.constructor,r="new "+i+"(";if(n===cc.Mat3||n===cc.Mat4){var s=t.data;for(e=0;e<s.length;e++)r+=s[e],e<s.length-1&&(r+=",")}else for(e="0;e<n.__props__.length;e++){var" o="n.__props__[e],a=t[o];if("object"==typeof" a)return="" cc.errorid(3641,i),"new="" "+i+"()";r+="a,e<n.__props__.length-1&&(r+=",")}return" r+")"}function="" _(t){return="" json.stringify(t).replace(="" \u2028="" g,"\\u2028").replace(="" \u2029="" g,"\\u2029")}function="" d(t){var="" e="C.getClassAttrs(t),i=t.__props__;null===i&&(I.init(),i=t.__props__);for(var" n="[],r="",s=0;s<i.length;s++){var" in="" e){var="" c;c="P.test(o)?"this."+o+"=":"this["+_(o)+"]=";var" h,l="e[a];if("object"==typeof" l&&l)h="l" instanceof="" cc.valuetype?u(l):array.isarray(l)?"[]":"{}";else="" if("function"="=typeof" l){var="" d="n.length;n.push(l),h="F["+d+"]()"}else" h="string" =="typeof" l?_(l):l;c="c+h+";\n",r+=c}}var" f;f="0===n.length?Function(r):Function("F","return" (function(){\n"+r+"})")(n),t.prototype.__initprops__="f,f.call(this)}function" f(t,e,i,n){var="" r="e&&m(e,n,i),s="",o="CCClass",a="return" function="" "+o+"("+s+"){\n";r&&(a+="this._super=null;\n" ),a+="this.__initProps__(" +o+");\n";var="" c="t.length;if(c">0){var h=!(i&&i.startsWith("cc."));h&&(a+="try{\n");var l="].apply(this,arguments);\n";if(1===c)a+=o+".__ctors__[0"+l;else{a+="var cs="+o+".__ctors__;\n";for(var u=0;u<c;u++)a+="cs["+u+l}h&&(a+="}catch(e){\ncc._throw(e);\n}\n")}return a+="}" ,function(a)()}function="" p(t,e,i){function="" r(t){return="" v._isccclass(t)?t.__ctors__||[]:[t]}for(var="" s="[],o=[t].concat(e),a=0;a<o.length;a++){var" c="o[a];if(c)for(var" h="r(c),l=0;l<h.length;l++)n(s,h[l])}var" u="i.ctor;return" u&&s.push(u),s}function="" m(t,e,i){var="" n="!1;for(var" r="" in="" e)if(!(w.indexof(r)="">=0)){var s=e[r];if("function"==typeof s){var o=x.getPropertyDescriptor(t.prototype,r);if(o){var a=o.value;if("function"==typeof a){O.test(s)&&(n=!0,e[r]=(function(t,e){return function(){var i=this._super;this._super=t;var n=e.apply(this,arguments);return this._super=i,n}})(a,s));continue}}}}return n}function g(t,e,i,n,r,a){if(t.__props__=[],n&&n.__props__&&(t.__props__=n.__props__.slice()),r)for(var c=0;c<r.length;++c){var h="r[c];h.__props__&&(t.__props__=t.__props__.concat(h.__props__.filter((function(e){return" t.__props__.indexof(e)<0}))))}if(i){e.preprocessattrs(i,e,t,a);for(var="" l="" in="" i){var="" u="i[l];"default"in" u?s(t,e,l,u,a):o(t,e,l,u,a)}}}function="" v(t){t="t||{};var" e="t.name,i=t.extends,n=t.mixins,r=l(e,i,n,t);e||(e=cc.js.getClassName(r));var" s="t.properties;"function"==typeof" s||i&&null="==i.__props__||n&&n.some((function(t){return" null="==t.__props__}))?(I.push({cls:r,props:s,mixins:n}),r.__props__=null):g(r,e,s,i,t.mixins,t.__ES6__);var" o="t.statics;if(o){var" a;for(a="" o)r[a]="o[a]}for(var" c="" t)if(!(w.indexof(c)="">=0)){var h=t[c];E.validateMethod(h,c,e,r,i)&&x.value(r.prototype,c,h,!0,!0)}var u=t.editor;return u&&cc.isChildClassOf(i,cc.Component)&&cc.Component._registerEditorProps(r,u),r}function y(t,e,i,n,r){function s(){return c=n+A,a=C.getClassAttrsProto(t)}function o(t,i){if(t in e){var n=e[t];typeof n===i&&((a||s())[c+t]=n)}}var a=null,c="";D.length=0;var h=D,l=e.type;if(l){var u=B[l];if(u)h.push({type:l,_onAfterProp:S(u,"cc."+l)});else if("Object"===l);else if(l===C.ScriptUuid){var _=C.ObjectType(cc.ScriptAsset);_.type="Script",h.push(_)}else"object"==typeof l?T.isEnum(l)&&h.push({type:"Enum",enumList:T.getList(l)}):"function"==typeof l&&(e.url?h.push({type:"Object",ctor:l,_onAfterProp:S("String","cc.String")}):h.push(e._short?{type:"Object",ctor:l}:C.ObjectType(l)))}e.editorOnly&&((a||s())[c+"editorOnly"]=!0),e.url&&((a||s())[c+"saveUrlAsAsset"]=!0),e.serializable===!1&&((a||s())[c+"serializable"]=!1);var d=e.range;return d&&Array.isArray(d)&&d.length>=2&&((a||s())[c+"min"]=d[0],a[c+"max"]=d[1],a[c+"step"]=d[2]),o("min","number"),o("max","number"),o("step","number"),h}var x=t("./js"),T=t("./CCEnum"),b=t("./utils"),C=(b.isPlainEmptyObj_DEV,b.cloneable_DEV,t("./attribute")),A=C.DELIMETER,S=C.getTypeChecker,E=t("./preprocess-class");t("./requiring-frame");var w=["name","extends","mixins","ctor","__ctor__","properties","statics","editor","__ES6__"],I={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout((function(){e.init()}),0)}},init:function(){var t=this.datas;if(t){for(var e=0;e<t.length;++e){var i="t[e],n=i.cls,r=i.props;"function"==typeof" r&&(r="r());var" s="x.getClassName(n);r?g(n,s,r,n.$super,i.mixins):cc.errorID(3633,s)}this.datas=null}}},R=[],P=/^[$A-Za-z_][0-9A-Za-z_$]*$/,O=/xyz/.test((function(){xyz}))?/\b\._super\b/:/.*/;/xyz/.test((function(){xyz}))?/this\._super\s*\(/:/(NONE){99}/;v._isCCClass=function(t){return" t&&t.hasownproperty("__ctors__")},v._fastdefine="function(t,e,i){x.setClassName(t,e);for(var" n="e.__props__=Object.keys(i),r=C.getClassAttrsProto(e),s=0;s<n.length;s++){var" o="n[s];r[o+A+"visible"]=!1,r[o+A+"default"]=i[o]}},v.Attr=C,v.attr=C.attr,cc.isChildClassOf=function(t,e){if(t&&e){if("function"!=typeof" t)return!1;if("function"!="typeof" e)return!1;if(t="==e)return!0;for(;;){if(t=x.getSuper(t),!t)return!1;if(t===e)return!0}}return!1},v.getInheritanceChain=function(t){for(var" e="[];t=x.getSuper(t),t;)t!==Object&&e.push(t);return" e};var="" b="{Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"},D=[];cc.Class=v,e.exports={isArray:function(t){return" t="a(t),Array.isArray(t)},fastDefine:v._fastDefine,getNewValueTypeCode:u,IDENTIFIER_RE:P,escapeForJS:_,getDefault:a}}),{"./CCEnum":175,"./attribute":186,"./js":193,"./preprocess-class":195,"./requiring-frame":196,"./utils":198}],174:[(function(t,e,i){function" n(t){return="" t}function="" r(t,e){var="" i||(i="t[e]={}),i}function" s(t){return="" function(e){return"function"="=typeof" e?t(e):function(i){return="" t(i,e)}}}function="" o(t,e,i){return="" function(t){return="" function(i){return="" e(i,t)}}}function="" a(t){return="" o.bind(null,!1)}function="" c(t,e){return="" r(t,"__ccclassproto__")}function="" h(t){var="" e;try{e="t()}catch(e){return" t}return"object"!="typeof" e||null="==e?e:t}function" l(t,e,i){function="" n(t,e,i){var="" e?(s="t,n):void" n(t,e,i)}function="" u(t,e,i){return="" t((function(t,n){var="" 0!="=i?i:n;r(s,"editor")[e]=o}}),e)}function" _(t){return="" t(n)}function="" d(){for(var="" function(e){var="" f="t("./preprocess-class"),p=t("./js"),m=o.bind(null,!1),g=a("string"),v=a("number"),y=s((function(t,e){var" 0);var="" s})),x="_(s,"executeInEditMode",!0),T=u(m,"requireComponent"),b=_(g,"menu"),C=u(v,"executionOrder"),A=_(s,"disallowMultiple"),S=_(s,"playOnFocus"),E=_(g,"inspector"),w=_(g,"icon"),I=_(g,"help");cc._decorator=e.exports={ccclass:y,property:l,executeInEditMode:x,requireComponent:T,menu:b,executionOrder:C,disallowMultiple:A,playOnFocus:S,inspector:E,icon:w,help:I,mixins:d}}),{"./CCClass":173,"./js":193,"./preprocess-class":195,"./utils":198}],175:[(function(t,e,i){function" n(t){if("__enums__"in="" t)return="" t;r.value(t,"__enums__",null,!0);for(var="" if("number"="=typeof" o)e="o;else" if("string"="=typeof" o&&number.isinteger(parsefloat(s)))continue;var="" a="" +o;s!="=a&&r.value(t,a,s)}return" t}var="" r="t("./js");n.isEnum=function(t){return" t&&t.hasownproperty("__enums__")},n.getlist="function(t){if(t.__enums__)return" t.__enums__;var="" in="" t){var="" e.sort((function(t,e){return="" t.value-e.value})),e};e.exports="cc.Enum=n}),{"./js":193}],176:[(function(t,e,i){cc.ClassManager||t("./_CCClass");var" cc.event.eventkeyboard(t.keycode,!0)),t.stoppropagation(),t.preventdefault()}),!1),cc.game.canvas.addeventlistener("keyup",(function(t){cc.eventmanager.dispatchevent(new="" cc.event.eventkeyboard(t.keycode,!1)),t.stoppropagation(),t.preventdefault()}),!1)},n._registeraccelerometerevent="function(){var" cc.acceleration,e._acceldeviceevent="t.DeviceMotionEvent||t.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(e._accelDeviceEvent=window.DeviceOrientationEvent);var" n,r,s,o="e._acceleration;if(e._accelDeviceEvent===window.DeviceMotionEvent){var" c="o.x;i.orientation===cc.macro.WEB_ORIENTATION_LANDSCAPE_RIGHT?(o.x=-o.y,o.y=c):i.orientation===cc.macro.WEB_ORIENTATION_LANDSCAPE_LEFT?(o.x=o.y,o.y=-c):i.orientation===cc.macro.WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN&&(o.x=-o.x,o.y=-o.y),cc.sys.os===cc.sys.OS_ANDROID&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(o.x=-o.x,o.y=-o.y)}}}),{"./CCInputManager":177,"./_CCClass":185}],177:[(function(t,e,i){var" this._indexbitsused|="1<<i,i;var">r)return this._removeUsedIndexBit(i),delete this._touchesIntegerDict[n.getID()],i;t>>=1}return-1},_removeUsedIndexBit:function(t){if(!(t<0||t>=this._maxTouches)){var e=1<<t;e=~e,this._indexbitsused&=e}},_glview:null,handletouchesbegin:function(t){for(var e,i,n,r,s="[],o=this._touchesIntegerDict,a=cc.sys.now(),c=0,h=t.length;c<h;c++)if(e=t[c],r=e.getID(),i=o[r],null==i){var" l="this._getUnUsedIndex();if(l===-1){cc.logID(2300,l);continue}n=this._touches[l]=new" cc.touch(e._point.x,e._point.y,e.getid()),n._lastmodified="a,n._setPrevPoint(e._prevPoint),o[r]=l,s.push(n)}if(s.length">0){this._glView._convertTouchesWithScale(s);var u=new cc.Event.EventTouch(s);u._eventCode=cc.Event.EventTouch.BEGAN,cc.eventManager.dispatchEvent(u)}},handleTouchesMove:function(t){for(var e,i,n,r=[],s=this._touches,o=cc.sys.now(),a=0,c=t.length;a<c;a++)e=t[a],n=e.getid(),i=this._touchesintegerdict[n],null!=i&&s[i]&&(s[i]._setpoint(e._point),s[i]._setprevpoint(e._prevpoint),s[i]._lastmodified=o,r.push(s[i]));if(r.length>0){this._glView._convertTouchesWithScale(r);var h=new cc.Event.EventTouch(r);h._eventCode=cc.Event.EventTouch.MOVED,cc.eventManager.dispatchEvent(h)}},handleTouchesEnd:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.ENDED,cc.eventManager.dispatchEvent(i)}},handleTouchesCancel:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.CANCELLED,cc.eventManager.dispatchEvent(i)}},getSetOfTouchesEndOrCancel:function(t){for(var e,i,n,r=[],s=this._touches,o=this._touchesIntegerDict,a=0,c=t.length;a<c;a++)e=t[a],n=e.getid(),i=o[n],null!=i&&s[i]&&(s[i]._setpoint(e._point),s[i]._setprevpoint(e._prevpoint),r.push(s[i]),this._removeusedindexbit(i),delete o[n]);return="" r},gethtmlelementposition:function(t){var="" e="document.documentElement,i=window,n=null;return" n="function" =="typeof" t.getboundingclientrect?t.getboundingclientrect():t="" instanceof="" htmlcanvaselement?{left:0,top:0,width:t.width,height:t.height}:{left:0,top:0,width:parseint(t.style.width),height:parseint(t.style.height)},{left:n.left+i.pagexoffset-e.clientleft,top:n.top+i.pageyoffset-e.clienttop,width:n.width,height:n.height}},getpretouch:function(t){for(var="">=0;r--)if(i[r].getID()===n){e=i[r];break}return e||(e=t),e},setPreTouch:function(t){for(var e=!1,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){i[r]=t,e=!0;break}e||(i.length<=50?i.push(t):(i[this._pretouchpoolpointer]=t,this._pretouchpoolpointer=(this._pretouchpoolpointer+1)%50))},gettouchbyxy:function(t,e,i){var n="this._preTouchPoint,r=this._glView.convertToLocationInView(t,e,i),s=new" cc.touch(r.x,r.y);return="" s._setprevpoint(n.x,n.y),n.x="r.x,n.y=r.y,s},getMouseEvent:function(t,e,i){var" r="new" cc.event.eventmouse(i);return="" r.setlocation(t.x,t.y),r._setprevcursor(n.x,n.y),n.x="t.x,n.y=t.y,r},getPointByEvent:function(t,e){return" null!="t.pageX?{x:t.pageX,y:t.pageY}:(e.left-=document.body.scrollLeft,e.top-=document.body.scrollTop,{x:t.clientX,y:t.clientY})},getTouchesByEvent:function(t,e){for(var" i,n,r,s="[],o=this._glView,a=this._preTouchPoint,c=t.changedTouches.length,h=0;h<c;h++)if(i=t.changedTouches[h]){var" l;l="cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?o.convertToLocationInView(i.pageX,i.pageY,e):o.convertToLocationInView(i.clientX,i.clientY,e),null!=i.identifier?(n=new" cc.touch(l.x,l.y,i.identifier),r="this.getPreTouch(n).getLocation(),n._setPrevPoint(r.x,r.y),this.setPreTouch(n)):(n=new" cc.touch(l.x,l.y),n._setprevpoint(a.x,a.y)),a.x="l.x,a.y=l.y,s.push(n)}return" s},registersystemevent:function(t){if(!this._isregisterevent){var="" e="(this._glView=cc.view,this),i="mouse"in" cc.sys.capabilities,n="touches" in="" cc.sys.capabilities,r="!1;if(cc.sys.isMobile&&(r=!0),i&&(!r&&window.addEventListener("mousedown",(function(){e._mousePressed=!0}),!1),!r&&window.addEventListener("mouseup",(function(i){var" cc.rect(r.left,r.top,r.width,r.height),s)){e.handletouchesend([e.gettouchbyxy(s.x,s.y,r)]);var="" o="e.getMouseEvent(s,r,cc.Event.EventMouse.UP);o.setButton(i.button),cc.eventManager.dispatchEvent(o)}}}),!1),!r&&t.addEventListener("mousedown",(function(i){e._mousePressed=!0;var" s="e.getMouseEvent(r,n,cc.Event.EventMouse.DOWN);s.setButton(i.button),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault(),t.focus()}),!1),!r&&t.addEventListener("mouseup",(function(i){e._mousePressed=!1;var" s)!(function(i,n){t.addeventlistener(i,(function(i){var="">this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration))),this._accelCurTime+=t}};cc.inputManager=s,e.exports=s}),{"./CCMacro":178}],178:[(function(t,e,i){t("./_CCClass"),cc._tmp=cc._tmp||{},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.getImageFormatByData=function(t){return t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.ImageFormat.PNG:t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.ImageFormat.TIFF:cc.ImageFormat.UNKNOWN},cc.macro={INVALID_INDEX:-1,NODE_TAG_INVALID:-1,PI:Math.PI,PI2:2*Math.PI,FLT_MAX:parseFloat("3.402823466e+38F"),FLT_MIN:parseFloat("1.175494351e-38F"),RAD:Math.PI/180,DEG:180/Math.PI,UINT_MAX:4294967295,REPEAT_FOREVER:Number.MAX_VALUE-1,FLT_EPSILON:1.192092896e-7,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,LINEAR:9729,BLEND_DST:771,WEB_ORIENTATION_PORTRAIT:0,WEB_ORIENTATION_LANDSCAPE_LEFT:-90,WEB_ORIENTATION_PORTRAIT_UPSIDE_DOWN:180,WEB_ORIENTATION_LANDSCAPE_RIGHT:90,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",VERTEX_ATTRIB_FLAG_NONE:0,VERTEX_ATTRIB_FLAG_POSITION:1,VERTEX_ATTRIB_FLAG_COLOR:2,VERTEX_ATTRIB_FLAG_TEX_COORDS:4,VERTEX_ATTRIB_FLAG_POS_COLOR_TEX:7,GL_ALL:0,VERTEX_ATTRIB_POSITION:0,VERTEX_ATTRIB_COLOR:1,VERTEX_ATTRIB_TEX_COORDS:2,VERTEX_ATTRIB_MAX:3,UNIFORM_PMATRIX:0,UNIFORM_MVMATRIX:1,UNIFORM_MVPMATRIX:2,UNIFORM_TIME:3,UNIFORM_SINTIME:4,UNIFORM_COSTIME:5,UNIFORM_RANDOM01:6,UNIFORM_SAMPLER:7,UNIFORM_MAX:8,SHADER_POSITION_TEXTURECOLOR:"ShaderPositionTextureColor",SHADER_SPRITE_POSITION_TEXTURECOLOR:"ShaderSpritePositionTextureColor",SHADER_POSITION_TEXTURECOLORALPHATEST:"ShaderPositionTextureColorAlphaTest",SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:"ShaderSpritePositionTextureColorAlphaTest",SHADER_POSITION_COLOR:"ShaderPositionColor",SHADER_SPRITE_POSITION_COLOR:"ShaderSpritePositionColor",SHADER_POSITION_TEXTURE:"ShaderPositionTexture",SHADER_POSITION_TEXTURE_UCOLOR:"ShaderPositionTexture_uColor",SHADER_POSITION_TEXTUREA8COLOR:"ShaderPositionTextureA8Color",SHADER_POSITION_UCOLOR:"ShaderPosition_uColor",SHADER_POSITION_LENGTHTEXTURECOLOR:"ShaderPositionLengthTextureColor",UNIFORM_PMATRIX_S:"CC_PMatrix",UNIFORM_MVMATRIX_S:"CC_MVMatrix",UNIFORM_MVPMATRIX_S:"CC_MVPMatrix",UNIFORM_TIME_S:"CC_Time",UNIFORM_SINTIME_S:"CC_SinTime",UNIFORM_COSTIME_S:"CC_CosTime",UNIFORM_RANDOM01_S:"CC_Random01",UNIFORM_SAMPLER_S:"CC_Texture0",UNIFORM_ALPHA_TEST_VALUE_S:"CC_alpha_value",ATTRIBUTE_NAME_COLOR:"a_color",ATTRIBUTE_NAME_POSITION:"a_position",ATTRIBUTE_NAME_TEX_COORD:"a_texCoord",ITEM_SIZE:32,CURRENT_ITEM:3233828865,ZOOM_ACTION_TAG:3233828866,NORMAL_TAG:8801,SELECTED_TAG:8802,DISABLE_TAG:8803,FIX_ARTIFACTS_BY_STRECHING_TEXEL:0,DIRECTOR_STATS_POSITION:cc.p(0,0),DIRECTOR_FPS_INTERVAL:.5,COCOSNODE_RENDER_SUBPIXEL:1,SPRITEBATCHNODE_RENDER_SUBPIXEL:1,AUTO_PREMULTIPLIED_ALPHA_FOR_PNG:0,OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA:0,TEXTURE_ATLAS_USE_TRIANGLE_STRIP:0,TEXTURE_ATLAS_USE_VAO:0,TEXTURE_NPOT_SUPPORT:0,USE_LA88_LABELS:1,SPRITE_DEBUG_DRAW:0,LABELBMFONT_DEBUG_DRAW:0,LABELATLAS_DEBUG_DRAW:0,ENABLE_STACKABLE_ACTIONS:1,ENABLE_GL_STATE_CACHE:1,TOUCH_TIMEOUT:5e3,BATCH_VERTEX_COUNT:2e3,ENABLE_GC_FOR_NATIVE_OBJECTS:!0,ENABLE_TILEDMAP_CULLING:!0,DOWNLOAD_MAX_CONCURRENT:64},cc.defineGetterSetter(cc.macro,"BLEND_SRC",(function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.macro.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?cc.macro.ONE:cc.macro.SRC_ALPHA})),cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.macro.RAD},cc.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.checkGLErrorDebug=function(){if(cc.renderMode===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();t&&cc.logID(2400,t)}},e.exports=cc.macro}),{"./_CCClass":185}],179:[(function(t,e,i){function n(){this._name="",this._objFlags=0}function r(){for(var t=I.length,e=0;e<t;++e){var i="I[e];i._objFlags&c||i._destroyImmediate()}t===I.length?I.length=0:I.splice(0,t)}function" s(t,e){var="" i,n="{};for(i" in="" t)if(t.hasownproperty(i))switch(typeof="" t[i]){case"string":n[i]="" ;break;case"object":case"function":n[i]="null}if(cc.Class._isCCClass(e))for(var" r="cc.Class.Attr.getClassAttrs(e),s=e.__props__,o=0;o<s.length;o++){i=s[o];var" c="i+cc.Class.Attr.DELIMETER+"default";if(c" r)switch(typeof="" r[c]){case"string":n[i]="" 0}}var="" h="t" instanceof="" cc._basenode||t="" cc.component,l="" ;for(i="" n)if(!h||"_id"!="=i){var" u;u="a.IDENTIFIER_RE.test(i)?"o."+i+"=":"o["+a.escapeForJS(i)+"]=";var" _="n[i];""===_&&(_='""'),l+=u+_+";\n"}return" function("o",l)}var="" o="t("./js"),a=t("./CCClass"),c=1,h=4,l=8,u=16,_=32,d=64,f=128,p=256,m=2048,g=4096,v=8192,y=16384,x=32768,T=65536,b=1<<17,C=1<<18,A=1<<19,S=1<<20,E=1<<21,w=~(h|_|f|d|p|v|x|y|T|m|g|b|C|A|S|E);a.fastDefine("cc.Object",n,{_name:"",_objFlags:0}),o.value(n,"Flags",{Destroyed:c,DontSave:l,EditorOnly:u,Dirty:_,DontDestroy:d,PersistentMask:w,Destroying:f,Deactivating:p,IsPreloadStarted:v,IsOnLoadStarted:x,IsOnLoadCalled:y,IsOnEnableCalled:m,IsStartCalled:T,IsEditorOnEnableCalled:g,IsPositionLocked:E,IsRotationLocked:b,IsScaleLocked:C,IsAnchorLocked:A,IsSizeLocked:S});var" this._name}),(function(t){this._name="t})),o.get(R,"isValid",(function(){return!(this._objFlags&c)}));R.destroy=function(){return" this._objflags&c?(cc.warnid(5e3),!1):!(this._objflags&h)&&(this._objflags|="h,I.push(this),!0)},R._destruct=function(){var" t="this.constructor,e=t.__destruct__;e||(e=s(this,t),o.value(t,"__destruct__",e,!0)),e(this)},R._onPreDestroy=null,R._destroyImmediate=function(){return" this._objflags&c?void="" cc.errorid(5e3):(this._onpredestroy&&this._onpredestroy(),this._destruct(),void(this._objflags|="c))},R._deserialize=null,cc.isValid=function(t){return"object"==typeof" t?!(!t||t._objflags&c):"undefined"!="typeof" t},cc.object="e.exports=n}),{"./CCClass":173,"./js":193}],180:[(function(t,e,i){cc.SAXParser=cc._Class.extend({ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new" domparser):(this._issupportdomparser="!1,this._parser=null)},parse:function(t){return" this._parsexml(t)},_parsexml:function(t){var="" e;return="" this._issupportdomparser?e="this._parser.parseFromString(t,"text/xml"):(e=new" activexobject("microsoft.xmldom"),e.async="false" ,e.loadxml(t)),e}}),cc.plistparser="cc.SAXParser.extend({parse:function(t){var" e="this._parseXML(t),i=e.documentElement;if("plist"!==i.tagName)return" cc.warnid(5100),{};for(var="" n="null,r=0,s=i.childNodes.length;r<s&&(n=i.childNodes[r],1!==n.nodeType);r++);return" if("array"="==i)e=this._parseArray(t);else" if("string"="==i)if(1===t.childNodes.length)e=t.firstChild.nodeValue;else{e="";for(var" e},_parsearray:function(t){for(var="" e},_parsedict:function(t){for(var="" s="t.childNodes[n];1===s.nodeType&&("key"===s.tagName?i=s.firstChild.nodeValue:e[i]=this._parseNode(s))}return" e}}),cc.saxparser="new" cc.saxparser,cc.plistparser="new" cc.plistparser}),{}],181:[(function(t,e,i){cc.screen="{_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var" t,e,i,n,r="this._fnMap;for(t=0,e=r.length;t<e;t++)if(i=r[t],i&&i[1]in" document){for(t="0,n=i.length;t<n;t++)this._fn[r[0][t]]=i[t];break}this._supportsFullScreen="undefined"!=typeof" this._fn.requestfullscreen,this._touchevent="ontouchstart" window?"touchstart":"mousedown"},fullscreen:function(){return!!this._supportsfullscreen&&(void="" 0!="=document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement])},requestFullScreen:function(t,e){if(this._supportsFullScreen){if(t=t||document.documentElement,e){var" t[this._fn.requestfullscreen]()}},exitfullscreen:function(){return!this._supportsfullscreen||document[this._fn.exitfullscreen]()},autofullscreen:function(t,e){function="" i(){n.removeeventlistener(r._touchevent,i),r.requestfullscreen(t,e)}t="t||document.body;var" n.language_dutch="du" ,n.language_russian="ru" ,n.language_korean="ko" ,n.language_japanese="ja" ,n.language_hungarian="hu" ,n.language_portuguese="pt" ,n.language_arabic="ar" ,n.language_norwegian="no" ,n.language_polish="pl" ,n.language_turkish="tr" ,n.language_ukrainian="uk" ,n.language_romanian="ro" ,n.language_bulgarian="bg" ,n.language_unknown="unknown" ,n.os_ios="iOS" ,n.os_android="Android" ,n.os_windows="Windows" ,n.os_marmalade="Marmalade" ,n.os_linux="Linux" ,n.os_bada="Bada" ,n.os_blackberry="Blackberry" ,n.os_osx="OS X" ,n.os_wp8="WP8" ,n.os_winrt="WINRT" ,n.os_unknown="Unknown" ,n.unknown="-1,n.WIN32=0,n.LINUX=1,n.MACOS=2,n.ANDROID=3,n.IPHONE=4,n.IPAD=5,n.BLACKBERRY=6,n.NACL=7,n.EMSCRIPTEN=8,n.TIZEN=9,n.WINRT=10,n.WP8=11,n.MOBILE_BROWSER=100,n.DESKTOP_BROWSER=101,n.EDITOR_PAGE=102,n.EDITOR_CORE=103,n.BROWSER_TYPE_WECHAT="wechat",n.BROWSER_TYPE_ANDROID="androidbrowser",n.BROWSER_TYPE_IE="ie",n.BROWSER_TYPE_QQ="qqbrowser",n.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",n.BROWSER_TYPE_UC="ucbrowser",n.BROWSER_TYPE_360="360browser",n.BROWSER_TYPE_BAIDU_APP="baiduboxapp",n.BROWSER_TYPE_BAIDU="baidubrowser",n.BROWSER_TYPE_MAXTHON="maxthon",n.BROWSER_TYPE_OPERA="opera",n.BROWSER_TYPE_OUPENG="oupeng",n.BROWSER_TYPE_MIUI="miuibrowser",n.BROWSER_TYPE_FIREFOX="firefox",n.BROWSER_TYPE_SAFARI="safari",n.BROWSER_TYPE_CHROME="chrome",n.BROWSER_TYPE_LIEBAO="liebao",n.BROWSER_TYPE_QZONE="qzone",n.BROWSER_TYPE_SOUGOU="sogou",n.BROWSER_TYPE_UNKNOWN="unknown",n.isNative=!1,n.isBrowser="object"==typeof" window&&"object"="=typeof" document;var="" l="!1,u=!1,_="",d=0,f=/android" (\d+(?:\.\d+)+)="" i.exec(c)||="" android="" i.exec(s.platform);f&&(l="!0,_=f[1]||"",d=parseInt(_)||0),f=/(iPad|iPhone|iPod).*OS" ((\d+_?){2,3})="" i.exec(c),f?(u="!0,_=f[2]||"",d=parseInt(_)||0):/(iPhone|iPad|iPod)/.exec(s.platform)&&(u=!0,_="",d=0);var" p="n.OS_UNKNOWN;s.appVersion.indexOf("Win")!==-1?p=n.OS_WINDOWS:u?p=n.OS_IOS:s.appVersion.indexOf("Mac")!==-1?p=n.OS_OSX:s.appVersion.indexOf("X11")!==-1&&s.appVersion.indexOf("Linux")===-1?p=n.OS_UNIX:l?p=n.OS_ANDROID:s.appVersion.indexOf("Linux")!==-1&&(p=n.OS_LINUX),n.os=p,n.osVersion=_,n.osMainVersion=d,n.browserType=n.BROWSER_TYPE_UNKNOWN,(function(){var" aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser="" i,e="/qqbrowser|chrome|safari|firefox|trident|opera|opr|oupeng/i,i=t.exec(c);i||(i=e.exec(c));var" aphone"="==r?r=n.BROWSER_TYPE_360:"mxbrowser"===r?r=n.BROWSER_TYPE_MAXTHON:"opr"===r&&(r=n.BROWSER_TYPE_OPERA),n.browserType=r})(),n.browserVersion="",(function(){var" aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui)(mobile)?(browser)?\="" ?([\d.]+)="" m="window.innerWidth||document.documentElement.clientWidth,g=window.innerHeight||document.documentElement.clientHeight,v=window.devicePixelRatio||1;n.windowPixelResolution={width:v*m,height:v*g},n._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw" new="" error("this="" feature="" supports="" webgl="" render="" mode="" only.")};var="" y="document.createElement("canvas"),x=document.createElement("canvas");if(cc.create3DContext=function(t,e,i){if(!i)return" cc.create3dcontext(t,e,"webgl")||cc.create3dcontext(t,e,"experimental-webgl")||cc.create3dcontext(t,e,"webkit-3d")||cc.create3dcontext(t,e,"moz-webgl")||null;try{return="" t.getcontext(i,e)}catch(t){return="" null}},n._supportcanvasnewblendmodes="(function(){var" n.fillstyle="#fff" ,n.fillrect(0,0,1,1),e.drawimage(i,0,0,1,1),0="==e.getImageData(0,0,1,1).data[0]})(),cc.sys.isMobile){var" -moz-user-select:="" none;-webkit-user-select:="" none;-ms-user-select:="" none;-khtml-user-select:="" none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var="" b="n.localStorage=r.localStorage;b.setItem("storage",""),b.removeItem("storage"),b=null}catch(t){var" a="y.toDataURL("image/webp").startsWith("data:image/webp"),S=!!y.getContext("2d"),E=!1;if(r.WebGLRenderingContext&&(cc.create3DContext(document.createElement("CANVAS"))&&(E=!0),E&&n.os===n.OS_IOS&&9===n.osMainVersion&&(r.indexedDB||(E=!1)),E&&n.os===n.OS_ANDROID)){var" w="parseFloat(n.browserVersion);switch(n.browserType){case" n.browser_type_mobile_qq:case="" n.browser_type_baidu:case="" n.browser_type_baidu_app:e="w">=6.2;break;case n.BROWSER_TYPE_ANDROID:n.osMainVersion&&n.osMainVersion>=5&&(E=!0);break;case n.BROWSER_TYPE_CHROME:E=w>=30;break;case n.BROWSER_TYPE_360:case n.BROWSER_TYPE_UC:E=!1}}var I=n.capabilities={canvas:S,opengl:E,webp:A};(void 0!==a.ontouchstart||void 0!==o.ontouchstart||s.msPointerEnabled)&&(I.touches=!0),void 0!==a.onmouseup&&(I.mouse=!0),void 0!==a.onkeyup&&(I.keyboard=!0),(r.DeviceMotionEvent||r.DeviceOrientationEvent)&&(I.accelerometer=!0);var R;!(function(){var t=!1,e=n.browserVersion,i=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);R={ONLY_ONE:!1,WEB_AUDIO:i,DELAY_CREATE_CTX:!1},n.os===n.OS_IOS&&(R.USE_LOADER_EVENT="loadedmetadata"),n.browserType===n.BROWSER_TYPE_FIREFOX&&(R.DELAY_CREATE_CTX=!0,R.USE_LOADER_EVENT="canplay"),n.os===n.OS_ANDROID&&n.browserType===n.BROWSER_TYPE_UC&&(R.ONE_SOURCE=!0),t&&setTimeout((function(){cc.log("browse type: "+n.browserType),cc.log("browse version: "+e),cc.log("MULTI_CHANNEL: "+R.MULTI_CHANNEL),cc.log("WEB_AUDIO: "+R.WEB_AUDIO),cc.log("AUTOPLAY: "+R.AUTOPLAY)}),0)})();try{R.WEB_AUDIO&&(R.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),R.DELAY_CREATE_CTX&&setTimeout((function(){R.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}),0))}catch(t){R.WEB_AUDIO=!1,cc.logID(5201)}var P=[];!(function(){var t=document.createElement("audio");if(t.canPlayType){var e=t.canPlayType('audio/ogg; codecs="vorbis"');e&&P.push(".ogg");var i=t.canPlayType("audio/mpeg");i&&P.push(".mp3");var n=t.canPlayType('audio/wav; codecs="1"');n&&P.push(".wav");var r=t.canPlayType("audio/mp4");r&&P.push(".mp4");var s=t.canPlayType("audio/x-m4a");s&&P.push(".m4a")}})(),R.format=P,n.__audioSupport=R,n.garbageCollect=function(){},n.dumpRoot=function(){},n.restartVM=function(){},n.cleanScript=function(t){},n.isObjectValid=function(t){return!!t},n.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},n.openURL=function(t){window.open(t)},n.now=function(){return Date.now?Date.now():+new Date},e.exports=n}}),{}],183:[(function(t,e,i){var n={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(t){return t&&t!==this.html?t.clientWidth:window.innerWidth},availHeight:function(t){return t&&t!==this.html?t.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(window.navigator.userAgent.indexOf("OS 8_1_")>-1&&(n.adaptationType=cc.sys.BROWSER_TYPE_MIUI),cc.sys.os===cc.sys.OS_IOS&&(n.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),n.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:n.meta["minimal-ui"]="true",n.availWidth=function(t){return t.clientWidth},n.availHeight=function(t){return t.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:n.__defineGetter__("target-densitydpi",(function(){return cc.view._targetDensityDPI}));break;case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:n.availWidth=function(t){return t.clientWidth},n.availHeight=function(t){return t.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:n.init=function(t){if(!t.__resizeWithBrowserSize){var e=function(){t.setDesignResolutionSize(t._designResolutionSize.width,t._designResolutionSize.height,t._resolutionPolicy),window.removeEventListener("resize",e,!1)};window.addEventListener("resize",e,!1)}}}var r=null,s=cc._Class.extend({ctor:function(){var t=this,e=cc.ContainerStrategy,i=cc.ContentStrategy;n.init(this),t._frameSize=cc.size(0,0),t._initFrameSize();var r=cc.game.canvas.width,s=cc.game.canvas.height;t._designResolutionSize=cc.size(r,s),t._originalDesignResolutionSize=cc.size(r,s),t._viewPortRect=cc.rect(0,0,r,s),t._visibleRect=cc.rect(0,0,r,s),t._contentTranslateLeftTop={left:0,top:0},t._autoFullScreen=!1,t._devicePixelRatio=1,t._viewName="Cocos2dHTML5",t._resizeCallback=null,t._orientationChanging=!0,t._resizing=!1,t._scaleX=1,t._originalScaleX=1,t._scaleY=1,t._originalScaleY=1,t._isRotated=!1,t._orientation=3;var o=cc.sys;t.enableRetina(o.os===o.OS_IOS||o.os===o.OS_OSX),cc.visibleRect&&cc.visibleRect.init(t._visibleRect),t._resolutionPolicy=null,t._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.EXACT_FIT),t._rpShowAll=new cc.ResolutionPolicy(e.PROPORTION_TO_FRAME,i.SHOW_ALL),t._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.NO_BORDER),t._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_HEIGHT),t._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_WIDTH),t._initialized=!1,t._contentTranslateLeftTop=null,t._frameZoomFactor=1,t.__resizeWithBrowserSize=!1,t._isAdjustViewPort=!0,t._targetDensityDPI=cc.macro.DENSITYDPI_HIGH,t.enableAntiAlias(!0)},_resizeEvent:function(){var t;t=this.setDesignResolutionSize?this:cc.view;var e=t._frameSize.width,i=t._frameSize.height,n=t._isRotated;if(cc.sys.isMobile){var r=cc.game.container.style,s=r.margin;r.margin="0",r.display="none",t._initFrameSize(),r.margin=s,r.display="block"}else t._initFrameSize();if(t._isRotated!==n||t._frameSize.width!==e||t._frameSize.height!==i){var o=t._originalDesignResolutionSize.width,a=t._originalDesignResolutionSize.height;t._resizing=!0,o>0&&t.setDesignResolutionSize(o,a,t._resolutionPolicy),t._resizing=!1,cc.eventManager.dispatchCustomEvent("canvas-resize"),t._resizeCallback&&t._resizeCallback.call()}},_orientationChange:function(){cc.view._orientationChanging=!0,cc.view._resizeEvent()},setTargetDensityDPI:function(t){this._targetDensityDPI=t,this._adjustViewportMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(t){t?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent),window.addEventListener("orientationchange",this._orientationChange)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._orientationChange))},setResizeCallback:function(t){"function"!=typeof t&&null!=t||(this._resizeCallback=t)},setOrientation:function(t){if(t&=cc.macro.ORIENTATION_AUTO,t&&this._orientation!==t){this._orientation=t;var e=this._originalDesignResolutionSize.width,i=this._originalDesignResolutionSize.height;this.setDesignResolutionSize(e,i,this._resolutionPolicy)}},_initFrameSize:function(){var t=this._frameSize,e=n.availWidth(cc.game.frame),i=n.availHeight(cc.game.frame),r=e>=i;!cc.sys.isMobile||r&&this._orientation&cc.macro.ORIENTATION_LANDSCAPE||!r&&this._orientation&cc.macro.ORIENTATION_PORTRAIT?(t.width=e,t.height=i,cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",this._isRotated=!1):(t.width=i,t.height=e,cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)",cc.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0),this._orientationChanging&&setTimeout((function(){cc.view._orientationChanging=!1}),1e3)},_adjustSizeKeepCanvasSize:function(){var t=this._originalDesignResolutionSize.width,e=this._originalDesignResolutionSize.height;t>0&&this.setDesignResolutionSize(t,e,this._resolutionPolicy)},_setViewportMeta:function(t,e){var i=document.getElementById("cocosMetaElement");i&&e&&document.head.removeChild(i);var n,r,s,o=document.getElementsByName("viewport"),a=o?o[0]:null;n=a?a.content:"",i=i||document.createElement("meta"),i.id="cocosMetaElement",i.name="viewport",i.content="";for(r in t)n.indexOf(r)==-1?n+=","+r+"="+t[r]:e&&(s=new RegExp(r+"s*=s*[^,]+"),n.replace(s,r+"="+t[r]));/^,/.test(n)&&(n=n.substr(1)),i.content=n,a&&(a.content=n),document.head.appendChild(i)},_adjustViewportMeta:function(){this._isAdjustViewPort&&(this._setViewportMeta(n.meta,!1),this._isAdjustViewPort=!1)},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(t){this._isAdjustViewPort=t},enableRetina:function(t){this._retinaEnabled=!!t},isRetinaEnabled:function(){return this._retinaEnabled},enableAntiAlias:function(t){if(this._antiAliasEnabled!==t)if(this._antiAliasEnabled=t,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var e=cc.loader._cache;for(var i in e){var n=e[i],r=n&&n.content instanceof cc.Texture2D?n.content:null;r&&(t?r.setAntiAliasTexParameters():r.setAliasTexParameters())}}else if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var s=cc._canvas.getContext("2d");s.imageSmoothingEnabled=t,s.mozImageSmoothingEnabled=t;var o=cc.rendererCanvas._dirtyRegion;if(o){var a=new cc.Region;a.setTo(0,0,cc.visibleRect.width,cc.visibleRect.height),o.addRegion(a)}}},isAntiAliasEnabled:function(){return this._antiAliasEnabled},enableAutoFullScreen:function(t){t&&t!==this._autoFullScreen&&cc.sys.isMobile&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_WECHAT?(this._autoFullScreen=!0,cc.screen.autoFullScreen(cc.game.frame)):this._autoFullScreen=!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},isViewReady:function(){return cc.game.canvas&&cc._renderContext},setFrameZoomFactor:function(t){this._frameZoomFactor=t,cc.director.setProjection(cc.director.getProjection())},setContentTranslateLeftTop:function(t,e){this._contentTranslateLeftTop={left:t,top:e}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},setCanvasSize:function(t,e){var i=cc.game.canvas,n=cc.game.container;i.width=t*this._devicePixelRatio,i.height=e*this._devicePixelRatio,i.style.width=t+"px",i.style.height=e+"px",n.style.width=t+"px",n.style.height=e+"px",this._resizeEvent()},getCanvasSize:function(){return cc.size(cc.game.canvas.width,cc.game.canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(t,e){this._frameSize.width=t,this._frameSize.height=e,cc.game.frame.style.width=t+"px",cc.game.frame.style.height=e+"px",this._resizeEvent(),cc.director.setProjection(cc.director.getProjection())},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.p(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(t){var e=this;if(t instanceof cc.ResolutionPolicy)e._resolutionPolicy=t;else{var i=cc.ResolutionPolicy;t===i.EXACT_FIT&&(e._resolutionPolicy=e._rpExactFit),t===i.SHOW_ALL&&(e._resolutionPolicy=e._rpShowAll),t===i.NO_BORDER&&(e._resolutionPolicy=e._rpNoBorder),t===i.FIXED_HEIGHT&&(e._resolutionPolicy=e._rpFixedHeight),t===i.FIXED_WIDTH&&(e._resolutionPolicy=e._rpFixedWidth)}},setDesignResolutionSize:function(t,e,i){if(!(t>0||e>0))return void cc.logID(2200);this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(n&&n.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._orientationChanging=!0,this._resizing||this._initFrameSize(),!n)return void cc.logID(2201);this._originalDesignResolutionSize.width=this._designResolutionSize.width=t,this._originalDesignResolutionSize.height=this._designResolutionSize.height=e;var r=n.apply(this,this._designResolutionSize);if(r.scale&&2===r.scale.length&&(this._scaleX=r.scale[0],this._scaleY=r.scale[1]),r.viewport){var s=this._viewPortRect,o=this._visibleRect,a=r.viewport;s.x=a.x,s.y=a.y,s.width=a.width,s.height=a.height,o.x=-s.x/this._scaleX,o.y=-s.y/this._scaleY,o.width=cc.game.canvas.width/this._scaleX,o.height=cc.game.canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(s.x,-s.y)}var c=cc.director;c._winSizeInPoints.width=this._designResolutionSize.width,c._winSizeInPoints.height=this._designResolutionSize.height,n.postApply(this),cc.winSize.width=c._winSizeInPoints.width,cc.winSize.height=c._winSizeInPoints.height,cc._renderType===cc.game.RENDER_TYPE_WEBGL?c.setGLDefaultValues():cc._renderType===cc.game.RENDER_TYPE_CANVAS&&(cc.renderer._allNeedDraw=!0),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(t,e,i){this._setViewportMeta({width:t},!0),document.documentElement.style.width=t+"px",document.body.style.width=t+"px",document.body.style.left="0px",document.body.style.top="0px",this.setDesignResolutionSize(t,e,i)},setViewPortInPoints:function(t,e,i,n){var r=this._frameZoomFactor,s=this._scaleX,o=this._scaleY;cc._renderContext.viewport(t*s*r+this._viewPortRect.x*r,e*o*r+this._viewPortRect.y*r,i*s*r,n*o*r)},setScissorInPoints:function(t,e,i,n){var s=this._frameZoomFactor,o=this._scaleX,a=this._scaleY,c=Math.ceil(t*o*s+this._viewPortRect.x*s),h=Math.ceil(e*a*s+this._viewPortRect.y*s),l=Math.ceil(i*o*s),u=Math.ceil(n*a*s);if(!r){var _=gl.getParameter(gl.SCISSOR_BOX);r=cc.rect(_[0],_[1],_[2],_[3])}r.x===c&&r.y===h&&r.width===l&&r.height===u||(r.x=c,r.y=h,r.width=l,r.height=u,cc._renderContext.scissor(c,h,l,u))},isScissorEnabled:function(){return cc._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!r){var t=gl.getParameter(gl.SCISSOR_BOX);r=cc.rect(t[0],t[1],t[2],t[3])}var e=1/this._scaleX,i=1/this._scaleY;return cc.rect((r.x-this._viewPortRect.x)*e,(r.y-this._viewPortRect.y)*i,r.width*e,r.height*i)},setViewName:function(t){null!=t&&t.length>0&&(this._viewName=t)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(t,e,i){var n=this._devicePixelRatio*(t-i.left),r=this._devicePixelRatio*(i.top+i.height-e);return this._isRotated?{x:this._viewPortRect.width-r,y:n}:{x:n,y:r}},_convertMouseToLocationInView:function(t,e){var i=this._viewPortRect,n=this;t.x=(n._devicePixelRatio*(t.x-e.left)-i.x)/n._scaleX,t.y=(n._devicePixelRatio*(e.top+e.height-t.y)-i.y)/n._scaleY},_convertPointWithScale:function(t){var e=this._viewPortRect;t.x=(t.x-e.x)/this._scaleX,t.y=(t.y-e.y)/this._scaleY},_convertTouchesWithScale:function(t){for(var e,i,n,r=this._viewPortRect,s=this._scaleX,o=this._scaleY,a=0;a<t.length;a++)e=t[a],i=e._point,n=e._prevpoint,i.x=(i.x-r.x) 0="" s,i.y="(i.y-r.y)/o,n.x=(n.x-r.x)/s,n.y=(n.y-r.y)/o}});s._getInstance=function(){return" this._instance||(this._instance="this._instance||new" s,this._instance.initialize()),this._instance},cc.containerstrategy="cc._Class.extend({preApply:function(t){},apply:function(t,e){},postApply:function(t){},_setupContainer:function(t,e,i){var" n="cc.game.canvas,r=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(t._isRotated?i:e)+"px",document.body.style.height=(t._isRotated?e:i)+"px"),r.style.width=n.style.width=e+"px",r.style.height=n.style.height=i+"px";var" s="t._devicePixelRatio=1;t.isRetinaEnabled()&&(s=t._devicePixelRatio=Math.min(2,window.devicePixelRatio||1)),n.width=e*s,n.height=i*s,cc._renderContext.resetCache&&cc._renderContext.resetCache()},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var" t="document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden";var" e="cc.container.style;e.position="fixed",e.left=e.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc._Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(t,e,i,n,r,s){Math.abs(t-i)<2&&(i=t),Math.abs(e-n)<2&&(n=e);var" o="cc.rect(Math.round((t-i)/2),Math.round((e-n)/2),i,n);return" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS,this._result.scale=[r,s],this._result.viewport=o,this._result},preApply:function(t){},apply:function(t,e){return{scale:[1,1]}},postApply:function(t){}}),(function(){var" "+e+"px":i.margin="0px" }}),e="cc.ContainerStrategy.extend({apply:function(t,e){var" i,n,r="t._frameSize.width,s=t._frameSize.height,o=cc.container.style,a=e.width,c=e.height,h=r/a,l=s/c;h<l?(i=r,n=c*h):(i=a*l,n=s);var" u="Math.round((r-i)/2),_=Math.round((s-n)/2);i=r-2*u,n=s-2*_,this._setupContainer(t,i,n),t._isRotated?o.margin="0" "+s+"px":o.margin="0px" ,o.paddingleft="u+"px",o.paddingRight=u+"px",o.paddingTop=_+"px",o.paddingBottom=_+"px"}}),i=(t.extend({preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t){this._super(t),this._fixContainer()}}),e.extend({preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t,e){this._super(t,e),this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(t){this._setupContainer(t,cc.game.canvas.width,cc.game.canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=new" t,cc.containerstrategy.proportion_to_frame="new" e,cc.containerstrategy.original_container="new" i;var="" i="cc.game.canvas.width,n=cc.game.canvas.height,r=i/e.width,s=n/e.height;return" this._buildresult(i,n,i,n,r,s)}}),r="cc.ContentStrategy.extend({apply:function(t,e){var" c<h?(l="c,i=r,n=a*l):(l=h,i=o*l,n=s),this._buildResult(r,s,i,n,l,l)}}),s=cc.ContentStrategy.extend({apply:function(t,e){var" i,n,r,s="cc.game.canvas.width,o=cc.game.canvas.height,a=e.width,c=e.height,h=s/a,l=o/c;return" h<l?(i="l,n=a*i,r=o):(i=h,n=s,r=c*i),this._buildResult(s,o,n,r,i,i)}}),o=cc.ContentStrategy.extend({apply:function(t,e){var" this._buildresult(i,n,o,a,s,s)},postapply:function(t){cc.director._winsizeinpoints="t.getVisibleSize()}}),a=cc.ContentStrategy.extend({apply:function(t,e){var" n,cc.contentstrategy.show_all="new" r,cc.contentstrategy.no_border="new" s,cc.contentstrategy.fixed_height="new" o,cc.contentstrategy.fixed_width="new" a})(),cc.resolutionpolicy="cc._Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(t,e){this.setContainerStrategy(t),this.setContentStrategy(e)},preApply:function(t){this._containerStrategy.preApply(t),this._contentStrategy.preApply(t)},apply:function(t,e){return" this._containerstrategy.apply(t,e),this._contentstrategy.apply(t,e)},postapply:function(t){this._containerstrategy.postapply(t),this._contentstrategy.postapply(t)},setcontainerstrategy:function(t){t="" instanceof="" cc.containerstrategy&&(this._containerstrategy="t)},setContentStrategy:function(t){t" cc.contentstrategy&&(this._contentstrategy="t)}}),cc.js.get(cc.ResolutionPolicy.prototype,"canvasSize",(function(){return" cc.v2(cc.game.canvas.width,cc.game.canvas.height)})),cc.resolutionpolicy.exact_fit="0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,e.exports=s}),{}],184:[(function(t,e,i){cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var" this.id++},getnewinstanceid:function(){return="" this.instanceid++}},r="/\b_super\b/,s=function(){};s.extend=function(t){var" e,i="this.prototype,o=Object.create(i),a={writable:!0,enumerable:!1,configurable:!0};if(cc.game&&cc.game.config&&cc.game.config[cc.game.CONFIG_KEY.exposeClassName]){var" c="return (function " +(t._classname||"class")+"(arg0,arg1,arg2,arg3,arg4)="" {\nthis.__instanceid="cc.ClassManager.getNewInstanceId();\nif" (this.ctor)="" {\nswitch="" (arguments.length)="" {\ncase="" 0:="" this.ctor();="" break;\ncase="" 1:="" this.ctor(arg0);="" 2:="" this.ctor(arg0,arg1);="" 3:="" this.ctor(arg0,arg1,arg2);="" 4:="" this.ctor(arg0,arg1,arg2,arg3);="" 5:="" this.ctor(arg0,arg1,arg2,arg3,arg4);="" break;\ndefault:="" this.ctor.apply(this,="" arguments);\n}\n}\n});";e="Function(c)()}else" 0:this.ctor();break;case="" 1:this.ctor(t);break;case="" 2:this.ctor(t,e);break;case="" 3:this.ctor(t,e,i);break;case="" 4:this.ctor(t,e,i,r);break;case="" 5:this.ctor(t,e,i,r,s);break;default:this.ctor.apply(this,arguments)}};a.value="n.getNewID(),Object.defineProperty(o,"__pid",a),e.prototype=o,a.value=e,Object.defineProperty(o,"constructor",a);for(var" h="" in="" t){var="" l="function" =="typeof" t[h],u="l&&"function"==typeof" i[h],_="u&&r.test(t[h]);_?(a.value=(function(t,e){return" function(){var="" r="e.apply(this,arguments);return" this._super="n,r}})(h,t[h]),Object.defineProperty(o,h,a)):l?(a.value=t[h],Object.defineProperty(o,h,a)):o[h]=t[h]}return" e.extend="s.extend,e.implement=function(t){for(var" t)o[e]="t[e]},e},cc.defineGetterSetter=function(t,e,i,n,r,s){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw" new="" error("browser="" does="" not="" support="" getters");var="" t.constructor:{};for(var="" n||!n||n="" _ccsg.node||n="" htmlelement?e[i]="n:e[i]=cc.clone(n)}return" e},cc._class="e.exports=s}),{}],186:[(function(t,e,i){function" n(t,e,i){var="" n;n="function(){},i&&u.extend(n,i.constructor);var" n;return="" u.value(t,"__attrs__",r),r}function="" r(t){for(var="">=0;r--){var s=i[r],o=s.hasOwnProperty("__attrs__")&&s.__attrs__;o||(e=i[r+1],n(s,s,e&&e.__attrs__))}return e=i[0],n(t,t,e&&e.__attrs__),t.__attrs__}function s(t,e,i){var r,s,a;if("function"==typeof t)r=o(t),s=r.constructor.prototype;else{var c=t;if(r=c.__attrs__,!r){t=c.constructor;var h=o(t);r=n(c,t,h)}s=r}if("undefined"==typeof i){var l=e+_,u={};for(a in r)a.startsWith(l)&&(u[a.slice(l.length)]=r[a]);return u}if("object"==typeof i)for(a in i)95!==a.charCodeAt(0)&&(s[e+_+a]=i[a])}function o(t){return t.hasOwnProperty("__attrs__")&&t.__attrs__||r(t)}function a(t){return o(t).constructor.prototype}function c(t,e,i,n){var r=a(t);r[e+_+i]=n}function h(t,e){}function l(t){return{type:"Object",ctor:t,_onAfterProp:!1}}var u=t("./js"),_=(t("./utils").isPlainEmptyObj_DEV,"$_$");cc.Integer="Integer",cc.Float="Float",cc.Boolean="Boolean",cc.String="String",e.exports={attr:s,getClassAttrs:o,getClassAttrsProto:a,setClassAttr:c,DELIMETER:_,getTypeChecker:h,ObjectType:l,ScriptUuid:{}}}),{"./CCClass":173,"./js":193,"./utils":198}],187:[(function(t,e,i){var n=t("./js"),r=function(){this._callbackTable={},this._invoking={},this._toRemove={},this._toRemoveAll=null},s={};r.REMOVE_PLACEHOLDER=s,r.prototype._clearToRemove=function(t){var e=this._callbackTable[t];if(this._toRemove[t]&&e){for(var i=e.indexOf(s),n=i,r=i+1;r<e.length;++r){var o="e[r];o!==s&&(e[n]=o,++n)}e.length=n,this._toRemove[t]=!1}this._toRemoveAll&&(this.removeAll(this._toRemoveAll),this._toRemoveAll=null)},r.prototype.add=function(t,e,i){var" n="this._callbackTable[t];return"undefined"!=typeof" n?("object"="=typeof" i?n.push(e,i):n.push(e),!1):(n="object" =="typeof" i?[e,i]:[e],this._callbacktable[t]="n,!0)},r.prototype.has=function(t,e,i){if(this._toRemoveAll===t)return!1;var" n,r,o="this._callbackTable[t];if(!o)return!1;if(!e){if(this._toRemove[t]){for(r=0;r<o.length;r++)if(o[r]!==s)return!0;return!1}return" o.length="">0}if("function"!=typeof e)return!1;for(r=o.indexOf(e);r!==-1;){if(n=o[r+1],"object"!=typeof n&&(n=void 0),n===i)return!0;r=cc.js.array.indexOf.call(o,e,r+1)}return!1},r.prototype.removeAll=function(t){if(this._invoking[t])return void(this._toRemoveAll=t);if("object"==typeof t){var e,i,n,r=t;for(t in this._callbackTable)for(e=this._callbackTable[t],i=e.lastIndexOf(r);i!==-1;)n=e[i-1],"function"==typeof n?e.splice(i-1,2):e.splice(i,1),i=e.lastIndexOf(r)}else delete this._callbackTable[t],delete this._toRemove[t]},r.prototype.remove=function(t,e,i){var n,r,o=this._callbackTable[t];if(o){for(n=o.indexOf(e);n!==-1;){if(r=o[n+1],"object"!=typeof r&&(r=void 0),r===i){this._invoking[t]?(o[n]=s,r&&(o[n+1]=s),this._toRemove[t]=!0):o.splice(n,r?2:1);break}n=cc.js.array.indexOf.call(o,e,n+1)}return!0}return!1};var o=function(){r.call(this)};n.extend(o,r),o.prototype.invoke=function(t,e,i,n,r,o){this._invoking[t]=!0;var a=this._callbackTable[t];if(a){var c,h=a.length-1;for(c=0;c<=h;){var l="a[c],u=1;if(l!==s){var" _="a[c+1],d=_&&"object"==typeof" _;d?(l.call(_,e,i,n,r,o),u="2):l(e,i,n,r,o)}c+=u}}this._invoking[t]=!1,this._clearToRemove(t)},o.prototype.invokeAndRemove=function(t,e,i,n,r,o){this._invoking[t]=!0;var" a,c,h,l,u,_="this._callbackTable[t];if(_)for(a=0,c=_.length;a<c;)l=_[a],h=1,l!==s&&(u=_[a+1],u&&"object"==typeof" u?(l.call(u,e,i,n,r,o),h="2):l(e,i,n,r,o)),a+=h;this._invoking[t]=!1,this._toRemove[t]=!1,this.removeAll(t)},o.prototype.bindKey=function(t,e){var" i="this;return" function(n,r,s,o,a){var="" c,h,l,u="i._callbackTable[t];if(u)for(c=0,h=u.length;c<h;)l=u[c+1],l&&"object"==typeof" l?(u[c].call(l,n,r,s,o,a),c+="2):(u[c](n,r,s,o,a),++c);e&&i.removeAll(t)}},o.CallbacksHandler=r,e.exports=o}),{"./js":193}],188:[(function(t,e,i){var" n="t("./js"),r=(t("./CCObject"),t("./attribute")),s=t("./CCClass"),o=function(){this.uuidList=[]," this.uuidobjlist="[],this.uuidPropList=[],this.rawProp=""};o.prototype.reset=function(){this.uuidList.length=0,this.uuidObjList.length=0,this.uuidPropList.length=0,this.rawProp=""},o.prototype.getUuidOf=function(t,e){for(var" this.uuidlist[i];return""},o.prototype.push="function(t,e,i){this.uuidList.push(i),this.uuidObjList.push(t),this.uuidPropList.push(e)},o.pool=new" n.pool(function(t){t.reset()},10),o.pool.get="function(){return" this._get()||new="" o};var="" a="(function(){function" t(t,e,i,n,r){this.result="t,this.customEnv=n,this.deserializedList=[],this.deserializedData=null,this._classFinder=i,this._idList=[],this._idObjList=[],this._idPropList=[]}function" e(t){var="" e,i,n,r="t.deserializedList,s=t._idPropList,o=t._idList,a=t._idObjList;t._classFinder&&t._classFinder.onDereferenced;for(e=0;e<o.length;e++)i=s[e],n=o[e],a[e][i]=r[n]}function" i(t,e){for(var="" prop;"],u="0;u<h.length;u++){var" _,d="h[u],f=c[d+i];if(f)_=s.IDENTIFIER_RE.test(d)?'"'+d+'"':s.escapeForJS(d),l.push('if(s.result.rawProp)\ncc.error("not" support="" multi="" raw="" object="" in="" file");'),l.push("s.result.rawprop="+_+" ;");else{if(c[d+o]="==!1)continue;var" p;s.identifier_re.test(d)?(_=""" +d+'"',p="." +d):(_="s.escapeForJS(d),p="["+_+"]"),l.push("prop=d"+p+";"),l.push('if(typeof" prop!="="undefined"){'),l.push('if(typeof" m="s.getDefault(c[d+a]);if(m" instanceof="" cc.valuetype){var="" g="n.getClassName(m);l.push("s._deserializeTypedObject(o"+p+",prop,"+g+");")}else" l.push("s._deserializeobjfield(o,prop,"+_+");");l.push("}else="" o"+p+"="null;}}")}}return"_$erialized"===h[h.length-1]&&(l.push("o._$erialized=JSON.parse(JSON.stringify(d));"),l.push("s._deserializePrimitiveObject(o._$erialized,d);")),Function("s","o","d","k","t",l.join(""))}function" o(t,e,r,s,o){var="" a.deserialize="function(t){if(Array.isArray(t)){var" r="0;r<n;r++)if(i[r]){this.deserializedList[r]=this._deserializeObject(i[r])}this.deserializedData=n">0?this.deserializedList[0]:[]}else this.deserializedList.length=1,this.deserializedData=t?this._deserializeObject(t):null,this.deserializedList[0]=this.deserializedData;return e(this),this.deserializedData},a._deserializeObject=function(t,e,i,r){var s,a=null,c=null;if(t.__type__){var h=t.__type__;if(c=this._classFinder(h,t,i,r),!c){var l=this._classFinder===n._getClassById;return l&&cc.deserialize.reportMissingClass(h),null}if(a=new c,a._deserialize)return a._deserialize(t.content,this),a;cc.Class._isCCClass(c)?o(this,a,t,c,e):this._deserializeTypedObject(a,t,c)}else if(Array.isArray(t)){a=new Array(t.length);for(var u=0;u<t.length;u++)s=t[u],"object"==typeof 0="==n?255:n)}var" s&&s?this._deserializeobjfield(a,s,""+u):a[u]="s}else" a="{},this._deserializePrimitiveObject(a,t);return" a},a._deserializeobjfield="function(t,e,i,n){var" r="e.__id__;if("undefined"==typeof" r){var="" s="e.__uuid__;s?(this.result.uuidList.push(s),this.result.uuidObjList.push(t),this.result.uuidPropList.push(i)):t[i]=this._deserializeObject(e)}else{var" o="this.deserializedList[r];o?t[i]=o:(this._idList.push(r),this._idObjList.push(t),this._idPropList.push(i))}},a._deserializePrimitiveObject=function(t,e){var" i="this;for(var" n="" in="" e)if(e.hasownproperty(n)){var="" r?"__type__"!="=n&&(t[n]=r):r?i._deserializeObjField(t,r,n):t[n]=null}},a._deserializeTypedObject=function(t,e,i){if(i===cc.Vec2)return" t.x="e.x||0,void(t.y=e.y||0);if(i===cc.Color){t.r=e.r||0,t.g=e.g||0,t.b=e.b||0;var" void(t.a="void" a&&e.hasownproperty(o)&&("object"!="typeof" a?t[o]="a:a?this._deserializeObjField(t,a,o):t[o]=null)}},t.pool=new" n.pool(function(t){t.result="null,t.customEnv=null,t.deserializedList.length=0,t.deserializedData=null,t._classFinder=null,t._idList.length=0,t._idObjList.length=0,t._idPropList.length=0},1),t.pool.get=function(e,i,n,r,s){var" o?(o.result="e,o.customEnv=r,o._classFinder=n,o):new" t(e,i,n,r,s)},t})();cc.deserialize="function(t,e,i){i=i||{};var" t&&(t="JSON.parse(t));var" u="!e;e=e||o.pool.get();var" _="a.pool.get(e,c,r,h,l);cc.game._isCloning=!0;var" d="_.deserialize(t);return" cc.game._iscloning="!1,a.pool.put(_),s&&e.assignAssetsBy(Editor.serialize.asAsset),u&&o.pool.put(e),d},cc.deserialize.Details=o,cc.deserialize.reportMissingClass=function(t){cc.warnID(5302,t)}}),{"./CCClass":173,"./CCObject":179,"./attribute":186,"./js":193}],189:[(function(t,e,i){function" n(t){this.id="0|998*Math.random(),this.prefix=t?t+r:""}var" ;n.prototype.getnewid="function(){return" this.prefix+="" ++this.id},n.global="new" n("global"),e.exports="n}),{}],190:[(function(t,e,i){t("./js"),t("./CCClass"),t("./CCClassDecorator"),t("./CCEnum"),t("./CCObject"),t("./callbacks-invoker"),t("./url"),t("./deserialize"),t("./instantiate"),t("./instantiate-jit"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),cc.sys.isBrowser&&t("./CCAssetLibrary"),t("./miniFramework"),t("./CCVisibleRect")}),{"./CCAssetLibrary":172,"./CCClass":173,"./CCClassDecorator":174,"./CCEnum":175,"./CCMacro":178,"./CCObject":179,"./CCSys":182,"./CCVisibleRect":184,"./callbacks-invoker":187,"./deserialize":188,"./instantiate":192,"./instantiate-jit":191,"./js":193,"./miniFramework":194,"./requiring-frame":196,"./url":197}],191:[(function(t,e,i){function" n(t,e){this.varname="t,this.expression=e}function" r(t,e){return="" e="" instanceof="" n?new="" n(e.varname,t+e.expression):t+e}function="" s(t,e,i){array.isarray(i)?(i[0]="r(e,i[0]),t.push(i)):t.push(r(e,i)+";")}function" o(t){this._exps="[],this._targetExp=t}function" a(t,e){if("function"="=typeof" t)try{t="t()}catch(t){return!1}if(t===e)return!0;if(t&&e){if(t" cc.valuetype&&t.equals(e))return!0;if(array.isarray(t)&&array.isarray(e)||t.constructor="==Object&&e.constructor===Object)try{return" json.stringify(t)="==JSON.stringify(e)}catch(t){}}return!1}function" c(t,e){var="" (function="" t(e){for(var="" h(t){return="" x.test(t)?"."+t:"["+t(t)+"]"}function="" l(t,e){this.parent="e,this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.codeArray.push(b+C+","+A+";","if(R){",C+"=R;","}else{",C+"=R=new" "+this.getfuncmodule(t.constructor,!0)+"();","}"),t._in$t="{globalVar:"R"},this.objsToClear_iN$t.push(t),this.enumerateObject(this.codeArray,t);var" i;this.globalvariables.length="">0&&(i=b+this.globalVariables.join(",")+";");var n=c(["return (function(R){",i||[],this.codeArray,"return o;","})"],"");this.result=Function("O","F",n)(this.objs,this.funcs);for(var r=0,s=this.objsToClear_iN$t.length;r<s;++r)this.objstoclear_in$t[r]._in$t=null;this.objstoclear_in$t.length=0}function u(t){var="" e="t" instanceof="" cc._basenode&&t,i="new" l(t,e);return="" i.result}var="" _="t("./CCObject"),d=_.Flags.Destroyed,f=_.Flags.PersistentMask,p=t("./attribute"),m=t("./js"),g=t("./CCClass"),v=p.DELIMETER+"serializable",y=p.DELIMETER+"default",x=g.IDENTIFIER_RE,T=g.escapeForJS,b="var" ",c="o" ,a="t" ,s="a" ,e="0;n.prototype.toString=function(){return" b+this.varname+"="+this.expression+" ;"},o.prototype.append="function(t,e){this._exps.push([t,e])},o.prototype.writeCode=function(t){var" e;if(this._exps.length="">1)t.push(A+"="+this._targetExp+";"),e=A;else{if(1!==this._exps.length)return;e=this._targetExp}for(var i=0;i<this._exps.length;i++){var n="this._exps[i];s(t,e+h(n[0])+"=",n[1])}},o.pool=new" m.pool(function(t){t._exps.length="0,t._targetExp=null},1),o.pool.get=function(t){var" e="this._get()||new" o;return="" e._targetexp="t,e};var" w="l.prototype;w.getFuncModule=function(t,e){var" i="m.getClassName(t),n=i.indexOf(".")!==-1;if(n)try{if(n=t===Function("return" "+i)())return="" i}catch(t){}var="" r="this.funcs.indexOf(t);r<0&&(r=this.funcs.length,this.funcs.push(t));var" s="F[" +r+"]";return="" e?"("+s+")":s},w.getobjref="function(t){var" e<0&&(e="this.objs.length,this.objs.push(t)),"O["+e+"]"},w.setValueType=function(t,e,i,n){var" a="0;a<s.length;a++){var" c="s[a],h=i[c];if(e[c]!==h){var" l="this.enumerateField(i,c,h);r.append(c,l)}}r.writeCode(t),o.pool.put(r)},w.enumerateCCClass=function(t,e,i){for(var" o="n[s];if(r[o+v]!==!1){var" c&&c="" instanceof="" cc.valuetype){var="" u="C+h(o);this.setValueType(t,l,c,u);continue}}this.setObjProp(t,e,o,c)}}},w.instantiateArray=function(t){if(0===t.length)return"[]";var" ++this.localvariableid,i="new" n(e,"new="" array("+t.length+")"),r="[i];t._iN$t={globalVar:"",source:r},this.objsToClear_iN$t.push(t);for(var" r},w.enumeratefield="function(t,e,i){if("object"==typeof" i&&i){var="" ++this.globalvariableid,this.globalvariables.push(s);var="" s}return="" array.isarray(i)?this.instantiatearray(i):this.instantiateobj(i)}return"function"="=typeof" i?this.getfuncmodule(i):"string"="=typeof" i?t(i):("_objflags"="==e&&t" _&&(i&="f),i)},w.setObjProp=function(t,e,i,n){var" for(var="" in="" e)if(e.hasownproperty(n)&&(95!="=n.charCodeAt(0)||95!==n.charCodeAt(1)||"__type__"===n)){var" r&&r&&r="==e._iN$t||this.setObjProp(t,e,n,r)}},w.instantiateObj=function(t){if(t" cc.valuetype)return="" g.getnewvaluetypecode(t);if(t="" cc.asset)return="" this.getobjref(t);if(t._objflags&d)return="" null;var="" e,i="t.constructor;if(cc.Class._isCCClass(i)){if(this.parent)if(this.parent" cc.component){if(t="" cc._basenode||t="" cc.component)return="" this.getobjref(t)}else="" if(this.parent="" cc._basenode)if(t="" cc._basenode){if(!t.ischildof(this.parent))return="" if(t="" cc.component&&!t.node.ischildof(this.parent))return="" this.getobjref(t);e="new" n(c,"new="" "+this.getfuncmodule(i,!0)+"()")}else{if(i!="=Object)return" n(c,"{}")}var="" t._in$t="{globalVar:"",source:r},this.objsToClear_iN$t.push(t),this.enumerateObject(r,t),["(function(){",r,"return" o;})();"]},e.exports="{compile:u,equalsToDefault:a}}),{"./CCClass":173,"./CCObject":179,"./attribute":186,"./js":193}],192:[(function(t,e,i){function" n(t,e){if(!e){if("object"!="typeof" t||array.isarray(t))return="" null;if(!t)return="" null;if(!cc.isvalid(t))return="" null}var="" i;if(t="" c){if(t._instantiate)return="" cc.game._iscloning="!0,i=t._instantiate(),cc.game._isCloning=!1,i;if(t" null}return="" r(t,e){if(array.isarray(t))return="" null;if(_&&_(t))return="" i;if(t._in$t)i="t._iN$t;else{var" n}o(t,i,e);for(var="" d.length="0,i}function" s(t,e,i,n){for(var="" h="e[c];"object"==typeof" h&&h?i[c]="h._iN$t||a(h,n):i[c]=h}}}function" o(t,e,i){t._in$t="e,d.push(t);var" t)if(t.hasownproperty(r)&&(95!="=r.charCodeAt(0)||95!==r.charCodeAt(1)||"__type__"===r)){var" o&&o){if(o="==e)continue;e[r]=o._iN$t||a(o,i)}else" e[r]="o}t" c&&(e._objflags&="l)}function" a(t,e){if(t="" t.clone();if(t="" t;var="" i;if(array.isarray(t)){var="" array(n),t._in$t="i;for(var" s&&s?i[r]="s._iN$t||a(s,e):i[r]=s}return" d.push(t),i}if(t._objflags&h)return="" t}else="" if(e="" cc._basenode){if(!t.ischildof(e))return="" cc.component&&!t.node.ischildof(e))return="" if(c!="=Object)return" t;return="" c,o(t,i,e),i}var="" n(t,e){for(;t;){var="" i;t="Object.getPrototypeOf(t)}return" null}function="" r(t,e,i){var="" s(t,e){t.splice(e,1)}function="" o(t,e){var="">=i||(t[e]=t[i-1],t.length=i-1)}function a(t,e){var i=t.indexOf(e);return i>=0&&(s(t,i),!0)}function c(t,e){var i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],--t.length)}function h(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return="" cc.logid(1300),!1;return!0}function="" l(t,e){for(var="" i="0,n=e.length;i<n;i++)a(t,e[i])}function" u(t,e,i){return="" t.splice.apply(t,[i,0].concat(e)),t}function="" _(t,e){return="" t.call(t,e)="">=0}function d(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e+=1)n[e]=t[e];return n}function="" f(t,e){"number"="=typeof" t&&(e="t,t=null),this.get=null,this.count=0,this._pool=new" array(e),this._cleanup="t}var" p="new(t("./id-generater"))("TmpCId."),m={isNumber:function(t){return"number"==typeof" t||t="" instanceof="" number},isstring:function(t){return"string"="=typeof" string},addon:function(t){"use="" strict";t="t||{};for(var" e="1,i=arguments.length;e<i;e++){var" n="arguments[e];if(n){if("object"!=typeof" n){cc.errorid(5402,n);continue}for(var="" s="" in="" n)s="" t||r(s,n,t)}}return="" t},mixin:function(t){"use="" n){cc.errorid(5403,n);continue}for(var="" n)r(s,n,t)}}return="" t},extend:function(t,e){for(var="" i="" e)e.hasownproperty(i)&&(t[i]="e[i]);return" t.prototype="Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),t},getSuper:function(t){var" i&&i.constructor},clear:function(t){for(var="" t[e[i]]},getpropertydescriptor:n},g="{value:void" 0,enumerable:!1,writable:!1,configurable:!0};m.value="function(t,e,i,n,r){g.value=i,g.writable=n,g.enumerable=r,Object.defineProperty(t,e,g),g.value=void" 0};var="" v="{get:null,set:null,enumerable:!1};m.getset=function(t,e,i,n,r){"function"!=typeof" n&&(r="n,n=void" 0),v.get="i,v.set=n,v.enumerable=r,Object.defineProperty(t,e,v),v.get=null,v.set=null};var" y="{get:null,enumerable:!1,configurable:!1};m.get=function(t,e,i,n,r){y.get=i,y.enumerable=n,y.configurable=r,Object.defineProperty(t,e,y),y.get=null};var" x="{set:null,enumerable:!1,configurable:!1};m.set=function(t,e,i,n,r){x.set=i,x.enumerable=n,x.configurable=r,Object.defineProperty(t,e,x),x.set=null},m.getClassName=function(t){if("function"==typeof" t){var="" e.__classname__;var="" ;if(t.name&&(i="t.name),t.toString){var" n,r="t.toString();n="["===r.charAt(0)?r.match(/\[\w+\s*(\w+)\]/):r.match(/function\s*(\w+)/),n&&2===n.length&&(i=n[1])}return"Object"!==i?i:""}return" t&&t.constructor?m.getclassname(t.constructor):""},(function(){function="" t(t,e){return="" function(i,n){if(n.prototype.hasownproperty(t)&&delete="" e[n.prototype[t]],m.value(n.prototype,t,i),i){var="" r="e[i];if(r&&r!==n){var" +t+'="" :="" "'+i+'".';cc.error(s)}else="" e[i]="n}}}var" t="0;t<arguments.length;t++){var" e[r];var="" i[s]}},m._getclassbyid="function(t){return" e[t]},m.getclassbyname="function(t){return" i[t]},m._getclassid="function(t,e){e="undefined"==typeof" e||e;var="" i;if("function"="=typeof" t&&t.prototype.hasownproperty("__cid__"))return="" r(){return="" this[i]}var="" i){var="" r&&i.test(r);if(s)for(var="" o="/%s/;n<e;++n){var" a="t[n],c="number"==typeof" a?i:o;c.test(r)?r="r.replace(c,a):r+="" "+a}else="" if(e="">1)for(;n<e;++n)r+=" "+t[n];else="" r="" +r;return="" r},m.shiftarguments="function(){for(var" t="arguments.length-1,e=new" array(t),i="0;i<t;++i)e[i]=arguments[i+i];return" e};var="">0){--this.count;var t=this._pool[this.count];return this._pool[this.count]=null,t}return null},f.prototype.put=function(t){var e=this._pool;if(this.count<e.length){if(this._cleanup&&this._cleanup(t)===!1)return;e[this.count]=t,++this.count}},m.pool=f,cc.js=m,e.exports=m}),{".. utils="" mutable-forward-iterator":224,".="" id-generater":189}],194:[(function(t,e,i){switch(cc.$="function(t){var" e="this===cc?document:this,i=t" instanceof="" htmlelement?t:e.queryselector(t);return="" i&&(i.find="i.find||cc.$,i.hasClass=i.hasClass||function(t){return" this.classname.match(new="" regexp("(\\s|^)"+t+"(\\s|$)"))},i.addclass="i.addClass||function(t){return" this.hasclass(t)||(this.classname&&(this.classname+=" " ),this.classname+="t),this},i.removeClass=i.removeClass||function(t){return" this.hasclass(t)&&(this.classname="this.className.replace(t,"")),this},i.remove=i.remove||function(){return" this.parentnode&&this.parentnode.removechild(this),this},i.appendto="i.appendTo||function(t){return" t.appendchild(this),this},i.prependto="i.prependTo||function(t){return" t.childnodes[0]?t.insertbefore(this,t.childnodes[0]):t.appendchild(this),this},i.transforms="i.transforms||function(){return" this.style[cc.$.trans]="cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(t,e){return" this.position.x="t,this.position.y=e,this.transforms(),this},i.rotate=function(t){return" this.rotation="t,this.transforms(),this},i.resize=function(t,e){return" this.scale.x="t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return" this.skew.x="t,this.skew.y=e,this.transforms(),this}),i},cc.sys.browserType){case" cc.sys.browser_type_firefox:cc.$.pfx="Moz" ,cc.$.hd="!0;break;case" cc.sys.browser_type_chrome:case="" cc.sys.browser_type_safari:cc.$.pfx="webkit" cc.sys.browser_type_opera:cc.$.pfx="O" cc.sys.browser_type_ie:cc.$.pfx="ms" "+t.y+"px,="" 0)="" "}:function(t){return"translate("+t.x+"px,="" "+t.y+"px)="" "},cc.$.rotate="cc.$.hd?function(t){return"rotateZ("+t+"deg)" "}:function(t){return"rotate("+t+"deg)="" "},cc.$.scale="function(t){return"scale("+t.x+"," "+t.y+")="" "},cc.$.skew="function(t){return"skewX("+-t.x+"deg)" skewy("+t.y+"deg)"},cc.$new="function(t){return" cc.$(document.createelement(t))},cc.$.findpos="function(t){var" e+="t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{x:e,y:i}}}),{}],195:[(function(t,e,i){function" n(t,e,i,n){if(!t.get&&!t.set&&t.hasownproperty("default")){var="" r="_N$" +e;t.get="function(){return" this[r]},t.set="function(t){var" s="{};n[r]=s;for(var" o="" in="" a){var="" c="a[o];t.hasOwnProperty(o)&&(s[o]=t[o],c.canUsedInGet||delete" t[o])}}}function="" r(t,e,i,n){array.isarray(n)&&n.length="">0&&(n=n[0]),t.type=n}function s(t,e,i,n){if(Array.isArray(e)){if(!(e.length>0))return cc.errorID(5508,i,n);if(cc.RawAsset.isRawAssetType(e[0]))return t.url=e[0],void delete t.type;t.type=e=e[0]}}function o(t,e,i,n){}var a={url:{canUsedInGet:!0},default:{},serializable:{},editorOnly:{},rawType:{}};i.getFullFormOfProperty=function(t){var e=t&&t.constructor===Object;if(!e){if(Array.isArray(t)&&t.length>0)return{default:[],type:t,_short:!0};if("function"==typeof t){var i=t;return cc.RawAsset.isRawAssetType(i)?{default:"",url:i,_short:!0}:{default:cc.isChildClassOf(i,cc.ValueType)?new i:null,type:i,_short:!0}}return{default:t,_short:!0}}return null},i.preprocessAttrs=function(t,e,a,c){for(var h in t){var l=t[h],u=i.getFullFormOfProperty(l);if(u&&(l=t[h]=u),l){var _=l.notify;_&&n(l,h,_,t),"type"in l&&s(l,l.type,e,h),"url"in l&&r(l,e,h,l.url),"type"in l&&o(l,l.type,e,h)}}},e.exports.validateMethod=function(t,e,i,n,r){if("function"!=typeof t&&null!==t){return!1}return!0}}),{"./CCClass":173}],196:[(function(t,e,i){var n=[];cc._RF={push:function(t,e,i){void 0===i&&(i=e,e=""),n.push({uuid:e,script:i,module:t,exports:t.exports,beh:null})},pop:function(){var t=n.pop(),e=t.module,i=e.exports;if(i===t.exports){for(var r in i)return;e.exports=i=t.cls}},peek:function(){return n[n.length-1]}},cc._RFpush=cc._RF.push,cc._RFpop=cc._RF.pop,cc._RFpeek=cc._RF.peek}),{}],197:[(function(t,e,i){var n={};cc.url={_rawAssets:"",_builtinRawAssets:"",normalize:function(t){return 46===t.charCodeAt(0)&&47===t.charCodeAt(1)?t=t.slice(2):47===t.charCodeAt(0)&&(t=t.slice(1)),t},raw:function(t){return t=this.normalize(t),t.startsWith("resources/")||cc.errorID(7002,t),this._rawAssets+t},builtinRaw:!1,_init:function(t){for(var e in t){var i=t[e];i=cc.path._setEndWithSep(i,"/"),n[e]=i}this._rawAssets=n.assets,this._builtinRawAssets=n.internal}},e.exports=cc.url}),{}],198:[(function(t,e,i){e.exports={contains:function(t,e){if("function"==typeof t.contains)return t.contains(e);if("function"==typeof t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));var i=e.parentNode;do{if(i===t)return!0;i=i.parentNode}while(null!==i);return!1},isDomNode:"object"==typeof window&&("function"==typeof Node?function(t){return t instanceof Node}:function(t){return t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}),callInNextTick:function(t,e,i){t&&setTimeout((function(){t(e,i)}),0)}}}),{}],199:[(function(t,e,i){function n(){var t=c.pop();return t||(t=new o),t}function r(t){c.push(t)}function s(t,e){var i=t._minX<e._minx?t._minx:e._minx,n=t._miny<e._miny?t._miny:e._miny,r=t._maxx>e._maxX?t._maxX:e._maxX,s=t._maxY>e._maxY?t._maxY:e._maxY;return(r-i)*(s-n)}var o=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},a=o.prototype,c=[];a.setTo=function(t,e,i,n){return this._minX=t,this._minY=e,this._maxX=i,this._maxY=n,this.updateArea(),this},a.intValues=function(){this._minX=Math.floor(this._minX),this._minY=Math.floor(this._minY),this._maxX=Math.ceil(this._maxX),this._maxY=Math.ceil(this._maxY),this.updateArea()},a.updateArea=function(){this._width=this._maxX-this._minX,this._height=this._maxY-this._minY,this._area=this._width*this._height},a.union=function(t){return this.isEmpty()?void this.setTo(t._minX,t._minY,t._maxX,t._maxY):(this._minX>t._minX&&(this._minX=t._minX),this._minY>t._minY&&(this._minY=t._minY),this._maxX<t._maxx&&(this._maxx=t._maxx),this._maxy<t._maxy&&(this._maxy=t._maxy),void this.updatearea())},a.setempty="function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},a.isEmpty=function(){return" this._width<="0||this._height<=0},a.intersects=function(t){if(this.isEmpty()||t.isEmpty())return!1;var" e="this._minX">t._minX?this._minX:t._minX,i=this._maxX<t._maxx?this._maxx:t._maxx;return!(e>i)&&(e=this._minY>t._minY?this._minY:t._minY,i=this._maxY<t._maxy?this._maxy:t._maxy,e<=i)},a.updateregion=function(t,e){if(0===t.width||0===t.height)return void="" this.setempty();var="" i,n,r,s,o="e,a=o.a,c=o.b,h=o.c,l=o.d,u=o.tx,_=o.ty,d=t.x,f=t.y,p=d+t.width,m=f+t.height;if(1===a&&0===c&&0===h&&1===l)i=d+u-1,n=f+_-1,r=p+u+1,s=m+_+1;else{var" g="a*d+h*f+u,v=c*d+l*f+_,y=a*p+h*f+u,x=c*p+l*f+_,T=a*p+h*m+u,b=c*p+l*m+_,C=a*d+h*m+u,A=c*d+l*m+_,S=0;g">y&&(S=g,g=y,y=S),T>C&&(S=T,T=C,C=S),i=(g<t?g:t)-1,r=(y>C?y:C)+1,v>x&&(S=v,v=x,x=S),b>A&&(S=b,b=A,A=S),n=(v<b?v:b)-1,s=(x>A?x:A)+1}this._minX=i,this._minY=n,this._maxX=r,this._maxY=s,this._width=r-i,this._height=s-n,this._area=this._width*this._height};var h=function(){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1},l=h.prototype;l.setClipRect=function(t,e){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},l.addRegion=function(t){var e=t._minX,i=t._minY,r=t._maxX,s=t._maxY;if(this.hasClipRect&&(e<0&&(e=0),i<0&&(i=0),r>this.clipWidth&&(r=this.clipWidth),s>this.clipHeight&&(s=this.clipHeight)),e>=r||i>=s)return!1;if(this.clipRectChanged)return!0;var o=this.dirtyList,a=n();return o.push(a.setTo(e,i,r,s)),this.mergeDirtyList(o),!0},l.clear=function(){for(var t=this.dirtyList,e=t.length,i=0;i<e;i++)r(t[i]);t.length=0},l.getdirtyregions=function(){var t="this.dirtyList;if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var" e="n();t.push(e.setTo(0,0,this.clipWidth,this.clipHeight))}else" for(;this.mergedirtylist(t););var="" i="this.dirtyList.length;if(i">0)for(var r=0;r<i;r++)this.dirtylist[r].intvalues();return this.dirtylist},l.mergedirtylist="function(t){var" e="t.length;if(e<2)return!1;for(var" i="this.hasClipRect,n=e">3?Number.POSITIVE_INFINITY:0,o=0,a=0,c=0,h=0;h<e-1;h++){var l="t[h];i&&(c+=l.area);for(var" u="h+1;u<e;u++){var" _="t[u],d=s(l,_)-l.area-_.area;n">d&&(o=h,a=u,n=d)}}if(i&&c/this.clipArea>.95&&(this.clipRectChanged=!0),o!==a){var f=t[a];return t[o].union(f),r(f),t.splice(a,1),!0}return!1},cc.Region=o,cc.DirtyRegion=h}),{}],200:[(function(t,e,i){cc.rendererCanvas={childrenOrderDirty:!0,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(),_clearFillStyle:"rgb(0, 0, 0)",_dirtyRegion:null,_allNeedDraw:!0,_enableDirtyRegion:!0,_debugDirtyRegion:!1,_dirtyRegionCountThreshold:10,init:function(){cc.sys.browserType!==cc.sys.BROWSER_TYPE_IE&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_UC||this.enableDirtyRegion(!1)},getRenderCmd:function(t){return t._createRenderCmd()},enableDirtyRegion:function(t){this._enableDirtyRegion=t},isDirtyRegionEnabled:function(){return this._enableDirtyRegion},setDirtyRegionCountThreshold:function(t){this._dirtyRegionCountThreshold=t},_collectDirtyRegion:function(){var t,e,i=this._renderCmds,n=this._dirtyRegion,r=_ccsg.Node.CanvasRenderCmd.RegionStatus,s=0,o=!0;for(t=0,e=i.length;t<e;t++){var a="i[t],c=a._regionFlag,h=a._oldRegion,l=a._currentRegion;c">r.NotDirty&&(++s,s>this._dirtyRegionCountThreshold&&(o=!1),o&&(!l.isEmpty()&&n.addRegion(l),a._regionFlag>r.Dirty&&!h.isEmpty()&&n.addRegion(h)),a._regionFlag=r.NotDirty)}return o},_beginDrawDirtyRegion:function(t){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();e.save(),t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},1,1),e.beginPath();for(var n=0,r=0,s=0,o=0,a=t._scaleX,c=t._scaleY,h=0,l=i.length;h<l;++h){var 0="==i?1:i,n=void" u="i[h];n=(u._minX*a|0)-1,r=(-u._maxY*a|0)-1,s=(u._width*a|0)+2,o=(u._height*c|0)+2,e.rect(n,r,s,o)}e.clip()},_endDrawDirtyRegion:function(t){t.restore()},_debugDrawDirtyRegion:function(t){if(this._debugDirtyRegion){var" e="t.getContext(),i=this._dirtyRegion.getDirtyRegions();t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},1,1),e.beginPath();for(var" n="0,r=0,s=0,o=0,a=t._scaleX,c=t._scaleY,h=0,l=i.length;h<l;++h){var" _="e.fillStyle;e.fillStyle="green",e.fill(),e.fillStyle=_}},rendering:function(t){var" cc.dirtyregion,i="cc._canvas,n=t||cc._renderContext,r=n.getContext(),s=cc.view.getScaleX(),o=cc.view.getScaleY();n.setViewScale(s,o),n.computeRealOffsetY();var" a,c,h="this._dirtyRegion.getDirtyRegions(),l=this._renderCmds,u=this._allNeedDraw||!this._enableDirtyRegion;for(u||(u=u||!this._collectDirtyRegion()),u||this._beginDrawDirtyRegion(n),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,i.width,i.height),0===this._clearColor.r&&0===this._clearColor.g&&0===this._clearColor.b||(n.setFillStyle(this._clearFillStyle),n.setGlobalAlpha(this._clearColor.a),r.fillRect(0,0,i.width,i.height)),a=0,c=l.length;a<c;a++){var" d="!1,f=_._currentRegion;if(!f||u)d=!0;else" for(var="" p="0,m=h.length;p<m;++p)if(h[p].intersects(f)){d=!0;break}d&&_.rendering(n,s,o)}}u||(this._debugDrawDirtyRegion(n),this._endDrawDirtyRegion(r)),e.clear(),this._allNeedDraw=!1},_renderingToCacheCanvas:function(t,e,i,n){t||cc.logID(7600),i=void" r,s,o="this._cacheToCanvasCmds[e];for(t.computeRealOffsetY(),r=0,s=o.length;r<s;r++)o[r].rendering(t,i,n);this._removeCache(e);var" a="this._cacheInstanceIds;0===a.length?this._isCacheToCanvasOn=!1:this._currentID=a[a.length-1]},_turnToCacheMode:function(t){this._isCacheToCanvasOn=!0,t=t||0,this._cacheToCanvasCmds[t]=[],this._cacheInstanceIds.indexOf(t)===-1&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(t){t=t||this._currentID;var" this._cachetocanvascmds[t]);var="" i="this._cacheInstanceIds;cc.js.array.remove(i,t)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var" t="this._transformNodePool;t.sort(this._sortNodeByLevelAsc);for(var" this._transformnodepool.length="">0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clear:function(){},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1,this._allNeedDraw=!0},pushRenderCommand:function(t){if(t.rendering)if(this._isCacheToCanvasOn){var e=this._currentID,i=this._cacheToCanvasCmds,n=i[e];n.indexOf(t)===-1&&n.push(t)}else this._renderCmds.indexOf(t)===-1&&this._renderCmds.push(t)}},(function(){cc.CanvasContextWrapper=function(t){this._context=t,this._saveCount=0,this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height,this._armatureMode=0};var t=cc.CanvasContextWrapper.prototype;t.resetCache=function(){var t=this._context;this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},t.setOffset=function(t,e){this._offsetX=t,this._offsetY=e,this._realOffsetY=this._context.canvas.height+this._offsetY},t.computeRealOffsetY=function(){
this._realOffsetY=this._context.canvas.height+this._offsetY},t.setViewScale=function(t,e){this._scaleX=t,this._scaleY=e},t.getContext=function(){return this._context},t.save=function(){this._context.save(),this._saveCount++},t.restore=function(){this._context.restore(),this._currentAlpha=this._context.globalAlpha,this._saveCount--},t.setGlobalAlpha=function(t){this._saveCount>0?this._context.globalAlpha=t:this._currentAlpha!==t&&(this._currentAlpha=t,this._context.globalAlpha=t)},t.setCompositeOperation=function(t){this._saveCount>0?this._context.globalCompositeOperation=t:this._currentCompositeOperation!==t&&(this._currentCompositeOperation=t,this._context.globalCompositeOperation=t)},t.setFillStyle=function(t){this._context.fillStyle=t},t.setStrokeStyle=function(t){this._saveCount>0?this._context.strokeStyle=t:this._currentStrokeStyle!==t&&(this._currentStrokeStyle=t,this._context.strokeStyle=t)},t.setTransform=function(t,e,i){this._armatureMode>0?(this.restore(),this.save(),this._context.transform(t.a,-t.b,-t.c,t.d,t.tx*e,-(t.ty*i))):this._context.setTransform(t.a*e,-t.b*i,-t.c*e,t.d*i,this._offsetX+t.tx*e,this._realOffsetY-t.ty*i)},t._switchToArmatureMode=function(t,e,i,n){t?(this._armatureMode++,this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*i,this._realOffsetY-e.ty*n),this.save()):(this._armatureMode--,this.restore())}})()}),{}],201:[(function(t,e,i){function n(t){var e=cc._renderContext;if(a){var i=6*Math.ceil(t/4);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),g=new Uint16Array(i);for(var n=0,r=0,s=i;r<s;r+=6)g[r]=n+0,g[r+1]=n+1,g[r+2]=n+2,g[r+3]=n+1,g[r+4]=n+2,g[r+5]=n+3,n+=4;e.bufferdata(e.element_array_buffer,g,e.dynamic_draw)}if(c){f=t*_;var o="4*f;d=new" arraybuffer(o),p="new" float32array(d),m="new" uint32array(d),e.bindbuffer(e.array_buffer,c),e.bufferdata(e.array_buffer,p,e.dynamic_draw)}h="t-200}function" r(t){var="" e="cc._renderContext;null===a&&(c=e.createBuffer(),a=e.createBuffer()),n(t)}var" s="{texture:null,blendSrc:null,blendDst:null,shader:null},o=!1,a=null,c=null,h=0,l=0,u=0,_=6,d=null,f=0,p=null,m=null,g=null,v=0,y=!0,x=!1,T=cc.Enum({QUAD:0,TRIANGLE:1,CUSTOM:2});cc.rendererWebGL={mat4Identity:null,childrenOrderDirty:!0,assignedZ:0,assignedZStep:.01,VertexType:T,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:{r:0,g:0,b:0,a:255},init:function(){var" t="cc._renderContext;t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),this.mat4Identity=new" cc.math.matrix4,this.mat4identity.identity(),r(cc.macro.batch_vertex_count),cc.sys.os="==cc.sys.OS_IOS&&(x=!0)},getVertexSize:function(){return" h},getrendercmd:function(t){return="" t._createrendercmd()},_turntocachemode:function(t){this._iscachetobufferon="!0,t=t||0,this._cacheToBufferCmds[t]?this._cacheToBufferCmds[t].length=0:this._cacheToBufferCmds[t]=[],this._cacheInstanceIds.indexOf(t)===-1&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_removeCache:function(t){t=t||this._currentID;var" this._cachetobuffercmds[t]);var="" i="this._cacheInstanceIds;cc.js.array.remove(i,t)},_renderingToBuffer:function(t){t=t||this._currentID;var" n="this._cacheInstanceIds;0===n.length?this._isCacheToBufferOn=!1:this._currentID=n[n.length-1]},resetFlag:function(){this.childrenOrderDirty&&(this.childrenOrderDirty=!1),this._transformNodePool.length=0},transform:function(){var" e,i,n;for(e="0,i=t.length;e<i;e++)n=t[e],n.updateStatus();t.length=0},transformDirty:function(){return" this._transformnodepool.length="">0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clearRenderCommands:function(){this._renderCmds.length=0},clear:function(){var t=cc._renderContext;t.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},setDepthTest:function(t){var e=cc._renderContext;t?(e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL)):e.disable(e.DEPTH_TEST)},pushRenderCommand:function(t){if(t.rendering||t.uploadData)if(this._isCacheToBufferOn){var e=this._currentID,i=this._cacheToBufferCmds,n=i[e];n.indexOf(t)===-1&&n.push(t)}else this._renderCmds.push(t)},_increaseBatchingSize:function(t,e,i){e=e||T.QUAD;var n,r;switch(e){case T.QUAD:for(n=0;n<t;n+=4)r=l+n,g[u++]=r+0,g[u++]=r+1,g[u++]=r+2,g[u++]=r+1,g[u++]=r+2,g[u++]=r+3;break;case t.triangle:for(y="!1,n=0;n<t;n+=3)r=l+n,g[u++]=r+0,g[u++]=r+1,g[u++]=r+2;break;case" t.custom:y="!1;var" s="i.length;for(n=0;n<s;n++)g[u++]=l+i[n];break;default:return}l+=t},_updateBatchedInfo:function(t,e,i){t&&(s.texture=t),e&&(s.blendSrc=e.src,s.blendDst=e.dst),i&&(s.shader=i)},_breakBatch:function(){o=!0},_uploadBufferData:function(t){l">=h&&this._batchRendering();var e=t._node,i=t._texture||e._texture||e._spriteFrame&&e._spriteFrame._texture,n=e._blendFunc.src,r=e._blendFunc.dst,a=t._shaderProgram;(o||s.texture!==i||s.blendSrc!==n||s.blendDst!==r||s.shader!==a)&&(this._batchRendering(),s.texture=i,s.blendSrc=n,s.blendDst=r,s.shader=a,o=!1);var c=t.uploadData(p,m,l*_);if(c>0){var d,f,v=t.vertexType||T.QUAD;switch(v){case T.QUAD:for(d=0;d<c;d+=4)f=l+d,g[u++]=f+0,g[u++]=f+1,g[u++]=f+2,g[u++]=f+1,g[u++]=f+2,g[u++]=f+3;break;case t.triangle:for(y="!1,d=0;d<c;d+=3)f=l+d,g[u++]=f+0,g[u++]=f+1,g[u++]=f+2;break;case" t.custom:y="!1,t.uploadIndexData&&(u+=t.uploadIndexData(g,u,l));break;default:return}l+=c}},_batchRendering:function(){if(0!==l&&s.texture){var" t="cc._renderContext,e=s.texture,i=s.shader,n=l">.5*h;if(i&&(i.use(),i._updateProjectionUniform()),cc.gl.blendFunc(s.blendSrc,s.blendDst),cc.gl.bindTexture2DN(0,e),t.bindBuffer(t.ARRAY_BUFFER,c),n)t.bufferData(t.ARRAY_BUFFER,p,t.DYNAMIC_DRAW);else{var r=p.subarray(0,l*_);t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW)}t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,24,12),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,24,16),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),(!v||!y||u>v)&&(n?t.bufferData(t.ELEMENT_ARRAY_BUFFER,g,t.DYNAMIC_DRAW):t.bufferData(t.ELEMENT_ARRAY_BUFFER,g.subarray(0,u),t.DYNAMIC_DRAW)),t.drawElements(t.TRIANGLES,u,t.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++,y?v=u:(v=0,y=!0),l=0,u=0}},rendering:function(t,e){var i,n,r,o=e||this._renderCmds,a=t||cc._renderContext;for(a.bindBuffer(a.ARRAY_BUFFER,null),i=0,n=o.length;i<n;++i)r=o[i],r._needdraw&&(r.uploaddata?this._uploadbufferdata(r):(l>0&&this._batchRendering(),r.rendering(a)));this._batchRendering(),s.texture=null}}}),{}],202:[(function(t,e,i){t("./RendererCanvas"),t("./RendererWebGL"),t("./DirtyRegion")}),{"./DirtyRegion":199,"./RendererCanvas":200,"./RendererWebGL":201}],203:[(function(t,e,i){_ccsg.Scene=_ccsg.Node.extend({_className:"Scene",ctor:function(){_ccsg.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.director.getWinSize())}})}),{}],204:[(function(t,e,i){var n=t("../event/event-target");_ccsg.Sprite=_ccsg.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_recursiveDirty:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(t,e,i){var r=this;_ccsg.Node.prototype.ctor.call(r),n.call(r),r._shouldBeHidden=!1,r._offsetPosition=cc.p(0,0),r._unflippedOffsetPositionFromCenter=cc.p(0,0),r._blendFunc={src:cc.macro.BLEND_SRC,dst:cc.macro.BLEND_DST},r._rect=cc.rect(0,0,0,0),r._softInit(t,e,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.once("load",t,e)},isDirty:function(){return this.dirty},setDirty:function(t){this.dirty=t},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(t){cc.assertID(t,2606),t.textureLoaded()||(this._textureLoaded=!1,t.once("load",this._renderCmd._spriteFrameLoadedCallback,this._renderCmd));var e=cc._renderType!==cc.game.RENDER_TYPE_CANVAS&&t._rotated,i=this.initWithTexture(t.getTexture(),t.getRect(),e);return this.setSpriteFrame(t),i},initWithSpriteFrameName:function(){cc.warnID(2608)},useBatchNode:function(t){this.textureAtlas=t.getTextureAtlas(),this._batchNode=t},setVertexRect:function(t){var e=this._rect;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},setFlippedX:function(t){this._flippedX!==t&&(this._flippedX=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(t){this._flippedY!==t&&(this._flippedY=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(t){this._opacityModifyRGB!==t&&(this._opacityModifyRGB=t,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(t,e){cc.assertID(t,2610);var i=cc.spriteFrameAnimationCache.getAnimation(t);if(!i)return void cc.logID(2602);var n=i.getFrames()[e];return n?void this.setSpriteFrame(n.getSpriteFrame()):void cc.logID(2603)},getTexture:function(){return this._texture},_softInit:function(t,e,i){if(void 0===t)_ccsg.Sprite.prototype.init.call(this);else if(cc.js.isString(t))"#"===t[0]?cc.logID(2728,t):_ccsg.Sprite.prototype.init.call(this,t,e);else if("object"==typeof t)if(t instanceof cc.Texture2D)this.initWithTexture(t,e,i);else if(t instanceof cc.SpriteFrame)this.initWithSpriteFrame(t);else if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var n=new cc.Texture2D;n.initWithElement(t),n.handleLoadedTexture(),this.initWithTexture(n)}},getQuad:function(){return null},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},init:function(){var t=this;return arguments.length>0?t.initWithFile(arguments[0],arguments[1]):(t.dirty=t._recursiveDirty=!1,t._blendFunc.src=cc.macro.BLEND_SRC,t._blendFunc.dst=cc.macro.BLEND_DST,t.texture=null,t._flippedX=t._flippedY=!1,t.anchorX=.5,t.anchorY=.5,t._offsetPosition.x=0,t._offsetPosition.y=0,t.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(t,e){cc.assertID(t,2609);var i=cc.textureCache.getTextureForKey(t);if(i){if(!e){var n=i.getContentSize();e=cc.rect(0,0,n.width,n.height)}return this.initWithTexture(i,e)}return i=cc.textureCache.addImage(t),this.initWithTexture(i,e||cc.rect(0,0,i._contentSize.width,i._contentSize.height))},initWithTexture:function(t,e,i,n){var r=this;cc.assertID(0!==arguments.length,2710),i=i||!1,t=this._renderCmd._handleTextureForRotatedTexture(t,e,i,n),r._recursiveDirty=!1,r.dirty=!1,r._opacityModifyRGB=!0,r._blendFunc.src=cc.macro.BLEND_SRC,r._blendFunc.dst=cc.macro.BLEND_DST,r._flippedX=r._flippedY=!1,r.setAnchorPoint(.5,.5),r._offsetPosition.x=0,r._offsetPosition.y=0;var s=t.isLoaded();return r._textureLoaded=s,s?(e||(e=cc.rect(0,0,t.width,t.height)),this._renderCmd._checkTextureBoundary(t,e,i),r.setTexture(t),r.setTextureRect(e,i),this.emit("load"),!0):(r._rectRotated=i,e&&(r._rect.x=e.x,r._rect.y=e.y,r._rect.width=e.width,r._rect.height=e.height),r.texture&&r.texture.off("load",r._renderCmd._textureLoadedCallback,r._renderCmd),t.once("load",r._renderCmd._textureLoadedCallback,r._renderCmd),r.setTexture(t),!0)},setTextureRect:function(t,e,i,n){var r=this;r._rectRotated=e||!1,r.setContentSize(i||t),r.setVertexRect(t),r._renderCmd._setTextureCoords(t,n);var s=r._unflippedOffsetPositionFromCenter.x,o=r._unflippedOffsetPositionFromCenter.y;r._flippedX&&(s=-s),r._flippedY&&(o=-o);var a=r._rect;r._offsetPosition.x=s+(r._contentSize.width-a.width)/2,r._offsetPosition.y=o+(r._contentSize.height-a.height)/2},setSpriteFrame:function(t){var e=this;cc.assertID(t,2712),this.setNodeDirty(!0);var i=t.getOffset();e._unflippedOffsetPositionFromCenter.x=i.x,e._unflippedOffsetPositionFromCenter.y=i.y;var n=t.getTexture(),r=t.textureLoaded();r?(e._textureLoaded=!0,n!==e._texture&&(e._setTexture(n),e.setColor(e._realColor)),e.setTextureRect(t.getRect(),t.isRotated(),t.getOriginalSize())):(e._textureLoaded=!1,t.once("load",(function(t){var i=t.currentTarget;e._textureLoaded=!0;var n=i.getTexture();n!==e._texture&&e._setTexture(n),e.setTextureRect(i.getRect(),i.isRotated(),i.getOriginalSize()),e.emit("load"),e.setColor(e._realColor)}),e)),this._renderCmd._updateForSetSpriteFrame(n)},setDisplayFrame:function(t){cc.logID(2604),this.setSpriteFrame(t)},isFrameDisplayed:function(t){return this._renderCmd.isFrameDisplayed(t)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,this._rect,this._rectRotated,this._unflippedOffsetPositionFromCenter,this._contentSize)},setTexture:function(t){if(!t)return this._renderCmd._setTexture(null);var e=cc.js.isString(t);e&&(t=cc.textureCache.addImage(t)),t._textureLoaded?(this._setTexture(t,e),this.setColor(this._realColor),this._textureLoaded=!0,this.emit("load")):(this._renderCmd._setTexture(t),t.once("load",(function(i){this._setTexture(t,e),this.setColor(this._realColor),this._textureLoaded=!0,this.emit("load")}),this))},_setTexture:function(t,e){this._renderCmd._setTexture(t),e&&this._changeRectWithTexture(t)},_changeRectWithTexture:function(t){var e=t._contentSize,i=cc.rect(0,0,e.width,e.height);this.setTextureRect(i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.Sprite.CanvasRenderCmd(this):new _ccsg.Sprite.WebGLRenderCmd(this)}}),cc.js.addon(_ccsg.Sprite.prototype,n.prototype),cc.assertID("function"==typeof cc._tmp.PrototypeSprite,3200,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite}),{"../event/event-target":112}],205:[(function(t,e,i){_ccsg.Sprite.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._textureToRender=null};var n=_ccsg.Sprite.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=_ccsg.Sprite.CanvasRenderCmd,n.setDirtyRecursively=function(t){},n._setTexture=function(t){var e=this._node;if(e._texture!==t){e._textureLoaded=!!t&&t._textureLoaded,e._texture=t;var i=t._contentSize,n=cc.rect(0,0,i.width,i.height);e.setTextureRect(n),this._updateColor()}},n._setColorDirty=function(){this.setDirtyFlag(_ccsg.Node._dirtyFlags.colorDirty|_ccsg.Node._dirtyFlags.opacityDirty)},n.isFrameDisplayed=function(t){var e=this._node;return t.getTexture()===e._texture&&cc.rectEqualToRect(t.getRect(),e._rect)},n.updateBlendFunc=function(t){this._blendFuncStr=_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},n._handleTextureForRotatedTexture=function(t,e,i,n){if(i&&t.isLoaded()){var r=t.getHtmlElementObj();r=_ccsg.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,e,n);var s=new cc.Texture2D;s.initWithElement(r),s.handleLoadedTexture(),t=s,e.x=e.y=0,this._node._rect=cc.rect(0,0,e.width,e.height)}return t},n._checkTextureBoundary=function(t,e,i){if(t&&t.url){var n=e.x+e.width,r=e.y+e.height;n>t.width&&cc.errorID(3300,t.url),r>t.height&&cc.errorID(3400,t.url)}},n.rendering=function(t,e,i){var n=this._node,r=this._textureCoord,s=this._displayedOpacity/255,o=this._textureToRender||n._texture;if((!o||0!==r.width&&0!==r.height&&o._textureLoaded)&&0!==s){var a,c=t||cc._renderContext,h=c.getContext(),l=n._offsetPosition.x,u=n._rect.height,_=n._rect.width,d=-n._offsetPosition.y-u;c.setTransform(this._worldTransform,e,i),c.setCompositeOperation(this._blendFuncStr),c.setGlobalAlpha(s),(n._flippedX||n._flippedY)&&c.save(),n._flippedX&&(l=-l-_,h.scale(-1,1)),n._flippedY&&(d=n._offsetPosition.y,h.scale(1,-1));var f,p,m,g,v,y,x,T;if(this._colorized?(f=0,p=0):(f=r.renderX,p=r.renderY),m=r.width,g=r.height,v=l,y=d,x=_,T=u,o&&o._htmlElementObj)a=o._htmlElementObj,""!==o._pattern?(c.setFillStyle(h.createPattern(a,o._pattern)),h.fillRect(v,y,x,T)):h.drawImage(a,f,p,m,g,v,y,x,T);else{var b=n._contentSize;if(r.validRect){var C=this._displayedColor;c.setFillStyle("rgba("+C.r+","+C.g+","+C.b+",1)"),h.fillRect(v,y,b.width,b.height)}}(n._flippedX||n._flippedY)&&c.restore(),cc.g_NumberOfDraws++}},n._updateColor=function(){var t=this._node,e=t._texture,i=this._textureCoord,n=this._displayedColor;e&&(255!==n.r||255!==n.g||255!==n.b?(this._textureToRender=e._generateColorTexture(n.r,n.g,n.b,i),this._colorized=!0):e&&(this._textureToRender=e,this._colorized=!1))},n._updateForSetSpriteFrame=function(t,e){if(this._colorized=!1,this._textureCoord.renderX=this._textureCoord.x,this._textureCoord.renderY=this._textureCoord.y,e=e||t._textureLoaded){var i=this._node.getColor();255===i.r&&255===i.g&&255===i.b||this._updateColor()}},n._spriteFrameLoadedCallback=function(t){var e=this._node,i=t.currentTarget;e.setTextureRect(i.getRect(),i.isRotated(),i.getOriginalSize()),this._updateColor(),e.emit("load")},n._textureLoadedCallback=function(t){var e=this._node,i=t.currentTarget;if(!e._textureLoaded){e._textureLoaded=!0;var n=e._rect;n?cc._rectEqualToZero(n)&&(n.width=i.width,n.height=i.height):n=cc.rect(0,0,i.width,i.height),e.texture=i,e.setTextureRect(n,e._rectRotated);var r=this._displayedColor;255===r.r&&255===r.g&&255===r.b||this._updateColor(),e.emit("load")}},n._setTextureCoords=function(t){var e=this._textureCoord;e.renderX=e.x=0|t.x,e.renderY=e.y=0|t.y,e.width=0|t.width,e.height=0|t.height,e.validRect=!(0===e.width||0===e.height||e.x<0||e.y<0)},_ccsg.sprite.canvasrendercmd._cutrotateimagetocanvas=function(t,e,i){if(!t)return null;if(!e)return="" t;i="null==i||i;var" n="document.createElement("canvas");n.width=e.width,n.height=e.height;var" r="n.getContext("2d");return" r.translate(n.width="" 2,n.height="" 2),i?r.rotate(-1.5707963267948966):r.rotate(1.5707963267948966),r.drawimage(t,e.x,e.y,e.height,e.width,-e.height="" 2,-e.width="" 2,e.height,e.width),n}}),{}],206:[(function(t,e,i){var="" e,i="this._node._children,n=i?i.length:0,r=0;r<n;r++)e=i[r],e" instanceof="" _ccsg.sprite&&e._rendercmd.setdirtyrecursively(t)},r._handletextureforrotatedtexture="function(t){return" t},r.isframedisplayed="function(t){var" e="this._node;return" cc.rectequaltorect(t.getrect(),e._rect)&&t.gettexture().getname()="==e._texture.getName()&&cc.pointEqualToPoint(t.getOffset(),e._unflippedOffsetPositionFromCenter)},r._updateForSetSpriteFrame=function(){},r._spriteFrameLoadedCallback=function(t){var" s,o,a,c,h,l="i.pixelWidth,u=i.pixelHeight;e._rectRotated?(n.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(2*t.x+1)/(2*l),o=s+(2*t.height-2)/(2*l),a=(2*t.y+1)/(2*u),c=a+(2*t.width-2)/(2*u)):(s=t.x/l,o=(t.x+t.height)/l,a=t.y/u,c=(t.y+t.width)/u),e._flippedX&&(h=a,a=c,c=h),e._flippedY&&(h=s,s=o,o=h),r[0].u=o,r[0].v=a,r[1].u=s,r[1].v=a,r[2].u=o,r[2].v=c,r[3].u=s,r[3].v=c):(n.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(2*t.x+1)/(2*l),o=s+(2*t.width-2)/(2*l),a=(2*t.y+1)/(2*u),c=a+(2*t.height-2)/(2*u)):(s=t.x/l,o=(t.x+t.width)/l,a=t.y/u,c=(t.y+t.height)/u),e._flippedX&&(h=s,s=o,o=h),e._flippedY&&(h=a,a=c,c=h),r[0].u=s,r[0].v=a,r[1].u=s,r[1].v=c,r[2].u=o,r[2].v=a,r[3].u=o,r[3].v=c)}},r._setColorDirty=function(){},r._updateBlendFunc=function(){var" t="this._node;t._texture&&t._texture.hasPremultipliedAlpha()?(t._blendFunc.src=n.BLEND_SRC,t._blendFunc.dst=n.BLEND_DST,t.opacityModifyRGB=!0):(t._blendFunc.src=n.SRC_ALPHA,t._blendFunc.dst=n.ONE_MINUS_SRC_ALPHA,t.opacityModifyRGB=!1)},r._setTexture=function(t){var" n,r;i?(n="e.x+e.height,r=e.y+e.width):(n=e.x+e.width,r=e.y+e.height),n">t.width&&cc.errorID(3300,t.url),r>t.height&&cc.errorID(3400,t.url)}},r.transform=function(t,e){this.originTransform(t,e);var i=this._node,n=i._offsetPosition.x,r=n+i._rect.width,s=i._offsetPosition.y,o=s+i._rect.height,a=this._worldTransform,c=this._vertices;c[0].x=n*a.a+o*a.c+a.tx,c[0].y=n*a.b+o*a.d+a.ty,c[1].x=n*a.a+s*a.c+a.tx,c[1].y=n*a.b+s*a.d+a.ty,c[2].x=r*a.a+o*a.c+a.tx,c[2].y=r*a.b+o*a.d+a.ty,c[3].x=r*a.a+s*a.c+a.tx,c[3].y=r*a.b+s*a.d+a.ty},r.needDraw=function(){var t=this._node,e=t._texture;return this._needDraw&&e},r.uploadData=function(t,e,i){var n=this._node,r=n._texture;if(!(r&&r._textureLoaded&&n._rect.width&&n._rect.height&&this._displayedOpacity))return 0;var s,o=this._displayedOpacity,a=this._displayedColor._val;if(n._opacityModifyRGB){var c=o/255,h=this._displayedColor.r*c,l=this._displayedColor.g*c,u=this._displayedColor.b*c;s=(o<<24>>>0)+(u<<16)+(l<<8)+h}else s="(o<<24">>>0)+((65280&a)<<8)+((16711680&a)>>8)+(a>>>24);var _,d,f=n._vertexZ,p=this._vertices,m=p.length,g=i;for(_=0;_<m;++_)d=p[_],t[g]=d.x,t[g+1]=d.y,t[g+2]=f,e[g+3]=s,t[g+4]=d.u,t[g+5]=d.v,g+=6;return m}}),{}],207:[(function(t,e,i){var="" n,r,s,o,a,c="t("../event/event-target"),h={_pool:{},_lengths:[],put:function(t){var" e="t.length;this._pool[e]?this._pool[e].push(t):(this._pool[e]=[t],this._lengths.push(e),this._lengths.sort())},get:function(t){for(var" e,i="0;i<this._lengths.length;i++)if(this._lengths[i]">=t){e=this._lengths[i];break}return e?this._pool[e].pop():void 0}},l=cc.macro,u=[],_={_rebuildQuads_base:function(t,e,i,r){var s,o,a,c,l=t._vertices,_=t._renderCmd._worldTransform;if(r)s=0,o=0,a=i.width,c=i.height;else{var d=e._originalSize,f=e._rect,p=e._offset,m=i.width/d.width,g=i.height/d.height,v=p.x+(d.width-f.width)/2,y=p.x-(d.width-f.width)/2,x=p.y+(d.height-f.height)/2,T=p.y-(d.height-f.height)/2;s=v*m,o=x*g,a=i.width+y*m,c=i.height+T*g}if(l.length<8&&(h.put(l),l=h.get(8)||new float32array(8),t._vertices="l),n){var" b="s*_.a,C=s*_.b,A=a*_.a,S=a*_.b,E=c*_.c+_.tx,w=c*_.d+_.ty,I=o*_.c+_.tx,R=o*_.d+_.ty;l[0]=b+I,l[1]=C+R,l[2]=A+I,l[3]=S+R,l[4]=b+E,l[5]=C+w,l[6]=A+E,l[7]=S+w}else" l[0]="s,l[1]=o,l[2]=a,l[3]=o,l[4]=s,l[5]=c,l[6]=a,l[7]=c;u[0]=0,u[1]=2,u[2]=4,u[3]=6,t._uvsDirty&&this._calculateUVs(t,e),t._vertCount=4},_calculateUVs:function(t,e){var" i="t._uvs,n=e._texture._pixelWidth,r=e._texture._pixelHeight,s=e._rect;i.length<8&&(h.put(i),i=h.get(8)||new" float32array(8),t._uvs="i);var" o,a,c,u,_="l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(o=(s.x+_)/n,a=(s.y+s.width-_)/r,c=(s.x+s.height-_)/n,u=(s.y+_)/r,i[0]=o,i[1]=u,i[2]=o,i[3]=a,i[4]=c,i[5]=u,i[6]=c,i[7]=a):(o=(s.x+_)/n,a=(s.y+s.height-_)/r,c=(s.x+s.width-_)/n,u=(s.y+_)/r,i[0]=o,i[1]=a,i[2]=c,i[3]=a,i[4]=o,i[5]=u,i[6]=c,i[7]=u)}},d={x:new" array(4),y:new="" array(4),_rebuildquads_base:function(t,e,i,r,s,o,a){var="" c,l,_,d,f,p,m="t._vertices,g=t._renderCmd._worldTransform,v=e._rect;c=r,_=s,l=v.width-c-_,d=o,p=a,f=v.height-d-p;var" y="i,x=y.width-c-_,T=y.height-d-p,b=y.width/(c+_),C=y.height/(d+p);b=isNaN(b)||b">1?1:b,C=isNaN(C)||C>1?1:C,x=x<0?0:x,t=t<0?0:t;var a="this.x,S=this.y;A[0]=0,A[1]=c*b,A[2]=A[1]+x,A[3]=y.width,S[0]=0,S[1]=p*C,S[2]=S[1]+T,S[3]=y.height,m.length<32&&(h.put(m),m=h.get(32)||new" float32array(32),t._vertices="m);var" e,w,i="0;if(n)for(E=0;E<4;E++)for(w=0;w<4;w++)m[I]=A[w]*g.a+S[E]*g.c+g.tx,m[I+1]=A[w]*g.b+S[E]*g.d+g.ty,I+=2;else" for(e="0;E<4;E++)for(w=0;w<4;w++)m[I]=A[w],m[I+1]=S[E],I+=2;u[0]=0,u[1]=6,u[2]=24,u[3]=30,t._uvsDirty&&this._calculateUVs(t,e,r,s,o,a)},_calculateUVs:function(t,e,i,n,r,s){var" o,a,c,u,_,d,f="t._uvs,p=e._rect,m=e._texture._pixelWidth,g=e._texture._pixelHeight,v=e._rect;o=i,c=n,a=p.width-o-c,u=r,d=s,_=p.height-u-d,f.length<32&&(h.put(f),f=h.get(32)||new" float32array(32),t._uvs="f);var" y,x,t="this.x,b=this.y,C=l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0,A=0;if(e._rotated)for(T[0]=(v.x+C)/m,T[1]=(d+v.x)/m,T[2]=(d+_+v.x)/m,T[3]=(v.x+v.height-C)/m,b[3]=(v.y+C)/g,b[2]=(o+v.y)/g,b[1]=(o+a+v.y)/g,b[0]=(v.y+v.width-C)/g,y=0;y<4;y++)for(x=0;x<4;x++)f[A]=T[y],f[A+1]=b[3-x],A+=2;else" for(t[0]="(v.x+C)/m,T[1]=(o+v.x)/m,T[2]=(o+a+v.x)/m,T[3]=(v.x+v.width-C)/m,b[3]=(v.y+C)/g,b[2]=(u+v.y)/g,b[1]=(u+_+v.y)/g,b[0]=(v.y+v.height-C)/g,y=0;y<4;y++)for(x=0;x<4;x++)f[A]=T[x],f[A+1]=b[y],A+=2}},f={_rebuildQuads_base:function(t,e,i){var" r,s,o,a,c="t._vertices,_=t._renderCmd._worldTransform,d=t._uvs,f=e._texture._pixelWidth,p=e._texture._pixelHeight,m=e._rect,g=l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(r=(m.x+g)/f,o=(m.x+m.height-g)/f,s=(m.y+m.width-g)/p,a=(m.y+g)/p):(r=(m.x+g)/f,o=(m.x+m.width-g)/f,s=(m.y+m.height-g)/p,a=(m.y+g)/p);var" v="m.width,y=m.height,x=i.width/v,T=i.height/y,b=Math.ceil(T),C=Math.ceil(x);b*C">16384&&cc.errorID(2625);var A=b*C*4*2;c.length<a&&(h.put(c),c=h.get(a)||new float32array(a),t._vertices="c),d.length<A&&(h.put(d),d=h.get(A)||new" float32array(a),t._uvs="d);var" s,e,w,i,r="0;t._vertCount=0;for(var" p="0;P<b;++P)for(var" o="0;O<C;++O){if(S=v*O,E=y*P,w=v*Math.min(O+1,x),I=y*Math.min(P+1,T),n){var" b="S*_.a,D=S*_.b,M=w*_.a,L=w*_.b,N=I*_.c+_.tx,F=I*_.d+_.ty,k=E*_.c+_.tx,z=E*_.d+_.ty;c[R]=B+k,c[R+1]=D+z,c[R+2]=M+k,c[R+3]=L+z,c[R+4]=B+N,c[R+5]=D+F,c[R+6]=M+N,c[R+7]=L+F}else" c[r]="S,c[R+1]=E,c[R+2]=w,c[R+3]=E,c[R+4]=S,c[R+5]=I,c[R+6]=w,c[R+7]=I;if(e._rotated?(d[R]=r,d[R+1]=a,d[R+2]=r,d[R+3]=I=a+(s-a)*Math.min(1,x-O),d[R+4]=w=r+(o-r)*Math.min(1,T-P),d[R+5]=a,d[R+6]=w,d[R+7]=I):(d[R]=r,d[R+1]=s,d[R+2]=w=r+(o-r)*Math.min(1,x-O),d[R+3]=s,d[R+4]=r,d[R+5]=I=s+(a-s)*Math.min(1,T-P),d[R+6]=w,d[R+7]=I),R+=8,t._vertCount+=4,R">A)return}u[0]=0,u[1]=8*(C-1)+2,u[2]=(b-1)*C*8+4,u[3]=A-2}},p={_rebuildQuads_base:function(t,e,i,r,s,o){var a,c,_,d,f,p=t._vertices,m=t._renderCmd._worldTransform,g=t._uvs,v=0,y=0,T=i.width,b=i.height,C=e._texture._pixelWidth,A=e._texture._pixelHeight,S=e._rect,E=l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;e._rotated?(c=(S.x+E)/C,_=(S.y+S.width-E)/A,d=(S.x+S.height-E)/C,f=(S.y+E)/A):(c=(S.x+E)/C,_=(S.y+S.height-E)/A,d=(S.x+S.width-E)/C,f=(S.y+E)/A),p.length<8&&(h.put(p),p=h.get(8)||new float32array(8),t._vertices="p),g.length<8&&(h.put(g),g=h.get(8)||new" float32array(8),t._uvs="g);var" w="new" array(8);e._rotated?(w[0]="w[2]=c,w[4]=w[6]=d,w[3]=w[7]=_,w[1]=w[5]=f):(w[0]=w[4]=c,w[2]=w[6]=d,w[1]=w[3]=_,w[5]=w[7]=f),s=s">1?1:s,s=s<0?0:s,o=o<0?0:o,a=s+o,a=a>1?1:a;var I,R;switch(r){case x.HORIZONTAL:I=v+(T-v)*s,R=v+(T-v)*a,v=I,T=R,g[0]=w[0]+(w[2]-w[0])*s,g[1]=w[1],g[2]=w[0]+(w[2]-w[0])*a,g[3]=w[3],g[4]=w[4]+(w[6]-w[4])*s,g[5]=w[5],g[6]=w[4]+(w[6]-w[4])*a,g[7]=w[7];break;case x.VERTICAL:I=y+(b-y)*s,R=y+(b-y)*a,y=I,b=R,g[0]=w[0],g[1]=w[1]+(w[5]-w[1])*s,g[2]=w[2],g[3]=w[3]+(w[7]-w[3])*s,g[4]=w[4],g[5]=w[1]+(w[5]-w[1])*a,g[6]=w[6],g[7]=w[3]+(w[7]-w[3])*a;break;default:cc.errorID(2626)}if(n){var P=v*m.a,O=v*m.b,B=T*m.a,D=T*m.b,M=b*m.c+m.tx,L=b*m.d+m.ty,N=y*m.c+m.tx,F=y*m.d+m.ty;p[0]=P+N,p[1]=O+F,p[2]=B+N,p[3]=D+F,p[4]=P+M,p[5]=O+L,p[6]=B+M,p[7]=D+L}else p[0]=v,p[1]=y,p[2]=T,p[3]=y,p[4]=v,p[5]=b,p[6]=T,p[7]=b;t._vertCount=4,u[0]=0,u[1]=2,u[2]=4,u[3]=6}},m={_vertPos:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],_vertices:[cc.v2(0,0),cc.v2(0,0)],_uvs:[cc.v2(0,0),cc.v2(0,0)],_intersectPoint_1:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],_intersectPoint_2:[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],outVerts:null,outUvs:null,rawVerts:null,rawUvs:null,_rebuildQuads_base:function(t,e,i,n,r,s){for(var o=t._vertices,a=t._uvs,c=t._rawVerts,l=t._rawUvs,_=t._renderCmd._worldTransform;r>=1;)r-=1;for(;r<0;)r+=1;var d="n.x*i.width,f=n.y*i.height,p=cc.v2(d,f);r*=2*Math.PI,s*=2*Math.PI;var" m="r+s;this.outVerts=o,this.outUvs=a,this.rawVerts=c,this.rawUvs=l,this._calculateVertices(_,e,i),this._calculateUVs(e);var" g="this._vertPos,v=this._vertices;g[0].x=g[3].x=v[0].x,g[1].x=g[2].x=v[1].x,g[0].y=g[1].y=v[0].y,g[2].y=g[3].y=v[1].y,p.x">v[1].x&&(p.x=v[1].x),p.x<v[0].x&&(p.x=v[0].x),p.y<v[0].y&&(p.y=v[0].y),p.y>v[1].y&&(p.y=v[1].y),c[0]=c[4]=this._vertices[0].x,c[2]=c[6]=this._vertices[1].x,c[1]=c[3]=this._vertices[0].y,c[5]=c[7]=this._vertices[1].y,e._rotated?(l[0]=l[2]=this._uvs[0].x,l[4]=l[6]=this._uvs[1].x,l[3]=l[7]=this._uvs[0].y,l[1]=l[5]=this._uvs[1].y):(l[0]=l[4]=this._uvs[0].x,l[2]=l[6]=this._uvs[1].x,l[1]=l[3]=this._uvs[0].y,l[5]=l[7]=this._uvs[1].y);var y=[null,null,null,null];p.x!==this._vertices[0].x&&(y[0]=[3,0]),p.x!==this._vertices[1].x&&(y[2]=[1,2]),p.y!==this._vertices[0].y&&(y[1]=[0,1]),p.y!==this._vertices[1].y&&(y[3]=[2,3]),this._getInsectedPoints(this._vertices[0].x,this._vertices[1].x,this._vertices[0].y,this._vertices[1].y,p,r,this._intersectPoint_1),this._getInsectedPoints(this._vertices[0].x,this._vertices[1].x,this._vertices[0].y,this._vertices[1].y,p,r+s,this._intersectPoint_2);var x=30;o.length<x&&(h.put(o),o=h.get(x)||new float32array(x),this.outverts="t._vertices=o),a.length<x&&(h.put(a),a=h.get(x)||new" float32array(x),this.outuvs="t._uvs=a);for(var" t="0,b=0,C=0;C<4;++C){var" a="y[C];if(null!==A)if(s">=2*Math.PI)this._generateTriangle(_,T,p,this._vertPos[A[0]],this._vertPos[A[1]]),T+=6,b+=3;else{var S=this._getVertAngle(p,this._vertPos[A[0]]),E=this._getVertAngle(p,this._vertPos[A[1]]);E<s&&(e+=2*math.pi),s-=2*math.pi,e-=2*math.pi;for(var w="0;w<3;++w)S">=m||(S>=r?(E>=m?this._generateTriangle(_,T,p,this._vertPos[A[0]],this._intersectPoint_2[C]):this._generateTriangle(_,T,p,this._vertPos[A[0]],this._vertPos[A[1]]),T+=6,b+=3):E<=r||(e<=m?(this._generatetriangle(_,t,p,this._intersectpoint_1[c],this._vertpos[a[1]]),t+=6,b+=3):(this._generatetriangle(_,t,p,this._intersectpoint_1[c],this._intersectpoint_2[c]),t+=6,b+=3))),s+=2*math.pi,e+=2*math.pi}}t._vertcount=b,u[0]=0,u[1]=2,u[2]=4,u[3]=6},_generatetriangle:function(t,e,i,r,s){var o,a,c="this.rawVerts,h=this.rawUvs,l=this.outVerts,u=c[0],_=c[1],d=c[6],f=c[7];n?(l[e]=i.x*t.a+i.y*t.c+t.tx,l[e+1]=i.x*t.b+i.y*t.d+t.ty,l[e+2]=r.x*t.a+r.y*t.c+t.tx,l[e+3]=r.x*t.b+r.y*t.d+t.ty,l[e+4]=s.x*t.a+s.y*t.c+t.tx,l[e+5]=s.x*t.b+s.y*t.d+t.ty):(l[e]=i.x,l[e+1]=i.y,l[e+2]=r.x,l[e+3]=r.y,l[e+4]=s.x,l[e+5]=s.y),o=(i.x-u)/(d-u),a=(i.y-_)/(f-_),this._generateUV(o,a,h,e),o=(r.x-u)/(d-u),a=(r.y-_)/(f-_),this._generateUV(o,a,h,e+2),o=(s.x-u)/(d-u),a=(s.y-_)/(f-_),this._generateUV(o,a,h,e+4)},_generateUV:function(t,e,i,n){var" r="this.outUvs,s=i[0]+(i[2]-i[0])*t,o=i[4]+(i[6]-i[4])*t,a=i[1]+(i[3]-i[1])*t,c=i[5]+(i[7]-i[5])*t;" r[n]="s+(o-s)*e,r[n+1]=a+(c-a)*e},_isAngleIn:function(t,e,i){for(var" n="2*Math.PI;t<e||t">=e+n;)t<e&&(t+=n),t>=e+n&&(t-=n);return t<=e+i},_getvertangle:function(t,e){var i,n;if(i="e.x-t.x,n=e.y-t.y,0!==i||0!==n){if(0===i)return" n="">0?.5*Math.PI:1.5*Math.PI;var r=Math.atan(n/i);return i<0&&(r+=math.pi),r}},_getinsectedpoints:function(t,e,i,n,r,s,o){var a,c,h="[null,null,null,null],l=Math.sin(s),u=Math.cos(s);if(0!==Math.cos(s)){if(a=l/u,(t-r.x)*u">0){var _=r.y+a*(t-r.x);o[0].x=t,o[0].y=_}if((e-r.x)*u>0){var d=r.y+a*(e-r.x);o[2].x=e,o[2].y=d}}if(0!==Math.sin(s)){if(c=u/l,(n-r.y)*l>0){var f=r.x+c*(n-r.y);o[3].x=f,o[3].y=n}if((i-r.y)*l>0){var p=r.x+c*(i-r.y);o[1].x=p,o[1].y=i}}return h},_calculateVertices:function(t,e,i){var n,r,s,o;n=0,s=0,r=i.width,o=i.height,this._vertices[0].x=n,this._vertices[0].y=s,this._vertices[1].x=r,this._vertices[1].y=o},_calculateUVs:function(t){var e,i,n,r,s=t._texture._pixelWidth,o=t._texture._pixelHeight,a=t._rect,c=l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;t._rotated?(e=(a.x+c)/s,i=(a.x+a.height-c)/s,n=(a.y+c)/o,r=(a.y+a.width-c)/o):(e=(a.x+c)/s,i=(a.x+a.width-c)/s,n=(a.y+c)/o,r=(a.y+a.height-c)/o),this._uvs[0].x=e,this._uvs[0].y=r,this._uvs[1].x=i,this._uvs[1].y=n}},g={_rebuildQuads_base:function(t,e,i){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS&&i){var n=t._renderCmd._worldTransform,r=i.triangles.verts,s=t._vertices,o=t._uvs,a=r.length,c=2*a;s.length<c&&(h.put(s),s=h.get(c)||new float32array(c),t._vertices="s),o.length<c&&(h.put(o),o=h.get(c)||new" float32array(c),t._uvs="o);for(var" l="1/0,_=1/0,d=-(1/0),f=-(1/0),p=0;p<a;p++){var" m="r[p].x*n.a+r[p].y*n.c+n.tx,g=r[p].x*n.b+r[p].y*n.d+n.ty;s[2*p]=m,s[2*p+1]=g,o[2*p]=r[p].u,o[2*p+1]=r[p].v,m<l&&(l=m,u[0]=2*p),m">d&&(d=m,u[1]=2*p),g<_&&(_=g,u[2]=2*p),g>f&&(f=g,u[3]=2*p)}t._vertCount=a}}};cc.Scale9Sprite=_ccsg.Node.extend({_spriteFrame:null,_insetLeft:0,_insetRight:0,_insetTop:0,_insetBottom:0,_blendFunc:null,_renderingType:1,_brightState:0,_rawVerts:null,_rawUvs:null,_vertices:null,_uvs:null,_vertCount:0,_quadsDirty:!0,_uvsDirty:!0,_isTriangle:!1,_isTrimmedContentSize:!0,_fillType:0,_fillCenter:null,_fillStart:0,_fillRange:2*Math.PI,_distortionOffset:null,_distortionTiling:null,_meshPolygonInfo:null,ctor:function(t){_ccsg.Node.prototype.ctor.call(this),this._renderCmd.setState(this._brightState),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),this._fillCenter=cc.v2(0,0),this.setAnchorPoint(cc.p(.5,.5)),this._rawVerts=null,this._rawUvs=null,this._vertices=h.get(8)||new Float32Array(8),this._uvs=h.get(8)||new Float32Array(8),"string"==typeof t||t instanceof cc.Texture2D?this.initWithTexture(t):t instanceof cc.SpriteFrame&&this.initWithSpriteFrame(t),void 0===n&&(n=cc._renderType===cc.game.RENDER_TYPE_WEBGL,r=cc.visibleRect.left,a=cc.visibleRect.right,o=cc.visibleRect.top,s=cc.visibleRect.bottom)},loaded:function(){return null!==this._spriteFrame&&this._spriteFrame.textureLoaded()},initWithTexture:function(t){this.setTexture(t)},initWithSpriteFrame:function(t){this.setSpriteFrame(t)},setTexture:function(t){var e=new cc.SpriteFrame(t);this.setSpriteFrame(e)},setSpriteFrame:function(t){if(t){this._spriteFrame=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd._needDraw=!1;var e=this,i=function(){cc.sizeEqualToSize(e._contentSize,cc.size(0,0))&&e.setContentSize(e._spriteFrame._rect),e._renderCmd._needDraw=!0,e._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)};t.textureLoaded()?i():t.once("load",i,this)}},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src||cc.macro.BLEND_SRC,this._blendFunc.dst=t.dst||cc.macro.BLEND_DST):(this._blendFunc.src=t||cc.macro.BLEND_SRC,this._blendFunc.dst=e||cc.macro.BLEND_DST),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setContentSize:function(t,e){void 0===e&&(e=t.height,t=t.width),t===this._contentSize.width&&e===this._contentSize.height||(_ccsg.Node.prototype.setContentSize.call(this,t,e),this._quadsDirty=!0)},enableTrimmedContentSize:function(t){this._isTrimmedContentSize!==t&&(this._isTrimmedContentSize=t,this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},isTrimmedContentSizeEnabled:function(){return this._isTrimmedContentSize},setState:function(t){this._brightState=t,this._renderCmd.setState(t),this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getState:function(){return this._brightState},setRenderingType:function(t){this._renderingType!==t&&(this._renderingType=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},getRenderingType:function(){return this._renderingType},setInsetLeft:function(t){this._insetLeft=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetLeft:function(){return this._insetLeft},setInsetTop:function(t){this._insetTop=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetTop:function(){return this._insetTop},setInsetRight:function(t){this._insetRight=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetRight:function(){return this._insetRight},setInsetBottom:function(t){this._insetBottom=t,this._quadsDirty=!0,this._uvsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)},getInsetBottom:function(){return this._insetBottom},setFillType:function(t){this._fillType!==t&&(this._fillType=t,this._renderingType===y.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillType:function(){return this._fillType},setFillCenter:function(t,e){this._fillCenter=cc.v2(t,e),this._renderingType===y.FILLED&&this._fillType===x.RADIAL&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty))},setDistortionTiling:function(t,e){void 0===e&&(e=t.y,t=t.x),this._distortionTiling=this._distortionTiling||cc.v2(0,0),this._distortionTiling.x=t,this._distortionTiling.y=e},setDistortionOffset:function(t,e){void 0===e&&(e=t.y,t=t.x),this._distortionOffset=this._distortionOffset||cc.v2(0,0),this._distortionOffset.x=t,this._distortionOffset.y=e},getFillCenter:function(){return cc.v2(this._fillCenter)},setFillStart:function(t){this._fillStart!==t&&(this._fillStart=t,this._renderingType===y.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillStart:function(){return this._fillStart},setFillRange:function(t){this._fillRange!==t&&(this._fillRange=t,this._renderingType===y.FILLED&&(this._quadsDirty=!0,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty)))},getFillRange:function(){return this._fillRange},_rebuildQuads:function(){if(!this._spriteFrame||!this._spriteFrame._textureLoaded)return void(this._renderCmd._needDraw=!1);switch(this._isTriangle=!1,this._renderingType){case y.SIMPLE:_._rebuildQuads_base(this,this._spriteFrame,this._contentSize,this._isTrimmedContentSize);break;case y.SLICED:d._rebuildQuads_base(this,this._spriteFrame,this._contentSize,this._insetLeft,this._insetRight,this._insetTop,this._insetBottom);break;case y.TILED:f._rebuildQuads_base(this,this._spriteFrame,this._contentSize);break;case y.FILLED:var t=this._fillStart,e=this._fillRange;e<0&&(t+=e,e=-e),this._filltype!==x.radial?(e=t+e,t=t>1?1:t,t=t<0?0:t,e=e>1?1:e,e=e<0?0:e,e-=t,p._rebuildquads_base(this,this._spriteframe,this._contentsize,this._filltype,t,e)):(this._istriangle=!0,this._rawverts||(this._rawverts=h.get(8)||new float32array(8),this._rawuvs="h.get(8)||new" float32array(8)),m._rebuildquads_base(this,this._spriteframe,this._contentsize,this._fillcenter,t,e));break;case="" y.mesh:g._rebuildquads_base(this,this._spriteframe,this._meshpolygoninfo);break;default:return="" this._quadsdirty="!1,this._uvsDirty=!1,this._renderCmd._needDraw=!1,void" cc.errorid(2627)}if(n);else{var="" i="this._renderCmd._currentRegion,c=i._minX,l=i._maxX,u=i._minY,v=i._maxY;l<r.x||c">a.x||v<s.y||u>o.y?this._renderCmd._needDraw=!1:this._renderCmd._needDraw=!0}this._quadsDirty=!1,this._uvsDirty=!1},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Scale9Sprite.CanvasRenderCmd(this):new cc.Scale9Sprite.WebGLRenderCmd(this)},setMeshPolygonInfo:function(t){this.setRenderingType(y.MESH),this._meshPolygonInfo=t,this._quadsDirty=!0,this._uvsDirty=!0},getMeshPolygonInfo:function(){return this._meshPolygonInfo}});var v=cc.Scale9Sprite.prototype;cc.js.addon(v,c.prototype),cc.defineGetterSetter(v,"insetLeft",v.getInsetLeft,v.setInsetLeft),cc.defineGetterSetter(v,"insetTop",v.getInsetTop,v.setInsetTop),cc.defineGetterSetter(v,"insetRight",v.getInsetRight,v.setInsetRight),cc.defineGetterSetter(v,"insetBottom",v.getInsetBottom,v.setInsetBottom),cc.Scale9Sprite.state={NORMAL:0,GRAY:1,DISTORTION:2};var y=cc.Scale9Sprite.RenderingType=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3,MESH:4}),x=cc.Scale9Sprite.FillType=cc.Enum({HORIZONTAL:0,VERTICAL:1,RADIAL:2})}),{"../event/event-target":112}],208:[(function(t,e,i){cc.Scale9Sprite.CanvasRenderCmd=function(t){this._rootCtor(t),this._node.loaded()?this._needDraw=!0:this._needDraw=!1,this._state=cc.Scale9Sprite.state.NORMAL,this._originalTexture=this._textureToRender=null};var n=cc.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.Scale9Sprite.CanvasRenderCmd,n.transform=function(t,e){this.originTransform(t,e),this._node._rebuildQuads()},n._updateDisplayColor=function(t){_ccsg.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(this,t),this._originalTexture=this._textureToRender=null},n.setState=function(t){this._state!==t&&(this._state=t,this._originalTexture=this._textureToRender=null)},n.rendering=function(t,e,i){var n=this._node,r=this._displayedOpacity,s=r/255,o=null;if(n._spriteFrame&&(o=n._spriteFrame._texture),n.loaded()&&0!==r){if(null===this._textureToRender||this._originalTexture!==o){this._textureToRender=this._originalTexture=o,cc.Scale9Sprite.state.GRAY===this._state&&(this._textureToRender=this._textureToRender._generateGrayTexture());var a=n.getDisplayedColor();!o||255===a.r&&255===a.g&&255===a.b||(this._textureToRender=this._textureToRender._generateColorTexture(a.r,a.g,a.b))}var c=t||cc._renderContext,h=c.getContext();if(c.setTransform(this._worldTransform,e,i),c.setCompositeOperation(_ccsg.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(n._blendFunc)),c.setGlobalAlpha(s),this._textureToRender){n._quadsDirty&&n._rebuildQuads();var l,u,_,d,f,p,m,g,v=this._textureToRender._pixelWidth,y=this._textureToRender._pixelHeight,x=this._textureToRender._htmlElementObj,T=n._vertices,b=n._uvs,C=0,A=0;if(n._isTriangle){var S=n._rawVerts,E=n._rawUvs;f=S[0],p=S[1],m=S[6]-f,g=S[7]-p,p=-p-g,l=E[4]*v,u=E[5]*y,_=(E[6]-E[0])*v,d=(E[1]-E[7])*y,c.save(),h.beginPath();var w=Math.floor(n._vertCount/3);for(C=0,A=0;C<w;c++)h.moveto(t[a++],-t[a++]),h.lineto(t[a++],-t[a++]),h.lineto(t[a++],-t[a++]);h.clip(),""!==this._texturetorender._pattern?(c.setfillstyle(h.createpattern(x,this._texturetorender._pattern)),h.fillrect(f,p,m,g)):_>0&&d>0&&m>0&&g>0&&h.drawImage(x,l,u,_,d,f,p,m,g),c.restore(),cc.g_NumberOfDraws+=w}else if(n._renderingType===cc.Scale9Sprite.RenderingType.SLICED){for(var I=0;I<3;++i)for(var r="0;R<3;++R)A=8*I+2*R,f=T[A],p=T[A+1],m=T[A+10]-f,g=T[A+11]-p,p=-p-g,l=b[A]*v,u=b[A+11]*y,_=(b[A+10]-b[A])*v,d=(b[A+1]-b[A+11])*y,_">0&&d>0&&m>0&&g>0&&h.drawImage(x,l,u,_,d,f,p,m,g);cc.g_NumberOfDraws+=9}else{var P=Math.floor(n._vertCount/4);for(C=0,A=0;C<p;c++)f=t[a],p=t[a+1],m=t[a+6]-f,g=t[a+7]-p,p=-p-g,l=b[a]*v,u=b[a+7]*y,_=(b[a+6]-b[a])*v,d=(b[a+1]-b[a+7])*y,""!==this._texturetorender._pattern?(c.setfillstyle(h.createpattern(x,this._texturetorender._pattern)),h.fillrect(f,p,m,g)):_>0&&d>0&&m>0&&g>0&&h.drawImage(x,l,u,_,d,f,p,m,g),A+=8;cc.g_NumberOfDraws+=P}}}}}),{}],209:[(function(t,e,i){cc.gl;cc.Scale9Sprite.WebGLRenderCmd=function(t){this._rootCtor(t),this._node.loaded()?this._needDraw=!0:this._needDraw=!1,this.vertexType=cc.renderer.VertexType.QUAD,this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var n=cc.Scale9Sprite,r=n.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);r.constructor=n.WebGLRenderCmd,r._uploadSliced=function(t,e,i,n,r,s,o){for(var a,c=0;c<3;++c)for(var h="0;h<3;++h)a=8*c+2*h,r[o]=t[a],r[o+1]=t[a+1],r[o+2]=n,s[o+3]=i,r[o+4]=e[a],r[o+5]=e[a+1],o+=6,r[o]=t[a+2],r[o+1]=t[a+3],r[o+2]=n,s[o+3]=i,r[o+4]=e[a+2],r[o+5]=e[a+3],o+=6,r[o]=t[a+8],r[o+1]=t[a+9],r[o+2]=n,s[o+3]=i,r[o+4]=e[a+8],r[o+5]=e[a+9],o+=6,r[o]=t[a+10],r[o+1]=t[a+11],r[o+2]=n,s[o+3]=i,r[o+4]=e[a+10],r[o+5]=e[a+11],o+=6;return" 36},r.transform="function(t,e){this.originTransform(t,e),this._node._rebuildQuads()},r.uploadData=function(t,e,i){var" r="this._node;if(0===this._displayedOpacity)return" 0;r._quadsdirty&&r._rebuildquads(),r._distortionoffset&&this._shaderprogram="==n.WebGLRenderCmd._distortionProgram&&(this._shaderProgram.use(),this._shaderProgram.setUniformLocationWith2f(n.WebGLRenderCmd._distortionOffset,r._distortionOffset.x,r._distortionOffset.y),this._shaderProgram.setUniformLocationWith2f(n.WebGLRenderCmd._distortionTiling,r._distortionTiling.x,r._distortionTiling.y),cc.renderer._breakBatch());var" s,o="this._displayedOpacity,a=this._displayedColor._val;if(r._opacityModifyRGB){var" c="o/255,h=this._displayedColor.r*c,l=this._displayedColor.g*c,u=this._displayedColor.b*c;s=(o<<24">>>0)+(u<<16)+(l<<8)+h}else s="(o<<24">>>0)+((65280&a)<<8)+((16711680&a)>>8)+(a>>>24);var _=r._vertexZ,d=r._vertices,f=r._uvs,p=n.RenderingType,m=i,g=0;switch(r._renderingType){case p.SIMPLE:case p.TILED:case p.FILLED:case p.MESH:g=this._node._vertCount;for(var v=0,y=0;v<g;v++,y+=2)t[m]=d[y],t[m+1]=d[y+1],t[m+2]=_,e[m+3]=s,t[m+4]=f[y],t[m+5]=f[y+1],m+=6;break;case 0="==e?this._blendFunc=t:this._blendFunc={src:t,dst:e}},getBlendFunc:function(){return" p.sliced:g="this._uploadSliced(d,f,s,_,t,e,m)}return" r._renderingtype="==p.MESH?this.vertexType=cc.renderer.VertexType.CUSTOM:r._renderingType===p.FILLED&&r._fillType===n.FillType.RADIAL?this.vertexType=cc.renderer.VertexType.TRIANGLE:this.vertexType=cc.renderer.VertexType.QUAD,g},r.uploadIndexData=function(t,e,i){var" n="this._node._meshPolygonInfo;if(!n)return" 0;for(var="" r="n.triangles.indices,s=r.length,o=0;o<s;o++)t[e+o]=i+r[o];return" s},r.setstate="function(t){t===n.state.NORMAL?this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLOR):t===n.state.GRAY?this._shaderProgram=cc.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram():t===n.state.DISTORTION&&(this._shaderProgram=cc.Scale9Sprite.WebGLRenderCmd._getDistortionProgram())},n.WebGLRenderCmd._grayShaderProgram=null,n.WebGLRenderCmd._getGrayShaderProgram=function(){var" t="n.WebGLRenderCmd._grayShaderProgram;return" t?t:(t="new" cc.glprogram,t.initwithvertexshaderbytearray(cc.presetshaders.sprite_position_texture_color_vert,cc.scale9sprite.webglrendercmd._grayshaderfragment),t.addattribute(cc.macro.attribute_name_position,cc.macro.vertex_attrib_position),t.addattribute(cc.macro.attribute_name_color,cc.macro.vertex_attrib_color),t.addattribute(cc.macro.attribute_name_tex_coord,cc.macro.vertex_attrib_tex_coords),t.link(),t.updateuniforms(),n.webglrendercmd._grayshaderprogram="t,t)},n.WebGLRenderCmd._grayShaderFragment="precision" lowp="" float;\nvarying="" vec4="" v_fragmentcolor;\nvarying="" vec2="" v_texcoord;\nvoid="" main()\n{\nvec4="" c="texture2D(CC_Texture0," v_texcoord);\ngl_fragcolor.xyz="vec3(0.2126*c.r" +="" 0.7152*c.g="" 0.0722*c.b);\ngl_fragcolor.w="c.w" ;\n}",n.webglrendercmd._distortionprogram="null,n.WebGLRenderCmd._getDistortionProgram=function(){var" cc.glprogram,t.initwithvertexshaderbytearray(cc.presetshaders.sprite_position_texture_color_vert,s.fshader),t.addattribute(cc.macro.attribute_name_position,cc.macro.vertex_attrib_position),t.addattribute(cc.macro.attribute_name_color,cc.macro.vertex_attrib_color),t.addattribute(cc.macro.attribute_name_tex_coord,cc.macro.vertex_attrib_tex_coords),t.link(),t.updateuniforms(),n.webglrendercmd._distortionprogram="t,n.WebGLRenderCmd._distortionOffset=t.getUniformLocationForName("u_offset"),n.WebGLRenderCmd._distortionTiling=t.getUniformLocationForName("u_offset_tiling"),t)};var" s="{shaderKey:"cc.Sprite.Shader.Distortion",fShader:"precision" v_texcoord;\nuniform="" u_offset;\nuniform="" u_offset_tiling;\nconst="" float="" pi="3.14159265359;\nvoid" main()\n{\nfloat="" halfpi="0.5" *="" pi;\nfloat="" maxfactor="sin(halfPI);\nvec2" uv="v_texCoord;\nvec2" xy="2.0" uv.xy="" -="" 1.0;\nfloat="" d="length(xy);\nif" (d="" <="" (2.0-maxfactor))="" {\nd="length(xy" maxfactor);\nfloat="" z="sqrt(1.0" d);\nfloat="" z)="" phi="atan(xy.y," xy.x);\nuv.x="r" cos(phi)="" 0.5;\nuv.y="r" sin(phi)="" 0.5;\n}="" else="" {\ndiscard;\n}\nuv="uv" u_offset_tiling="" u_offset;\nuv="fract(uv);\ngl_FragColor" =="" v_fragmentcolor="" texture2d(cc_texture0,="" uv);\n}"}}),{}],210:[(function(t,e,i){cc.spritebatchnode="_ccsg.Node.extend({_blendFunc:null,_texture:null,_className:"SpriteBatchNode",ctor:function(t){_ccsg.Node.prototype.ctor.call(this),this._blendFunc=new" cc.blendfunc(cc.macro.blend_src,cc.macro.blend_dst);var="" e;cc.js.isstring(t)?(e="cc.textureCache.getTextureForKey(t),e||(e=cc.textureCache.addImage(t))):t" instanceof="" cc.texture2d&&(e="t),e&&this.initWithTexture(e)},addSpriteWithoutQuad:function(t,e,i){return" this.addchild(t,e,i),this},gettextureatlas:function(){return="" null},settextureatlas:function(t){},getdescendants:function(){return="" this._children},initwithfile:function(t,e){var="" i="cc.textureCache.getTextureForKey(t);return" i||(i="cc.textureCache.addImage(t)),this.initWithTexture(i,e)},init:function(t,e){var" e},highestatlasindexinchild:function(t){var="" e="t.children;return" e&&0!="=e.length?this.highestAtlasIndexInChild(e[e.length-1]):t.zIndex},lowestAtlasIndexInChild:function(t){var" t.zindex},reorderbatch:function(t){this._reorderchilddirty="t},setBlendFunc:function(t,e){void" new="" cc.blendfunc(this._blendfunc.src,this._blendfunc.dst)},updatequadfromsprite:function(t,e){return="" cc.assertid(t,2623),t="" _ccsg.sprite?(t.dirty="!0,void" t._rendercmd.transform(this._rendercmd,!0)):void="" cc.log(2616)},insertquadfromsprite:function(t,e){this.addchild(t,e)},insertchild:function(t,e){this.addchild(t,e)},appendchild:function(t){this.sortallchildren();this._children[this._children.length-1]._localzorder;this.addchild(t.lastlocalzorder+1)},removespritefromatlas:function(t,e){this.removechild(t,e)},initwithtexture:function(t){return="" this.settexture(t),!0},gettexture:function(){return="" this._texture},settexture:function(t){if(this._texture="t,t._textureLoaded){var" e,i="this._children,n=i.length;for(e=0;e<n;++e)i[e].setTexture(t)}else" t.addeventlistener("load",(function(){var="" 0!="=t,2614),this._isValidChild(t)&&(e=void" _ccsg.sprite?t.texture="==this._texture||(cc.logID(2619),!1):(cc.logID(2618),!1)}});var" this._textureloaded},addloadedeventlistener:function(t,e){this.once("load",t,e)},isrotated:function(){return="" this._rotated},setrotated:function(t){this._rotated="t},getRect:function(){return" cc.rect(this._rect)},setrect:function(t){this._rect="t},getOriginalSize:function(){return" cc.size(this._originalsize)},setoriginalsize:function(t){this._originalsize?(this._originalsize.width="t.width,this._originalSize.height=t.height):this._originalSize=cc.size(t)},getTexture:function(){return" this._texture},_refreshtexture:function(t){function="" e(){if(i._texture){i._textureloaded="!0;var" cc.texture2d;s.initwithelement(r),s.handleloadedtexture(),i._texture="s,i._rotated=!1,e=i._texture.width,n=i._texture.height,i.setRect(cc.rect(0,0,e,n))}i._rect?i._checkRect(i._texture):i.setRect(cc.rect(0,0,e,n)),i._originalSize||i.setOriginalSize(cc.size(e,n)),i._offset||i.setOffset(cc.v2(0,0)),i.emit("load")}}var" cc.v2(this._offset)},setoffset:function(t){this._offset="cc.v2(t)},clone:function(){return" cc.spriteframe(this._texture||this._texturefilename,this._rect,this._rotated,this._offset,this._originalsize)},settexture:function(t,e,i,n,r){e?this.setrect(e):this._rect="null,n?this.setOffset(n):this._offset=null,r?this.setOriginalSize(r):this._originalSize=null,this._rotated=i||!1;var" cc.js.isstring(s)?(this._texturefilename="s,this._loadTexture()):s" cc.texture2d&&this._refreshtexture(s),!0},_loadtexture:function(){if(this._texturefilename){var="">t.getPixelWidth()&&cc.errorID(3300,t.url+"/"+this.name),n>t.getPixelHeight()&&cc.errorID(3400,t.url+"/"+this.name)},_serialize:!1,_deserialize:function(t,e){var i=t.rect;i&&this.setRect(new cc.Rect(i[0],i[1],i[2],i[3])),t.offset&&this.setOffset(new cc.Vec2(t.offset[0],t.offset[1])),t.originalSize&&this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1])),this._rotated=1===t.rotated,this._name=t.name;var n=t.capInsets;n&&(this.insetLeft=n[0],this.insetTop=n[1],this.insetRight=n[2],this.insetBottom=n[3]);var r=t.texture;if(r){var s=e.customEnv&&e.customEnv.deferredLoadRaw,o=s?"_textureFilename":"_textureFilenameSetter";e.result.push(this,o,r)}}});var r=cc.SpriteFrame.prototype;r.copyWithZone=r.clone,r.copy=r.clone,r.initWithTexture=r.setTexture}),{"../assets/CCAsset":44,"../event/event-target":112}],212:[(function(t,e,i){cc._tmp.PrototypeSprite=function(){var t=_ccsg.Sprite.prototype;cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB,t.setOpacityModifyRGB),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),t.dirty,t.flippedX,cc.defineGetterSetter(t,"flippedX",t.isFlippedX,t.setFlippedX),t.flippedY,cc.defineGetterSetter(t,"flippedY",t.isFlippedY,t.setFlippedY),t.offsetX,cc.defineGetterSetter(t,"offsetX",t._getOffsetX),t.offsetY,cc.defineGetterSetter(t,"offsetY",t._getOffsetY),t.atlasIndex,t.texture,cc.defineGetterSetter(t,"texture",t.getTexture,t.setTexture),t.textureRectRotated,cc.defineGetterSetter(t,"textureRectRotated",t.isTextureRectRotated),t.textureAtlas,t.batchNode,cc.defineGetterSetter(t,"batchNode",t.getBatchNode,t.setBatchNode),t.quad,cc.defineGetterSetter(t,"quad",t.getQuad)}}),{}],213:[(function(t,e,i){var n=t("../event/event-target"),r=t("../platform/CCSys"),s=(t("../platform/js"),t("../utils/misc")),o=t("../CCGame");t("../platform/_CCClass"),t("../platform/CCClass");var a=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648}),c=cc.Class({name:"cc.Texture2D",extends:t("../assets/CCRawAsset"),mixins:[n],statics:{WrapMode:a},ctor:function(){this.url=null,this._textureLoaded=!1,this._htmlElementObj=null,this._contentSize=cc.size(0,0),this._pixelWidth=0,this._pixelHeight=0,cc._renderType===o.RENDER_TYPE_CANVAS?(this._pattern="",this._grayElementObj=null,this._backupElement=null,this._isGray=!1):cc._renderType===o.RENDER_TYPE_WEBGL&&(this._pixelFormat=c.defaultPixelFormat,this._hasPremultipliedAlpha=!1,this._hasMipmaps=!1,this._webTextureObj=null)},getPixelWidth:function(){return this._pixelWidth},getPixelHeight:function(){return this._pixelHeight},getContentSize:function(){return cc.size(this._contentSize.width,this._contentSize.height)},_getWidth:function(){return this._contentSize.width},_getHeight:function(){return this._contentSize.height},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(t){t&&(this._htmlElementObj=t,this._pixelWidth=this._contentSize.width=t.width,this._pixelHeight=this._contentSize.height=t.height,this._textureLoaded=!0)},initWithData:function(t,e,i,n,r){return!1},initWithImage:function(t){return!1},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var t=this;if(t._htmlElementObj&&t._htmlElementObj.width&&t._htmlElementObj.height){var e=t._htmlElementObj;t._pixelWidth=t._contentSize.width=e.width,t._pixelHeight=t._contentSize.height=e.height,t._textureLoaded=!0,t.emit("load")}},description:function(){return"<cc.texture2d |="" name="+this.getName()+" dimensions="+this.getPixelWidth()+" x="" "+this.getpixelheight()+"="">"},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj)},getName:function(){return this._webTextureObj||null},getPixelFormat:function(){return this._pixelFormat||null},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha||!1},hasMipmaps:function(){return this._hasMipmaps||!1},setTexParameters:function(t,e,i,n){return void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),t.wrapS===a.REPEAT&&t.wrapT===a.REPEAT?void(this._pattern="repeat"):t.wrapS===a.REPEAT?void(this._pattern="repeat-x"):t.wrapT===a.REPEAT?void(this._pattern="repeat-y"):void(this._pattern="")},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(t){return-1}});c.WrapMode=a;var h=c;h.PIXEL_FORMAT_RGBA8888=2,h.PIXEL_FORMAT_RGB888=3,h.PIXEL_FORMAT_RGB565=4,h.PIXEL_FORMAT_A8=5,h.PIXEL_FORMAT_I8=6,h.PIXEL_FORMAT_AI88=7,h.PIXEL_FORMAT_RGBA4444=8,h.PIXEL_FORMAT_RGB5A1=7,h.PIXEL_FORMAT_PVRTC4=9,h.PIXEL_FORMAT_PVRTC2=10,h.PIXEL_FORMAT_DEFAULT=h.PIXEL_FORMAT_RGBA8888,h.defaultPixelFormat=h.PIXEL_FORMAT_DEFAULT;var l=c._M={};l[h.PIXEL_FORMAT_RGBA8888]="RGBA8888",l[h.PIXEL_FORMAT_RGB888]="RGB888",l[h.PIXEL_FORMAT_RGB565]="RGB565",l[h.PIXEL_FORMAT_A8]="A8",l[h.PIXEL_FORMAT_I8]="I8",l[h.PIXEL_FORMAT_AI88]="AI88",l[h.PIXEL_FORMAT_RGBA4444]="RGBA4444",l[h.PIXEL_FORMAT_RGB5A1]="RGB5A1",l[h.PIXEL_FORMAT_PVRTC4]="PVRTC4",l[h.PIXEL_FORMAT_PVRTC2]="PVRTC2";var u=c._B={};u[h.PIXEL_FORMAT_RGBA8888]=32,u[h.PIXEL_FORMAT_RGB888]=24,u[h.PIXEL_FORMAT_RGB565]=16,u[h.PIXEL_FORMAT_A8]=8,u[h.PIXEL_FORMAT_I8]=8,u[h.PIXEL_FORMAT_AI88]=16,u[h.PIXEL_FORMAT_RGBA4444]=16,u[h.PIXEL_FORMAT_RGB5A1]=16,u[h.PIXEL_FORMAT_PVRTC4]=4,u[h.PIXEL_FORMAT_PVRTC2]=3;var _=c.prototype;_.name,cc.defineGetterSetter(_,"name",_.getName),_.pixelFormat,cc.defineGetterSetter(_,"pixelFormat",_.getPixelFormat),_.pixelWidth,cc.defineGetterSetter(_,"pixelWidth",_.getPixelWidth),_.pixelHeight,cc.defineGetterSetter(_,"pixelHeight",_.getPixelHeight),_.width,cc.defineGetterSetter(_,"width",_._getWidth),_.height,cc.defineGetterSetter(_,"height",_._getHeight),o.once(o.EVENT_RENDERER_INITED,(function(){if(cc._renderType===o.RENDER_TYPE_CANVAS){var t=function(t,e){var i=t.width,n=t.height;e[0].width=i,e[0].height=n,e[1].width=i,e[1].height=n,e[2].width=i,e[2].height=n,e[3].width=i,e[3].height=n;var r=e[3].getContext("2d");r.drawImage(t,0,0);for(var s,o=r.getImageData(0,0,i,n).data,a=0;a<4;a++){s=e[a].getcontext("2d");for(var c="s.getImageData(0,0,i,n),h=c.data,l=0;l<o.length;l+=4)h[l]=0===a?o[l]:0,h[l+1]=1===a?o[l+1]:0,h[l+2]=2===a?o[l+2]:0,h[l+3]=o[l+3];s.putImageData(c,0,0)}t.onload=null},e=function(t,e,i){if(null===t)return" null;i="i||document.createElement("canvas"),e=e||cc.rect(0,0,t.width,t.height),i.width=e.width,i.height=e.height;var" n="i.getContext("2d");n.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);for(var" r="n.getImageData(0,0,e.width,e.height),s=r.data,o=0,a=s.length;o<a;o+=4)s[o]=s[o+1]=s[o+2]=.34*s[o]+.5*s[o+1]+.16*s[o+2];return" n.putimagedata(r,0,0),i};_._generatetexturecacheforcolor="function(){if(this.channelCache)return" this.channelcache;var="" e="[document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas")];return" t(this._htmlelementobj,e),this.channelcache="e},_._switchToGray=function(t){this._textureLoaded&&this._isGray!==t&&(this._isGray=t,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=e(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))},_._generateGrayTexture=function(){if(!this._textureLoaded)return" null;var="" t="e(this._htmlElementObj),i=new" c;return="" i.initwithelement(t),i.handleloadedtexture(),i},_._generatecolortexture="r._supportCanvasNewBlendModes?function(t,e,i,n,r){var" s="!1;r?s=!0:r=document.createElement("canvas");var" o="this._htmlElementObj;if(n||(n=cc.rect(0,0,o.width,o.height)),r.width=n.width,r.height=n.height,n.width&&n.height){var" a="r.getContext("2d");a.globalCompositeOperation="source-over",a.fillStyle="rgb("+(0|t)+","+(0|e)+","+(0|i)+")",a.fillRect(0,0,n.width,n.height),a.globalCompositeOperation="multiply",a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),a.globalCompositeOperation="destination-atop",a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height)}if(s)return" r;var="" h="new" h.initwithelement(r),h.handleloadedtexture(),h}:function(t,e,i,n,r){var="" u="0;u<l.length;u+=4)l[u]=l[u]*t,l[u+1]=l[u+1]*e,l[u+2]=l[u+2]*i;a.putImageData(h,0,0)}if(s)return" _="new" _.initwithelement(r),_.handleloadedtexture(),_}}else="" cc._rendertype="==o.RENDER_TYPE_WEBGL&&(_.initWithData=function(t,e,i,n,r){var" a.texparameteri(a.texture_2d,a.texture_wrap_s,a.clamp_to_edge),a.texparameteri(a.texture_2d,a.texture_wrap_t,a.clamp_to_edge),e){case="" o.pixel_format_rgba8888:h="a.RGBA;break;case" o.pixel_format_rgb888:h="a.RGB;break;case" o.pixel_format_rgba4444:l="a.UNSIGNED_SHORT_4_4_4_4;break;case" o.pixel_format_rgb5a1:l="a.UNSIGNED_SHORT_5_5_5_1;break;case" o.pixel_format_rgb565:l="a.UNSIGNED_SHORT_5_6_5;break;case" o.pixel_format_ai88:h="a.LUMINANCE_ALPHA;break;case" o.pixel_format_a8:h="a.ALPHA;break;case" o.pixel_format_i8:h="a.LUMINANCE;break;default:cc.assertID(0,3113)}return" a.teximage2d(a.texture_2d,0,h,i,n,0,h,l,t),s._contentsize.width="r.width,s._contentSize.height=r.height,s._pixelWidth=i,s._pixelHeight=n,s._pixelFormat=e,s._hasPremultipliedAlpha=!1,s._hasMipmaps=!1,s._textureLoaded=!0,!0},_.initWithImage=function(t){if(null==t)return" cc.logid(3104),!1;var="">n||i>n?(cc.logID(3105,e,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(t,e,i))},_.initWithElement=function(t){t&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=t,this._textureLoaded=!0)},_.handleLoadedTexture=function(t){t=!!t;var e=this;if(o._rendererInitialized&&e._htmlElementObj&&e._htmlElementObj.width&&e._htmlElementObj.height){var i=cc._renderContext;cc.gl.bindTexture2D(e),i.pixelStorei(i.UNPACK_ALIGNMENT,4),t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e._htmlElementObj),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),cc.gl.bindTexture2D(null),t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);var n=e._htmlElementObj.width,r=e._htmlElementObj.height;e._pixelWidth=e._contentSize.width=n,e._pixelHeight=e._contentSize.height=r,e._pixelFormat=c.PIXEL_FORMAT_RGBA8888,e._hasPremultipliedAlpha=t,e._hasMipmaps=!1,e._textureLoaded=!0,cc.view._antiAliasEnabled?e.setAntiAliasTexParameters():e.setAliasTexParameters(),e._htmlElementObj=null,e.emit("load")}},_.setTexParameters=function(t,e,i,n){var r=this,o=cc._renderContext;void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),cc.assertID(r._pixelWidth===s.NextPOT(r._pixelWidth)&&r._pixelHeight===s.NextPOT(r._pixelHeight)||t.wrapS===o.CLAMP_TO_EDGE&&t.wrapT===o.CLAMP_TO_EDGE,3116),cc.gl.bindTexture2D(r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t.minFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t.magFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t.wrapS),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t.wrapT)},_.setAntiAliasTexParameters=function(){var t=cc._renderContext;cc.gl.bindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)},_.setAliasTexParameters=function(){var t=cc._renderContext;cc.gl.bindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)},_.generateMipmap=function(){var t=this;cc.assertID(t._pixelWidth===s.NextPOT(t._pixelWidth)&&t._pixelHeight===s.NextPOT(t._pixelHeight),3117),cc.gl.bindTexture2D(t),cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D),t._hasMipmaps=!0},_.stringForFormat=function(){return c._M[this._pixelFormat]},_.bitsPerPixelForFormat=function(t){t=t||this._pixelFormat;var e=c._B[t];return null!=e?e:(cc.logID(3110,t),-1)},_._initPremultipliedATextureWithImage=function(t,e,i){var n,r=c,s=t.getData(),o=null,a=null,h=t.hasAlpha(),l=cc.size(t.getWidth(),t.getHeight()),u=r.defaultPixelFormat,_=t.getBitsPerComponent();h||(_>=8?u=r.PIXEL_FORMAT_RGB888:(cc.logID(3111),u=r.PIXEL_FORMAT_RGB565));var d=e*i;if(u===r.PIXEL_FORMAT_RGB565)if(h)for(s=new Uint16Array(e*i),o=t.getData(),n=0;n<d;++n)s[n]=(o[n]>>0&255)>>3<<11|(o[n]>>8&255)>>2<<5|(o[n]>>16&255)>>3<<0;else for(s="new" uint16array(e*i),a="t.getData(),n=0;n<d;++n)s[n]=(255&a[n])">>3<<11|(255&a[n])>>2<<5|(255&a[n])>>3<<0;else if(u="==r.PIXEL_FORMAT_RGBA4444)for(s=new" uint16array(e*i),o="t.getData(),n=0;n<d;++n)s[n]=(o[n]">>0&255)>>4<<12|(o[n]>>8&255)>>4<<8|(o[n]>>16&255)>>4<<4|(o[n]>>24&255)>>4<<0;else if(u="==r.PIXEL_FORMAT_RGB5A1)for(s=new" uint16array(e*i),o="t.getData(),n=0;n<d;++n)s[n]=(o[n]">>0&255)>>3<<11|(o[n]>>8&255)>>3<<6|(o[n]>>16&255)>>3<<1|(o[n]>>24&255)>>7<<0;else if(u="==r.PIXEL_FORMAT_A8)for(s=new" uint8array(e*i),o="t.getData(),n=0;n<d;++n)s[n]=o">>24&255;if(h&&u===r.PIXEL_FORMAT_RGB888)for(o=t.getData(),s=new Uint8Array(e*i*3),n=0;n<d;++n)s[3*n]=o>>0&255,s[3*n+1]=o>>8&255,s[3*n+2]=o>>16&255;return this.initWithData(s,u,e,i,l),s!=t.getData()&&(s=null),this._hasPremultipliedAlpha=t.isPremultipliedAlpha(),!0})})),cc.Texture2D=e.exports=c}),{"../CCGame":40,"../assets/CCRawAsset":50,"../event/event-target":112,"../platform/CCClass":173,"../platform/CCSys":182,"../platform/_CCClass":185,"../platform/js":193,"../utils/misc":223}],214:[(function(t,e,i){var n=t("../platform/_CCClass"),r=(t("../platform/js"),t("../CCGame")),s=n.extend({ctor:function(t,e){this.dirty=!1,this.texture=null,this._indices=null,this._buffersVBO=[],this._capacity=0,this._quads=null,this._quadsArrayBuffer=null,this._quadsWebBuffer=null,this._quadsReader=null,cc.js.isString(t)?this.initWithFile(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(t){this.texture=t},setDirty:function(t){this.dirty=t},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(t){this._quads=t},_copyQuadsToTextureAtlas:function(t,e){if(t)for(var i=0;i<t.length;i++)this._setquadtoarray(t[i],e+i)},_setquadtoarray:function(t,e){var i="this._quads;return" i[e]?(i[e].bl="t.bl,i[e].br=t.br,i[e].tl=t.tl,void(i[e].tr=t.tr)):void(i[e]=new" cc.v3f_c4b_t2f_quad(t.tl,t.bl,t.tr,t.br,this._quadsarraybuffer,e*cc.v3f_c4b_t2f_quad.bytes_per_element))},description:function(){return"<cc.textureatlas="" |="" totalquads="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var t=this._indices,e=this._capacity,i=0;i<e;i++)cc.macro.texture_atlas_use_triangle_strip?(t[6*i+0]=4*i+0,t[6*i+1]=4*i+0,t[6*i+2]=4*i+2,t[6*i+3]=4*i+1,t[6*i+4]=4*i+3,t[6*i+5]=4*i+3):(t[6*i+0]=4*i+0,t[6*i+1]=4*i+1,t[6*i+2]=4*i+2,t[6*i+3]=4*i+3,t[6*i+4]=4*i+2,t[6*i+5]=4*i+1)},initwithfile:function(t,e){var i="cc.textureCache.addImage(t);return" i?this.initwithtexture(i,e):(cc.logid(2900,t),!1)},initwithtexture:function(t,e){cc.assertid(t,2902),e|="0,this._capacity=e,this._totalQuads=0,this.texture=t,this._quads=[],this._indices=new" uint16array(6*e);var="" arraybuffer(i*e),this._quadsreader="new" uint8array(this._quadsarraybuffer),(!this._quads||!this._indices)&&e="">0)return!1;for(var n=this._quads,r=0;r<e;r++)n[r]=new cc.v3f_c4b_t2f_quad(null,null,null,null,this._quadsarraybuffer,r*i);return="" this._setupindices(),this._setupvbo(),this.dirty="!0,!0},updateQuad:function(t,e){cc.assertID(t,2903),cc.assertID(e">=0&&e<this._capacity,2904),this._totalquads=math.max(e+1,this._totalquads),this._setquadtoarray(t,e),this.dirty=!0},insertquad:function(t,e){if(cc.assertid(e<this._capacity,2905),this._totalquads++,this._totalquads>this._capacity)return void cc.logID(2901);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=this._totalQuads-1-e,r=e*i,s=n*i;this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(r,r+s),r+i),this._setQuadToArray(t,e),this.dirty=!0},insertQuads:function(t,e,i){i=i||t.length,cc.assertID(e+i<=this._capacity,2906);var n="cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads">this._capacity)return void cc.logID(2901);var r,s=this._totalQuads-1-e-i,o=e*n,a=s*n,c=this._totalQuads-1-i;for(r=0;r<i;r++)this._quads[c+r]=new cc.v3f_c4b_t2f_quad(null,null,null,null,this._quadsarraybuffer,(this._totalquads-1)*n);for(this._quadsreader.set(this._quadsreader.subarray(o,o+a),o+n*i),r="0;r<i;r++)this._setQuadToArray(t[r],e+r);this.dirty=!0},insertQuadFromIndex:function(t,e){if(t!==e){cc.assertID(e">=0||e<this._totalquads,2907),cc.assertid(t>=0||t<this._totalquads,2908);var i,n,r="cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=this._quadsReader,o=s.subarray(t*r,r);t">e?(i=e*r,n=(t-e)*r,s.set(s.subarray(i,i+n),i+r),s.set(o,i)):(i=(t+1)*r,n=(e-t)*r,s.set(s.subarray(i,i+n),i-r),s.set(o,e*r)),this.dirty=!0}},removeQuadAtIndex:function(t){cc.assertID(t<this._totalquads,2909);var e="cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,t!==this._totalQuads){var" i="(t+1)*e,n=(this._totalQuads-t)*e;this._quadsReader.set(this._quadsReader.subarray(i,i+n),i-e)}this.dirty=!0},removeQuadsAtIndex:function(t,e){if(cc.assertID(t+e<=this._totalQuads,2910),this._totalQuads-=e,t!==this._totalQuads){var" n,r="this._capacity,s=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new" arraybuffer(e*r),this._quadsreader="new" uint8array(this._quadsarraybuffer),n="0;n<r;n++)this._quads=new" cc.v3f_c4b_t2f_quad(null,null,null,null,this._quadsarraybuffer,n*e);else{var="" o,a,c="this._quads;if(r">i){for(o=[],a=new ArrayBuffer(e*r),n=0;n<s;n++)o[n]=new cc.v3f_c4b_t2f_quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*e);for(;n<r;n++)o[n]="new" cc.v3f_c4b_t2f_quad(null,null,null,null,a,n*e);this._quadsreader="new" uint8array(a),this._quads="o,this._quadsArrayBuffer=a}else{var" h="Math.max(s,r);for(o=[],a=new" arraybuffer(e*r),n="0;n<h;n++)o[n]=new" cc.v3f_c4b_t2f_quad(c[n].tl,c[n].bl,c[n].tr,c[n].br,a,n*e);this._quadsreader="new" uint16array(6*r);else="" if(r="">i){var l=new Uint16Array(6*r);l.set(this._indices,0),this._indices=l}else this._indices=this._indices.subarray(0,6*r);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(t){this._totalQuads+=t},moveQuadsFromIndex:function(t,e,i){if(void 0===i){if(i=e,e=this._totalQuads-t,cc.assertID(i+(this._totalQuads-t)<=this._capacity,2911),0===e)return}else if(cc.assertid(i+e<="this._totalQuads,2912),cc.assertID(t<this._totalQuads,2913),t===i)return;var" n,r,s="cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,o=t*s,a=e*s,c=this._quadsReader,h=c.subarray(o,o+a),l=i*s;i<t?(n=(t-i)*s,r=i*s,c.set(c.subarray(r,r+n),r+a)):(n=(i-t)*s,r=(t+e)*s,c.set(c.subarray(r,r+n),o)),c.set(h,l),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(t,e){for(var" i="e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new" uint8array(this._quadsarraybuffer,t*cc.v3f_c4b_t2f_quad.bytes_per_element,i),r="0;r<i;r++)n[r]=0},_setupVBO:function(){},_mapBuffers:function(){},drawQuads:function(){},drawNumberOfQuads:null,_releaseBuffer:function(){var" t="cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&t.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&t.deleteBuffer(this._buffersVBO[1])),this._quadsWebBuffer&&t.deleteBuffer(this._quadsWebBuffer)}}),o=s.prototype;o.totalQuads,cc.defineGetterSetter(o,"totalQuads",o.getTotalQuads),o.capacity,cc.defineGetterSetter(o,"capacity",o.getCapacity),o.quads,cc.defineGetterSetter(o,"quads",o.getQuads,o.setQuads),r.once(r.EVENT_RENDERER_INITED,(function(){cc._renderType===r.RENDER_TYPE_WEBGL&&(s.prototype._setupVBO=function(){var" n="cc._renderContext;cc.gl.bindTexture2D(i.texture),n.bindBuffer(n.ARRAY_BUFFER,i._quadsWebBuffer),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),n.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),i.dirty&&(n.bufferData(n.ARRAY_BUFFER,i._quadsArrayBuffer,n.DYNAMIC_DRAW),i.dirty=!1),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,24,16),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i._buffersVBO[1]),cc.macro.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?n.drawElements(n.TRIANGLE_STRIP,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT):n.drawElements(n.TRIANGLES,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT),cc.g_NumberOfDraws++}})})),cc.TextureAtlas=e.exports=s}),{"../CCGame":40,"../platform/_CCClass":185,"../platform/js":193}],215:[(function(t,e,i){var" t,e="this._loadedTexturesBefore,i=this._textures;for(t" in="" e){var="" |="" number="" of="" textures="+this._textures.length+">"},textureForKey:function(t){return cc.logID(3002),this.getTextureForKey(t)},getTextureForKey:function(t){return this._textures[t]},getKeyByTexture:function(t){for(var e in this._textures)if(this._textures[e]===t)return e;return null},_generalTextureKey:function(t){return"_textureKey_"+t},getTextureColors:function(t){var e=t._htmlElementObj,i=this.getKeyByTexture(e);return i||(i=e instanceof HTMLImageElement?e.src:this._generalTextureKey(t.__instanceId)),this._textureColorsCache[i]||(this._textureColorsCache[i]=t._generateTextureCacheForColor()),this._textureColorsCache[i]},getAllTextures:function(){var t=[];for(var e in this._textures){var i=this._textures[e];t.push(i)}return t},removeAllTextures:function(){var t=this._textures;for(var e in t)t[e]&&t[e].releaseTexture();this._textures={}},removeTexture:function(t){if(t){var e=this._textures;for(var i in e)e[i]===t&&(e[i].releaseTexture(),delete e[i])}},removeTextureForKey:function(t){if("string"==typeof t){var e=this._textures;e[t]&&(e[t].releaseTexture(),delete e[t])}},addImage:null,addImageAsync:null,cacheImage:function(t,e){if(cc.assertID(t,3009),e instanceof r)return void(this._textures[t]=e);var i=new r;i.initWithElement(e),i.handleLoadedTexture(),this._textures[t]=i},addUIImage:function(t,e){if(cc.assertID(t,3008),e&&this._textures[e])return this._textures[e];var i=new r;return i.initWithImage(t),null!=e?this._textures[e]=i:cc.logID(3004),i},dumpCachedTextureInfo:function(){var t=0,e=0,i=this._textures;for(var n in i){var r=i[n];t++,r.getHtmlElementObj()instanceof HTMLImageElement?cc.logID(3005,n,r.getHtmlElementObj().src,r.getPixelWidth(),r.getPixelHeight()):cc.logID(3006,n,r.getPixelWidth(),r.getPixelHeight()),e+=r.getPixelWidth()*r.getPixelHeight()*4}var s=this._textureColorsCache;for(n in s){var o=s[n];for(var a in o){var c=o[a];t++,cc.logID(3006,n,c.width,c.height),e+=c.width*c.height*4}}cc.logID(3007,t,e/1024,(e/1048576).toFixed(2))},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}};n.once(n.EVENT_RENDERER_INITED,(function(){var t=s;cc._renderType===n.RENDER_TYPE_CANVAS?(t.handleLoadedTexture=function(t){var e=this._textures,i=e[t];i||(cc.assertID(t,3009),i=e[t]=new r,i.url=t),i.handleLoadedTexture()},t.addImage=function(t,e,i){cc.assertID(t,3103);var n=this._textures,o=n[t];return o?o.isLoaded()?(e&&e.call(i,o),o):(o.once("load",(function(){e&&e.call(i,o)}),i),o):(o=n[t]=new r,o.url=t,cc.loader.load(t,(function(n,r){return n?e&&e.call(i,n||new Error("Unknown error")):(s.handleLoadedTexture(t),void(e&&e.call(i,o)))})),o)},t.addImageAsync=t.addImage):cc._renderType===n.RENDER_TYPE_WEBGL&&(t.handleLoadedTexture=function(t){var e,i,n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore),e=n[t],e||(cc.assertID(t,3009),e=n[t]=new r,e.url=t),i=cc.macro.AUTO_PREMULTIPLIED_ALPHA_FOR_PNG&&".png"===cc.path.extname(t),e.handleLoadedTexture(i)},t.addImage=function(t,e,i){cc.assertID(t,3112);var n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore);var o=n[t];return o?o.isLoaded()?(e&&e.call(i,o),o):(o.once("load",(function(){e&&e.call(i,o)}),i),o):(o=n[t]=new r,o.url=t,cc.loader.load(t,(function(n,r){return n?e&&e.call(i,n||new Error("Unknown error")):(s.handleLoadedTexture(t),void(e&&e.call(i,o)))})),o)},t.addImageAsync=t.addImage)})),cc.textureCache=e.exports=s}),{"../CCGame":40,"./CCTexture2D":213}],216:[(function(t,e,i){t("./CCTexture2D"),t("./CCTextureAtlas"),t("./CCTextureCache")}),{"./CCTexture2D":213,"./CCTextureAtlas":214,"./CCTextureCache":215}],217:[(function(t,e,i){t("../platform/CCSys");var n=/(\.[^\.\/\?\\]*)(\?.*)?$/,r=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":" ")+arguments[i]).replace(="" (\="" |\\\\)$="" ,"");return="" e},extname:function(t){var="" e="n.exec(t);return" e?e[1]:""},mainfilename:function(t){if(t){var="" t.substring(0,e)}return="" t},basename:function(t,e){var="" i="t.indexOf("?");i">0&&(t=t.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g,r=n.exec(t.replace(/(\/|\\\\)$/,""));if(!r)return null;var s=r[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?s.substring(0,s.length-e.length):s},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),i=t.lastIndexOf("."),i<0?t+e+n:t.substring(0,i)+e+n},changebasename:function(t,e,i){if(0===e.indexof("."))return this.changeextname(t,e);var="" n="t.indexOf("?"),r="",s=i?this.extname(t):"";return">0&&(r=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=n<=0?0:n+1,t.substring(0,n)+e+s+r},_normalize:function(t){var e="t=String(t);do" t},sep:cc.sys.os="==cc.sys.OS_WINDOWS?"\\":"/",_setEndWithSep:function(t,e){var" i="cc.path.sep;"undefined"==typeof" e?e="!0:"string"==typeof" e&&(i="e,e=!!e);var" n="t[t.length-1],r="\\"===n||"/"===n;return!r&&e?t+=i:r&&!e&&(t=t.slice(0,-1)),t}},e.exports=cc.path}),{"../platform/CCSys":182}],218:[(function(t,e,i){function" n(){h("frame").start(),h("logic").start()}function="" r(){cc.director.ispaused()?h("frame").start():h("logic").end(),h("render").start()}function="" s(){h("render").end(),h("draws").value="cc.g_NumberOfDraws,h("frame").end(),h("fps").frame(),h().tick()}var" o="t("../../../external/pstats/pstats"),a=t("../platform/CCMacro"),c=document.createElement("div");c.id="fps";var" h="o.new(c,{values:{frame:{desc:"Frame" time="" (ms)",min:0,max:50,average:500},fps:{desc:"framerate="" (fps)",below:30,average:500},draws:{desc:"draw="" call"},logic:{desc:"game="" logic="" (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"renderer="" (ms)",min:0,max:50,average:500,color:"#f90"}},css:".pstats="" {left:="" "+a.director_stats_position.x+"px;="" bottom:="" "+a.director_stats_position.y+"px;}"}),l="!1;cc.profiler=e.exports={isShowingStats:function(){return" l},hidestats:function(){l&&(c.parentelement="==document.body&&document.body.removeChild(c),cc.director.off(cc.Director.EVENT_BEFORE_UPDATE,n),cc.director.off(cc.Director.EVENT_AFTER_VISIT,r),cc.director.off(cc.Director.EVENT_AFTER_DRAW,s),l=!1)},showStats:function(){l||(null===c.parentElement&&document.body.appendChild(c),cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,n),cc.director.on(cc.Director.EVENT_AFTER_VISIT,r),cc.director.on(cc.Director.EVENT_AFTER_DRAW,s),l=!0)}}}),{"../../../external/pstats/pstats":312,"../platform/CCMacro":178}],219:[(function(t,e,i){function" n(t){return="" t?"string"="=typeof" t?u.getclassbyname(t):t:(cc.errorid(3804),null)}function="" r(t,e){for(var="" instanceof="" e)return="" n}return="" null}function="" s(t,e,i){for(var="" r="t._components[n];r" e&&i.push(r)}}function="" o(t,e){for(var="" s;if(n._children.length="">0&&(s=o(n._children,e)))return s}return null}function a(t,e,i){for(var n=0;n<t.length;++n){var r="t[n];s(r,e,i),r._children.length">0&&a(r._children,e,i)}}var c=t("../platform/CCObject").Flags,h=t("./misc"),l=t("../platform/id-generater"),u=cc.js,_=c.Destroying,d=c.DontDestroy,f="child-added",p="child-removed",m=new l("Node"),g=cc.Class({name:"cc._BaseNode",extends:cc.Object,mixins:[cc.EventTarget],properties:{_parent:null,_children:[],_tag:cc.macro.NODE_TAG_INVALID,_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&d)>0},set:function(t){t?this._objFlags|=d:this._objFlags&=~d}},name:{get:function(){return this._name},set:function(t){this._name=t}},_id:{default:"",editorOnly:!0},uuid:{get:function(){var t=this._id;return t||(t=this._id=m.getNewId()),t}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent;if(e){var i=e._activeInHierarchy;i&&cc.director._nodeActivator.activateNode(this,t)}}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},ctor:function(t){this._name="undefined"!=typeof t?t:"New Node",this._activeInHierarchy=!1,this.__instanceId=this._id||cc.ClassManager.getNewInstanceId(),this.__eventTargets=[]},getTag:function(){return this._tag},setTag:function(t){this._tag=t},getParent:function(){return this._parent},setParent:function(t){if(this._parent!==t){var e=this._parent;if(this._parent=t||null,this._onSetParent(t),t&&(cc.eventManager._setDirtyForNode(this),t._children.push(this),t.emit(f,this)),e){if(!(e._objFlags&_)){var i=e._children.indexOf(this);e._children.splice(i,1),e.emit(p,this),this._onHierarchyChanged(e)}}else t&&this._onHierarchyChanged(null)}},init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var 0="==t&&(t=!0),this._parent.removeChild(this,t))},removeChild:function(t,e){this._children.indexOf(t)" n="e[i];if(n&&n._tag===t)return" n}return="" null},getchildbyuuid:function(t){if(!t)return="" cc.log("invalid="" uuid"),null;for(var="" e="this._children,i=0,n=e.length;i<n;i++)if(e[i]._id===t)return" e[i];return="" null},getchildbyname:function(t){if(!t)return="" name"),null;for(var="" null},addchild:function(t){cc.assertid(t,1606),cc.assertid(null="==t._parent,1605),t.setParent(this)},getSiblingIndex:function(){return" this._parent?this._parent._children.indexof(this):0},setsiblingindex:function(t){if(this._parent){var="" i="e.indexOf(this);t!==i&&(e.splice(i,1),t<e.length?e.splice(t,0,this):e.push(this),this._onSiblingIndexChanged&&this._onSiblingIndexChanged(t))}},cleanup:function(){},removeFromParent:function(t){this._parent&&(void">-1&&((e||void 0===e)&&t.cleanup(),t.parent=null)},removeChildByTag:function(t,e){t===cc.macro.NODE_TAG_INVALID&&cc.logID(1609);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.logID(1610,t)},removeAllChildren:function(t){var e=this._children;void 0===t&&(t=!0);for(var i=e.length-1;i>=0;i--){var n=e[i];n&&(t&&n.cleanup(),n.parent=null)}this._children.length=0},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},getComponent:function(t){var e=n(t);return e?r(this,e):null},getComponents:function(t){var e=n(t),i=[];return e&&s(this,e,i),i},getComponentInChildren:function(t){var e=n(t);return e?o(this._children,e):null},getComponentsInChildren:function(t){var e=n(t),i=[];return e&&(s(this,e,i),a(this._children,e,i)),i},_checkMultipleComp:!1,addComponent:function(t){var e;if("string"==typeof t){if(e=u.getClassByName(t),!e)return cc.errorID(3807,t),cc._RFpeek()&&cc.errorID(3808,t),null}else{if(!t)return cc.errorID(3804),null;e=t}if("function"!=typeof e)return cc.errorID(3809),null;if(!cc.isChildClassOf(e,cc.Component))return cc.errorID(3810),null;var i=e._requireComponent;if(i&&!this.getComponent(i)){var n=this.addComponent(i);if(!n)return null}var r=new e;return r.node=this,this._components.push(r),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(r),r},_addComponentAt:!1,removeComponent:function(t){return t?(t instanceof cc.Component||(t=this.getComponent(t)),void(t&&t.destroy())):void cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(t){if(!t)return void cc.errorID(3814);if(!(this._objFlags&_)){var e=this._components.indexOf(t);e!==-1?this._components.splice(e,1):t.node!==this&&cc.errorID(3815)}},_disableChildComps:function(){var t,e=this._components.length;for(t=0;t<e;++t){var i="this._components[t];i._enabled&&cc.director._compScheduler.disableComp(i)}for(t=0,e=this._children.length;t<e;++t){var" n="this._children[t];n._active&&n._disableChildComps()}},destroy:function(){cc.Object.prototype.destroy.call(this)&&this._activeInHierarchy&&this._disableChildComps()},destroyAllChildren:function(){for(var" t="this._children,e=0;e<t.length;++e)t[e].destroy()},_onSetParent:function(t){},_onPostActivated:function(){},_onHierarchyChanged:function(t){var" e="this._parent;!this._persistNode||e" instanceof="" cc.scene||cc.game.removepersistrootnode(this);var="" i&&(t._prefab._synced="e._synced),t._parent=null,t._onBatchCreated(),t},_registerIfAttached:!1,_onPreDestroy:function(){var" t,e;this._objflags|="_;var" s="this._components[t];s._destroyImmediate()}var" o="this.__eventTargets;for(t=0,e=o.length;t<e;++t){var" a="o[t];a&&a.targetOff(this)}if(o.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!n&&i){var" c="i._children.indexOf(this);i._children.splice(c,1),i.emit("child-removed",this)}return" n},onrestore:!1});g.prototype._onpredestroybase="g.prototype._onPreDestroy,g.prototype._onHierarchyChangedBase=g.prototype._onHierarchyChanged;var" v="["name","children","childrenCount"];h.propertyDefine(g,v,{}),cc._BaseNode=e.exports=g}),{"../platform/CCObject":179,"../platform/id-generater":189,"./misc":223}],220:[(function(t,e,i){function" n(t,e){for(var="">>>1;i<=n;s=i+n>>>1){var o=t[s];if(o>e+r)n=s-1;else{if(!(o<e-r))return s;i="s+1}}return~i}var" r="1e-6;e.exports={binarySearchEpsilon:n}}),{}],221:[(function(t,e,i){cc.find=e.exports=function(t,e){if(null==t)return" cc.errorid(5600),null;if(!e){var="" i="cc.director.getScene();if(!i)return" null;e="i}for(var" n="e,r="/"!==t[0]?0:1,s=t.split("/"),o=r;o<s.length;o++){var" a="s[o],c=n._children;n=null;for(var" h="0,l=c.length;h<l;++h){var" u="c[h];if(u.name===a){n=u;break}}if(!n)return" null}return="" n}}),{}],222:[(function(t,e,i){t(".="" ccpath"),t(".="" ccprofiler"),t(".="" find"),t(".="" mutable-forward-iterator")}),{".="" ccpath":217,".="" ccprofiler":218,".="" find":221,".="" mutable-forward-iterator":224}],223:[(function(t,e,i){var="" n(t,e,i,n){var="" s="t[i];cc.js.getset(t,e,s,t[n])}}for(var" r,s="t.prototype,o=0;o<e.length;o++){r=e[o];var" in="" i){var="" c="i[r];n(s,r,c[0],c[1])}},r.NextPOT=function(t){return" t-="1,t|=t">>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1},r.imagePool=new n.Pool(function(t){return t instanceof HTMLImageElement&&(t.src=this._smallImg,!0)},10),r.imagePool.get=function(){return this._get()||new Image},r.imagePool._smallImg="data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",r.isBuiltinClassId=function(t){return t.startsWith("cc.")||t.startsWith("dragonBones.")||t.startsWith("sp.")||t.startsWith("ccsg.")},e.exports=r}),{"../platform/js":193}],224:[(function(t,e,i){function n(t){this.i=0,this.array=t}var r=n.prototype;r.remove=function(t){var e=this.array.indexOf(t);e>=0&&this.removeAt(e)},r.removeAt=function(t){this.array.splice(t,1),t<=this.i&&--this.i},r.fastremove=function(t){var e="this.array.indexOf(t);e">=0&&this.fastRemoveAt(e)},r.fastRemoveAt=function(t){var e=this.array;e[t]=e[e.length-1],--e.length,t<=this.i&&--this.i},r.push=function(t){this.array.push(t)},e.exports=n}),{}],225:[(function(t,e,i){cc._prefabinfo=cc.class({name:"cc.prefabinfo",properties:{root:null,asset:null,fileid:"",sync:!1,_synced:{default:!1,serializable:!1}}}),e.exports={syncwithprefab:function(t){var 0="==i?(i=e,n=t.x,r=t.y):(n=t,r=e),{x:i.a*n+i.c*r+i.tx,y:i.b*n+i.d*r+i.ty}},cc._pointApplyAffineTransformIn=function(t,e,i,n){var" e="t._prefab;if(e._synced=!0,!e.asset)return" cc.errorid(3701,t.name),void(t._prefab="null);var" i="t._objFlags,n=t._parent,r=t._id,s=t._name,o=t._active,a=t._position,c=t._rotationX,h=t._rotationY,l=t._localZOrder,u=t._globalZOrder;cc.game._isCloning=!0,e.asset._doInstantiate(t),cc.game._isCloning=!1,t._objFlags=i,t._parent=n,t._id=r,t._prefab=e,t._name=s,t._active=o,t._position=a,t._rotationX=c,t._rotationY=h,t._localZOrder=l,t._globalZOrder=u}}}),{}],226:[(function(t,e,i){var" n="{removeSgNode:function(){var" t="this._sgNode;if(t){var" n,r;return="" void="" r,s,o;void="" cc.pointapplyaffinetransform(t,e,i)},cc.sizeapplyaffinetransform="function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var" cc.rect(f,m,p-f,g-m)},cc._rectapplyaffinetransformin="function(t,e){" var="" t.x="f,t.y=m,t.width=p-f,t.height=g-m,t},cc.obbApplyAffineTransform=function(t,e,i,n,r,s){var" o="t.x,a=t.y,c=t.width,h=t.height,l=e.a*o+e.c*a+e.tx,u=e.b*o+e.d*a+e.ty,_=e.a*c,d=e.b*c,f=e.c*h,p=e.d*h;n.x=l,n.y=u,r.x=_+l,r.y=d+u,i.x=f+l,i.y=p+u,s.x=_+f+l,s.y=d+p+u},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var" t.a="i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=r*e.a+s*e.c,t.d=r*e.b+s*e.d,t.tx=o*e.a+a*e.c+e.tx,t.ty=o*e.b+a*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return" e(t,e,i,n){"object"="=typeof" t&&(e="t.g,i=t.b,n=t.a,t=t.r),t=t||0,e=e||0,i=i||0,n="number"==typeof" n?n:255,this._val="(~~t<<24">>>0)+(~~e<<16)+(~~i<<8)+~~n}r.extend(e,n),t(".. platform="" ccclass").fastdefine("cc.color",e,{r:0,g:0,b:0,a:255});var="" i="{WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]};for(var" s="" in="" i)r.get(e,s,(function(t){return="" function(){return="" new="" e(t[0],t[1],t[2],t[3])}})(i[s]));var="" o="e.prototype;return" o.clone="function(){var" t="new" e;return="" t._val="this._val,t},o.equals=function(t){return" t&&this._val="==t._val},o.lerp=function(t,i,n){n=n||new" e;var="" r="this.r,s=this.g,o=this.b,a=this.a;return" n.r="r+(t.r-r)*i,n.g=s+(t.g-s)*i,n.b=o+(t.b-o)*i,n.a=a+(t.a-a)*i,n},o.toString=function(){return"rgba("+this.r.toFixed()+"," "+this.g.tofixed()+",="" "+this.b.tofixed()+",="" "+this.a.tofixed()+")"},o.getr="function(){return(4278190080&this._val)">>>24},o.setR=function(t){return this._val=(16777215&this._val|~~t<<24>>>0)>>>0,this},o.getG=function(){return(16711680&this._val)>>16},o.setG=function(t){return this._val=(4278255615&this._val|~~t<<16)>>>0,this},o.getB=function(){return(65280&this._val)>>8},o.setB=function(t){return this._val=(4294902015&this._val|~~t<<8)>>>0,this},o.getA=function(){return 255&this._val},o.setA=function(t){return this._val=(4294967040&this._val|~~t)>>>0,this},r.getset(o,"r",o.getR,o.setR,!0),r.getset(o,"g",o.getG,o.setG,!0),r.getset(o,"b",o.getB,o.setB,!0),r.getset(o,"a",o.getA,o.setA,!0),o.toCSS=function(t){return"rgba"===t?"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")":"rgb"===t?"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")":"#"+this.toHEX(t)},o.clamp=function(){},o.fromHEX=function(t){t.length<8&&(t+="ff");var e="parseInt(t.indexOf("#")">-1?t.substring(1):t,16);return this._val=(4278190080&this._val|e)>>>0,this},o.toHEX=function(t){var e=[(0|this.r).toString(16),(0|this.g).toString(16),(0|this.b).toString(16)],i=-1;if("#rgb"===t)for(i=0;i<e.length;++i)e[i].length>1&&(e[i]=e[i][0]);else if("#rrggbb"===t)for(i=0;i<e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);return e.join("")},o.torgbvalue="function(){return" 16777215&this._val},o.fromhsv="function(t,i,n){var" r="e.hsv2rgb(t,i,n);return" this._val="(r.r<<24">>>0)+(r.g<<16)+(r.b<<8)+this.a,this},o.tohsv=function(){return e.rgb2hsv(this.r,this.g,this.b)},o.fromcolor="function(t){t._val?this._val=t._val:(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a)},e})();s.rgb2hsv=function(t,e,i){t/=255,e/=255,i/=255;var" n="{h:0,s:0,v:0},r=Math.max(t,e,i),s=Math.min(t,e,i),o=0;return" n.v="r,n.s=r?(r-s)/r:0,n.s?(o=r-s,t===r?n.h=(e-i)/o:e===r?n.h=2+(i-t)/o:n.h=4+(t-e)/o,n.h/=6,n.h<0&&(n.h+=1)):n.h=0,n},s.hsv2rgb=function(t,e,i){var" if(0="==i)n.r=n.g=n.b=0;else{1===t&&(t=0),t*=6,e=e,i=i;var" r="Math.floor(t),s=t-r,o=i*(1-e),a=i*(1-e*s),c=i*(1-e*(1-s));switch(r){case" 0:n.r="i,n.g=c,n.b=o;break;case" 1:n.r="a,n.g=i,n.b=o;break;case" 2:n.r="o,n.g=i,n.b=c;break;case" 3:n.r="o,n.g=a,n.b=i;break;case" 4:n.r="c,n.g=o,n.b=i;break;case" 5:n.r="i,n.g=o,n.b=a}}return" n.r*="255,n.g*=255,n.b*=255,n},cc.Color=s,cc.color=function(t,e,i,n){if("string"==typeof" t){var="" cc.color;return="" r.fromhex(t)}return"object"="=typeof" t?new="" cc.color(t.r,t.g,t.b,t.a):new="" cc.color(t,e,i,n)},cc.colorequal="function(t,e){return" void="" 0!="=t._val&&void" e="parseInt(t),i=e">>16,n=(65280&e)>>8,r=255&e;return cc.color(i,n,r)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},e.exports=cc.color}),{".. 0="==e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return" platform="" ccclass":173,"..="" js":193,".="" ccvaluetype":234}],229:[(function(t,e,i){var="" n="parseFloat("1.192092896e-07F");cc.pNeg=function(t){return" cc.p(-t.x,-t.y)},cc.padd="function(t,e){return" cc.p(t.x+e.x,t.y+e.y)},cc.psub="function(t,e){return" cc.p(t.x-e.x,t.y-e.y)},cc.pmult="function(t,e){return" cc.p(t.x*e,t.y*e)},cc.pmidpoint="function(t,e){return" cc.pmult(cc.padd(t,e),.5)},cc.pdot="function(t,e){return" t.x*e.x+t.y*e.y},cc.pcross="function(t,e){return" t.x*e.y-t.y*e.x},cc.pperp="function(t){return" cc.p(-t.y,t.x)},cc.prperp="function(t){return" cc.p(t.y,-t.x)},cc.pproject="function(t,e){return" cc.pmult(e,cc.pdot(t,e)="" cc.pdot(e,e))},cc.plengthsq="function(t){return" cc.pdot(t,t)},cc.pdistancesq="function(t,e){return" cc.plengthsq(cc.psub(t,e))},cc.plength="function(t){return" math.sqrt(cc.plengthsq(t))},cc.pdistance="function(t,e){return" cc.plength(cc.psub(t,e))},cc.pnormalize="function(t){var" e="cc.pLength(t);return" cc.p(math.cos(t),math.sin(t))},cc.ptoangle="function(t){return" math.atan2(t.y,t.x)},cc.clampf="function(t,e,i){if(e">i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},cc.clamp01=function(t){return t<0?0:t<1?t:1},cc.pclamp="function(t,e,i){return" cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pfromsize="function(t){return" cc.p(t.width,t.height)},cc.pcompop="function(t,e){return" cc.p(e(t.x),e(t.y))},cc.plerp="function(t,e,i){return" cc.padd(cc.pmult(t,1-i),cc.pmult(e,i))},cc.pfuzzyequal="function(t,e,i){return" t.x-i<="e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i},cc.pCompMult=function(t,e){return" cc.p(t.x*e.x,t.y*e.y)},cc.panglesigned="function(t,e){var" i="cc.pNormalize(t),r=cc.pNormalize(e),s=Math.atan2(i.x*r.y-i.y*r.x,cc.pDot(i,r));return" math.abs(s)<n?0:s},cc.pangle="function(t,e){var" math.abs(i)<n?0:i},cc.protatebyangle="function(t,e,i){var" n="cc.pSub(t,e),r=Math.cos(i),s=Math.sin(i),o=n.x;return" n.x="o*r-n.y*s+e.x,n.y=o*s+n.y*r+e.y,n},cc.pLineIntersect=function(t,e,i,n,r){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var" s="e.x-t.x,o=e.y-t.y,a=n.x-i.x,c=n.y-i.y,h=t.x-i.x,l=t.y-i.y,u=c*s-a*o;return" r.x="a*l-c*h,r.y=s*l-o*h,0===u?0===r.x||0===r.y:(r.x=r.x/u,r.y=r.y/u,!0)},cc.pSegmentIntersect=function(t,e,i,n){var" r="cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,r)&&r.x">=0&&r.x<=1&&r.y>=0&&r.y<=1)},cc.pintersectpoint=function(t,e,i,n){var r="cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,r)){var" s="cc.p(0,0);return" s.x="t.x+r.x*(e.x-t.x),s.y=t.y+r.x*(e.y-t.y),s}return" cc.p(0,0)},cc.psameas="function(t,e){return" null!="t&&null!=e&&(t.x===e.x&&t.y===e.y)},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))}}),{}],230:[(function(t,e,i){function" n(t,e,i,n){t&&"object"="=typeof" t&&(e="t.y,i=t.width,n=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0}var" i="Math.min(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.x,e.x),o=Math.max(t.y,e.y);return" new="" n(i,r,s-i,o-r)},n.contain="function(t,e){return" t.x<e.x&&t.x+t.width="">e.x+e.width&&t.y<e.y&&t.y+t.height>e.y+e.height?1:e.x<t.x&&e.x+e.width>t.x+t.width&&e.y<t.y&&e.y+e.height>t.y+t.height?-1:0};var o=n.prototype;o.clone=function(){return new n(this.x,this.y,this.width,this.height)},o.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},o.lerp=function(t,e,i){i=i||new n;var r=this.x,s=this.y,o=this.width,a=this.height;return i.x=r+(t.x-r)*e,i.y=s+(t.y-s)*e,i.width=o+(t.width-o)*e,i.height=a+(t.height-a)*e,i},o.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},s.getset(o,"xMin",(function(){return this.x}),(function(t){this.width+=this.x-t,this.x=t})),s.getset(o,"yMin",(function(){return this.y}),(function(t){this.height+=this.y-t,this.y=t})),s.getset(o,"xMax",(function(){return this.x+this.width}),(function(t){this.width=t-this.x})),s.getset(o,"yMax",(function(){return this.y+this.height}),(function(t){this.height=t-this.y})),s.getset(o,"center",(function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)}),(function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height})),s.getset(o,"origin",(function(){return new cc.Vec2(this.x,this.y)}),(function(t){this.x=t.x,this.y=t.y})),s.getset(o,"size",(function(){return new cc.Size(this.width,this.height)}),(function(t){this.width=t.width,this.height=t.height})),o.intersects=function(t){return cc.rectIntersectsRect(this,t)},o.contains=function(t){return this.x<t.x&&this.x+this.width>t.x&&this.y<t.y&&this.y+this.height>t.y},o.containsRect=function(t){return this.x<t.x&&this.x+this.width>t.x+t.width&&this.y<t.y&&this.y+this.height>t.y+t.height},cc.Rect=n,cc.rect=function(t,e,i,r){return new n(t,e,i,r)},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return!(!t||!e)&&!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectgetmaxx=function(t){return t.x+t.width},cc.rectgetmidx="function(t){return" t.x+t.width="" 2},cc.rectgetminx="function(t){return" t.x},cc.rectgetmaxy="function(t){return" t.y+t.height},cc.rectgetmidy="function(t){return" t.y+t.height="" 2},cc.rectgetminy="function(t){return" t.y},cc.rectcontainspoint="function(t,e){return" e.x="">=cc.rectGetMinX(t)&&e.x<=cc.rectgetmaxx(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectgetmaxy(t)},cc.rectintersectsrect=function(t,e){var i="t.x+t.width,n=t.y+t.height,r=e.x+e.width,s=e.y+e.height;return!(i<e.x||r<t.x||n<e.y||s<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var" i.x="Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var" i.width="Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},e.exports=cc.Rect}),{"../platform/CCClass":173,"../platform/js":193,"./CCValueType":234}],231:[(function(t,e,i){function" n(t,e){t&&"object"="=typeof" t&&(e="t.height,t=t.width),this.width=t||0,this.height=e||0}var" r="t("./CCValueType"),s=t("../platform/js");s.extend(n,r),t("../platform/CCClass").fastDefine("cc.Size",n,{width:0,height:0}),s.get(n,"ZERO",(function(){return" new="" n(0,0)}));var="" o="n.prototype;o.clone=function(){return" n(this.width,this.height)},o.equals="function(t){return" t&&this.width="==t.width&&this.height===t.height},o.lerp=function(t,e,i){i=i||new" n;var="" "+this.height.tofixed(2)+")"},cc.size="function(t,e){return" n(t,e)},cc.sizeequaltosize="function(t,e){return" t&&e&&t.width="==e.width&&t.height===e.height},cc.Size=e.exports=n}),{"../platform/CCClass":173,"../platform/js":193,"./CCValueType":234}],232:[(function(t,e,i){cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.BlendFunc=function(t,e){this.src=t,this.dst=e};var" n="cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.BlendFunc._disable=function(){return" cc.blendfunc(n.one,n.zero)},cc.blendfunc._alphapremultiplied="function(){return" cc.blendfunc(n.one,n.one_minus_src_alpha)},cc.blendfunc._alphanonpremultiplied="function(){return" cc.blendfunc(n.src_alpha,n.one_minus_src_alpha)},cc.blendfunc._additive="function(){return" cc.blendfunc(n.src_alpha,n.one)},cc.blendfunc.blendfactor="n,cc.BlendFunc.DISABLE,cc.js.get(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.js.get(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.js.get(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.blendFuncDisable=cc.BlendFunc._disable,cc.FontDefinition=function(t){var" e="this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TextAlignment.CENTER,e.verticalAlign=cc.VerticalTextAlignment.TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t" instanceof="" object)for(var="" in="" t)e[i]="t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var" t="this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return" this.fontstyle+"="" "+this.fontweight+"="" "+this.fontsize+"px="" "+t+"="" '"+this.fontname+"'"},cc.textalignment="cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),cc._Dictionary=cc.Class({ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return" this.__currid++,"key_"+this.__currid},setobject:function(t,e){if(null!="e){var" null;var="" e)if(e[i]="==t)return" this._valuemaptb[i];return="" null},valueforkey:function(t){return="" this.objectforkey(t)},removeobjectforkey:function(t){if(null!="t){var" delete="" this._valuemaptb[i],void="" e[i]}},removeobjectsforkeys:function(t){if(null!="t)for(var" e)t.push(e[i]);return="" t},removeallobjects:function(){this._keymaptb="{},this._valueMapTb={}},count:function(){return" this.allkeys().length}})}),{}],233:[(function(t,e,i){cc.webglcolor="function(t,e,i,n,r,s){this._arrayBuffer=r||new" arraybuffer(cc.webglcolor.bytes_per_element),this._offset="s||0;var" uint8array(o,a,4),this._view[0]="t||0,this._view[1]=e||0,this._view[2]=i||0,"number"==typeof" n?this._view[3]="n:(this._view[3]=255,this.a_undefined=!0)},cc.WebGLColor.BYTES_PER_ELEMENT=4;var" this._view[0]},n._setr="function(t){this._view[0]=t<0?0:t},n._getG=function(){return" this._view[1]},n._setg="function(t){this._view[1]=t<0?0:t},n._getB=function(){return" this._view[2]},n._setb="function(t){this._view[2]=t<0?0:t},n._getA=function(){return" this._view[3]},n._seta="function(t){this._view[3]=t<0?0:t},n.r,cc.js.getset(n,"r",n._getR,n._setR),n.g,cc.js.getset(n,"g",n._getG,n._setG),n.b,cc.js.getset(n,"b",n._getB,n._setB),n.a,cc.js.getset(n,"a",n._getA,n._setA),cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new" arraybuffer(cc.vertex2f.bytes_per_element),this._offset="n||0,this._view=new" float32array(this._arraybuffer,this._offset,2),this._view[0]="t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8;var" this._view[0]},n._setx="function(t){this._view[0]=t},n._getY=function(){return" this._view[1]},n._sety="function(t){this._view[1]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.Vertex3F=function(t,e,i,n,r){this._arrayBuffer=n||new" arraybuffer(cc.vertex3f.bytes_per_element),this._offset="r||0;var" s="this._arrayBuffer,o=this._offset;this._view=new" float32array(s,o,3),this._view[0]="t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,n=cc.Vertex3F.prototype,n._getX=function(){return" this._view[2]},n._setz="function(t){this._view[2]=t},cc.js.getset(n,"x",n._getX,n._setX),cc.js.getset(n,"y",n._getY,n._setY),cc.js.getset(n,"z",n._getZ,n._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new" arraybuffer(cc.tex2f.bytes_per_element),this._offset="n||0,this._view=new" this._view[0]},n._setu="function(t){this._view[0]=t},n._getV=function(){return" this._view[1]},n._setv="function(t){this._view[1]=t},cc.js.getset(n,"u",n._getU,n._setU),cc.js.getset(n,"v",n._getV,n._setV),cc.Quad2=function(t,e,i,n,r,s){this._arrayBuffer=r||new" arraybuffer(cc.quad2.bytes_per_element),this._offset="s||0;var" cc.vertex2f(t.x,t.y,o,a):new="" cc.vertex2f(0,0,o,a),a+="c,this._tr=e?new" cc.vertex2f(e.x,e.y,o,a):new="" cc.vertex2f(i.x,i.y,o,a):new="" cc.vertex2f(n.x,n.y,o,a):new="" cc.vertex2f(0,0,o,a)},cc.quad2.bytes_per_element="32,n=cc.Quad2.prototype,n._getTL=function(){return" this._tl},n._settl="function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},n._getTR=function(){return" this._tr},n._settr="function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},n._getBL=function(){return" this._bl},n._setbl="function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},n._getBR=function(){return" this._br},n._setbr="function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},cc.js.getset(n,"tl",n._getTL,n._setTL),cc.js.getset(n,"tr",n._getTR,n._setTR),cc.js.getset(n,"bl",n._getBL,n._setBL),cc.js.getset(n,"br",n._getBR,n._setBR),cc.Quad3=function(t,e,i,n,r,s){this._arrayBuffer=r||new" arraybuffer(cc.quad3.bytes_per_element),this._offset="s||0;var" cc.vertex3f(bl.x,bl.y,bl.z,o,a):new="" cc.vertex3f(0,0,0,o,a),a+="c,this.br=br?new" cc.vertex3f(br.x,br.y,br.z,o,a):new="" cc.vertex3f(tl.x,tl.y,tl.z,o,a):new="" cc.vertex3f(tr.x,tr.y,tr.z,o,a):new="" cc.vertex3f(0,0,0,o,a)},cc.quad3.bytes_per_element="48,cc.V3F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new" arraybuffer(cc.v3f_c4b_t2f.bytes_per_element),this._offset="r||0;var" cc.vertex3f(t.x,t.y,t.z,s,o):new="" cc.vertex3f(0,0,0,s,o),o+="cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new" cc.webglcolor(e.r,e.g,e.b,e.a,s,o):new="" cc.webglcolor(0,0,0,0,s,o),o+="cc.WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new" cc.tex2f(i.u,i.v,s,o):new="" cc.tex2f(0,0,s,o)},cc.v3f_c4b_t2f.bytes_per_element="24,n=cc.V3F_C4B_T2F.prototype,n._getVertices=function(){return" this._vertices},n._setvertices="function(t){var" this._colors},n._setcolor="function(t){var" this._texcoords},n._settexcoords="function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.js.getset(n,"vertices",n._getVertices,n._setVertices),cc.js.getset(n,"colors",n._getColor,n._setColor),cc.js.getset(n,"texCoords",n._getTexCoords,n._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,r,s){this._arrayBuffer=r||new" arraybuffer(cc.v3f_c4b_t2f_quad.bytes_per_element),this._offset="s||0;var" cc.v3f_c4b_t2f(t.vertices,t.colors,t.texcoords,o,a):new="" cc.v3f_c4b_t2f(null,null,null,o,a),a+="c,this._bl=e?new" cc.v3f_c4b_t2f(e.vertices,e.colors,e.texcoords,o,a):new="" cc.v3f_c4b_t2f(i.vertices,i.colors,i.texcoords,o,a):new="" cc.v3f_c4b_t2f(n.vertices,n.colors,n.texcoords,o,a):new="" cc.v3f_c4b_t2f(null,null,null,o,a)},cc.v3f_c4b_t2f_quad.bytes_per_element="96,n=cc.V3F_C4B_T2F_Quad.prototype,n._getTL=function(){return" this._arraybuffer},cc.js.getset(n,"tl",n._gettl,n._settl),cc.js.getset(n,"tr",n._gettr,n._settr),cc.js.getset(n,"bl",n._getbl,n._setbl),cc.js.getset(n,"br",n._getbr,n._setbr),cc.js.get(n,"arraybuffer",n._getarraybuffer),cc.v3f_c4b_t2f_quadzero="function(){return" cc.v3f_c4b_t2f_quad},cc.v3f_c4b_t2f_quadcopy="function(t){if(!t)return" cc.v3f_c4b_t2f_quadzero();var="" e},cc.v2f_c4b_t2f="function(t,e,i,n,r){this._arrayBuffer=n||new" arraybuffer(cc.v2f_c4b_t2f.bytes_per_element),this._offset="r||0;var" cc.vertex2f(t.x,t.y,s,o):new="" cc.vertex2f(0,0,s,o),o+="cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?new" cc.tex2f(0,0,s,o)},cc.v2f_c4b_t2f.bytes_per_element="20,n=cc.V2F_C4B_T2F.prototype,n._getVertices=function(){return" arraybuffer(cc.v2f_c4b_t2f_triangle.bytes_per_element),this._offset="r||0;var" cc.v2f_c4b_t2f(t.vertices,t.colors,t.texcoords,s,o):new="" cc.v2f_c4b_t2f(null,null,null,s,o),o+="a,this._b=e?new" cc.v2f_c4b_t2f(e.vertices,e.colors,e.texcoords,s,o):new="" cc.v2f_c4b_t2f(i.vertices,i.colors,i.texcoords,s,o):new="" cc.v2f_c4b_t2f(null,null,null,s,o)},cc.v2f_c4b_t2f_triangle.bytes_per_element="60,n=cc.V2F_C4B_T2F_Triangle.prototype,n._getA=function(){return" this._a},n._seta="function(t){var" this._b},n._setb="function(t){var" this._c},n._setc="function(t){var" n(){}var="" a="n.prototype;a.clone=function(){return" n(this.x,this.y)},a.set="function(t){return" this.x="t.x,this.y=t.y,this},a.equals=function(t){return" t&&this.x="==t.x&&this.y===t.y},a.toString=function(){return"("+this.x.toFixed(2)+"," "+this.y.tofixed(2)+")"},a.lerp="function(t,e,i){i=i||new" this.x+="t.x,this.y+=t.y,this},a.add=function(t,e){return" n,e.x="this.x+t.x,e.y=this.y+t.y,e},a.subSelf=function(t){return" this.x-="t.x,this.y-=t.y,this},a.sub=function(t,e){return" this.x*="t,this.y*=t,this},a.mul=function(t,e){return" =t,this.y="" =t,this},a.div="function(t,e){return" n,t.x="-this.x,t.y=-this.y,t},a.dot=function(t){return" this.x*t.x+this.y*t.y},a.cross="function(t){return" this.y*t.x-this.x*t.y},a.mag="function(){return" math.sqrt(this.x*this.x+this.y*this.y)},a.magsqr="function(){return" this.x*this.x+this.y*this.y},a.normalizeself="function(){var" this;if(0="==t)return" console.warn("can't="" normalize="" zero="" vector"),this;var="" get="" angle="" between="" vector"),0;var="" math.atan2(this.y,this.x)-math.atan2(t.y,t.x)},a.rotate="function(t,e){return" n(1,1)})),s.get(n,"zero",(function(){return="" n(0,0)})),s.get(n,"up",(function(){return="" n(0,1)})),s.get(n,"right",(function(){return="" n(1,0)})),cc.vec2="n,cc.v2=function(t,e){return" n(t,e)},cc.p="cc.v2,cc.pointEqualToPoint=function(t,e){return" t&&e&&t.x="==e.x&&t.y===e.y},e.exports=cc.Vec2}),{"../platform/CCClass":173,"../platform/js":193,"./CCValueType":234}],236:[(function(t,e,i){t("./CCValueType"),t("./CCVec2"),t("./CCPointExtension"),t("./CCSize"),t("./CCRect"),t("./CCColor"),t("./CCTypes"),t("./CCAffineTransform"),t("./CCTypesWebGL")}),{"./CCAffineTransform":227,"./CCColor":228,"./CCPointExtension":229,"./CCRect":230,"./CCSize":231,"./CCTypes":232,"./CCTypesWebGL":233,"./CCValueType":234,"./CCVec2":235}],237:[(function(t,e,i){var" _ccsg.videoplayer.rendercmd(this)},seturl:function(t){this._rendercmd.updateurl(t)},geturl:function(){return="" this._rendercmd._url},play:function(){this._rendercmd.play()},pause:function(){this._rendercmd.pause()},_resume:function(){this._rendercmd.play()},stop:function(){this._rendercmd.stop()},seekto:function(t){this._rendercmd.seekto(t)},isplaying:function(){return="" this._rendercmd.isplaying()},duration:function(){return="" this._rendercmd.duration()},currenttime:function(){return="" this._rendercmd.currenttime()},createdomelementifneeded:function(){this._rendercmd._video||this._rendercmd.createdom()},setkeepaspectratioenabled:function(){cc.logid(7700)},iskeepaspectratioenabled:function(){return!0},setfullscreenenabled:function(t){var="" 0!="=t.width&&void" t,e="_ccsg.VideoPlayer.elements,i=0;i<e.length;i++)t=e[i],e[i]._playing&&(t.pause(),_ccsg.VideoPlayer.pauseElements.push(t))})),cc.game.on(cc.game.EVENT_SHOW,(function(){for(var" t._polyfill.canplaytype.push(".ogv")),e.canplaytype("video="" mp4")&&t._polyfill.canplaytype.push(".mp4"),e.canplaytype("video="" webm")&&t._polyfill.canplaytype.push(".webm")})(),cc.sys.browsertype="==cc.sys.BROWSER_TYPE_FIREFOX&&(t._polyfill.autoplayAfterOperation=!0),cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(t._polyfill.zoomInvalid=!0);var" !important;}.cocosvideo:full-screen{transform:matrix(1,0,0,1,0,0)="" !important;}.cocosvideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0)="" !important;}",document.head.appendchild(e)})(_ccsg.videoplayer),(function(t){_ccsg.videoplayer.rendercmd="function(t){this._rootCtor(t),this._video=null,this._url="",this._played=!1,this._playing=!1,this._ignorePause=!1};var" p="matrix(" +a+","+-c+","+-h+","+l+","+d+","+-f+")";this._video.style.transform="p,this._video.style["-webkit-transform"]=p,this._video.style["transform-origin"]="0px" 100%="" 0px",this._video.style["-webkit-transform-origin"]="0px 100% 0px" }},e.updateurl="function(e){var" i,n,r,s="this._node;if(this._url!=e){this._url=e,cc.loader.resPath&&!/^http/.test(e)&&(e=cc.path.join(cc.loader.resPath,e)),this.removeDom(),this.createDom(),this.bindEvent(),n=this._video;var" t.play(),this._playing="!0},e.pause=function(){var" _ccsg.videoplayer._polyfill.autoplayafteroperation&&this._playing&&settimeout((function(){t.play()}),20),this._playing},e.duration="function(){var" t?(e="t.duration,e<=0&&cc.logID(7702),e):e},e.currentTime=function(){var" t?t.currenttime:-1}})(_ccsg.videoplayer._polyfill)}),{"..="" platform="" utils":198}],238:[(function(t,e,i){var="" cc.logid(7801),!0},cangoforward:function(){return="" cc.logid(7802),!0},goback:function(){try{if(_ccsg.webview._polyfill.closehistory)return="" cc.logid(7803);var="" cc.logid(7804);var="" _ccsg.webview.rendercmd(this)},setcontentsize:function(t,e){void="" e;e="cc._renderType===cc.game.RENDER_TYPE_CANVAS?_ccsg.Node.CanvasRenderCmd:_ccsg.Node.WebGLRenderCmd,_ccsg.WebView.RenderCmd=function(t){this._rootCtor(t),this._parent=null,this._div=null,this._iframe=null,this._listener=null};var" 0px",this._div.style["-webkit-transform-origin"]="0px 100% 0px" }},i.initstyle="function(){if(this._div){var" cc.math.vec3,this.max="e||new" cc.math.vec3},cc.math.aabb.prototype.containspoint="function(t){return" t.x="">=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z},cc.math.aabb.containspoint=function(t,e){return t.x="">=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y&&t.z>=e.min.z&&t.z<=e.max.z},cc.math.aabb.prototype.assignfrom=function(t){this.min.assignfrom(t.min),this.max.assignfrom(t.max)},cc.math.aabb.assign=function(t,e){return 1="==t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},n.transpose=function(){var" t.min.assignfrom(e.min),t.max.assignfrom(e.max),t}}),{}],242:[(function(t,e,i){cc.math.matrix4stack="function(t,e){this.top=t,this.stack=e||[],this.lastUpdated=0};var" n="cc.math.Matrix4Stack.prototype;n.initialize=function(){this.stack.length=0,this.top=null},n.push=function(t){t=t||this.top,this.stack.push(this.top),this.top=new" cc.math.matrix4(t),this.update()},n.pop="function(){this.top=this.stack.pop(),this.update()},n.update=function(){this.lastUpdated++},n.release=function(){this.stack=null,this.top=null,this._matrixPool=null},n._getFromPool=function(t){var" e="this._matrixPool;if(0===e.length)return" new="" cc.math.matrix4(t);var="" i="e.pop();return" i.assignfrom(t),i},n._putinpool="function(t){this._matrixPool.push(t)}}),{}],243:[(function(t,e,i){var" n.matrix4stack,n.projection_matrix_stack="new" n.matrix4stack,n.texture_matrix_stack="new" n.matrix4stack,cc.current_stack="null;var" r="!1,s=function(){if(!r){var" t="new" n.matrix4;n.modelview_matrix_stack.initialize(),n.projection_matrix_stack.initialize(),n.texture_matrix_stack.initialize(),cc.current_stack="n.modelview_matrix_stack,r=!0,t.identity(),n.modelview_matrix_stack.push(t),n.projection_matrix_stack.push(t),n.texture_matrix_stack.push(t)}};s(),n.glFreeAll=function(){n.modelview_matrix_stack.release(),n.modelview_matrix_stack=null,n.projection_matrix_stack.release(),n.projection_matrix_stack=null,n.texture_matrix_stack.release(),n.texture_matrix_stack=null,r=!1,cc.current_stack=null},n.glPushMatrix=function(){cc.current_stack.push(cc.current_stack.top)},n.glPushMatrixWitMat4=function(t){cc.current_stack.stack.push(cc.current_stack.top),t.assignFrom(cc.current_stack.top),cc.current_stack.top=t},n.glPopMatrix=function(){cc.current_stack.top=cc.current_stack.stack.pop()},n.glMatrixMode=function(t){switch(t){case" n.km_gl_modelview:cc.current_stack="n.modelview_matrix_stack;break;case" n.km_gl_projection:cc.current_stack="n.projection_matrix_stack;break;case" n.km_gl_texture:cc.current_stack="n.texture_matrix_stack;break;default:throw" error("invalid="" matrix="" mode="" specified")}},n.glloadidentity="function(){cc.current_stack.top.identity(),cc.current_stack.update()},n.glLoadMatrix=function(t){cc.current_stack.top.assignFrom(t),cc.current_stack.update()},n.glMultMatrix=function(t){cc.current_stack.top.multiply(t),cc.current_stack.update()};var" o="new" n.matrix4;n.gltranslatef="function(t,e,i){var" a="new" n.vec3;n.glrotatef="function(t,e,i,r){a.fill(e,i,r);var" s="n.Matrix4.createByAxisAndAngle(a,cc.degreesToRadians(t),o);cc.current_stack.top.multiply(s),cc.current_stack.update()},n.glScalef=function(t,e,i){var" n.km_gl_modelview:e.assignfrom(n.modelview_matrix_stack.top);break;case="" n.km_gl_projection:e.assignfrom(n.projection_matrix_stack.top);break;case="" n.km_gl_texture:e.assignfrom(n.texture_matrix_stack.top);break;default:throw="" specified")}}}),{}],244:[(function(t,e,i){t(".="" utility"),t(".="" vec2"),t(".="" vec3"),t(".="" vec4"),t(".="" ray2"),t(".="" mat3"),t(".="" mat4"),t(".="" plane"),t(".="" quaternion"),t(".="" aabb"),t(".="" gl="" mat4stack"),t(".="" matrix")}),{".="" aabb":241,".="" mat4stack":242,".="" matrix":243,".="" mat3":245,".="" mat4":246,".="" plane":247,".="" quaternion":248,".="" ray2":249,".="" utility":250,".="" vec2":251,".="" vec3":252,".="" vec4":253}],245:[(function(t,e,i){window.uint16array="window.Uint16Array||window.Array,window.Float32Array=window.Float32Array||window.Array,cc.math.Matrix3=function(t){t&&t.mat?this.mat=new" float32array(t.mat):this.mat="new" float32array(9)};var="" e[0]="i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},n.adjugate=function(){var" t[0]="s*h-o*c,t[1]=n*c-i*h,t[2]=i*o-n*s,t[3]=o*a-r*h,t[4]=e*h-n*a,t[5]=n*r-e*o,t[6]=r*c-s*a,t[8]=e*s-i*r,this},n.identity=function(){var" t[1]="t[2]=t[3]=t[5]=t[6]=t[7]=0,t[0]=t[4]=t[8]=1,this};var" cc.math.matrix3;n.inverse="function(t){if(0===t)return" this;r.assignfrom(this);var="" this.adjugate(),this.multiplyscalar(e),this},n.isidentity="function(){var" e-="t[2]*t[4]*t[6]+t[0]*t[5]*t[7]+t[1]*t[3]*t[8]},n.multiply=function(t){var" e[0]*="t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},cc.math.Matrix3.rotationAxisAngle=function(t,e){var" cc.math.matrix3,s="r.mat;return" s[0]="i+t.x*t.x*(1-i),s[1]=t.z*n+t.y*t.x*(1-i),s[2]=-t.y*n+t.z*t.x*(1-i),s[3]=-t.z*n+t.x*t.y*(1-i),s[4]=i+t.y*t.y*(1-i),s[5]=t.x*n+t.z*t.y*(1-i),s[6]=t.y*n+t.x*t.z*(1-i),s[7]=-t.x*n+t.y*t.z*(1-i),s[8]=i+t.z*t.z*(1-i),r},n.assignFrom=function(t){if(this===t)return" cc.logid(7900),this;var="">n[r]&&i[r]-e<n[r]))return!1;return!0},cc.math.matrix3.createbyrotationx=function(t){var e="new" cc.math.matrix3,i="e.mat;return" i[0]="1,i[1]=0,i[2]=0,i[3]=0,i[4]=Math.cos(t),i[5]=Math.sin(t),i[6]=0,i[7]=-Math.sin(t),i[8]=Math.cos(t),e},cc.math.Matrix3.createByRotationY=function(t){var" i="new" cc.math.matrix3;return="" i.identity(),i.mat[0]="t,i.mat[4]=e,i},cc.math.Matrix3.createByTranslation=function(t,e){var" i.identity(),i.mat[6]="t,i.mat[7]=e,i},cc.math.Matrix3.createByQuaternion=function(t){if(!t)return" null;var="" cc.math.quaternion.rotationmatrix(this).toaxisandangle()}}),{}],246:[(function(t,e,i){cc.math.matrix4="function(t){t&&t.mat?this.mat=new" float32array(t.mat):this.mat="new" float32array(16)};var="" n="cc.math.Matrix4.prototype;n.fill=function(t){for(var" this},cc.math.mat4identity="function(t){var" e[1]="e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1,t},n.identity=function(){var" t="this.mat;return" t[1]="t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[5]=t[10]=t[15]=1,this},n.get=function(t,e){return" this.mat[t+4*e]},n.set="function(t,e,i){this.mat[t+4*e]=i},n.swap=function(t,e,i,n){var" r="this.mat,s=r[t+4*e];r[t+4*e]=r[i+4*n],r[i+4*n]=s},cc.math.Matrix4._gaussj=function(t,e){var" i,n,r,s,o,a,c,h,l,u="0,_=0,d=4,f=4,p=[0,0,0,0],m=[0,0,0,0],g=[0,0,0,0];for(i=0;i<d;i++){for(c=0,n=0;n<d;n++)if(1!==g[n])for(r=0;r<d;r++)0===g[r]&&(a=Math.abs(t.get(n,r)),a">=c&&(c=a,_=n,u=r));if(++g[u],_!==u){for(s=0;s<d;s++)t.swap(_,s,u,s);for(s=0;s<f;s++)e.swap(_,s,u,s)}if(m[i]=_,p[i]=u,0===t.get(u,u))return!1;for(l=1 t.get(u,u),t.set(u,u,1),s="0;s<d;s++)t.set(u,s,t.get(u,s)*l);for(s=0;s<f;s++)e.set(u,s,e.get(u,s)*l);for(o=0;o<d;o++)if(o!==u){for(h=t.get(o,u),t.set(o,u,0),s=0;s<d;s++)t.set(o,s,t.get(o,s)-t.get(u,s)*h);for(s=0;s<f;s++)e.set(o,s,t.get(o,s)-e.get(u,s)*h)}}for(s=d-1;s">=0;s--)if(m[s]!==p[s])for(r=0;r<d;r++)t.swap(r,m[s],r,p[s]);return!0};var 1="==t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},n.transpose=function(){var" r="(new" cc.math.matrix4).identity();cc.math.mat4inverse="function(t,e){var" i="new" cc.math.matrix4(e),n="new" cc.math.matrix4(r);return="" cc.math.matrix4._gaussj(i,n)="==!1?null:(t.assignFrom(i),t)},n.inverse=function(){var" t="new" cc.math.matrix4(this),e="new" cc.math.matrix4._gaussj(t,e)="==!1?null:t},n.isIdentity=function(){var" t[1]="r,t[2]=a,t[3]=l,t[4]=e,t[6]=c,t[7]=u,t[8]=i,t[9]=s,t[11]=_,t[12]=n,t[13]=o,t[14]=h,this},cc.math.mat4Multiply=function(t,e,i){var" n="t.mat,r=e.mat,s=i.mat,o=r[0],a=r[1],c=r[2],h=r[3],l=r[4],u=r[5],_=r[6],d=r[7],f=r[8],p=r[9],m=r[10],g=r[11],v=r[12],y=r[13],x=r[14],T=r[15],b=s[0],C=s[1],A=s[2],S=s[3],E=s[4],w=s[5],I=s[6],R=s[7],P=s[8],O=s[9],B=s[10],D=s[11],M=s[12],L=s[13],N=s[14],F=s[15];return" n[0]="b*o+C*l+A*f+S*v,n[1]=b*a+C*u+A*p+S*y,n[2]=b*c+C*_+A*m+S*x,n[3]=b*h+C*d+A*g+S*T,n[4]=E*o+w*l+I*f+R*v,n[5]=E*a+w*u+I*p+R*y,n[6]=E*c+w*_+I*m+R*x,n[7]=E*h+w*d+I*g+R*T,n[8]=P*o+O*l+B*f+D*v,n[9]=P*a+O*u+B*p+D*y,n[10]=P*c+O*_+B*m+D*x,n[11]=P*h+O*d+B*g+D*T,n[12]=M*o+L*l+N*f+F*v,n[13]=M*a+L*u+N*p+F*y,n[14]=M*c+L*_+N*m+F*x,n[15]=M*h+L*d+N*g+F*T,t},n.multiply=function(t){var" e="this.mat,i=t.mat,n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],l=e[7],u=e[8],_=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],v=e[15],y=i[0],x=i[1],T=i[2],b=i[3],C=i[4],A=i[5],S=i[6],E=i[7],w=i[8],I=i[9],R=i[10],P=i[11],O=i[12],B=i[13],D=i[14],M=i[15];return" e[0]="y*n+x*a+T*u+b*p,e[1]=y*r+x*c+T*_+b*m,e[2]=y*s+x*h+T*d+b*g,e[3]=y*o+x*l+T*f+b*v,e[4]=C*n+A*a+S*u+E*p,e[5]=C*r+A*c+S*_+E*m,e[6]=C*s+A*h+S*d+E*g,e[7]=C*o+A*l+S*f+E*v,e[8]=w*n+I*a+R*u+P*p,e[9]=w*r+I*c+R*_+P*m,e[10]=w*s+I*h+R*d+P*g,e[11]=w*o+I*l+R*f+P*v,e[12]=O*n+B*a+D*u+M*p,e[13]=O*r+B*c+D*_+M*m,e[14]=O*s+B*h+D*d+M*g,e[15]=O*o+B*l+D*f+M*v,this},cc.math.getMat4MultiplyValue=function(t,e){var" float32array(16);return="" r[0]="i[0]*n[0]+i[4]*n[1]+i[8]*n[2]+i[12]*n[3],r[1]=i[1]*n[0]+i[5]*n[1]+i[9]*n[2]+i[13]*n[3],r[2]=i[2]*n[0]+i[6]*n[1]+i[10]*n[2]+i[14]*n[3],r[3]=i[3]*n[0]+i[7]*n[1]+i[11]*n[2]+i[15]*n[3],r[4]=i[0]*n[4]+i[4]*n[5]+i[8]*n[6]+i[12]*n[7],r[5]=i[1]*n[4]+i[5]*n[5]+i[9]*n[6]+i[13]*n[7],r[6]=i[2]*n[4]+i[6]*n[5]+i[10]*n[6]+i[14]*n[7],r[7]=i[3]*n[4]+i[7]*n[5]+i[11]*n[6]+i[15]*n[7],r[8]=i[0]*n[8]+i[4]*n[9]+i[8]*n[10]+i[12]*n[11],r[9]=i[1]*n[8]+i[5]*n[9]+i[9]*n[10]+i[13]*n[11],r[10]=i[2]*n[8]+i[6]*n[9]+i[10]*n[10]+i[14]*n[11],r[11]=i[3]*n[8]+i[7]*n[9]+i[11]*n[10]+i[15]*n[11],r[12]=i[0]*n[12]+i[4]*n[13]+i[8]*n[14]+i[12]*n[15],r[13]=i[1]*n[12]+i[5]*n[13]+i[9]*n[14]+i[13]*n[15],r[14]=i[2]*n[12]+i[6]*n[13]+i[10]*n[14]+i[14]*n[15],r[15]=i[3]*n[12]+i[7]*n[13]+i[11]*n[14]+i[15]*n[15],r},cc.math.mat4Assign=function(t,e){if(t===e)return" cc.logid(7901),t;var="" i[0]="n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],t},n.assignFrom=function(t){if(this===t)return" cc.logid(7902),this;var="" cc.logid(7903),!0;for(var="">i[r]&&e[r]-n<i[r]))return!1;return!0},cc.math.matrix4.createbyrotationx=function(t,e){e=e||new 0="==e?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d):(this.a=t||0,this.b=e||0,this.c=i||0,this.d=n||0)};var" cc.math.matrix4;var="" i="e.mat;return" i[0]="1,i[3]=i[2]=i[1]=0,i[4]=0,i[5]=Math.cos(t),i[6]=Math.sin(t),i[7]=0,i[8]=0,i[9]=-Math.sin(t),i[10]=Math.cos(t),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},cc.math.Matrix4.createByRotationY=function(t,e){e=e||new" r="Math.cos(t),s=Math.sin(t),o=Math.cos(e),a=Math.sin(e),c=Math.cos(i),h=Math.sin(i),l=s*a,u=r*a,_=n.mat;return" _[0]="o*c,_[4]=o*h,_[8]=-a,_[1]=l*c-r*h,_[5]=l*h+r*c,_[9]=s*o,_[2]=u*c+s*h,_[6]=u*h-s*c,_[10]=r*o,_[3]=_[7]=_[11]=0,_[15]=1,n},cc.math.Matrix4.createByQuaternion=function(t,e){e=e||new" n="i.mat,r=t.mat;return" n[0]="r[0],n[1]=r[1],n[2]=r[2],n[3]=0,n[4]=r[3],n[5]=r[4],n[6]=r[5],n[7]=0,n[8]=r[6],n[9]=r[7],n[10]=r[8],n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,i},cc.math.Matrix4.createByScale=function(t,e,i,n){n=n||new" r[0]="t,r[5]=e,r[10]=i,r[15]=1,r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=r[12]=r[13]=r[14]=0,n},cc.math.mat4Translation=function(t,e,i,n){return" t.mat[0]="t.mat[5]=t.mat[10]=t.mat[15]=1,t.mat[1]=t.mat[2]=t.mat[3]=t.mat[4]=t.mat[6]=t.mat[7]=t.mat[8]=t.mat[9]=t.mat[11]=0,t.mat[12]=e,t.mat[13]=i,t.mat[14]=n,t},cc.math.Matrix4.createByTranslation=function(t,e,i,n){return" cc.math.matrix4,n.identity(),n.mat[12]="t,n.mat[13]=e,n.mat[14]=i,n},n.getUpVec3=function(){var" t="this.mat,e=new" cc.math.vec3(t[4],t[5],t[6]);return="" e.normalize()},n.getrightvec3="function(){var" cc.math.vec3(t[0],t[1],t[2]);return="" e.normalize()},n.getforwardvec3="function(){var" cc.math.vec3(t[8],t[9],t[10]);return="" e.normalize()},cc.math.mat4perspectiveprojection="function(t,e,i,n,r){var" s="cc.degreesToRadians(e/2),o=r-n,a=Math.sin(s);if(0===o||0===a||0===i)return" null;var="" c="Math.cos(s)/a;return" t.identity(),t.mat[0]="c/i,t.mat[5]=c,t.mat[10]=-(r+n)/o,t.mat[11]=-1,t.mat[14]=-2*n*r/o,t.mat[15]=0,t},cc.math.Matrix4.createPerspectiveProjection=function(t,e,i,n){var" a="Math.cos(r)/o,c=new" cc.math.matrix4,h="c.mat;return" c.identity(),h[0]="a/e,h[5]=a,h[10]=-(n+i)/s,h[11]=-1,h[14]=-2*i*n/s,h[15]=0,c},cc.math.mat4OrthographicProjection=function(t,e,i,n,r,s,o){return" o="new" cc.math.matrix4,a="o.mat;return" o.identity(),a[0]="2/(e-t),a[5]=2/(n-i),a[10]=-2/(s-r),a[12]=-((e+t)/(e-t)),a[13]=-((n+i)/(n-i)),a[14]=-((s+r)/(s-r)),o},cc.math.mat4LookAt=function(t,e,i,n){var" cc.math.vec3(i),s="new" cc.math.vec3(n);r.subtract(e),r.normalize(),s.normalize();var="" cc.math.vec3(r);o.cross(s),o.normalize();var="" cc.math.vec3(o);a.cross(r),o.normalize(),t.identity(),t.mat[0]="o.x,t.mat[4]=o.y,t.mat[8]=o.z,t.mat[1]=a.x,t.mat[5]=a.y,t.mat[9]=a.z,t.mat[2]=-r.x,t.mat[6]=-r.y,t.mat[10]=-r.z;var" t.multiply(c),t};var="" cc.math.matrix4;n.lookat="function(t,e,i){var" cc.math.vec3(e),r="new" cc.math.vec3(i),o="this.mat;n.subtract(t),n.normalize(),r.normalize();var" cc.math.vec3(n);a.cross(r),a.normalize();var="" cc.math.vec3(a);return="" c.cross(n),a.normalize(),this.identity(),o[0]="a.x,o[4]=a.y,o[8]=a.z,o[1]=c.x,o[5]=c.y,o[9]=c.z,o[2]=-n.x,o[6]=-n.y,o[10]=-n.z,s=cc.math.Matrix4.createByTranslation(-t.x,-t.y,-t.z,s),this.multiply(s),this},cc.math.mat4RotationAxisAngle=function(t,e,i){var" cc.math.vec3(e);return="" s.normalize(),t.mat[0]="n+s.x*s.x*(1-n),t.mat[1]=s.z*r+s.y*s.x*(1-n),t.mat[2]=-s.y*r+s.z*s.x*(1-n),t.mat[3]=0,t.mat[4]=-s.z*r+s.x*s.y*(1-n),t.mat[5]=n+s.y*s.y*(1-n),t.mat[6]=s.x*r+s.z*s.y*(1-n),t.mat[7]=0,t.mat[8]=s.y*r+s.x*s.z*(1-n),t.mat[9]=-s.x*r+s.y*s.z*(1-n),t.mat[10]=n+s.z*s.z*(1-n),t.mat[11]=0,t.mat[12]=0,t.mat[13]=0,t.mat[14]=0,t.mat[15]=1,t},cc.math.Matrix4.createByAxisAndAngle=function(t,e,i){i=i||new" cc.math.vec3(t);return="" o.normalize(),n[0]="r+o.x*o.x*(1-r),n[1]=o.z*s+o.y*o.x*(1-r),n[2]=-o.y*s+o.z*o.x*(1-r),n[3]=0,n[4]=-o.z*s+o.x*o.y*(1-r),n[5]=r+o.y*o.y*(1-r),n[6]=o.x*s+o.z*o.y*(1-r),n[7]=0,n[8]=o.y*s+o.x*o.z*(1-r),n[9]=-o.x*s+o.y*o.z*(1-r),n[10]=r+o.z*o.z*(1-r),n[11]=0,n[12]=n[13]=n[14]=0,n[15]=1,i},n.extractRotation=function(){var" cc.math.matrix3,e="this.mat,i=t.mat;return" e="new" cc.math.plane,i="this.mat;switch(t){case" cc.math.plane.right:e.a="i[3]-i[0],e.b=i[7]-i[4],e.c=i[11]-i[8],e.d=i[15]-i[12];break;case" cc.math.plane.left:e.a="i[3]+i[0],e.b=i[7]+i[4],e.c=i[11]+i[8],e.d=i[15]+i[12];break;case" cc.math.plane.bottom:e.a="i[3]+i[1],e.b=i[7]+i[5],e.c=i[11]+i[9],e.d=i[15]+i[13];break;case" cc.math.plane.top:e.a="i[3]-i[1],e.b=i[7]-i[5],e.c=i[11]-i[9],e.d=i[15]-i[13];break;case" cc.math.plane.far:e.a="i[3]-i[2],e.b=i[7]-i[6],e.c=i[11]-i[10],e.d=i[15]-i[14];break;case" cc.math.plane.near:e.a="i[3]+i[2],e.b=i[7]+i[6],e.c=i[11]+i[10],e.d=i[15]+i[14];break;default:cc.logID(7904)}var" e.a="" =n,e.b="" =n,="" e.c="" =n,e.d="" =n,e},n.toaxisandangle="function(){var" e.toaxisandangle()}}),{}],247:[(function(t,e,i){cc.math.plane="function(t,e,i,n){t&&void" this.a*t.x+this.b*t.y+this.c*t.z+this.d*t.w},n.dotcoord="function(t){return" this.a*t.x+this.b*t.y+this.c*t.z+this.d},n.dotnormal="function(t){return" this.a*t.x+this.b*t.y+this.c*t.z},cc.math.plane.frompointnormal="function(t,e){return" new="" cc.math.plane(e.x,e.y,e.z,-e.dot(t))},cc.math.plane.frompoints="function(t,e,i){var" cc.math.plane;return="" n.subtract(t),r.subtract(t),n.cross(r),n.normalize(),s.a="n.x,s.b=n.y,s.c=n.z,s.d=n.scale(-1).dot(t),s},n.normalize=function(){var" cc.math.vec3(this.a,this.b,this.c),e="1/t.length();return" t.normalize(),this.a="t.x,this.b=t.y,this.c=t.z,this.d=this.d*e,this},n.classifyPoint=function(t){var">.001?cc.math.Plane.POINT_INFRONT_OF_PLANE:e<-.001?cc.math.plane.point_behind_plane:cc.math.plane.point_on_plane}}),{}],248:[(function(t,e,i){cc.math.quaternion=function(t,e,i,n){t&&void 0="==e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)};var" n="cc.math.Quaternion.prototype;n.conjugate=function(t){return" this.x="-t.x,this.y=-t.y,this.z=-t.z,this.w=t.w,this},n.dot=function(t){return" this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.exponential="function(){return" this},n.identity="function(){return" t="this.length();return" math.abs(t)="">cc.math.EPSILON?(this.x=0,this.y=0,this.z=0,this.w=0,this):(this.conjugate(this).scale(1/t),this)},n.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w},n.length=function(){return Math.sqrt(this.lengthSq())},n.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.multiply=function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return this.w=r*t.w-e*t.x-i*t.y-n*t.z,this.x=r*t.x+e*t.w+i*t.z-n*t.y,this.y=r*t.y+i*t.w+n*t.x-e*t.z,this.z=r*t.z+n*t.w+e*t.y-i*t.x,this},n.normalize=function(){var t=this.length();if(Math.abs(t)<=cc.math.epsilon)throw new="" error("current="" quaternion="" is="" an="" invalid="" value");return="" this.scale(1="" t),this},n.rotationaxis="function(t,e){var" i=".5*e,n=Math.sin(i);return" this.w="Math.cos(i),this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this},cc.math.Quaternion.rotationMatrix=function(t){if(!t)return" null;var="" e,i,n,r,s="[],o=t.mat,a=0;s[0]=o[0],s[1]=o[3],s[2]=o[6],s[4]=o[1],s[5]=o[4],s[6]=o[7],s[8]=o[2],s[9]=o[5],s[10]=o[8],s[15]=1;var" c="s[0],h=c[0]+c[5]+c[10]+1;return" h="">cc.math.EPSILON?(a=2*Math.sqrt(h),e=(c[9]-c[6])/a,i=(c[2]-c[8])/a,n=(c[4]-c[1])/a,r=.25*a):c[0]>c[5]&&c[0]>c[10]?(a=2*Math.sqrt(1+c[0]-c[5]-c[10]),e=.25*a,i=(c[4]+c[1])/a,n=(c[2]+c[8])/a,r=(c[9]-c[6])/a):c[5]>c[10]?(a=2*Math.sqrt(1+c[5]-c[0]-c[10]),e=(c[4]+c[1])/a,i=.25*a,n=(c[9]+c[6])/a,r=(c[2]-c[8])/a):(a=2*Math.sqrt(1+c[10]-c[0]-c[5]),e=(c[2]+c[8])/a,i=(c[9]+c[6])/a,n=.25*a,r=(c[4]-c[1])/a),new cc.math.Quaternion(e,i,n,r)},cc.math.Quaternion.rotationYawPitchRoll=function(t,e,i){var n,r,s,o,a,c,h,l,u,_,d;n=cc.degreesToRadians(e)/2,r=cc.degreesToRadians(t)/2,s=cc.degreesToRadians(i)/2,o=Math.cos(n),a=Math.cos(r),c=Math.cos(s),h=Math.sin(n),l=Math.sin(r),u=Math.sin(s),_=a*c,d=l*u;var f=new cc.math.Quaternion;return f.w=o*_+h*d,f.x=h*_-o*d,f.y=o*l*c+h*a*u,f.z=o*a*u-h*l*c,f.normalize(),f},n.slerp=function(t,e){if(this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w)return this;var i=this.dot(t),n=Math.acos(i),r=Math.sqrt(1-cc.math.square(i)),s=Math.sin(e*n)/r,o=Math.sin((1-e)*n)/r,a=new cc.math.Quaternion(t);return this.scale(o),a.scale(s),this.add(a),this},n.toAxisAndAngle=function(){var t,e,i,n=new cc.math.Vec3;return t=Math.acos(this.w),e=Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)),e>-cc.math.EPSILON&&e<cc.math.epsilon||e<2*math.pi+cc.math.epsilon&&e>2*Math.PI-cc.math.EPSILON?(i=0,n.x=0,n.y=0,n.z=1):(i=2*t,n.x=this.x/e,n.y=this.y/e,n.z=this.z/e,n.normalize()),{axis:n,angle:i}},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},cc.math.Quaternion.rotationBetweenVec3=function(t,e,i){var n=new cc.math.Vec3(t),r=new cc.math.Vec3(e);n.normalize(),r.normalize();var s=n.dot(r),o=new cc.math.Quaternion;if(s>=1)return o.identity(),o;if(s<1e-6-1)if(math.abs(i.lengthsq())<cc.math.epsilon)o.rotationaxis(i,math.pi);else{var a="new" cc.math.vec3(1,0,0);a.cross(t),math.abs(a.lengthsq())<cc.math.epsilon&&(a.fill(0,1,0),a.cross(t)),a.normalize(),o.rotationaxis(a,math.pi)}else{var="" c="Math.sqrt(2*(1+s)),h=1/c;n.cross(r),o.x=n.x*h,o.y=n.y*h,o.z=n.z*h,o.w=.5*c,o.normalize()}return" o},n.multiplyvec3="function(t){var" e="this.x,i=this.y,n=this.z,r=new" cc.math.vec3(t),s="new" cc.math.vec3(e,i,n),o="new" cc.math.vec3(e,i,n);return="" s.cross(t),o.cross(s),s.scale(2*q.w),o.scale(2),r.add(s),r.add(o),r}}),{}],249:[(function(t,e,i){function="" n(t,e,i){var="" n="new" cc.math.vec2(e);n.subtract(t),i.x="-n.y,i.y=n.x,i.normalize()}cc.math.Ray2=function(t,e){this.start=t||new" cc.math.vec2,this.dir="e||new" cc.math.vec2},cc.math.ray2.prototype.fill="function(t,e,i,n){this.start.x=t,this.start.y=e,this.dir.x=i,this.dir.y=n},cc.math.Ray2.prototype.intersectLineSegment=function(t,e,i){var" n,r,s,o="this.start.x,a=this.start.y,c=this.start.x+this.dir.x,h=this.start.y+this.dir.y,l=t.x,u=t.y,_=e.x,d=e.y,f=(d-u)*(c-o)-(_-l)*(h-a);return!(f">-cc.math.EPSILON&&f<cc.math.epsilon)&&(n=((_-l)*(a-u)-(d-u)*(o-l)) f,r="o+n*(c-o),s=a+n*(h-a),!(r<Math.min(t.x,e.x)-cc.math.EPSILON||r">Math.max(t.x,e.x)+cc.math.EPSILON||s<math.min(t.y,e.y)-cc.math.epsilon||s>Math.max(t.y,e.y)+cc.math.EPSILON)&&(!(r<math.min(o,c)-cc.math.epsilon||r>Math.max(o,c)+cc.math.EPSILON||s<math.min(a,h)-cc.math.epsilon||s>Math.max(a,h)+cc.math.EPSILON)&&(i.x=r,i.y=s,!0)))},cc.math.Ray2.prototype.intersectTriangle=function(t,e,i,r,s){var o,a=new cc.math.Vec2,c=new cc.math.Vec2,h=new cc.math.Vec2,l=1e4,u=!1;return this.intersectLineSegment(t,e,a)&&(u=!0,o=a.subtract(this.start).length(),o<l&&(c.x=a.x,c.y=a.y,l=o,n(t,e,h))),this.intersectlinesegment(e,i,a)&&(u=!0,o=a.subtract(this.start).length(),o<l&&(c.x=a.x,c.y=a.y,l=o,n(e,i,h))),this.intersectlinesegment(i,t,a)&&(u=!0,o=a.subtract(this.start).length(),o<l&&(c.x=a.x,c.y=a.y,l=o,n(i,t,h))),u&&(r.x=c.x,r.y=c.y,s&&(s.x=h.x,s.y=h.y)),u}}),{}],250:[(function(t,e,i){cc.math=cc.math||{},cc.math.epsilon=1 64,cc.math.square="function(t){return" t*t},cc.math.almostequal="function(t,e){return" t+cc.math.epsilon="">e&&t-cc.math.EPSILON<e}}),{}],251:[(function(t,e,i){cc.math.vec2=function(t,e){void 0="==e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=e||0)};var" n="cc.math.Vec2.prototype;n.fill=function(t,e){this.x=t,this.y=e},n.length=function(){return" math.sqrt(cc.math.square(this.x)+cc.math.square(this.y))},n.lengthsq="function(){return" cc.math.square(this.x)+cc.math.square(this.y)},n.normalize="function(){var" t="1/this.length();return" this.x*="t,this.y*=t,this},cc.math.Vec2.add=function(t,e,i){return" t.x="e.x+i.x,t.y=e.y+i.y,t},n.add=function(t){return" this.x+="t.x,this.y+=t.y,this},n.dot=function(t){return" this.x*t.x+this.y*t.y},cc.math.vec2.subtract="function(t,e,i){return" this.x-="t.x,this.y-=t.y,this},n.transform=function(t){var" e="this.x,i=this.y;return" this.x="e*t.mat[0]+i*t.mat[3]+t.mat[6],this.y=e*t.mat[1]+i*t.mat[4]+t.mat[7],this},cc.math.Vec2.scale=function(t,e,i){return" this.x<t.x+cc.math.epsilon&&this.x="">t.x-cc.math.EPSILON&&this.y<t.y+cc.math.epsilon&&this.y>t.y-cc.math.EPSILON}}),{}],252:[(function(t,e,i){cc.math.Vec3=cc.math.Vec3=function(t,e,i){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t||0,this.y=e||0,this.z=i||0)},cc.math.vec3=function(t,e,i){return new cc.math.Vec3(t,e,i)};var n=cc.math.Vec3.prototype;n.fill=function(t,e,i){return t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),this},n.length=function(){return Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z))},n.lengthSq=function(){return cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)},n.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this},n.cross=function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.transform=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8]+r[12],this.y=e*r[1]+i*r[5]+n*r[9]+r[13],this.z=e*r[2]+i*r[6]+n*r[10]+r[14],this},n.transformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8],this.y=e*r[1]+i*r[5]+n*r[9],this.z=e*r[2]+i*r[6]+n*r[10],this},n.transformCoord=function(t){var e=new cc.math.Vec4(this.x,this.y,this.z,1);return e.transform(t),this.x=e.x/e.w,this.y=e.y/e.w,this.z=e.z/e.w,this},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.equals=function(t){var e=cc.math.EPSILON;return this.x<t.x+e&&this.x>t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e},n.inverseTransform=function(t){var e=t.mat,i=new cc.math.Vec3(this.x-e[12],this.y-e[13],this.z-e[14]);return this.x=i.x*e[0]+i.y*e[1]+i.z*e[2],this.y=i.x*e[4]+i.y*e[5]+i.z*e[6],this.z=i.x*e[8]+i.y*e[9]+i.z*e[10],this},n.inverseTransformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[1]+n*r[2],this.y=e*r[4]+i*r[5]+n*r[6],this.z=e*r[8]+i*r[9]+n*r[10],this},n.assignFrom=function(t){return t?(this.x=t.x,this.y=t.y,this.z=t.z,this):this},cc.math.Vec3.zero=function(t){return t.x=t.y=t.z=0,t},n.toTypeArray=function(){var t=new Float32Array(3);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t}}),{}],253:[(function(t,e,i){cc.math.Vec4=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)};var n=cc.math.Vec4.prototype;n.fill=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t,this.y=e,this.z=i,this.w=n)},n.add=function(t){return t?(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this):this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},n.length=function(){return Math.sqrt(cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)+cc.math.square(this.w))},n.lengthSq=function(){return cc.math.square(this.x)+cc.math.square(this.y)+cc.math.square(this.z)+cc.math.square(this.w)},n.lerp=function(t,e){return this},n.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.scale=function(t){return this.normalize(),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},n.transform=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,s=t.mat;return this.x=e*s[0]+i*s[4]+n*s[8]+r*s[12],this.y=e*s[1]+i*s[5]+n*s[9]+r*s[13],this.z=e*s[2]+i*s[6]+n*s[10]+r*s[14],this.w=e*s[3]+i*s[7]+n*s[11]+r*s[15],this},cc.math.Vec4.transformArray=function(t,e){for(var i=[],n=0;n<t.length;n++){var r="new" cc.math.vec4(t[n]);r.transform(e),i.push(r)}return="" i},n.equals="function(t){var" e="cc.math.EPSILON;return" this.x<t.x+e&&this.x="">t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e&&this.w<t.w+e&&this.w>t.w-e},n.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.toTypeArray=function(){var t=new Float32Array(4);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t[3]=this.w,t}}),{}],254:[(function(t,e,i){t("./CCSGMotionStreak.js"),t("./CCSGMotionStreakWebGLRenderCmd.js");var n=cc.Class({name:"cc.MotionStreak",extends:cc.Component,editor:!1,ctor:function(){this._root=null,this._motionStreak=null},properties:{preview:{default:!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this._motionStreak&&this._motionStreak.setFadeTime(t)},animatable:!1,tooltip:!1},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){this._minSeg=t,this._motionStreak&&this._motionStreak.setMinSeg(t)},animatable:!1,tooltip:!1},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){this._stroke=t,this._motionStreak&&this._motionStreak.setStroke(t)},animatable:!1,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._motionStreak&&(cc.js.isString(t)&&(t=cc.textureCache.addImage(t)),this._motionStreak.setTexture(t))},url:cc.Texture2D,animatable:!1,tooltip:!1},_color:cc.Color.WHITE,color:{get:function(){return this._color},set:function(t){this._color=t,this._motionStreak&&this._motionStreak.tintWithColor(t)},tooltip:!1},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){this._fastMode=t,this._motionStreak&&this._motionStreak.setFastMode(t)},animatable:!1,tooltip:!1}},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._motionStreak.reset()},__preload:function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)return void cc.warnID(5900);this._root=new _ccsg.Node;var t=new _ccsg.MotionStreak;t.initWithFade(this._fadeTime,this._minSeg,this._stroke,this.node.color,this._texture||null),t.setFastMode(this._fastMode),this._root.addChild(t);var e=this.node._sgNode;e&&e.addChild(this._root,-10),this._motionStreak=t},onEnable:function(){this.node.on("position-changed",this._onNodePositionChanged,this)},onDisable:function(){this.node.off("position-changed",this._onNodePositionChanged,this)},_onNodePositionChanged:function(){if(this._motionStreak){var t=this.node,e=t.getNodeToWorldTransform(),i=e.tx-(t.width/2+t.anchorX*t.width),n=e.ty-(t.height/2+t.anchorY*t.height);this._root.setPosition(-i,-n),this._motionStreak.setPosition(i,n)}}});cc.MotionStreak=e.exports=n}),{"./CCSGMotionStreak.js":255,"./CCSGMotionStreakWebGLRenderCmd.js":256}],255:[(function(t,e,i){function n(t,e,i,n,s){if(s+=n,!(s<=1)){e*=.5;for(var o,a="s-1,c=n;c<s;c++){o=2*c;var" h,l="cc.p(t[2*c],t[2*c+1]);if(0===c)h=cc.pPerp(cc.pNormalize(cc.pSub(l,cc.p(t[2*(c+1)],t[2*(c+1)+1]))));else" if(c="==a)h=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(t[2*(c-1)],t[2*(c-1)+1]),l)));else{var" u="cc.p(t[2*(c-1)],t[2*(c-1)+1]),_=cc.p(t[2*(c+1)],t[2*(c+1)+1]),d=cc.pNormalize(cc.pSub(_,l)),f=cc.pNormalize(cc.pSub(u,l)),p=Math.acos(cc.pDot(d,f));h=p<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(d,f))):p<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(d,f)):cc.pPerp(cc.pNormalize(cc.pSub(_,u)))}h=cc.pMult(h,e),i[2*o]=l.x+h.x,i[2*o+1]=l.y+h.y,i[2*(o+1)]=l.x-h.x,i[2*(o+1)+1]=l.y-h.y}for(n=0===n?0:n-1,c=n;c<a;c++){o=2*c;var" m="o+2,g=cc.v2(i[2*o],i[2*o+1]),v=cc.v2(i[2*(o+1)],i[2*(o+1)+1]),y=cc.v2(i[2*m],i[2*m+1]),x=cc.v2(i[2*(m+1)],i[2*(m+1)+1]),T=r(g.x,g.y,x.x,x.y,v.x,v.y,y.x,y.y),b=!T.isSuccess;b||(T.value<0||T.value">1)&&(b=!0),b&&(i[2*m]=x.x,i[2*m+1]=x.y,i[2*(m+1)]=y.x,i[2*(m+1)+1]=y.y)}}}function r(t,e,i,n,r,s,o,a){var c,h,l,u;if(t===i&&e===n||r===o&&s===a)return{isSuccess:!1,value:0};if(i-=t,n-=e,r-=t,s-=e,o-=t,a-=e,c=Math.sqrt(i*i+n*n),h=i/c,l=n/c,u=r*h+s*l,s=s*h-r*l,r=u,u=o*h+a*l,a=a*h-o*l,o=u,s===a)return{isSuccess:!1,value:0};var _=(o+(r-o)*a/(a-s))/c;return{isSuccess:!0,value:_}}_ccsg.MotionStreak=_ccsg.Node.extend({texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(t,e,i,n,r){_ccsg.Node.prototype.ctor.call(this),this._positionR=cc.p(0,0),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.fastMode=!1,this.startingPositionInitialized=!1,this.texture=null,this._stroke=0,this._fadeDelta=0,this._minSeg=0,this._maxPoints=0,this._nuPoints=0,this._previousNuPoints=0,this._pointVertexes=null,this._pointState=null,this._vertices=null,this._colorPointer=null,this._texCoords=null,this._verticesBuffer=null,this._colorPointerBuffer=null,this._texCoordsBuffer=null,void 0!==r&&this.initWithFade(t,e,i,n,r)},initWithFade:function(t,e,i,n,r){return cc.js.isString(r)&&(r=cc.textureCache.addImage(r)),this.anchorX=0,this.anchorY=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._stroke=i,this.setMinSeg(e),this.setFadeTime(t),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this.setTexture(r),this.color=n,this.scheduleUpdate(),!0},getTexture:function(){return this.texture},setTexture:function(t){this.texture!==t&&(this.texture=t)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:(this._blendFunc.src=t,this._blendFunc.dst=e)},getOpacity:function(){return cc.logID(5901),0},setOpacity:function(t){cc.logID(5902)},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},getFadeTime:function(){return 1/this._fadeDelta},setFadeTime:function(t){this._fadeDelta=1/t;var e=(0|60*t)+2;this._maxPoints=e,this._nuPoints=0,this._pointState=new Float32Array(e),this._pointVertexes=new Float32Array(2*e),this._vertices=new Float32Array(4*e),this._texCoords=new Float32Array(4*e),this._colorPointer=new Uint8Array(8*e),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW)},getMinSeg:function(){return this._minSeg},setMinSeg:function(t){this._minSeg=t===-1?this._stroke/5:t,this._minSeg*=this._minSeg},isFastMode:function(){return this.fastMode},setFastMode:function(t){this.fastMode=t},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(t){this.startingPositionInitialized=t},getStroke:function(){return this._stroke},setStroke:function(t){this._stroke=t},tintWithColor:function(t){this.color=t;for(var e=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)e[4*i]=t.r,e[4*i+1]=t.g,e[4*i+2]=t.b},reset:function(){this._nupoints=0},setposition:function(t,e){this.startingpositioninitialized=!0,void 0="==e?(this._positionR.x=t.x,this._positionR.y=t.y):(this._positionR.x=t,this._positionR.y=e)},getPositionX:function(){return" this._positionr.x},setpositionx:function(t){this._positionr.x="t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return" this._positionr.y},setpositiony:function(t){this._positionr.y="t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(t){if(this.startingPositionInitialized){t*=this._fadeDelta;var" e,i,r,s,o="0,a=this._nuPoints,c=this._pointState,h=this._pointVertexes,l=this._vertices,u=this._colorPointer;for(r=0;r<a;r++)if(c[r]-=t,c[r]<=0)o++;else{e=r-o,o">0?(c[e]=c[r],h[2*e]=h[2*r],h[2*e+1]=h[2*r+1],s=2*r,i=2*e,l[2*i]=l[2*s],l[2*i+1]=l[2*s+1],l[2*(i+1)]=l[2*(s+1)],l[2*(i+1)+1]=l[2*(s+1)+1],s*=4,i*=4,u[i+0]=u[s+0],u[i+1]=u[s+1],u[i+2]=u[s+2],u[i+4]=u[s+4],u[i+5]=u[s+5],u[i+6]=u[s+6]):i=8*e;var _=255*c[e];u[i+3]=_,u[i+7]=_}a-=o;var d=!0;if(a>=this._maxPoints)d=!1;else if(a>0){var f=cc.p(h[2*(a-1)],h[2*(a-1)+1]),p=cc.pDistanceSQ(f,this._positionR)<this._minseg,m=cc.p(h[2*(a-2)],h[2*(a-2)+1]),g=1!==a&&cc.pdistancesq(m,this._positionr)<2*this._minseg;(p||g)&&(d=!1)}if(d){h[2*a]=this._positionr.x,h[2*a+1]=this._positionr.y,c[a]=1;var v="8*a,y=this.getDisplayedColor();u[v]=y.r,u[v+1]=y.g,u[v+2]=y.b,u[v+4]=y.r,u[v+5]=y.g,u[v+6]=y.b,u[v+3]=255,u[v+7]=255,a">0&&this.fastMode&&(a>1?n(h,this._stroke,this._vertices,a,1):n(h,this._stroke,this._vertices,0,2)),a++}if(this.fastMode||n(h,this._stroke,this._vertices,0,a),a&&this._previousNuPoints!==a){var x=1/a,T=this._texCoords;for(r=0;r<a;r++)t[4*r]=0,t[4*r+1]=x*r,t[2*(2*r+1)]=1,t[2*(2*r+1)+1]=x*r;this._previousnupoints=a}this._nupoints=a}},_createrendercmd:function(){return cc._rendertype="==cc.game.RENDER_TYPE_WEBGL?new" _ccsg.motionstreak.webglrendercmd(this):null}});var="" s="_ccsg.MotionStreak.prototype;Object.defineProperty(s,"x",{get:s.getPositionX,set:s.setPositionX}),Object.defineProperty(s,"y",{get:s.getPositionY,set:s.setPositionY})}),{}],256:[(function(t,e,i){_ccsg.MotionStreak.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new" cc.math.matrix4,this._matrix.identity(),this._shaderprogram="cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLOR)},_ccsg.MotionStreak.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype),_ccsg.MotionStreak.WebGLRenderCmd.prototype.constructor=_ccsg.Sprite.WebGLRenderCmd,_ccsg.MotionStreak.WebGLRenderCmd.prototype.rendering=function(t){var" e="this._node;if(!(e._nuPoints<=1)&&e.texture&&e.texture.isLoaded()){t=t||cc._renderContext,this._updateDisplayColor();var" i="this._worldTransform,n=this._matrix.mat;n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.gl.blendFunc(e._blendFunc.src,e._blendFunc.dst),cc.gl.bindTexture2DN(0,e.texture),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.macro.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,e._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,e._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._texCoordsBuffer),t.bufferData(t.ARRAY_BUFFER,e._texCoords,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._colorPointerBuffer),t.bufferData(t.ARRAY_BUFFER,e._colorPointer,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.macro.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,2*e._nuPoints),cc.g_NumberOfDraws++}}}),{}],257:[(function(t,e,i){var" n="cc._Class.extend({ctor:function(t){var" e,i,n,r,s,o,a,c,h,l,u,_,d,f;for(this.data="t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(e=this.readUInt32(),h=function(){var" t,e;for(e="[],o=t=0;t<4;o=++t)e.push(String.fromCharCode(this.data[this.pos++]));return" e}.call(this).join("")){case"ihdr":this.width="this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},r=this.readUInt16(),n=this.readUInt16()||100,s.delay=1e3*r/n,s.disposeOp=this.data[this.pos++],s.blendOp=this.data[this.pos++],s.data=[];break;case"IDAT":case"fdAT":for("fdAT"===h&&(this.pos+=4,e-=4),t=(null!=s?s.data:void" 0)||this.imgdata,o="_=0;0<=e?_<e:_">e;o=0<=e?++_:--_)t.push(this.data[this.pos++]);break;case"trns":switch(this.transparency={},this.colortype){case 3:if(this.transparency.indexed="this.read(e),l=255-this.transparency.indexed.length,l">0)for(o=d=0;0<=l?d<l:d>l;o=0<=l?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale="this.read(e)[0];break;case" 2:this.transparency.rgb="this.read(e)}break;case"tEXt":u=this.read(e),a=u.indexOf(0),c=String.fromCharCode.apply(String,u.slice(0,a)),this.text[c]=String.fromCharCode.apply(String,u.slice(a+1));break;case"IEND":return" s&&this.animation.frames.push(s),this.colors="function(){switch(this.colorType){case" 0:case="" 3:case="" 4:return="" 1;case="" 2:case="" 6:return="" 3}}.call(this),this.hasalphachannel="4===(f=this.colorType)||6===f,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case" 1:return"devicegray";case="" 3:return"devicergb"}}.call(this),void(uint8array!="Array&&(this.imgData=new" uint8array(this.imgdata)));default:this.pos+="e}if(this.pos+=4,this.pos">this.data.length)throw new Error("Incomplete or corrupt PNG file")}},read:function(t){var e,i,n;for(n=[],e=i=0;0<=t?i<t:i>t;e=0<=t?++i:--i)n.push(this.data[this.pos++]);return n},readuint32:function(){var="" t,e,i,n;return="" t="this.data[this.pos++]<<24,e=this.data[this.pos++]<<16,i=this.data[this.pos++]<<8,n=this.data[this.pos++],t|e|i|n},readUInt16:function(){var" t,e;return="" e,i,n,r,s,o,a,c,h,l,u,_,d,f,p,m,g,v,y,x,t,b,c;if(null="=t&&(t=this.imgData),0===t.length)return" new="" uint8array(0);var="" a="new" zlib.inflate(t,{index:0,verify:!1});for(t="A.decompress(),_=this.pixelBitlength/8,m=_*this.width,d=new" uint8array(m*this.height),o="t.length,p=0,f=0,i=0;f<o;){switch(t[f++]){case" 0:for(r="y=0;y<m;r=y+=1)d[i++]=t[f++];break;case" 1:for(r="x=0;x<m;r=x+=1)e=t[f++],s=r<_?0:d[i-_],d[i++]=(e+s)%256;break;case" 2:for(r="T=0;T<m;r=T+=1)e=t[f++],n=(r-r%_)/_,g=p&&d[(p-1)*m+n*_+r%_],d[i++]=(g+e)%256;break;case" 3:for(r="b=0;b<m;r=b+=1)e=t[f++],n=(r-r%_)/_,s=r<_?0:d[i-_],g=p&&d[(p-1)*m+n*_+r%_],d[i++]=(e+Math.floor((s+g)/2))%256;break;case" 4:for(r="C=0;C<m;r=C+=1)e=t[f++],n=(r-r%_)/_,s=r<_?0:d[i-_],0===p?g=v=0:(g=d[(p-1)*m+n*_+r%_],v=n&&d[(p-1)*m+(n-1)*_+r%_]),a=s+g-v,c=Math.abs(a-s),l=Math.abs(a-g),u=Math.abs(a-v),h=c<=l&&c<=u?s:l<=u?g:v,d[i++]=(e+h)%256;break;default:throw" error("invalid="" filter="" algorithm:="" "+t[f-1])}p++}return="" d},copytoimagedata:function(t,e){var="" i,n,r,s,o,a,c,h,l,u,_;if(n="this.colors,l=null,i=this.hasAlphaChannel,this.palette.length&&(l=null!=(_=this._decodedPalette)?_:this._decodedPalette=this.decodePalette(),n=4,i=!0),r=t.data||t,h=r.length,o=l||e,s=a=0,1===n)for(;s<h;)c=l?4*e[s/4]:a,u=o[c++],r[s++]=u,r[s++]=u,r[s++]=u,r[s++]=i?o[c++]:255,a=c;else" for(;s<h;)c="l?4*e[s/4]:a,r[s++]=o[c++],r[s++]=o[c++],r[s++]=o[c++],r[s++]=i?o[c++]:255,a=c},decodePalette:function(){var" t,e,i,n,r,s,o,a,c;for(i="this.palette,s=this.transparency.indexed||[],r=new" uint8array((s.length||0)+i.length),n="0,t=0,e=o=0,a=i.length;o<a;e=o+=3)r[n++]=i[e],r[n++]=i[e+1],r[n++]=i[e+2],r[n++]=null!=(c=s[t++])?c:255;return" r},render:function(t){var="" e,i;return="" t.width="this.width,t.height=this.height,e=t.getContext("2d"),i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0)}});e.exports=n}),{}],258:[(function(t,e,i){var" n="cc.Class({name:"cc.ParticleAsset",extends:cc.RawAsset});cc.ParticleAsset=e.exports=n}),{}],259:[(function(t,e,n){cc.ParticleBatchNode=_ccsg.Node.extend({textureAtlas:null,_blendFunc:null,_className:"ParticleBatchNode",ctor:function(t,e){_ccsg.Node.prototype.ctor.call(this),this._blendFunc={src:cc.macro.BLEND_SRC,dst:cc.macro.BLEND_DST},cc.js.isString(t)?this.init(t,e):t" instanceof="" cc.texture2d&&this.initwithtexture(t,e)},_createrendercmd:function(){return="" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" cc.particlebatchnode.canvasrendercmd(this):new="" cc.particlebatchnode.webglrendercmd(this)},initwithtexture:function(t,e){return="" this.textureatlas="new" cc.textureatlas,this.textureatlas.initwithtexture(t,e),this._children.length="0,this._renderCmd._initWithTexture(),!0},initWithFile:function(t,e){var" i="cc.textureCache.addImage(t);return" this.initwithtexture(i,e)},init:function(t,e){var="" this.initwithtexture(i,e)},visit:function(t){var="" e="this._renderCmd,i=t?t._renderCmd:null;return" this._visible?(e.visit(i),cc.renderer.pushrendercommand(e),void(e._dirtyflag="0)):void" e._propagateflagsdown(i)},addchild:function(t,e,i){if(!t)throw="" error("cc.particlebatchnode.addchild()="" :="" child="" should="" be="" non-null");if(!(t="" _ccsg.particlesystem))throw="" only="" supports="" _ccsg.particlesystem="" as="" children");if(e="null==e?t.zIndex:e,i=null==i?t.tag:i,t.getTexture()!==this.textureAtlas.texture)throw" error("_ccsg.particlesystem.addchild()="" the="" is="" not="" using="" same="" texture="" id");var="" if(n.src!="=this._blendFunc.src||n.dst!==this._blendFunc.dst)return" void="" cc.logid(6002);var="" r="this._addChildHelper(t,e,i),s=0;if(0!==r){var" o="this._children[r-1];s=o.getAtlasIndex()+o.getTotalParticles()}else" s="0;this.insertChild(t,s),t.setBatchNode(this)},insertChild:function(t,e){var">n.getCapacity()&&(this._increaseAtlasCapacityTo(r+i),n.fillWithEmptyQuadsFromIndex(n.getCapacity()-i,i)),t.getAtlasIndex()+i!==r&&n.moveQuadsFromIndex(e,e+i),n.increaseTotalQuadsWith(i),this._updateAllAtlasIndexes()},removeChild:function(t,e){if(null!=t){if(!(t instanceof _ccsg.ParticleSystem))throw new Error("cc.ParticleBatchNode.removeChild(): only supports _ccsg.ParticleSystem as children");if(this._children.indexOf(t)===-1)return void cc.logID(6003);_ccsg.Node.prototype.removeChild.call(this,t,e);var i=this.textureAtlas;i.removeQuadsAtIndex(t.getAtlasIndex(),t.getTotalParticles()),i.fillWithEmptyQuadsFromIndex(i.totalQuads,t.getTotalParticles()),t.setBatchNode(null),this._updateAllAtlasIndexes()}},reorderChild:function(t,e){if(!t)throw new Error("cc.ParticleBatchNode.reorderChild(): child should be non-null");if(!(t instanceof _ccsg.ParticleSystem))throw new Error("cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children");if(this._children.indexOf(t)===-1)return void cc.logID(6004);if(e!==t.zIndex){if(this._children.length>1){var i=this._getCurrentIndex(t,e);if(i.oldIndex!==i.newIndex){this._children.splice(i.oldIndex,1),this._children.splice(i.newIndex,0,t);var n=t.getAtlasIndex();this._updateAllAtlasIndexes();for(var r=0,s=this._children,o=0;o<s.length;o++){var 0="==e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.src=e)},getBlendFunc:function(){return" a="s[o];if(a===t){r=t.getAtlasIndex();break}}this.textureAtlas.moveQuadsFromIndex(n,t.getTotalParticles(),r),t.updateWithNoTime()}}t._setLocalZOrder(e)}},removeChildAtIndex:function(t,e){this.removeChild(this._children[i],e)},removeAllChildren:function(t){for(var" e="this._children,i=0;i<e.length;i++)e[i].setBatchNode(null);_ccsg.Node.prototype.removeAllChildren.call(this,t),this.textureAtlas.removeAllQuads()},disableParticle:function(t){var" this.textureatlas.texture},settexture:function(t){this.textureatlas.texture="t;var" new="" cc.blendfunc(this._blendfunc.src,this._blendfunc.dst)},_updateallatlasindexes:function(){for(var="" t="0,e=this._children,i=0;i<e.length;i++){" var="" n="e[i];n.setAtlasIndex(t),t+=n.getTotalParticles()}},_increaseAtlasCapacityTo:function(t){cc.logID(6006,this.textureAtlas.getCapacity(),t),this.textureAtlas.resizeCapacity(t)||cc.logID(6005)},_searchNewPositionInChildrenForZ:function(t){for(var">t)return n;return i},_getCurrentIndex:function(t,e){for(var i=!1,n=!1,r=0,s=0,o=0,a=this._children,c=a.length,h=0;h<c;h++){var l="a[h];if(l.zIndex">e&&!n&&(r=h,n=!0,i&&n))break;if(t===l&&(s=h,i=!0,n||(o=-1),i&&n))break}return n||(r=c),r+=o,{newIndex:r,oldIndex:s}},_addChildHelper:function(t,e,i){if(!t)throw new Error("cc.ParticleBatchNode._addChildHelper(): child should be non-null");if(t.parent)return cc.logID(6007),null;this._children||(this._children=[]);var n=this._searchNewPositionInChildrenForZ(e);return this._children.splice(n,0,t),t.tag=i,t._setLocalZOrder(e),t.parent=this,this._running&&(t.performRecursive(_ccsg.Node.performType.onEnter),t.performRecursive(_ccsg.Node.performType.onEnterTransitionDidFinish)),n},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=cc.macro.SRC_ALPHA,this._blendFunc.dst=cc.macro.ONE_MINUS_SRC_ALPHA)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t}});var r=cc.ParticleBatchNode.prototype;r.texture,cc.defineGetterSetter(r,"texture",r.getTexture,r.setTexture)}),{}],260:[(function(t,e,i){cc.ParticleBatchNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1};var n=cc.ParticleBatchNode.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.ParticleBatchNode.CanvasRenderCmd,n._initWithTexture=function(){}}),{}],261:[(function(t,e,i){cc.ParticleBatchNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()};var n=cc.ParticleBatchNode.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);n.constructor=cc.ParticleBatchNode.WebGLRenderCmd,n.rendering=function(t){var e=this._node;if(0!==e.textureAtlas.totalQuads){var i=this._worldTransform,n=this._matrix.mat;n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.gl.blendFuncForParticle(e._blendFunc.src,e._blendFunc.dst),e.textureAtlas.drawQuads()}},n._initWithTexture=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLOR)}}),{}],262:[(function(t,e,i){t("./CCSGParticleSystem.js"),t("./CCSGParticleSystemCanvasRenderCmd.js"),t("./CCSGParticleSystemWebGLRenderCmd.js"),t("./CCParticleBatchNode.js"),t("./CCParticleBatchNodeCanvasRenderCmd.js"),t("./CCParticleBatchNodeWebGLRenderCmd.js");var n=cc.BlendFunc.BlendFactor,r=cc.Enum({GRAVITY:0,RADIUS:1}),s=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),o={preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,t?this._applyCustoms():this._applyFile())},animatable:!1,tooltip:!1},_file:{default:"",url:cc.ParticleAsset},file:{get:function(){return this._file},set:function(t,e){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)},animatable:!1,url:cc.ParticleAsset,tooltip:!1},_texture:{default:"",url:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture=t,this._sgNode.texture=t?cc.textureCache.addImage(t):null,!t&&this._file&&this._applyFile()},url:cc.Texture2D,tooltip:!1},particleCount:{get:function(){return this._sgNode.particleCount},set:function(t){this._sgNode.particleCount=t},visible:!1,tooltip:!1},_srcBlendFactor:n.SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor=t,this._blendFunc.src=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor=t,this._blendFunc.dst=t,this._sgNode.setBlendFunc(this._blendFunc)},animatable:!1,type:n,tooltip:!1},playOnLoad:!0,_autoRemoveOnFinish:!1,autoRemoveOnFinish:{get:function(){return this._autoRemoveOnFinish},set:function(t){this._autoRemoveOnFinish!==t&&(this._autoRemoveOnFinish=t,this._applyAutoRemove())},animatable:!1,tooltip:!1},active:{get:function(){return!!this._sgNode&&this._sgNode.isActive()},visible:!1}},a=(function(){for(var t={totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,startColor:cc.Color.WHITE,startColorVar:cc.Color.BLACK,endColor:cc.color(255,255,255,0),endColorVar:cc.color(0,0,0,0),angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.p(0,0),posVar:cc.p(0,0),positionType:s.FREE,emitterMode:r.GRAVITY,gravity:cc.p(0,0),speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},e=Object.keys(t),i=0;i<e.length;++i){var n="e[i];!(function(t,e){var" i="_" +t;o[i]="e;var" new="" n(this[i])},r.type="n):r.get=function(){return" this[i]},cc.ischildclassof(n,cc.valuetype)?r.set="function(e){this[i]=new" n(e),this._sgnode[t]="e}:r.set=function(e){this[i]=e,this._sgNode[t]=e}})(n,t[n])}return" e})();o.positiontype.type="s,o.emitterMode.type=r;var" c="cc.Class({name:"cc.ParticleSystem",extends:cc._RendererUnderSG,editor:!1,ctor:function(){this._previewTimer=null,this._focused=!1,this._willStart=!1,this._blendFunc=new" cc.blendfunc(0,0),this._originonexit="null},properties:o,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:r,PositionType:s},__preload:function(){this._super(),this.playOnLoad&&this.resetSystem(),this._applyAutoRemove()},onDestroy:function(){this._autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._super()},onFocusInEditor:!1,onLostFocusInEditor:!1,_createSgNode:function(){return" _ccsg.particlesystem},_initsgnode:function(){var="" t="this._sgNode;if(this._file)if(this._custom){var" e="!this._texture;e?this._applyFile():this._applyCustoms()}else" this._applyfile();else="" this._custom&&this._applycustoms();t.stopsystem()},addparticle:function(){return="" this._sgnode.addparticle()},stopsystem:function(){this._sgnode.stopsystem()},resetsystem:function(){this._sgnode.resetsystem()},isfull:function(){return="" this.particlecount="">=this._totalParticles},setDisplayFrame:function(t){if(t){var e=t.getTexture();e&&(this._texture=e.url),this._sgNode.setDisplayFrame(t)}},setTextureWithRect:function(t,e){t instanceof cc.Texture2D&&(this._texture=t.url),this._sgNode.setTextureWithRect(t,e)},_applyFile:function(){var t=this._file;if(t){var e=this;cc.loader.load(t,(function(i,n){if(i||!n)throw i||new Error("Unkown error");if(e.isValid){var r=e._sgNode;r.particleCount=0;var s=r.isActive();r.initWithFile(t),n.textureUuid&&cc.AssetLibrary.queryAssetInfo(n.textureUuid,(function(t,i,n){return t?void cc.error(t):void(e.texture=i)})),n.emissionRate&&(e.emissionRate=n.emissionRate),r.setPosition(0,0),s||r.stopSystem(),e._applyAutoRemove(),e._custom&&e._applyCustoms()}}))}},_applyCustoms:function(){for(var t=this._sgNode,e=t.isActive(),i=0;i<a.length;i++){var 0="==e?this._blendFunc!==t&&(this._blendFunc=t,this._updateBlendFunc()):this._blendFunc.src===t&&this._blendFunc.dst===e||(this._blendFunc={src:t,dst:e},this._updateBlendFunc())},isOpacityModifyRGB:function(){return" n="a[i];t[n]=this["_"+n]}this._blendFunc.src=this._srcBlendFactor,this._blendFunc.dst=this._dstBlendFactor,t.setBlendFunc(this._blendFunc),this._texture&&(t.texture=cc.textureCache.addImage(this._texture)),e||t.stopSystem(),this._applyAutoRemove()},_applyAutoRemove:function(){var" t="this._sgNode,e=this._autoRemoveOnFinish;if(t.autoRemoveOnFinish=e,e){if(this._originOnExit)return;this._originOnExit=t.onExit;var" i="this;t.onExit=function(){i._originOnExit.call(this),i.node.destroy()}}else" this._originonexit&&(t.onexit="this._originOnExit,this._originOnExit=null)}});cc.ParticleSystem=e.exports=c}),{"./CCParticleBatchNode.js":259,"./CCParticleBatchNodeCanvasRenderCmd.js":260,"./CCParticleBatchNodeWebGLRenderCmd.js":261,"./CCSGParticleSystem.js":263,"./CCSGParticleSystemCanvasRenderCmd.js":264,"./CCSGParticleSystemWebGLRenderCmd.js":265}],263:[(function(t,e,i){var" cc.particle.modea,this.modeb="u?u:new" cc.particle.modeb,this.ischangecolor="!1,this.drawPos=cc.p(0,0)},cc.Particle.ModeA=function(t,e,i){this.dir=t?t:cc.p(0,0),this.radialAccel=e||0,this.tangentialAccel=i||0},cc.Particle.ModeB=function(t,e,i,n){this.angle=t||0,this.degreesPerSecond=e||0,this.radius=i||0,this.deltaRadius=n||0},cc.Particle.TemporaryPoints=[cc.p(),cc.p(),cc.p(),cc.p()],_ccsg.ParticleSystem=_ccsg.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:cc.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,_batchNode:null,atlasIndex:0,_transformSystemDirty:!1,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(t){if(_ccsg.Node.prototype.ctor.call(this),this.emitterMode=_ccsg.ParticleSystem.Mode.GRAVITY,this.modeA=new" _ccsg.particlesystem.modea,this.modeb="new" _ccsg.particlesystem.modeb,this._blendfunc="{src:cc.macro.BLEND_SRC,dst:cc.macro.BLEND_DST},this._particles=[],this._sourcePosition=cc.p(0,0),this._posVar=cc.p(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.p(0,0),this._emitCounter=0,this._particleIdx=0,this._batchNode=null,this.atlasIndex=0,this._transformSystemDirty=!1,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=_ccsg.ParticleSystem.Type.FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!t||cc.js.isNumber(t)){var" e="t||100;this.setDrawMode(_ccsg.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(e)}else"string"==typeof" t?this.initwithfile(t):"object"="=typeof" t&&this.initwithdictionary(t,"")},_createrendercmd:function(){return="" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" _ccsg.particlesystem.canvasrendercmd(this):new="" _ccsg.particlesystem.webglrendercmd(this)},ignorecolor:function(t){this._donttint="t},initTexCoordsWithRect:function(t){this._renderCmd.initTexCoordsWithRect(t)},getBatchNode:function(){return" this._batchnode},setbatchnode:function(t){this._rendercmd.setbatchnode(t)},getatlasindex:function(){return="" this.atlasindex},setatlasindex:function(t){this.atlasindex="t},getDrawMode:function(){return" this._rendercmd.getdrawmode()},setdrawmode:function(t){this._rendercmd.setdrawmode(t)},getshapetype:function(){return="" this._rendercmd.getshapetype()},setshapetype:function(t){this._rendercmd.setshapetype(t)},isactive:function(){return="" this._isactive},getparticlecount:function(){return="" this.particlecount},setparticlecount:function(t){this.particlecount="t},getDuration:function(){return" this.duration},setduration:function(t){this.duration="t},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(t){this._sourcePosition.x=t.x,this._sourcePosition.y=t.y},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(t){this._posVar.x=t.x,this._posVar.y=t.y},getLife:function(){return" this.life},setlife:function(t){this.life="t},getLifeVar:function(){return" this.lifevar},setlifevar:function(t){this.lifevar="t},getAngle:function(){return" this.angle},setangle:function(t){this.angle="t},getAngleVar:function(){return" this.anglevar},setanglevar:function(t){this.anglevar="t},getGravity:function(){var" cc.p(t.x,t.y)},setgravity:function(t){this.modea.gravity="t},getSpeed:function(){return" this.modea.speed},setspeed:function(t){this.modea.speed="t},getSpeedVar:function(){return" this.modea.speedvar},setspeedvar:function(t){this.modea.speedvar="t},getTangentialAccel:function(){return" this.modea.tangentialaccel},settangentialaccel:function(t){this.modea.tangentialaccel="t},getTangentialAccelVar:function(){return" this.modea.tangentialaccelvar},settangentialaccelvar:function(t){this.modea.tangentialaccelvar="t},getRadialAccel:function(){return" this.modea.radialaccel},setradialaccel:function(t){this.modea.radialaccel="t},getRadialAccelVar:function(){return" this.modea.radialaccelvar},setradialaccelvar:function(t){this.modea.radialaccelvar="t},getRotationIsDir:function(){return" this.modea.rotationisdir},setrotationisdir:function(t){this.modea.rotationisdir="t},getStartRadius:function(){return" this.modeb.startradius},setstartradius:function(t){this.modeb.startradius="t},getStartRadiusVar:function(){return" this.modeb.startradiusvar},setstartradiusvar:function(t){this.modeb.startradiusvar="t},getEndRadius:function(){return" this.modeb.endradius},setendradius:function(t){this.modeb.endradius="t},getEndRadiusVar:function(){return" this.modeb.endradiusvar},setendradiusvar:function(t){this.modeb.endradiusvar="t},getRotatePerSecond:function(){return" this.modeb.rotatepersecond},setrotatepersecond:function(t){this.modeb.rotatepersecond="t},getRotatePerSecondVar:function(){return" this.modeb.rotatepersecondvar},setrotatepersecondvar:function(t){this.modeb.rotatepersecondvar="t},setScale:function(t,e){this._transformSystemDirty=!0,_ccsg.Node.prototype.setScale.call(this,t,e)},setRotation:function(t){this._transformSystemDirty=!0,_ccsg.Node.prototype.setRotation.call(this,t)},setScaleX:function(t){this._transformSystemDirty=!0,_ccsg.Node.prototype.setScaleX.call(this,t)},setScaleY:function(t){this._transformSystemDirty=!0,_ccsg.Node.prototype.setScaleY.call(this,t)},getStartSize:function(){return" this.startsize},setstartsize:function(t){this.startsize="t},getStartSizeVar:function(){return" this.startsizevar},setstartsizevar:function(t){this.startsizevar="t},getEndSize:function(){return" this.endsize},setendsize:function(t){this.endsize="t},getEndSizeVar:function(){return" this.endsizevar},setendsizevar:function(t){this.endsizevar="t},getStartColor:function(){return" cc.color(this._startcolor.r,this._startcolor.g,this._startcolor.b,this._startcolor.a)},setstartcolor:function(t){this._startcolor.fromcolor(t)},getstartcolorvar:function(){return="" cc.color(this._startcolorvar.r,this._startcolorvar.g,this._startcolorvar.b,this._startcolorvar.a)},setstartcolorvar:function(t){this._startcolorvar.fromcolor(t)},getendcolor:function(){return="" cc.color(this._endcolor.r,this._endcolor.g,this._endcolor.b,this._endcolor.a)},setendcolor:function(t){this._endcolor.fromcolor(t)},getendcolorvar:function(){return="" cc.color(this._endcolorvar.r,this._endcolorvar.g,this._endcolorvar.b,this._endcolorvar.a)},setendcolorvar:function(t){this._endcolorvar.fromcolor(t)},getstartspin:function(){return="" this.startspin},setstartspin:function(t){this.startspin="t},getStartSpinVar:function(){return" this.startspinvar},setstartspinvar:function(t){this.startspinvar="t},getEndSpin:function(){return" this.endspin},setendspin:function(t){this.endspin="t},getEndSpinVar:function(){return" this.endspinvar},setendspinvar:function(t){this.endspinvar="t},getEmissionRate:function(){return" this.emissionrate},setemissionrate:function(t){this.emissionrate="t},getTotalParticles:function(){return" this._totalparticles},settotalparticles:function(t){this._rendercmd.settotalparticles(t)},gettexture:function(){return="" this._texture},settexture:function(t){t&&(t.isloaded()?this.settexturewithrect(t,cc.rect(0,0,t.width,t.height)):(this._textureloaded="!1,t.once("load",(function(e){this._textureLoaded=!0,this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height))}),this)))},getBlendFunc:function(){return" this._blendfunc},setblendfunc:function(t,e){void="" this._opacitymodifyrgb},setopacitymodifyrgb:function(t){this._opacitymodifyrgb="t},isBlendAdditive:function(){return" this._blendfunc.src="==cc.macro.SRC_ALPHA&&this._blendFunc.dst===cc.macro.ONE||this._blendFunc.src===cc.macro.ONE&&this._blendFunc.dst===cc.macro.ONE},setBlendAdditive:function(t){var" this.positiontype},setpositiontype:function(t){this.positiontype="t},isAutoRemoveOnFinish:function(){return" this.autoremoveonfinish},setautoremoveonfinish:function(t){this.autoremoveonfinish="t},getEmitterMode:function(){return" this.emittermode},setemittermode:function(t){this.emittermode="t},init:function(){return" this.initwithtotalparticles(150)},initwithfile:function(t){this._plistfile="t;var" e?this.initwithdictionary(e,""):(cc.logid(6008),!1)},getboundingboxtoworld:function(){return="" cc.rect(0,0,cc._canvas.width,cc._canvas.height)},initwithdictionary:function(t,e){var="" c="this._startColor;c.r=255*parseFloat(o("startColorRed",t)),c.g=255*parseFloat(o("startColorGreen",t)),c.b=255*parseFloat(o("startColorBlue",t)),c.a=255*parseFloat(o("startColorAlpha",t));var" h="this._startColorVar;h.r=255*parseFloat(o("startColorVarianceRed",t)),h.g=255*parseFloat(o("startColorVarianceGreen",t)),h.b=255*parseFloat(o("startColorVarianceBlue",t)),h.a=255*parseFloat(o("startColorVarianceAlpha",t));var" l="this._endColor;l.r=255*parseFloat(o("finishColorRed",t)),l.g=255*parseFloat(o("finishColorGreen",t)),l.b=255*parseFloat(o("finishColorBlue",t)),l.a=255*parseFloat(o("finishColorAlpha",t));var" u="this._endColorVar;if(u.r=255*parseFloat(o("finishColorVarianceRed",t)),u.g=255*parseFloat(o("finishColorVarianceGreen",t)),u.b=255*parseFloat(o("finishColorVarianceBlue",t)),u.a=255*parseFloat(o("finishColorVarianceAlpha",t)),this.startSize=parseFloat(o("startParticleSize",t)),this.startSizeVar=parseFloat(o("startParticleSizeVariance",t)),this.endSize=parseFloat(o("finishParticleSize",t)),this.endSizeVar=parseFloat(o("finishParticleSizeVariance",t)),this.setPosition(parseFloat(o("sourcePositionx",t)),parseFloat(o("sourcePositiony",t))),this._posVar.x=parseFloat(o("sourcePositionVariancex",t)),this._posVar.y=parseFloat(o("sourcePositionVariancey",t)),this.startSpin=parseFloat(o("rotationStart",t)),this.startSpinVar=parseFloat(o("rotationStartVariance",t)),this.endSpin=parseFloat(o("rotationEnd",t)),this.endSpinVar=parseFloat(o("rotationEndVariance",t)),this.emitterMode=parseInt(o("emitterType",t)),this.emitterMode===_ccsg.ParticleSystem.Mode.GRAVITY){var" _="this.modeA;_.gravity.x=parseFloat(o("gravityx",t)),_.gravity.y=parseFloat(o("gravityy",t)),_.speed=parseFloat(o("speed",t)),_.speedVar=parseFloat(o("speedVariance",t));var" d="o("radialAcceleration",t);_.radialAccel=d?parseFloat(d):0,d=o("radialAccelVariance",t),_.radialAccelVar=d?parseFloat(d):0,d=o("tangentialAcceleration",t),_.tangentialAccel=d?parseFloat(d):0,d=o("tangentialAccelVariance",t),_.tangentialAccelVar=d?parseFloat(d):0;var" f="o("rotationIsDir",t);null!==f?(f=f.toString().toLowerCase(),_.rotationIsDir="true"===f||"1"===f):_.rotationIsDir=!1}else{if(this.emitterMode!==_ccsg.ParticleSystem.Mode.RADIUS)return" cc.logid(6009),!1;var="" p="this.modeB;p.startRadius=parseFloat(o("maxRadius",t)),p.startRadiusVar=parseFloat(o("maxRadiusVariance",t)),p.endRadius=parseFloat(o("minRadius",t)),p.endRadiusVar=0,p.rotatePerSecond=parseFloat(o("rotatePerSecond",t)),p.rotatePerSecondVar=parseFloat(o("rotatePerSecondVariance",t))}if(this.life=parseFloat(o("particleLifespan",t)),this.lifeVar=parseFloat(o("particleLifespanVariance",t)),this.emissionRate=this._totalParticles/this.life,!this._batchNode){this._opacityModifyRGB=!1;var" m="o("textureFileName",t),g=cc.path.changeBasename(this._plistFile,m),v=cc.textureCache.getTextureForKey(g);if(v)this.setTexture(v);else{var" y="o("textureImageData",t);if(y&&0!==y.length){if(s=cc.Codec.unzipBase64AsArray(y,1),!s)return" cc.logid(6010),!1;var="" x="cc.getImageFormatByData(s);if(x!==cc.ImageFormat.TIFF&&x!==cc.ImageFormat.PNG)return" cc.logid(6011),!1;var="" b="new" n(s);b.render(t)}else="" r.parsetiff(s,t);cc.texturecache.cacheimage(g,t);var="" i},initwithtotalparticles:function(t){this._totalparticles="t;var" e,i="this._particles;for(i.length=0,e=0;e<t;e++)i[e]=new" cc.particle;if(!i)return="" cc.logid(6013),!1;if(this._allocatedparticles="t,this._batchNode)for(e=0;e<this._totalParticles;e++)i[e].atlasIndex=e;return" this._isactive="!0,this._blendFunc.src=cc.macro.BLEND_SRC,this._blendFunc.dst=cc.macro.BLEND_DST,this.positionType=_ccsg.ParticleSystem.Type.FREE,this.emitterMode=_ccsg.ParticleSystem.Mode.GRAVITY,this.autoRemoveOnFinish=!1,this._transformSystemDirty=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(t),!0},destroyParticleSystem:function(){this.unscheduleUpdate()},addParticle:function(){if(this.isFull())return!1;var" this.initparticle(t),++this.particlecount,!0},initparticle:function(t){var="" i,n,r="this._startColor,s=this._startColorVar,o=this._endColor,a=this._endColorVar;i={r:cc.clampf(r.r+s.r*e(),0,255),g:cc.clampf(r.g+s.g*e(),0,255),b:cc.clampf(r.b+s.b*e(),0,255),a:cc.clampf(r.a+s.a*e(),0,255)},n={r:cc.clampf(o.r+a.r*e(),0,255),g:cc.clampf(o.g+a.g*e(),0,255),b:cc.clampf(o.b+a.b*e(),0,255),a:cc.clampf(o.a+a.a*e(),0,255)},t.color=i;var" v="this.modeB,y=t.modeB,x=v.startRadius+v.startRadiusVar*e(),T=v.endRadius+v.endRadiusVar*e();y.radius=x,y.deltaRadius=v.endRadius===_ccsg.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(T-x)/h,y.angle=f,y.degreesPerSecond=cc.degreesToRadians(v.rotatePerSecond+v.rotatePerSecondVar*e())}},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var" this.particlecount="">=this._totalParticles},updateQuadWithParticle:function(t,e){this._renderCmd.updateQuadWithParticle(t,e)},postStep:function(){this._renderCmd.postStep()},update:function(t){if(this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty),this._isActive&&this.emissionRate){var e=1/this.emissionRate;for(this.particleCount<this._totalparticles&&(this._emitcounter+=t);this.particlecount<this._totalparticles&&this._emitcounter>e;)this.addParticle(),this._emitCounter-=e;this._elapsed+=t,this.duration!==-1&&this.duration<this._elapsed&&this.stopsystem()}this._particleidx=0;var i="this.getWorldToNodeTransform(),n=cc.Particle.TemporaryPoints[0];if(this.positionType===_ccsg.ParticleSystem.Type.FREE?cc.pIn(n,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType===_ccsg.ParticleSystem.Type.RELATIVE&&(n.x=this._position.x,n.y=this._position.y),this._visible){for(var" r="cc.Particle.TemporaryPoints[1],s=cc.Particle.TemporaryPoints[2],o=cc.Particle.TemporaryPoints[3],a=this._particles;this._particleIdx<this.particleCount;){cc.pZeroIn(r),cc.pZeroIn(s),cc.pZeroIn(o);var" c="a[this._particleIdx];if(c.timeToLive-=t,c.timeToLive">0){if(this.emitterMode===_ccsg.ParticleSystem.Mode.GRAVITY){var h=o,l=r,u=s;c.pos.x||c.pos.y?(cc.pIn(l,c.pos),cc.pNormalizeIn(l)):cc.pZeroIn(l),cc.pIn(u,l),cc.pMultIn(l,c.modeA.radialAccel);var _=u.x;u.x=-u.y,u.y=_,cc.pMultIn(u,c.modeA.tangentialAccel),cc.pIn(h,l),cc.pAddIn(h,u),cc.pAddIn(h,this.modeA.gravity),cc.pMultIn(h,t),cc.pAddIn(c.modeA.dir,h),cc.pIn(h,c.modeA.dir),cc.pMultIn(h,t),cc.pAddIn(c.pos,h)}else{var d=c.modeB;d.angle+=d.degreesPerSecond*t,d.radius+=d.deltaRadius*t,c.pos.x=-Math.cos(d.angle)*d.radius,c.pos.y=-Math.sin(d.angle)*d.radius}this._renderCmd._updateDeltaColor(c,t),c.size+=c.deltaSize*t,c.size=Math.max(0,c.size),c.rotation+=c.deltaRotation*t;var f=r;if(this.positionType===_ccsg.ParticleSystem.Type.FREE||this.positionType===_ccsg.ParticleSystem.Type.RELATIVE){var p=s,m=o;cc._pointApplyAffineTransformIn(n,i,p),cc._pointApplyAffineTransformIn(c.startPos,i,m),cc.pSubIn(p,m),cc.pIn(f,c.pos),cc.pSubIn(f,p)}else cc.pIn(f,c.pos);this._batchNode&&(f.x+=this._position.x,f.y+=this._position.y),this._renderCmd.updateParticlePosition(c,f),++this._particleIdx}else{var g=c.atlasIndex;if(this._particleIdx!==this.particleCount-1){var v=a[this._particleIdx];a[this._particleIdx]=a[this.particleCount-1],a[this.particleCount-1]=v}if(this._batchNode&&(this._batchNode.disableParticle(this.atlasIndex+g),a[this.particleCount-1].atlasIndex=g),--this.particleCount,0===this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),this._parent.removeChild(this,!0),void(this._renderCmd.updateLocalBB&&this._renderCmd.updateLocalBB())}}this._renderCmd.updateLocalBB&&this._renderCmd.updateLocalBB(),this._transformSystemDirty=!1}this._batchNode||this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(t,e){if(e){var i=e[t];return null!=i?i:""}return""},_updateBlendFunc:function(){if(this._batchNode)return void cc.logID(6014);var t=this._texture;if(t&&t instanceof cc.Texture2D){this._opacityModifyRGB=!1;var e=this._blendFunc;e.src===cc.macro.BLEND_SRC&&e.dst===cc.macro.BLEND_DST&&(t.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(e.src=cc.macro.SRC_ALPHA,e.dst=cc.macro.ONE_MINUS_SRC_ALPHA))}},clone:function(){var t=new _ccsg.ParticleSystem;if(t.initWithTotalParticles(this.getTotalParticles())){t.setAngle(this.getAngle()),t.setAngleVar(this.getAngleVar()),t.setDuration(this.getDuration());var e=this.getBlendFunc();if(t.setBlendFunc(e.src,e.dst),t.setStartColor(this.getStartColor()),t.setStartColorVar(this.getStartColorVar()),t.setEndColor(this.getEndColor()),t.setEndColorVar(this.getEndColorVar()),t.setStartSize(this.getStartSize()),t.setStartSizeVar(this.getStartSizeVar()),t.setEndSize(this.getEndSize()),t.setEndSizeVar(this.getEndSizeVar()),t.setPosition(cc.p(this.x,this.y)),t.setPosVar(cc.p(this.getPosVar().x,this.getPosVar().y)),t.setPositionType(this.getPositionType()),t.setStartSpin(this.getStartSpin()||0),t.setStartSpinVar(this.getStartSpinVar()||0),t.setEndSpin(this.getEndSpin()||0),t.setEndSpinVar(this.getEndSpinVar()||0),t.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()===_ccsg.ParticleSystem.Mode.GRAVITY){var i=this.getGravity();t.setGravity(cc.p(i.x,i.y)),t.setSpeed(this.getSpeed()),t.setSpeedVar(this.getSpeedVar()),t.setRadialAccel(this.getRadialAccel()),t.setRadialAccelVar(this.getRadialAccelVar()),t.setTangentialAccel(this.getTangentialAccel()),t.setTangentialAccelVar(this.getTangentialAccelVar())}else this.getEmitterMode()===_ccsg.ParticleSystem.Mode.RADIUS&&(t.setStartRadius(this.getStartRadius()),t.setStartRadiusVar(this.getStartRadiusVar()),t.setEndRadius(this.getEndRadius()),t.setEndRadiusVar(this.getEndRadiusVar()),t.setRotatePerSecond(this.getRotatePerSecond()),t.setRotatePerSecondVar(this.getRotatePerSecondVar()));if(t.setLife(this.getLife()),t.setLifeVar(this.getLifeVar()),t.setEmissionRate(this.getEmissionRate()),!this.getBatchNode()){t.setOpacityModifyRGB(this.isOpacityModifyRGB());var n=this.getTexture();if(n){var r=n.getContentSize();t.setTextureWithRect(n,cc.rect(0,0,r.width,r.height))}}}return t},setDisplayFrame:function(t){if(t){var e=t.getOffset();0===e.x&&0===e.y||cc.logID(6015);var i=t.getTexture(),n=this._texture;n!==i&&this.setTexture(i)}},setTextureWithRect:function(t,e){var i=this._texture;i!==t&&(this._texture=t,this._updateBlendFunc()),this.initTexCoordsWithRect(e)},listenBackToForeground:function(t){}});var s=_ccsg.ParticleSystem.prototype;s.opacityModifyRGB,cc.defineGetterSetter(s,"opacityModifyRGB",s.isOpacityModifyRGB,s.setOpacityModifyRGB),s.batchNode,cc.defineGetterSetter(s,"batchNode",s.getBatchNode,s.setBatchNode),s.drawMode,cc.defineGetterSetter(s,"drawMode",s.getDrawMode,s.setDrawMode),s.shapeType,cc.defineGetterSetter(s,"shapeType",s.getShapeType,s.setShapeType),s.active,cc.defineGetterSetter(s,"active",s.isActive),s.sourcePos,cc.defineGetterSetter(s,"sourcePos",s.getSourcePosition,s.setSourcePosition),s.posVar,cc.defineGetterSetter(s,"posVar",s.getPosVar,s.setPosVar),s.gravity,cc.defineGetterSetter(s,"gravity",s.getGravity,s.setGravity),s.speed,cc.defineGetterSetter(s,"speed",s.getSpeed,s.setSpeed),s.speedVar,cc.defineGetterSetter(s,"speedVar",s.getSpeedVar,s.setSpeedVar),s.tangentialAccel,cc.defineGetterSetter(s,"tangentialAccel",s.getTangentialAccel,s.setTangentialAccel),s.tangentialAccelVar,cc.defineGetterSetter(s,"tangentialAccelVar",s.getTangentialAccelVar,s.setTangentialAccelVar),s.radialAccel,cc.defineGetterSetter(s,"radialAccel",s.getRadialAccel,s.setRadialAccel),s.radialAccelVar,cc.defineGetterSetter(s,"radialAccelVar",s.getRadialAccelVar,s.setRadialAccelVar),s.rotationIsDir,cc.defineGetterSetter(s,"rotationIsDir",s.getRotationIsDir,s.setRotationIsDir),s.startRadius,cc.defineGetterSetter(s,"startRadius",s.getStartRadius,s.setStartRadius),s.startRadiusVar,cc.defineGetterSetter(s,"startRadiusVar",s.getStartRadiusVar,s.setStartRadiusVar),s.endRadius,cc.defineGetterSetter(s,"endRadius",s.getEndRadius,s.setEndRadius),s.endRadiusVar,cc.defineGetterSetter(s,"endRadiusVar",s.getEndRadiusVar,s.setEndRadiusVar),s.rotatePerS,
cc.defineGetterSetter(s,"rotatePerS",s.getRotatePerSecond,s.setRotatePerSecond),s.rotatePerSVar,cc.defineGetterSetter(s,"rotatePerSVar",s.getRotatePerSecondVar,s.setRotatePerSecondVar),s.startColor,cc.defineGetterSetter(s,"startColor",s.getStartColor,s.setStartColor),s.startColorVar,cc.defineGetterSetter(s,"startColorVar",s.getStartColorVar,s.setStartColorVar),s.endColor,cc.defineGetterSetter(s,"endColor",s.getEndColor,s.setEndColor),s.endColorVar,cc.defineGetterSetter(s,"endColorVar",s.getEndColorVar,s.setEndColorVar),s.totalParticles,cc.defineGetterSetter(s,"totalParticles",s.getTotalParticles,s.setTotalParticles),s.texture,cc.defineGetterSetter(s,"texture",s.getTexture,s.setTexture),_ccsg.ParticleSystem.ModeA=function(t,e,i,n,r,s,o,a){this.gravity=t?t:cc.p(0,0),this.speed=e||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=r||0,this.radialAccel=s||0,this.radialAccelVar=o||0,this.rotationIsDir=a||!1},_ccsg.ParticleSystem.ModeB=function(t,e,i,n,r,s){this.startRadius=t||0,this.startRadiusVar=e||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=r||0,this.rotatePerSecondVar=s||0},_ccsg.ParticleSystem.SHAPE_MODE=0,_ccsg.ParticleSystem.TEXTURE_MODE=1,_ccsg.ParticleSystem.STAR_SHAPE=0,_ccsg.ParticleSystem.BALL_SHAPE=1,_ccsg.ParticleSystem.DURATION_INFINITY=-1,_ccsg.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,_ccsg.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,_ccsg.ParticleSystem.Mode=cc.Enum({GRAVITY:0,RADIUS:1}),_ccsg.ParticleSystem.Type=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2})}),{"./CCPNGReader":257,"./CCTIFFReader":266}],264:[(function(t,e,i){_ccsg.ParticleSystem.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._drawMode=_ccsg.ParticleSystem.TEXTURE_MODE,this._shapeType=_ccsg.ParticleSystem.BALL_SHAPE,this._pointRect=cc.rect(0,0,0,0),this._localRegion=new cc.Region,this._tintCache=null};var n=_ccsg.ParticleSystem.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=_ccsg.ParticleSystem.CanvasRenderCmd,n.getDrawMode=function(){return this._drawMode},n.setDrawMode=function(t){this._drawMode=t},n.getShapeType=function(){return this._shapeType},n.setShapeType=function(t){this._shapeType=t},n.setBatchNode=function(t){this._batchNode!==t&&(this._node._batchNode=t)},n.updateQuadWithParticle=function(t,e){},n.updateParticlePosition=function(t,e){cc.pIn(t.drawPos,e)};var r=new cc.Region,s=new cc.Rect;n.updateLocalBB=function(){var t=this._localRegion,e=this._node._particles;t.setEmpty();for(var i=e.length-1;i>=0;--i){var n=e[i],o=n.drawPos,a=1.415*n.size;r.setTo(o.x-a,o.y-a,o.x+a,o.y+a),t.union(r)}s.x=t._minX,s.y=t._minY,s.width=t._maxX-t._minX,s.height=t._maxY-t._minY},n.getLocalBB=function(){return s},n.updateStatus=function(){this.originUpdateStatus(),this._updateCurrentRegions(),this._regionFlag=_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble,this._dirtyFlag&=~_ccsg.Node._dirtyFlags.contentDirty},n.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),s=this._node,o=this._pointRect;n.setTransform(this._worldTransform,e,i),n.save(),s.isBlendAdditive()?r.globalCompositeOperation="lighter":r.globalCompositeOperation="source-over";var a,c,h,l,u=this._node.particleCount,_=this._node._particles;if(s.drawMode!==_ccsg.ParticleSystem.SHAPE_MODE&&s._texture){if(!s._texture._textureLoaded)return void n.restore();var d=s._texture.getHtmlElementObj();if(!d.width||!d.height)return void n.restore();var f=d;for(a=0;a<u;a++)if(c=_[a],h=0|.5*c.size,l=c.color.a 255,0!="=l){r.globalAlpha=l,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y));var" p="4*Math.floor(c.size/4),m=o.width,g=o.height;r.scale(Math.max(1/m*p,1e-6),Math.max(1/g*p,1e-6)),c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),f=c.isChangeColor?this._changeTextureColor(s._texture,c.color,this._pointRect):d,r.drawImage(f,-(0|m/2),-(0|g/2)),r.restore()}}else{var" v="cc._drawingUtil;for(a=0;a<u;a++)c=_[a],h=0|.5*c.size,l=c.color.a/255,0!==l&&(r.globalAlpha=l,r.save(),r.translate(0|c.drawPos.x,-(0|c.drawPos.y)),s.shapeType===_ccsg.ParticleSystem.STAR_SHAPE?(c.rotation&&r.rotate(cc.degreesToRadians(c.rotation)),v.drawStar(n,h,c.color)):v.drawColorBall(n,h,c.color),r.restore())}n.restore(),cc.g_NumberOfDraws++},n._changeTextureColor=function(t,e,i){this._tintCache||(this._tintCache=document.createElement("canvas"));var" n="this._tintCache,r=t.getContentSize();return" n.width="r.width,n.height=r.height,t._generateColorTexture(e.r,e.g,e.b,i,n)},n.initTexCoordsWithRect=function(t){this._pointRect=t},n.setTotalParticles=function(t){this._node._totalParticles=t<200?t:200},n.addParticle=function(){var" t,e="this._node,i=e._particles;return" e.particlecount<i.length?t="i[e.particleCount]:(t=new" cc.particle,i.push(t)),t},n._setupvbo="function(){},n._allocMemory=function(){return!0},n.postStep=function(){},n._setBlendAdditive=function(){var" t="this._node._blendFunc;t.src=cc.macro.BLEND_SRC,t.dst=cc.macro.BLEND_DST},n._initWithTotalParticles=function(t){},n._updateDeltaColor=function(t,e){this._node._dontTint||(t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0)}}),{}],265:[(function(t,e,i){_ccsg.ParticleSystem.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new" cc.math.matrix4,this._matrix.identity(),this._buffersvbo="[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var" e="this._node;if(e._batchNode!==t){var" i="e._batchNode;if(e._batchNode=t,t)for(var" r="6*i,s=4*i;e[r+0]=s+0,e[r+1]=s+1,e[r+2]=s+2,e[r+5]=s+1,e[r+4]=s+2,e[r+3]=s+3}},n.isDifferentTexture=function(t,e){return" s,o,a,c;n._opacitymodifyrgb?(s="0|t.color.r*t.color.a/255,o=0|t.color.g*t.color.a/255,a=0|t.color.b*t.color.a/255):(s=0|t.color.r,o=0|t.color.g,a=0|t.color.b),c=0|t.color.a;var" h="i.bl.colors,l=i.br.colors,u=i.tl.colors,_=i.tr.colors;h.r=l.r=u.r=_.r=s,h.g=l.g=u.g=_.g=o,h.b=l.b=u.b=_.b=a,h.a=l.a=u.a=_.a=c;var" d="t.size/2;if(t.rotation){var" f="-d,p=-d,m=d,g=d,v=e.x,y=e.y,x=-cc.degreesToRadians(t.rotation),T=Math.cos(x),b=Math.sin(x),C=f*T-p*b+v,A=f*b+p*T+y,S=m*T-p*b+v,E=m*b+p*T+y,w=m*T-g*b+v,I=m*b+g*T+y,R=f*T-g*b+v,P=f*b+g*T+y;i.bl.vertices.x=C,i.bl.vertices.y=A,i.br.vertices.x=S,i.br.vertices.y=E,i.tl.vertices.x=R,i.tl.vertices.y=P,i.tr.vertices.x=w,i.tr.vertices.y=I}else" i.bl.vertices.x="e.x-d,i.bl.vertices.y=e.y-d,i.br.vertices.x=e.x+d,i.br.vertices.y=e.y-d,i.tl.vertices.x=e.x-d,i.tl.vertices.y=e.y+d,i.tr.vertices.x=e.x+d,i.tr.vertices.y=e.y+d},n.rendering=function(t){var" s,o,a,c;cc.macro.fix_artifacts_by_streching_texel?(s="(2*t.x+1)/(2*n),o=(2*t.y+1)/(2*r),a=s+(2*t.width-2)/(2*n),c=o+(2*t.height-2)/(2*r)):(s=t.x/n,o=t.y/r,a=s+t.width/n,c=o+t.height/r);var" l,u="0,_=0;e._batchNode?(l=e._batchNode.textureAtlas.quads,u=e.atlasIndex,_=e.atlasIndex+e._totalParticles):(l=this._quads,u=0,_=e._totalParticles);for(var">e._allocatedParticles){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._indices=new Uint16Array(6*t);var n=new ArrayBuffer(t*i),r=e._particles;r.length=0;var s=this._quads;s.length=0;for(var o=0;o<t;o++)r[o]=new cc.particle,s[o]="new" cc.v3f_c4b_t2f_quad(null,null,null,null,n,o*i);if(e._allocatedparticles="t,e._totalParticles=t,e._batchNode)for(var" a="0;a<t;a++)r[a].atlasIndex=a;this._quadsArrayBuffer=n,this.initIndices(t),this._setupVBO(),e._texture&&this.initTexCoordsWithRect(cc.rect(0,0,e._texture.width,e._texture.height))}else" e._totalparticles="t;e.resetSystem()},n.addParticle=function(){var" t="this._node,e=t._particles;return" e[t.particlecount]},n._setupvbo="function(){var" cc.logid(6016),!1;var="" e="cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=t._totalParticles,n=this._quads;n.length=0,this._indices=new" uint16array(6*i);for(var="" r="new" arraybuffer(e*i),s="0;s<i;s++)n[s]=new" cc.v3f_c4b_t2f_quad(null,null,null,null,r,s*e);return="" n&&this._indices?(this._quadsarraybuffer="r,!0):(cc.logID(6013),!1)},n.postStep=function(){var" n="{_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(t){return" this._tiffdata[t]},getuint16:function(t){return="" this._littleendian?this._tiffdata[t+1]<<8|this._tiffdata[t]:this._tiffdata[t]<<8|this._tiffdata[t+1]},getuint32:function(t){var="" this._littleendian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},checklittleendian:function(){var="" console.log(t),typeerror("invalid="" byte="" order="" value.");this.littleendian="!1}return" this.littleendian},hastowel:function(){if(42!="=this.getUint16(2))throw" rangeerror("you="" forgot="" your="" towel!");return!0},getfieldtypename:function(t){var="" in="" e?e[t]:null},getfieldtagname:function(t){var="" e?e[t]:(console.log("unknown="" field="" tag:",t),"tag"+t)},getfieldtypelength:function(t){return["byte","ascii","sbyte","undefined"].indexof(t)!="=-1?1:["SHORT","SSHORT"].indexOf(t)!==-1?2:["LONG","SLONG","FLOAT"].indexOf(t)!==-1?4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)!==-1?8:null},getFieldValues:function(t,e,i,n){var">>>8*(4-s)):r.push(n);else for(var a=0;a<i;a++){var c="s*a;s">=8?["RATIONAL","SRATIONAL"].indexOf(e)!==-1?(r.push(this.getUint32(n+c)),r.push(this.getUint32(n+c+4))):cc.logID(8e3):r.push(this.getBytes(s,n+c))}return"ASCII"===e&&r.forEach((function(t,e,i){i[e]=String.fromCharCode(t)})),r},getBytes:function(t,e){if(t<=0)cc.logid(8001);else{if(t<=1)return this.getuint8(e);if(t<="2)return" this.getuint16(e);if(t<="3)return" this.getuint32(e)="">>>8;if(t<=4)return this.getuint32(e);cc.logid(8002)}},getbits:function(t,e,i){i="i||0;var" n,r,s="Math.floor(i/8),o=e+s,a=i+t,c=32-t;return" a<="0?console.log("No" bits="" requested"):a<="8?(n=24+i,r=this.getUint8(o)):a<=16?(n=16+i,r=this.getUint16(o)):a<=32?(n=i,r=this.getUint32(o)):console.log("Too" many="" requested"),{bits:r<<n="">>>c,byteOffset:o+Math.floor(a/8),bitOffset:a%8}},parseFileDirectory:function(t){for(var e=this.getUint16(t),i=[],n=t+2,r=0;r<e;n+=12,r++){var s="this.getUint16(n),o=this.getUint16(n+2),a=this.getUint32(n+4),c=this.getUint32(n+8),h=this.getFieldTagName(s),l=this.getFieldTypeName(o),u=this.getFieldValues(h,l,a,c);i[h]={type:l,values:u}}this._fileDirectories.push(i);var" _="this.getUint32(n);0!==_&&this.parseFileDirectory(_)},clampColorSample:function(t,e){var" i="Math.pow(2,8-e);return" math.floor(t*i+(i-1))},parsetiff:function(t,e){if(e="e||document.createElement("canvas"),this._tiffData=t,this.canvas=e,this.checkLittleEndian(),this.hasTowel()){var" n="this._fileDirectories[0],r=n.ImageWidth.values[0],s=n.ImageLength.values[0];this.canvas.width=r,this.canvas.height=s;var" o="[],a=n.Compression?n.Compression.values[0]:1,c=n.SamplesPerPixel.values[0],h=[],l=0,u=!1;if(n.BitsPerSample.values.forEach((function(t,e,i){h[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void" 0},t%8="==0&&(h[e].hasBytesPerSample=!0,h[e].bytesPerSample=t/8),l+=t}),this),l%8===0){u=!0;var" d="n.StripOffsets.values,f=d.length;if(n.StripByteCounts)var" p="n.StripByteCounts.values;else{if(cc.logID(8003),1!==f)throw" error("cannot="" recover="" from="" missing="" stripbytecounts");var="" m="0;m<f;m++){var" g="d[m];o[m]=[];for(var" v="p[m],y=0,x=0,T=1,b=!0,C=[],A=0,S=0,E=0;y<v;y+=T)switch(a){case" 1:for(var="" w="0,C=[];w<c;w++){if(!h[w].hasBytesPerSample){var" c.push(i.bits),y="I.byteOffset-g,x=I.bitOffset,RangeError("Cannot" handle="" sub-byte="" bits="" per="" sample")}var="" r="h[w].bytesPerSample*w;C.push(this.getBytes(h[w].bytesPerSample,g+y+R))}if(o[m].push(C),!u)throw" t="0,RangeError("Cannot" pixel");t="_;break;case" 2:break;case="" 3:break;case="" 4:break;case="" 5:break;case="" 6:break;case="" 7:break;case="" 32773:if(b){b="!1;var">=0&&B<=127?p=b+1:b>=-127&&B<=-1?o=-b+1:b=!0}else{for(var d="this.getUint8(g+y),w=0;w<O;w++){if(!h[S].hasBytesPerSample)throw" rangeerror("cannot="" handle="" sub-byte="" bits="" per="" sample");e="E<<8*A|D,A++,A===h[S].bytesPerSample&&(C.push(E),E=A=0,S++),S===c&&(o[m].push(C),C=[],S=0)}P--,0===P&&(b=!0)}T=1}}if(e.getContext){var" m="this.canvas.getContext("2d");M.fillStyle="rgba(255," 255,="" 0)";var="" l="n.RowsPerStrip?n.RowsPerStrip.values[0]:s,N=o.length,F=s%L,k=0===F?L:F,z=L,V=0,G=n.PhotometricInterpretation.values[0],W=[],U=0;if(n.ExtraSamples&&(W=n.ExtraSamples.values,U=W.length),n.ColorMap)var" j="n.ColorMap.values,X=Math.pow(2,h[0].bitsPerSample);for(var" y="o[m].length,H=V*m,q=0,Z=0;Z<Y;q++)for(var" q="o[m][Z],K=0,$=0,tt=0,et=1;if(U">0)for(var it=0;it<u;it++)if(1===w[it]||2===w[it]){et=q[3+it] 0="==j)throw" 256;break}switch(g){case="" 0:if(h[0].hasbytespersample)var="" nt="Math.pow(16,2*h[0].bytesPerSample);Q.forEach((function(t,e,i){i[e]=nt-t}));case" 1:k="$=tt=this.clampColorSample(Q[0],h[0].bitsPerSample);break;case" 2:k="this.clampColorSample(Q[0],h[0].bitsPerSample),$=this.clampColorSample(Q[1],h[1].bitsPerSample),tt=this.clampColorSample(Q[2],h[2].bitsPerSample);break;case" 3:if(void="" error("palette="" image="" missing="" color="" map");var="" rt="Q[0];K=this.clampColorSample(j[rt],16),$=this.clampColorSample(j[X+rt],16),tt=this.clampColorSample(j[2*X+rt],16);break;default:throw" rangeerror("unknown="" photometric="" interpretation:",g)}m.fillstyle="rgba(" +k+",="" "+$+",="" "+tt+",="" "+et+")",m.fillrect(j,h+q,1,1)}v="z}}return" this.canvas}},fieldtagnames:{315:"artist",258:"bitspersample",265:"celllength",264:"cellwidth",320:"colormap",259:"compression",33432:"copyright",306:"datetime",338:"extrasamples",266:"fillorder",289:"freebytecounts",288:"freeoffsets",291:"grayresponsecurve",290:"grayresponseunit",316:"hostcomputer",270:"imagedescription",257:"imagelength",256:"imagewidth",271:"make",281:"maxsamplevalue",280:"minsamplevalue",272:"model",254:"newsubfiletype",274:"orientation",262:"photometricinterpretation",284:"planarconfiguration",296:"resolutionunit",278:"rowsperstrip",277:"samplesperpixel",305:"software",279:"stripbytecounts",273:"stripoffsets",255:"subfiletype",263:"threshholding",282:"xresolution",283:"yresolution",326:"badfaxlines",327:"cleanfaxdata",343:"clippath",328:"consecutivebadfaxlines",433:"decode",434:"defaultimagecolor",269:"documentname",336:"dotrange",321:"halftonehints",346:"indexed",347:"jpegtables",285:"pagename",297:"pagenumber",317:"predictor",319:"primarychromaticities",532:"referenceblackwhite",339:"sampleformat",559:"striprowcounts",330:"subifds",292:"t4options",293:"t6options",325:"tilebytecounts",323:"tilelength",324:"tileoffsets",322:"tilewidth",301:"transferfunction",318:"whitepoint",344:"xclippathunits",286:"xposition",529:"ycbcrcoefficients",531:"ycbcrpositioning",530:"ycbcrsubsampling",345:"yclippathunits",287:"yposition",37378:"aperturevalue",40961:"colorspace",36868:"datetimedigitized",36867:"datetimeoriginal",34665:"exif="" ifd",36864:"exifversion",33434:"exposuretime",41728:"filesource",37385:"flash",40960:"flashpixversion",33437:"fnumber",42016:"imageuniqueid",37384:"lightsource",37500:"makernote",37377:"shutterspeedvalue",37510:"usercomment",33723:"iptc",34675:"icc="" profile",700:"xmp",42112:"gdal_metadata",42113:"gdal_nodata",34377:"photoshop"},fieldtypenames:{1:"byte",2:"ascii",3:"short",4:"long",5:"rational",6:"sbyte",7:"undefined",8:"sshort",9:"slong",10:"srational",11:"float",12:"double"}};e.exports="n}),{}],267:[(function(t,e,i){cc.RenderTexture=_ccsg.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:0,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(t,e,i,n){_ccsg.Node.prototype.ctor.call(this),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this._clearColor=new" cc.color(0,0,0,255),void="" 0!="=t&&void" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" cc.rendertexture.canvasrendercmd(this):new="" cc.rendertexture.webglrendercmd(this)},visit:function(t){var="" e="this._renderCmd,i=t?t._renderCmd:null;if(!this._visible)return" void="" e._propagateflagsdown(i);var="" n="cc.renderer;e.visit(i),n.pushRenderCommand(e),this.sprite.visit(this),e._dirtyFlag=0},cleanup:function(){_ccsg.Node.prototype.onExit.call(this),this._renderCmd.cleanup()},getSprite:function(){return" this.sprite},setsprite:function(t){this.sprite="t},setVirtualViewport:function(t,e,i){this._renderCmd.setVirtualViewport(t,e,i)},initWithWidthAndHeight:function(t,e,i,n){return" this._rendercmd.initwithwidthandheight(t,e,i,n)},begin:function(){cc.renderer._turntocachemode(this.__instanceid),this._rendercmd.begin()},beginwithclear:function(t,e,i,n,r,s){var="" o="cc._renderContext;r=r||o.COLOR_BUFFER_BIT,s=s||o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT,this._beginWithClear(t,e,i,n,r,s,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT|o.STENCIL_BUFFER_BIT)},_beginWithClear:function(t,e,i,n,r,s,o){this.begin(),this._renderCmd._beginWithClear(t,e,i,n,r,s,o)},end:function(){this._renderCmd.end()},clear:function(t,e,i,n){this.beginWithClear(t,e,i,n),this.end()},clearRect:function(t,e,i,n){this._renderCmd.clearRect(t,e,i,n)},clearDepth:function(t){this._renderCmd.clearDepth(t)},clearStencil:function(t){this._renderCmd.clearStencil(t)},getClearFlags:function(){return" this.clearflags},setclearflags:function(t){this.clearflags="t},getClearColor:function(){return" this._clearcolor},setclearcolor:function(t){var="" this.cleardepthval},setcleardepth:function(t){this.cleardepthval="t},getClearStencil:function(){return" this.clearstencilval},setclearstencil:function(t){this.clearstencilval="t},isAutoDraw:function(){return" this.autodraw},setautodraw:function(t){this.autodraw="t},saveToFile:function(t,e){cc.log("saveToFile" isn't="" supported="" on="" cocos2d-html5")},newccimage:function(t){return="" cc.log("savetofile="" cocos2d-html5"),null},listentobackground:function(t){},listentoforeground:function(t){}});var="" new="" cc.rendertexture(t,e,i,n)}}),{}],268:[(function(t,e,i){cc.rendertexture.canvasrendercmd="function(t){this._rootCtor(t),this._needDraw=!1,this._clearColorStr="rgba(255,255,255,1)",this._cacheCanvas=document.createElement("canvas"),this._cacheContext=new" cc.canvascontextwrapper(this._cachecanvas.getcontext("2d"))};var="" r="this._node,s=this._cacheCanvas;s.width=0|t,s.height=0|e;var" cc.texture2d;o.initwithelement(s),o.handleloadedtexture();var="" a="r.sprite=new" _ccsg.sprite(o);return="" a.setblendfunc(cc.macro.one,cc.macro.one_minus_src_alpha),r.autodraw="!1,r.addChild(a),!0},n.begin=function(){},n._beginWithClear=function(t,e,i,n,r,s,o){t=t||0,e=e||0,i=i||0,n=isNaN(n)?255:n;var" t="this._node;cc.renderer._renderingToCacheCanvas(this._cacheContext,t.__instanceId);var" cocos2d-html5")}}),{}],269:[(function(t,e,i){var="" cc.rect,this._fullrect="new" cc.rect,this._fullviewport="new" cc.rect};var="" this._needdraw&&this._node.autodraw},r.rendering="function(t){var" h="a[c];h!==i.sprite&&h.visit(i.sprite)}i.end()}},r.clearStencil=function(t){var" s="this._node;i===cc.Texture2D.PIXEL_FORMAT_A8&&cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL()" :="" only="" rgb="" and="" rgba="" formats="" are="" valid="" for="" render="" texture;");var="" cc.rect(0,0,t,e),this._fullviewport="new" cc.rect(0,0,t,e),t|="0,e|=0,this._oldFBO=o.getParameter(o.FRAMEBUFFER_BINDING);var" a,c;cc.configuration.supportsnpot()?(a="t,c=e):(a=n.NextPOT(t),c=n.NextPOT(e));for(var" uint8array(h),u="0;u<a*c*4;u++)l[u]=0;this._pixelFormat=i;var" _="s._texture=new" cc.texture2d;if(!s._texture)return!1;_.initwithdata(l,s._pixelformat,a,c,cc.size(t,e));var="" d="o.getParameter(o.RENDERBUFFER_BINDING);if(cc.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=new" cc.texture2d,!this._texturecopy)return!1;this._texturecopy.initwithdata(l,s._pixelformat,a,c,cc.size(t,e))}this._fbo="o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,this._fBO),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,_._webTextureObj,0),0!==r&&(this._depthRenderBuffer=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,this._depthRenderBuffer),o.renderbufferStorage(o.RENDERBUFFER,r,a,c),r===o.DEPTH_STENCIL?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):r===o.STENCIL_INDEX||r===o.STENCIL_INDEX8?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):r===o.DEPTH_COMPONENT16&&o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer)),o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&cc.log("Could" not="" attach="" texture="" to="" the="" framebuffer"),_.setaliastexparameters();var="" f="s.sprite=new" _ccsg.sprite(_);return="" f.scaley="-1,f.setBlendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.bindRenderbuffer(o.RENDERBUFFER,d),o.bindFramebuffer(o.FRAMEBUFFER,this._oldFBO),s.autoDraw=!1,s.addChild(f),!0},r.begin=function(){var" c="new" cc.rect(0,0,0,0);c.width="this._fullViewport.width,c.height=this._fullViewport.height;var" i="cc._renderContext,n=i.getParameter(i.DEPTH_CLEAR_VALUE);i.clearDepth(t),i.clear(i.DEPTH_BUFFER_BIT),i.clearDepth(n),e.end()}}),{"../core/utils/misc":223}],270:[(function(t,e,i){var" e,i="this._hashForUniforms[t];if(i){e=!1;for(var" e},_description:function(){return"<ccglprogram="+this.toString()+" |="" program="+this._programObj.toString()+" ,="" vertexshader="+this._vertShader.toString()+" fragmentshader="+this._fragShader.toString()+">"},_compileShader:function(t,e,i){if(!i||!t)return!1;var n=cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n";i=n+"uniform mat4 CC_PMatrix;\nuniform mat4 CC_MVMatrix;\nuniform mat4 CC_MVPMatrix;\nuniform vec4 CC_Time;\nuniform vec4 CC_SinTime;\nuniform vec4 CC_CosTime;\nuniform vec4 CC_Random01;\nuniform sampler2D CC_Texture0;\n//CC INCLUDES END\n"+i,this._glContext.shaderSource(t,i),this._glContext.compileShader(t);var r=this._glContext.getShaderParameter(t,this._glContext.COMPILE_STATUS);return r||(cc.logID(8100,this._glContext.getShaderSource(t)),e===this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog())),r===!0},ctor:function(t,e,i){this._uniforms={},this._hashForUniforms={},this._glContext=i||cc._renderContext,this._programObj=null,this._vertShader=null,this._fragShader=null,this._usesTime=!1,this._projectionUpdated=-1,t&&e&&this.init(t,e)},destroyProgram:function(){this._vertShader=null,this._fragShader=null,this._uniforms=null,this._hashForUniforms=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(t,e){var i=this._glContext;this._programObj=i.createProgram(),this._projectionUpdated=-1,this._vertShader=null,this._fragShader=null,t&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,t)||cc.logID(8101)),e&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,e)||cc.logID(8102)),this._vertShader&&i.attachShader(this._programObj,this._vertShader),cc.checkGLErrorDebug(),this._fragShader&&i.attachShader(this._programObj,this._fragShader);for(var n in this._hashForUniforms)delete this._hashForUniforms[n];return cc.checkGLErrorDebug(),!0},initWithString:function(t,e){return this.initWithVertexShaderByteArray(t,e)},initWithVertexShaderFilename:function(t,e){var i=cc.loader.getRes(t);if(!i)throw new Error("Please load the resource firset : "+t);
var n=cc.loader.getRes(e);if(!n)throw new Error("Please load the resource firset : "+e);return this.initWithVertexShaderByteArray(i,n)},init:function(t,e){return this.initWithVertexShaderFilename(t,e)},addAttribute:function(t,e){this._glContext.bindAttribLocation(this._programObj,e,t)},link:function(){if(!this._programObj)return cc.logID(8103),!1;if(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._vertShader=null,this._fragShader=null,cc.game.config[cc.game.CONFIG_KEY.debugMode]){var t=this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS);if(!t)return cc.logID(8104,this._glContext.getProgramInfoLog(this._programObj)),cc.gl.deleteProgram(this._programObj),this._programObj=null,!1}return!0},use:function(){cc.gl.useProgram(this._programObj)},updateUniforms:function(){this._uniforms[n.UNIFORM_PMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_PMATRIX_S),this._uniforms[n.UNIFORM_MVMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_MVMATRIX_S),this._uniforms[n.UNIFORM_MVPMATRIX]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_MVPMATRIX_S),this._uniforms[n.UNIFORM_TIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_TIME_S),this._uniforms[n.UNIFORM_SINTIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_SINTIME_S),this._uniforms[n.UNIFORM_COSTIME]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_COSTIME_S),this._usesTime=null!=this._uniforms[n.UNIFORM_TIME]||null!=this._uniforms[n.UNIFORM_SINTIME]||null!=this._uniforms[n.UNIFORM_COSTIME],this._uniforms[n.UNIFORM_RANDOM01]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_RANDOM01_S),this._uniforms[n.UNIFORM_SAMPLER]=this._glContext.getUniformLocation(this._programObj,n.UNIFORM_SAMPLER_S),this.use(),this.setUniformLocationWith1i(this._uniforms[n.UNIFORM_SAMPLER],0)},_addUniformLocation:function(t){var e=this._glContext.getUniformLocation(this._programObj,t);this._uniforms[t]=e},getUniformLocationForName:function(t){if(!t)throw new Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");if(!this._programObj)throw new Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized");var e=this._uniforms[t]||this._glContext.getUniformLocation(this._programObj,t);return e},getUniformMVPMatrix:function(){return this._uniforms[n.UNIFORM_MVPMATRIX]},getUniformSampler:function(){return this._uniforms[n.UNIFORM_SAMPLER]},setUniformLocationWith1i:function(t,e){var i=this._glContext;if("string"==typeof t){var n=this._updateUniformLocation(t,e);if(n){var r=this.getUniformLocationForName(t);i.uniform1i(r,e)}}else i.uniform1i(t,e)},setUniformLocationWith2i:function(t,e,i){var n=this._glContext;if("string"==typeof t){var r=this._updateUniformLocation(t,e,i);if(r){var s=this.getUniformLocationForName(t);n.uniform2i(s,e,i)}}else n.uniform2i(t,e,i)},setUniformLocationWith3i:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){var s=this._updateUniformLocation(t,e,i,n);if(s){var o=this.getUniformLocationForName(t);r.uniform3i(o,e,i,n)}}else r.uniform3i(t,e,i,n)},setUniformLocationWith4i:function(t,e,i,n,r){var s=this._glContext;if("string"==typeof t){var o=this._updateUniformLocation(t,e,i,n,r);if(o){var a=this.getUniformLocationForName(t);s.uniform4i(a,e,i,n,r)}}else s.uniform4i(t,e,i,n,r)},setUniformLocationWith2iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2iv(i,e)},setUniformLocationWith3iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3iv(i,e)},setUniformLocationWith4iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4iv(i,e)},setUniformLocationI32:function(t,e){this.setUniformLocationWith1i(t,e)},setUniformLocationWith1f:function(t,e){var i=this._glContext;if("string"==typeof t){var n=this._updateUniformLocation(t,e);if(n){var r=this.getUniformLocationForName(t);i.uniform1f(r,e)}}else i.uniform1f(t,e)},setUniformLocationWith2f:function(t,e,i){var n=this._glContext;if("string"==typeof t){var r=this._updateUniformLocation(t,e,i);if(r){var s=this.getUniformLocationForName(t);n.uniform2f(s,e,i)}}else n.uniform2f(t,e,i)},setUniformLocationWith3f:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){var s=this._updateUniformLocation(t,e,i,n);if(s){var o=this.getUniformLocationForName(t);r.uniform3f(o,e,i,n)}}else r.uniform3f(t,e,i,n)},setUniformLocationWith4f:function(t,e,i,n,r){var s=this._glContext;if("string"==typeof t){var o=this._updateUniformLocation(t,e,i,n,r);if(o){var a=this.getUniformLocationForName(t);s.uniform4f(a,e,i,n,r)}}else s.uniform4f(t,e,i,n,r)},setUniformLocationWith2fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2fv(i,e)},setUniformLocationWith3fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3fv(i,e)},setUniformLocationWith4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4fv(i,e)},setUniformLocationWithMatrix3fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniformMatrix3fv(i,!1,e)},setUniformLocationWithMatrix4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniformMatrix4fv(i,!1,e)},setUniformLocationF32:function(t,e,i,n,r){"use strict";switch(arguments.length){case 0:case 1:return;case 2:this.setUniformLocationWith1f(t,e);break;case 3:this.setUniformLocationWith2f(t,e,i);break;case 4:this.setUniformLocationWith3f(t,e,i,n);break;case 5:this.setUniformLocationWith4f(t,e,i,n,r)}},setUniformsForBuiltins:function(){var t=new r.Matrix4,e=new r.Matrix4,i=new r.Matrix4;if(r.glGetMatrix(r.KM_GL_PROJECTION,t),r.glGetMatrix(r.KM_GL_MODELVIEW,e),r.mat4Multiply(i,t,e),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var s=cc.director,o=s.getTotalFrames()*s.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_TIME],o/10,o,2*o,4*o),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_SINTIME],o/8,o/4,o/2,Math.sin(o)),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_COSTIME],o/8,o/4,o/2,Math.cos(o))}this._uniforms[n.UNIFORM_RANDOM01]!==-1&&this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(t){if(t&&t._renderCmd){var e=new r.Matrix4,i=new r.Matrix4;if(r.glGetMatrix(r.KM_GL_PROJECTION,e),r.mat4Multiply(i,e,t._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],t._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],i.mat,1),this._usesTime){var s=cc.director,o=s.getTotalFrames()*s.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_TIME],o/10,o,2*o,4*o),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_SINTIME],o/8,o/4,o/2,Math.sin(o)),this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_COSTIME],o/8,o/4,o/2,Math.cos(o))}this._uniforms[n.UNIFORM_RANDOM01]!==-1&&this.setUniformLocationWith4f(this._uniforms[n.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],!1,r.getMat4MultiplyValue(r.projection_matrix_stack.top,r.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(t){r.mat4Multiply(t,r.projection_matrix_stack.top,r.modelview_matrix_stack.top),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVPMATRIX],!1,t.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],!1,r.modelview_matrix_stack.top.mat),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,r.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(t){if(!t)throw new Error("modelView matrix is undefined.");this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_MVMATRIX],!1,t.mat),this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,r.projection_matrix_stack.top.mat)},_updateProjectionUniform:function(){var t=r.projection_matrix_stack;t.lastUpdated!==this._projectionUpdated&&(this._glContext.uniformMatrix4fv(this._uniforms[n.UNIFORM_PMATRIX],!1,t.top.mat),this._projectionUpdated=t.lastUpdated)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._vertShader=null,this._fragShader=null,this._uniforms.length=0,this._glContext.deleteProgram(this._programObj),this._programObj=null;for(var t in this._hashForUniforms)this._hashForUniforms[t].length=0,delete this._hashForUniforms[t]},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),cc.GLProgram._highpSupported=null,cc.GLProgram._isHighpSupported=function(){var t=cc._renderContext;if(t.getShaderPrecisionFormat&&null==cc.GLProgram._highpSupported){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);cc.GLProgram._highpSupported=0!==e.precision}return cc.GLProgram._highpSupported}}),{}],271:[(function(t,e,i){var n=-1,r=cc.macro,s=r.ENABLE_GL_STATE_CACHE,o=0,a=0,c=null,h=0,l=0,u=0,_=0;s&&(o=16,a=-1,c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],h=-1,l=-1,u=0,r.TEXTURE_ATLAS_USE_VAO&&(_=0)),cc.gl={},cc.gl.invalidateStateCache=function(){if(cc.math.glFreeAll(),n=-1,s){a=-1;for(var t=0;t<o;t++)c[t]=-1;h=-1,l=-1,u=0}},cc.gl.useprogram=s?function(t){t!==a&&(a=t,cc._rendercontext.useprogram(t))}:function(t){cc._rendercontext.useprogram(t)},cc.gl.deleteprogram=function(t){s&&t===a&&(a=-1),gl.deleteprogram(t)},cc.gl.setblending=function(t,e){var 0="==e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},setLineWidth:function(t){this._lineWidth=t},getLineWidth:function(){return" i="cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),cc._renderContext.blendFunc(t,e))},cc.gl.blendFunc=s?function(t,e){t===h&&e===l||(h=t,l=e,cc.gl.setBlending(t,e))}:cc.gl.setBlending,cc.gl.blendFuncForParticle=function(t,e){if(t!==h||e!==l){h=t,l=e;var" t="cc._renderContext;t.blendEquation(t.FUNC_ADD),s?cc.gl.setBlending(h,l):cc.gl.setBlending(t.BLEND_SRC,t.BLEND_DST)},cc.gl.setProjectionMatrixDirty=function(){n=-1},cc.gl.bindTexture2D=function(t){cc.gl.bindTexture2DN(0,t)},cc.gl.bindTexture2DN=s?function(t,e){if(c[t]!==e){c[t]=e;var" n="cc.PresetShaders,r=cc.macro;cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_SPRITE_POSITION_TEXTURECOLOR:8,TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:9,TYPE_SPRITE_POSITION_COLOR:10,TYPE_MAX:10,_programs:{},_init:function(){return" this.loaddefaultshaders(),!0},_loaddefaultshader:function(t,e){switch(e){case="" r.shader_position_texturecolor:t.initwithvertexshaderbytearray(n.position_texture_color_vert,n.position_texture_color_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_sprite_position_texturecolor:t.initwithvertexshaderbytearray(n.sprite_position_texture_color_vert,n.position_texture_color_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_position_texturecoloralphatest:t.initwithvertexshaderbytearray(n.position_texture_color_vert,n.position_texture_color_alphatest_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_sprite_position_texturecoloralphatest:t.initwithvertexshaderbytearray(n.sprite_position_texture_color_vert,n.position_texture_color_alphatest_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_position_color:t.initwithvertexshaderbytearray(n.position_color_vert,n.position_color_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color);break;case="" r.shader_sprite_position_color:t.initwithvertexshaderbytearray(n.sprite_position_color_vert,n.position_color_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color);break;case="" r.shader_position_texture:t.initwithvertexshaderbytearray(n.position_texture_vert,n.position_texture_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_position_texture_ucolor:t.initwithvertexshaderbytearray(n.position_texture_ucolor_vert,n.position_texture_ucolor_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_position_texturea8color:t.initwithvertexshaderbytearray(n.position_texture_a8color_vert,n.position_texture_a8color_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_color,r.vertex_attrib_color),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords);break;case="" r.shader_position_ucolor:t.initwithvertexshaderbytearray(n.position_ucolor_vert,n.position_ucolor_frag),t.addattribute("avertex",r.vertex_attrib_position);break;case="" r.shader_position_lengthtexturecolor:t.initwithvertexshaderbytearray(n.position_color_length_texture_vert,n.position_color_length_texture_frag),t.addattribute(r.attribute_name_position,r.vertex_attrib_position),t.addattribute(r.attribute_name_tex_coord,r.vertex_attrib_tex_coords),t.addattribute(r.attribute_name_color,r.vertex_attrib_color);break;default:return="" void="" cc.logid(8105)}t.link(),t.updateuniforms()},_reloadshader:function(t){var="" e="this.programForKey(t);e.reset(),this._loadDefaultShader(e,t)},loadDefaultShaders:function(){},reloadDefaultShaders:function(){this._reloadShader(r.SHADER_POSITION_TEXTURECOLOR),this._reloadShader(r.SHADER_SPRITE_POSITION_TEXTURECOLOR),this._reloadShader(r.SHADER_POSITION_TEXTURECOLORALPHATEST),this._reloadShader(r.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),this._reloadShader(r.SHADER_POSITION_COLOR),this._reloadShader(r.SHADER_POSITION_TEXTURE),this._reloadShader(r.SHADER_POSITION_TEXTURE_UCOLOR),this._reloadShader(r.SHADER_POSITION_TEXTUREA8COLOR),this._reloadShader(r.SHADER_POSITION_UCOLOR)},programForKey:function(t){if(!this._programs[t]){var" cc.glprogram;this._loaddefaultshader(e,t),this._programs[t]="e}return" this._programs[t]},getprogram:function(t){return="" this.programforkey(t)},addprogram:function(t,e){this._programs[e]="t}}}),{}],273:[(function(t,e,i){cc.PresetShaders={POSITION_UCOLOR_FRAG:"precision" lowp="" float;\nvarying="" vec4="" v_fragmentcolor;\nvoid="" main()\n{\ngl_fragcolor="v_fragmentColor;\n}",POSITION_UCOLOR_VERT:"attribute" a_position;\nuniform="" u_color;\nuniform="" float="" u_pointsize;\nvarying="" main(void)\n{\ngl_position="(CC_PMatrix" *="" cc_mvmatrix)="" a_position;\ngl_pointsize="u_pointSize;\nv_fragmentColor" =="" u_color;\n}",position_color_frag:"precision="" a_position;\nattribute="" a_color;\nvarying="" main()\n{\ngl_position="(CC_PMatrix" a_position;\nv_fragmentcolor="a_color;\n}",SPRITE_POSITION_COLOR_VERT:"attribute" gl_oes_standard_derivatives="" :="" enable\nvarying="" mediump="" v_color;\nvarying="" vec2="" v_texcoord;\nvoid="" main()\n{\n="" #if="" defined="" gl_oes_standard_derivatives\n="" gl_fragcolor="v_color*smoothstep(0.0," length(fwidth(v_texcoord)),="" 1.0-length(v_texcoord));\n="" #else\ngl_fragcolor="v_color" step(0.0,="" 1.0="" -="" length(v_texcoord));\n="" #endif\n}",position_color_length_texture_vert:"attribute="" a_texcoord;\nattribute="" main()\n{\nv_color="a_color;\nv_texcoord" a_texcoord;\ngl_position="(CC_PMatrix" a_position;\n}",position_texture_frag:"precision="" v_texcoord);\n}",position_texture_vert:"attribute="" a_texcoord;\nvarying="" a_position;\nv_texcoord="a_texCoord;\n}",POSITION_TEXTURE_UCOLOR_FRAG:"precision" float;\nuniform="" u_color;\nvarying="" v_texcoord)="" u_color;\n}",position_texture_ucolor_vert:"attribute="" v_fragmentcolor;\nvarying="" texture2d(cc_texture0,="" v_texcoord).a);\n}",position_texture_a8color_vert:"attribute="" a_texcoord;\n}",position_texture_color_frag:"precision="" v_texcoord);\n}",position_texture_color_vert:"attribute="" a_texcoord;\n}",sprite_position_texture_color_vert:"attribute="" a_texcoord;\n}",position_texture_color_alphatest_frag:"precision="" v_texcoord;\nuniform="" cc_alpha_value;\nvoid="" main()\n{\nvec4="" texcolor="texture2D(CC_Texture0," v_texcoord);\nif(texcolor.a="" <="CC_alpha_value)\n" discard;="" \ngl_fragcolor="texColor*v_fragmentColor;\n}",EX_SWITCHMASK_FRAG:"precision" sampler2d="" u_texture;\nuniform="" u_mask;\nvoid="" texcolorc="texture2D(u_texture," v_texcoord);\nvec4="" maskcolor="texture2D(u_mask," finalcolor="vec4(texColor.r," texcolor.g,="" texcolor.b,="" maskcolor.a*texcolor.a);\ngl_fragcolor="v_fragmentColor*finalColor;\n}"}}),{}],274:[(function(t,e,i){t("./CCShaders"),t("./CCShaderCache"),t("./CCGLProgram"),t("./CCGLStateCache")}),{"./CCGLProgram":270,"./CCGLStateCache":271,"./CCShaderCache":272,"./CCShaders":273}],275:[(function(t,e,i){var" this._blendfunc},setblendfunc:function(t,e){void="" this._linewidth},setdrawcolor:function(t){var="" cc.color(this._drawcolor.r,this._drawcolor.g,this._drawcolor.b,this._drawcolor.a)}}),cc.drawnode.type_dot="0,cc.DrawNode.TYPE_SEGMENT=1,cc.DrawNode.TYPE_POLY=2,cc.game.once(cc.game.EVENT_RENDERER_INITED,(function(){var" h="this;h.type=t,h.verts=e||null,h.fillColor=i||null,h.lineWidth=n||0,h.lineColor=r||null,h.lineCap=s||"butt",h.isClosePolygon=o||!1,h.isFill=a||!1,h.isStroke=c||!1},t._className="DrawNodeCanvas",t.ctor=function(){_ccsg.Node.prototype.ctor.call(this);var" cc.blendfunc(cc.macro.src_alpha,cc.macro.one_minus_src_alpha),this.init()},t.drawrect="function(t,e,i,n,r){n=null==n?this._lineWidth:n,r=r||this.getDrawColor(),null==r.a&&(r.a=255);var" s="[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],o=new" cc._drawnodeelement(cc.drawnode.type_poly);o.verts="s,o.lineWidth=n,o.lineColor=r,o.isClosePolygon=!0,o.isStroke=!0,o.lineCap="butt",o.fillColor=i,i&&(null==i.a&&(i.a=255),o.isFill=!0),this._buffer.push(o)},t.drawCircle=function(t,e,i,n,r,s,o){s=s||this._lineWidth,o=o||this.getDrawColor(),null==o.a&&(o.a=255);for(var" a="2*Math.PI/n,c=[],h=0;h<=n;h++){var" l="h*a,u=e*Math.cos(l+i)+t.x,_=e*Math.sin(l+i)+t.y;c.push(cc.p(u,_))}r&&c.push(cc.p(t.x,t.y));var" d="new" cc._drawnodeelement(cc.drawnode.type_poly);d.verts="c,d.lineWidth=s,d.lineColor=o,d.isClosePolygon=!0,d.isStroke=!0,this._buffer.push(d)},t.drawQuadBezier=function(t,e,i,n,r,s){r=r||this._lineWidth,s=s||this.getDrawColor(),null==s.a&&(s.a=255);for(var" o="[],a=0,c=0;c<n;c++){var" u="new" cc._drawnodeelement(cc.drawnode.type_poly);u.verts="o,u.lineWidth=r,u.lineColor=s,u.isStroke=!0,u.lineCap="round",this._buffer.push(u)},t.drawCubicBezier=function(t,e,i,n,r,s,o){s=s||this._lineWidth,o=o||this.getDrawColor(),null==o.a&&(o.a=255);for(var" _="new" cc._drawnodeelement(cc.drawnode.type_poly);_.verts="a,_.lineWidth=s,_.lineColor=o,_.isStroke=!0,_.lineCap="round",this._buffer.push(_)},t.drawCatmullRom=function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},t.drawCardinalSpline=function(t,e,i,n,r){n=n||this._lineWidth,r=r||this.getDrawColor(),null==r.a&&(r.a=255);for(var" s,o,a="[],c=1/t.length,h=0;h<i+1;h++){var" cc._drawnodeelement(cc.drawnode.type_dot);n.verts="[t],n.lineWidth=e,n.fillColor=i,this._buffer.push(n)},t.drawDots=function(t,e,i){if(t&&0!=t.length){i=i||this.getDrawColor(),null==i.a&&(i.a=255);for(var" r="new" cc._drawnodeelement(cc.drawnode.type_poly);r.verts="[t,e],r.lineWidth=2*i,r.lineColor=n,r.isStroke=!0,r.lineCap="round",this._buffer.push(r)},t.drawPoly_=function(t,e,i,n,r){i=null==i?this._lineWidth:i,n=n||this.getDrawColor(),null==n.a&&(n.a=255);var" cc._drawnodeelement(cc.drawnode.type_poly);s.verts="t,s.fillColor=e,s.lineWidth=i,s.lineColor=n,s.isClosePolygon=!r,s.isStroke=!0,s.lineCap="round",e&&(s.isFill=!0),this._buffer.push(s)},t.drawPoly=function(t,e,i,n,r){for(var" this.drawpoly_(s,e,i,n,r)},t.clear="function(){this._buffer.length=0},t._createRenderCmd=function(){return" new="" cc.drawnode.canvasrendercmd(this)}):cc._rendertype="==cc.game.RENDER_TYPE_WEBGL&&(t._bufferCapacity=0,t._trianglesArrayBuffer=null,t._trianglesWebBuffer=null,t._trianglesReader=null,t._dirty=!1,t._className="DrawNodeWebGL",t.ctor=function(){_ccsg.Node.prototype.ctor.call(this),this._buffer=[],this._blendFunc=new" cc.blendfunc(cc.macro.src_alpha,cc.macro.one_minus_src_alpha),this._drawcolor="cc.color(255,255,255,255),this.init()},t.init=function(){return!!_ccsg.Node.prototype.init.call(this)&&(this.shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0,!0)},t.drawRect=function(t,e,i,n,r){n=null==n?this._lineWidth:n,r=r||this.getDrawColor(),null==r.a&&(r.a=255);var" a,c,h="2*Math.PI/n,l=[];for(a=0;a<=n;a++){var">e._bufferCapacity){var n=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;if(e._bufferCapacity+=Math.max(e._bufferCapacity,t),null==i||0===i.length)e._buffer=[],e._trianglesArrayBuffer=new ArrayBuffer(n*e._bufferCapacity),e._trianglesReader=new Uint8Array(e._trianglesArrayBuffer);else{for(var r=[],s=new ArrayBuffer(n*e._bufferCapacity),o=0;o<i.length;o++)r[o]=new cc.v2f_c4b_t2f_triangle(i[o].a,i[o].b,i[o].c,s,o*n);e._trianglesreader="new" uint8array(s),e._trianglesarraybuffer="s,e._buffer=r}}},t.drawDot=function(t,e,i){i=i||this.getDrawColor(),null==i.a&&(i.a=255);var" n="{r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},r={vertices:{x:t.x-e,y:t.y-e},colors:n,texCoords:{u:-1,v:-1}},s={vertices:{x:t.x-e,y:t.y+e},colors:n,texCoords:{u:-1,v:1}},o={vertices:{x:t.x+e,y:t.y+e},colors:n,texCoords:{u:1,v:1}},a={vertices:{x:t.x+e,y:t.y-e},colors:n,texCoords:{u:1,v:-1}};this._ensureCapacity(6),this._buffer.push(new" cc.v2f_c4b_t2f_triangle(r,s,o,this._trianglesarraybuffer,this._buffer.length*cc.v2f_c4b_t2f_triangle.bytes_per_element)),this._buffer.push(new="" cc.v2f_c4b_t2f_triangle(r,o,a,this._trianglesarraybuffer,this._buffer.length*cc.v2f_c4b_t2f_triangle.bytes_per_element)),this._dirty="!0},t.drawDots=function(t,e,i){if(t&&0!==t.length){i=i||this.getDrawColor(),null==i.a&&(i.a=255);for(var" s="18;this._ensureCapacity(s);var" o="{r:0|r.r,g:0|r.g,b:0|r.b,a:0|r.a},a=cc.v2(t),c=cc.v2(e),h=cc.pNormalize(cc.pPerp(cc.pSub(c,a))),l=cc.pPerp(h),u=cc.pMult(h,i),_=cc.pMult(l,i),d=cc.pSub(c,cc.pAdd(u,_)),f=cc.pAdd(c,cc.pSub(u,_)),p=cc.pSub(c,u),m=cc.pAdd(c,u),g=cc.pSub(a,u),v=cc.pAdd(a,u),y=cc.pSub(a,cc.pSub(u,_)),x=cc.pAdd(a,cc.pAdd(u,_)),T=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,b=this._trianglesArrayBuffer,C=this._buffer;C.push(new" cc.v2f_c4b_t2f_triangle({vertices:d,colors:o,texcoords:n(cc.pneg(cc.padd(h,l)))},{vertices:f,colors:o,texcoords:n(cc.psub(h,l))},{vertices:p,colors:o,texcoords:n(cc.pneg(h))},b,c.length*t)),c.push(new="" cc.v2f_c4b_t2f_triangle({vertices:m,colors:o,texcoords:n(h)},{vertices:f,colors:o,texcoords:n(cc.psub(h,l))},{vertices:p,colors:o,texcoords:n(cc.pneg(h))},b,c.length*t)),c.push(new="" cc.v2f_c4b_t2f_triangle({vertices:m,colors:o,texcoords:n(h)},{vertices:g,colors:o,texcoords:n(cc.pneg(h))},{vertices:p,colors:o,texcoords:n(cc.pneg(h))},b,c.length*t)),c.push(new="" cc.v2f_c4b_t2f_triangle({vertices:m,colors:o,texcoords:n(h)},{vertices:g,colors:o,texcoords:n(cc.pneg(h))},{vertices:v,colors:o,texcoords:n(h)},b,c.length*t)),c.push(new="" cc.v2f_c4b_t2f_triangle({vertices:y,colors:o,texcoords:n(cc.psub(l,h))="" },{vertices:g,colors:o,texcoords:n(cc.pneg(h))},{vertices:v,colors:o,texcoords:n(h)},b,c.length*t)),c.push(new="" cc.v2f_c4b_t2f_triangle({vertices:y,colors:o,texcoords:n(cc.psub(l,h))},{vertices:x,colors:o,texcoords:n(cc.padd(h,l))},{vertices:v,colors:o,texcoords:n(h)},b,c.length*t)),this._dirty="!0},t.drawPoly=function(t,e,i,r,s){if(null==e)return" void="" this._drawsegments(t,i,r,!s);null="=e.a&&(e.a=255),null==r.a&&(r.a=255),i=null==i?this._lineWidth:i,i*=.5;var" o,a,c,h,l="{r:0|e.r,g:0|e.g,b:0|e.b,a:0|e.a},u={r:0|r.r,g:0|r.g,b:0|r.b,a:0|r.a},_=[],d=t.length;for(o=0;o<d;o++){a=cc.v2(t[(o-1+d)%d]),c=cc.v2(t[o]),h=cc.v2(t[(o+1)%d]);var" f="cc.pNormalize(cc.pPerp(cc.pSub(c,a))),p=cc.pNormalize(cc.pPerp(cc.pSub(h,c))),m=cc.pMult(cc.pAdd(f,p),1/(cc.pDot(f,p)+1));_[o]={offset:m,n:p}}var" g="i">0,v=3*d-2,y=3*v;this._ensureCapacity(y);var x=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,T=this._trianglesArrayBuffer,b=this._buffer,C=0==g?.5:0;for(o=0;o<d-2;o++)a=cc.psub(cc.v2(t[0]),cc.pmult(_[0].offset,c)),c=cc.psub(cc.v2(t[o+1]),cc.pmult(_[o+1].offset,c)),h=cc.psub(cc.v2(t[o+2]),cc.pmult(_[o+2].offset,c)),b.push(new cc.v2f_c4b_t2f_triangle({vertices:a,colors:l,texcoords:n(cc.v2())},{vertices:c,colors:l,texcoords:n(cc.v2())},{vertices:h,colors:l,texcoords:n(cc.v2())},t,b.length*x));for(o="0;o<d;o++){var" a="(o+1)%d;a=cc.v2(t[o]),c=cc.v2(t[A]);var" s="_[o].n,E=_[o].offset,w=_[A].offset,I=g?cc.pSub(a,cc.pMult(E,i)):cc.pSub(a,cc.pMult(E,.5)),R=g?cc.pSub(c,cc.pMult(w,i)):cc.pSub(c,cc.pMult(w,.5)),P=g?cc.pAdd(a,cc.pMult(E,i)):cc.pAdd(a,cc.pMult(E,.5)),O=g?cc.pAdd(c,cc.pMult(w,i)):cc.pAdd(c,cc.pMult(w,.5));g?(b.push(new" cc.v2f_c4b_t2f_triangle({vertices:i,colors:u,texcoords:n(cc.pneg(s))},{vertices:r,colors:u,texcoords:n(cc.pneg(s))},{vertices:o,colors:u,texcoords:n(s)},t,b.length*x)),b.push(new="" cc.v2f_c4b_t2f_triangle({vertices:i,colors:u,texcoords:n(cc.pneg(s))},{vertices:p,colors:u,texcoords:n(s)},{vertices:o,colors:u,texcoords:n(s)},t,b.length*x))):(b.push(new="" cc.v2f_c4b_t2f_triangle({vertices:i,colors:l,texcoords:n(cc.v2())},{vertices:r,colors:l,texcoords:n(cc.v2())},{vertices:o,colors:l,texcoords:n(s)},t,b.length*x)),b.push(new="" cc.v2f_c4b_t2f_triangle({vertices:i,colors:l,texcoords:n(cc.v2())},{vertices:p,colors:l,texcoords:n(s)},{vertices:o,colors:l,texcoords:n(s)},t,b.length*x)))}_="null,this._dirty=!0},t._drawSegments=function(t,e,i,r){if(e=null==e?this._lineWidth:e,i=i||this._drawColor,null==i.a&&(i.a=255),e*=.5,!(e<=0)){var" s,o,a,c,h="{r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},l=[],u=t.length;for(s=0;s<u;s++){o=cc.v2(t[(s-1+u)%u]),a=cc.v2(t[s]),c=cc.v2(t[(s+1)%u]);var" _="cc.pNormalize(cc.pPerp(cc.pSub(a,o))),d=cc.pNormalize(cc.pPerp(cc.pSub(c,a))),f=cc.pMult(cc.pAdd(_,d),1/(cc.pDot(_,d)+1));l[s]={offset:f,n:d}}var" p="3*u-2,m=3*p;this._ensureCapacity(m);var" g="cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,v=this._trianglesArrayBuffer,y=this._buffer,x=r?u:u-1;for(s=0;s<x;s++){var" t="(s+1)%u;o=cc.v2(t[s]),a=cc.v2(t[T]);var" b="l[s].n,C=l[s].offset,A=l[T].offset,S=cc.pSub(o,cc.pMult(C,e)),E=cc.pSub(a,cc.pMult(A,e)),w=cc.pAdd(o,cc.pMult(C,e)),I=cc.pAdd(a,cc.pMult(A,e));y.push(new" cc.v2f_c4b_t2f_triangle({vertices:s,colors:h,texcoords:n(cc.pneg(b))},{vertices:e,colors:h,texcoords:n(cc.pneg(b))},{vertices:i,colors:h,texcoords:n(b)},v,y.length*g)),y.push(new="" cc.v2f_c4b_t2f_triangle({vertices:s,colors:h,texcoords:n(cc.pneg(b))},{vertices:w,colors:h,texcoords:n(b)},{vertices:i,colors:h,texcoords:n(b)},v,y.length*g))}l="null,this._dirty=!0}},t.clear=function(){this._buffer.length=0,this._dirty=!0},t._createRenderCmd=function(){return" new="" cc.drawnode.webglrendercmd(this)})}))}),{}],276:[(function(t,e,i){cc.drawnode.canvasrendercmd="function(t){this._rootCtor(t),this._needDraw=!0,this._buffer=null,this._drawColor=null,this._blendFunc=null};var" n="cc.DrawNode.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);n.constructor=cc.DrawNode.CanvasRenderCmd,n.rendering=function(t,e,i){var" o="this._buffer,a=0,c=o.length;a<c;a++){var" h="o[a];switch(h.type){case" cc.drawnode.type_dot:this._drawdot(n,h,e,i);break;case="" cc.drawnode.type_segment:this._drawsegment(n,h,e,i);break;case="" cc.drawnode.type_poly:this._drawpoly(n,h,e,i)}}}},n._drawdot="function(t,e,i,n){var" r="e.fillColor,s=e.verts[0],o=e.lineWidth,a=t.getContext();t.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),a.beginPath(),a.arc(s.x,-s.y,o,0,2*Math.PI,!1),a.closePath(),a.fill()},n._drawSegment=function(t,e,i,n){var" f="1,p=r.length;f<p;f++)_.lineTo(r[f].x,-r[f].y);h&&_.closePath(),l&&_.fill(),u&&_.stroke()}}}),{}],277:[(function(t,e,i){cc.DrawNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new" cc.math.matrix4,this._matrix.identity()},cc.drawnode.webglrendercmd.prototype="Object.create(_ccsg.Node.WebGLRenderCmd.prototype),cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd,cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(t){var" e="this._node;if(e._buffer.length">0){var i=this._worldTransform,n=this._matrix.mat;n[0]=i.a,n[4]=i.c,n[12]=i.tx,n[1]=i.b,n[5]=i.d,n[13]=i.ty,cc.gl.blendFunc(e._blendFunc.src,e._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e._render()}}}),{}],278:[(function(t,e,i){_ccsg.TMXLayer=_ccsg.Node.extend({tiles:null,tileset:null,layerOrientation:null,properties:null,layerName:"",_texture:null,_textures:null,_texGrids:null,_spriteTiles:null,_layerSize:null,_mapTileSize:null,_opacity:255,_minGID:null,_maxGID:null,_vertexZvalue:null,_useAutomaticVertexZ:null,_reusedTile:null,_atlasIndexArray:null,_contentScaleFactor:null,_staggerAxis:null,_staggerIndex:null,_hexSideLength:0,_className:"TMXLayer",ctor:function(t,e,i){cc.SpriteBatchNode.prototype.ctor.call(this),this._descendants=[],this._layerSize=cc.size(0,0),this._mapTileSize=cc.size(0,0),this._spriteTiles={},this._staggerAxis=cc.TiledMap.StaggerAxis.STAGGERAXIS_Y,this._staggerIndex=cc.TiledMap.StaggerIndex.STAGGERINDEX_EVEN,void 0!==i&&this.initWithTilesetInfo(t,e,i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new _ccsg.TMXLayer.CanvasRenderCmd(this):new _ccsg.TMXLayer.WebGLRenderCmd(this)},_fillTextureGrids:function(t,e){var i=this._textures[e];if(!i.isLoaded())return void i.once("load",(function(){this._fillTextureGrids(t,e)}),this);t.imageSize.width&&t.imageSize.height||(t.imageSize.width=i.width,t.imageSize.height=i.height);for(var n=t._tileSize.width,r=t._tileSize.height,s=i._contentSize.width,o=i._contentSize.height,a=t.spacing,c=t.margin,h=Math.floor((s-2*c+a)/(n+a)),l=Math.floor((o-2*c+a)/(r+a)),u=l*h,_=t.firstGid,d=t.firstGid+u,f=this._texGrids,p=null,m=!!f[_],g=cc.macro.FIX_ARTIFACTS_BY_STRECHING_TEXEL?.5:0;_<d&&(m&&!f[_]&&(m=!1),m||!f[_]);++_)p={texid:e,x:0,y:0,width:n,height:r,t:0,l:0,r:0,b:0},t.rectforgid(_,p),p.x+=g,p.y+=g,p.width-=2*g,p.height-=2*g,p.t=p.y o,p.l="p.x/s,p.r=(p.x+p.width)/s,p.b=(p.y+p.height)/o,f[_]=p},initWithTilesetInfo:function(t,e,i){var" n="e._layerSize;this.layerName=e.name,this.tiles=e._tiles,this.properties=e.properties,this._layerSize=n,this._minGID=e._minGID,this._maxGID=e._maxGID,this._opacity=e._opacity,this._staggerAxis=i.getStaggerAxis(),this._staggerIndex=i.getStaggerIndex(),this._hexSideLength=i.getHexSideLength(),this.tileset=t,this.layerOrientation=i.orientation,this._mapTileSize=i.getTileSize();var" r="i._tilesets;if(r){var" s,o,a,c="r.length;for(this._textures=new" array(c),this._texgrids="[],s=0;s<c;++s)o=r[s],a=cc.textureCache.addImage(o.sourceImage),a.setAliasTexParameters(),this._textures[s]=a,this._fillTextureGrids(o,s),o===t&&(this._texture=a)}var" h="this._calculateLayerOffset(e.offset);if(this.setPosition(h),this._parseInternalProperties(),this.layerOrientation===cc.TiledMap.Orientation.HEX){var" l="0,u=0;this._staggerAxis===cc.TiledMap.StaggerAxis.STAGGERAXIS_X?(u=i._tileSize.height*(this._layerSize.height+.5),l=(i._tileSize.width+this._hexSideLength)*Math.floor(this._layerSize.width/2)+i._tileSize.width*(this._layerSize.width%2)):(l=i._tileSize.width*(this._layerSize.width+.5),u=(i._tileSize.height+this._hexSideLength)*Math.floor(this._layerSize.height/2)+i._tileSize.height*(this._layerSize.height%2)),this.setContentSize(l,u)}else" this.setcontentsize(this._layersize.width*this._maptilesize.width,this._layersize.height*this._maptilesize.height);return="" this._useautomaticvertexz="!1,this._vertexZvalue=0,!0},visit:function(t){var" e="this._renderCmd,i=t?t._renderCmd:null;if(!this._visible)return" void="" e._propagateflagsdown(i);var="" r,s,o="this._children,a=o.length,c=cc._renderType===cc.game.RENDER_TYPE_CANVAS,h=this._spriteTiles;if(a">0){for(this._reorderChildDirty&&this.sortAllChildren(),r=0;r<a&&(s=o[r],s._localzorder<0);r++)s.visit(this);for(n.pushrendercommand(e);r<a;r++)s=o[r],c&&0===s._localzorder&&h[s.tag]?(isnan(s._customz)&&(s._vertexz=n.assignedz,n.assignedz+=n.assignedzstep),s._rendercmd.updatestatus()):s.visit(this)}else 0="==t)throw" n.pushrendercommand(e);e._dirtyflag="0},getLayerSize:function(){return" cc.size(this._layersize.width,this._layersize.height)},setlayersize:function(t){this._layersize.width="t.width,this._layerSize.height=t.height},_getLayerWidth:function(){return" this._layersize.width},_setlayerwidth:function(t){this._layersize.width="t},_getLayerHeight:function(){return" this._layersize.height},_setlayerheight:function(t){this._layersize.height="t},getMapTileSize:function(){return" cc.size(this._maptilesize.width,this._maptilesize.height)},setmaptilesize:function(t){this._maptilesize.width="t.width,this._mapTileSize.height=t.height},_getTileWidth:function(){return" this._maptilesize.width},_settilewidth:function(t){this._maptilesize.width="t},_getTileHeight:function(){return" this._maptilesize.height},_settileheight:function(t){this._maptilesize.height="t},getTiles:function(){return" this.tiles},settiles:function(t){this.tiles="t},getTileSet:function(){return" this.tileset},settileset:function(t){this.tileset="t},getLayerOrientation:function(){return" this.layerorientation},setlayerorientation:function(t){this.layerorientation="t},getProperties:function(){return" this.properties},setproperties:function(t){this.properties="t},getProperty:function(t){return" this.properties[t]},getlayername:function(){return="" this.layername},setlayername:function(t){this.layername="t},releaseMap:function(){this._spriteTiles={}},getTileAt:function(t,e){if(void" new="" error("_ccsg.tmxlayer.gettileat():="" pos="" should="" be="" non-null");var="" i="t;if(void">=this._layerSize.width||e>=this._layerSize.height||i<0||e<0)throw 0="==t)throw" new="" error("_ccsg.tmxlayer.gettileat():="" invalid="" position");if(!this.tiles)return="" cc.logid(7204),null;var="" n="null,r=this.getTileGIDAt(i,e);if(0===r)return" n;var="" s="Math.floor(i)+Math.floor(e)*this._layerSize.width;if(n=this._spriteTiles[s],!n){var" o="this._texGrids[r],a=this._textures[o.texId];n=new" _ccsg.sprite(a,o),n.setposition(this.getpositionat(i,e));var="" c="this._vertexZForPos(i,e);n.setVertexZ(c),n.setAnchorPoint(0,0),n.setOpacity(this._opacity),this.addChild(n,c,s)}return" n},gettilegidat:function(t,e){if(void="" error("_ccsg.tmxlayer.gettilegidat():="" pos="" should="" be="" non-null");var="" i="t;if(void">=this._layerSize.width||e>=this._layerSize.height||i<0||e<0)throw new="" error("_ccsg.tmxlayer.gettilegidat():="" invalid="" position");if(!this.tiles)return="" cc.logid(7205),null;var="" n="Math.floor(i)+Math.floor(e)*this._layerSize.width,r=this.tiles[n];return(r&cc.TiledMap.TileFlag.FLIPPED_MASK)">>>0},setTileGID:function(t,e,i,n){if(void 0===e)throw new Error("_ccsg.TMXLayer.setTileGID(): pos should be non-null");var r;if(void 0===n&&e instanceof cc.Vec2?(r=e,n=i):r=cc.p(e,i),r.x=Math.floor(r.x),r.y=Math.floor(r.y),r.x>=this._layerSize.width||r.y>=this._layerSize.height||r.x<0||r.y<0)throw new="" error("_ccsg.tmxlayer.settilegid():="" invalid="" position");if(!this.tiles)return="" void="" cc.logid(7206);if(0!="=t&&t<this.tileset.firstGid)return" cc.logid(7207,t);n="n||0;var" s="this.getTileFlagsAt(r),o=this.getTileGIDAt(r);if(o!==t||s!==n){var" a="(t|n)">>>0;if(0===t)this.removeTileAt(r);else if(0===o)this._updateTileForGID(a,r);else{var c=r.x+r.y*this._layerSize.width,h=this.getChildByTag(c);if(h){var l=this._texGrids[t],u=this._textures[l.texId];h.setTexture(u),h.setTextureRect(l,!1),null!=n&&this._setupTileSprite(h,r,a),this.tiles[c]=a}else this._updateTileForGID(a,r)}}},addChild:function(t,e,i){_ccsg.Node.prototype.addChild.call(this,t,e,i),void 0!==i&&(this._spriteTiles[i]=t,t._vertexZ=this._vertexZ+cc.renderer.assignedZStep*i/this.tiles.length)},removeChild:function(t,e){this._spriteTiles[t.tag]&&(this._spriteTiles[t.tag]=null),_ccsg.Node.prototype.removeChild.call(this,t,e)},getTileFlagsAt:function(t,e){if(!t)throw new Error("_ccsg.TMXLayer.getTileFlagsAt(): pos should be non-null");if(void 0!==e&&(t=cc.p(t,e)),t.x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw new="" error("_ccsg.tmxlayer.gettileflagsat():="" invalid="" position");if(!this.tiles)return="" cc.logid(7208),null;var="" i="Math.floor(t.x)+Math.floor(t.y)*this._layerSize.width,n=this.tiles[i];return(n&cc.TiledMap.TileFlag.FLIPPED_ALL)">>>0},removeTileAt:function(t,e){if(!t)throw new Error("_ccsg.TMXLayer.removeTileAt(): pos should be non-null");if(void 0!==e&&(t=cc.p(t,e)),t.x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw new="" error("_ccsg.tmxlayer.removetileat():="" invalid="" position");if(!this.tiles)return="" void="" cc.logid(7209);var="" i="this.getTileGIDAt(t);if(0!==i){var" n="Math.floor(t.x)+Math.floor(t.y)*this._layerSize.width;this.tiles[n]=0;var" r="this._spriteTiles[n];r&&this.removeChild(r,!0)}},getPositionAt:function(t,e){void" 0!="=e&&(t=cc.p(t,e)),t.x=Math.floor(t.x),t.y=Math.floor(t.y);var" cc.tiledmap.orientation.ortho:i="this._positionForOrthoAt(t);break;case" cc.tiledmap.orientation.iso:i="this._positionForIsoAt(t);break;case" cc.tiledmap.orientation.hex:i="this._positionForHexAt(t)}return" i},_positionforisoat:function(t){return="" cc.p(this._maptilesize.width="" 2*(this._layersize.width+t.x-t.y-1),this._maptilesize.height="" 2*(2*this._layersize.height-t.x-t.y-2))},_positionfororthoat:function(t){return="" cc.p(t.x*this._maptilesize.width,(this._layersize.height-t.y-1)*this._maptilesize.height)},_positionforhexat:function(t){var="" e="cc.p(0,0),i=this.tileset.tileOffset,n=this._staggerIndex===cc.TiledMap.StaggerIndex.STAGGERINDEX_ODD?1:-1;switch(this._staggerAxis){case" cc.tiledmap.staggeraxis.staggeraxis_y:var="" cc.tiledmap.staggeraxis.staggeraxis_x:var="" s="0;t.x%2===1&&(s=this._mapTileSize.height/2*-n),e=cc.p(t.x*(this._mapTileSize.width-(this._mapTileSize.width-this._hexSideLength)/2)+i.x,(this._layerSize.height-t.y-1)*this._mapTileSize.height+s-i.y)}return" e},_calculatelayeroffset:function(t){var="" cc.tiledmap.orientation.ortho:e="cc.p(t.x*this._mapTileSize.width,-t.y*this._mapTileSize.height);break;case" cc.tiledmap.orientation.iso:e="cc.p(this._mapTileSize.width/2*(t.x-t.y),this._mapTileSize.height/2*(-t.x-t.y));break;case" cc.tiledmap.orientation.hex:if(this._staggeraxis="==cc.TiledMap.StaggerAxis.STAGGERAXIS_Y){var" if(this._staggeraxis="==cc.TiledMap.StaggerAxis.STAGGERAXIS_X){var" e},_updatetileforgid:function(t,e){if(this._texgrids[t]){var="" t="this.getProperty("cc_vertexz");if(t)if("automatic"===t){this._useAutomaticVertexZ=!0;var" this._vertexzvalue="parseInt(t,10)},_setupTileSprite:function(t,e,i){var">>>0){t.setAnchorPoint(.5,.5),t.setPosition(n.x+t.width/2,n.y+t.height/2);var r=(i&(cc.TiledMap.TileFlag.HORIZONTAL|cc.TiledMap.TileFlag.VERTICAL)>>>0)>>>0;r===cc.TiledMap.TileFlag.HORIZONTAL?t.setRotation(90):r===cc.TiledMap.TileFlag.VERTICAL?t.setRotation(270):r===(cc.TiledMap.TileFlag.VERTICAL|cc.TiledMap.TileFlag.HORIZONTAL)>>>0?(t.setRotation(90),t.setFlippedX(!0)):(t.setRotation(270),t.setFlippedX(!0))}else(i&cc.TiledMap.TileFlag.HORIZONTAL)>>>0&&t.setFlippedX(!0),(i&cc.TiledMap.TileFlag.VERTICAL)>>>0&&t.setFlippedY(!0)},_vertexZForPos:function(t,e){void 0===e&&(e=t.y,t=t.x);var i=0,n=0;if(this._useAutomaticVertexZ)switch(this.layerOrientation){case cc.TiledMap.Orientation.ISO:n=this._layerSize.width+this._layerSize.height,i=-(n-(t+e));break;case cc.TiledMap.Orientation.ORTHO:i=-(this._layerSize.height-e);break;case cc.TiledMap.Orientation.HEX:cc.logID(7210);break;default:cc.logID(7211)}else i=this._vertexZvalue;return i}})}),{}],279:[(function(t,e,i){_ccsg.TMXObject=cc.Class({properties:{sgNode:null,offset:cc.p(0,0),gid:0,name:"",type:null,id:0,objectVisible:!0,objectSize:cc.size(0,0),objectRotation:0,_properties:null,_groupSize:cc.size(0,0)},initWithInfo:function(t,e,i,n){this.setProperties(t),this.setObjectName(t.name),this.id=t.id,this.gid=t.gid,this.type=t.type,this.offset=cc.p(t.x,t.y),this.objectSize=cc.size(t.width,t.height),this.objectVisible=t.visible,this.objectRotation=t.rotation,this._groupSize=i,this.type===cc.TiledMap.TMXObjectType.IMAGE?this.sgNode=new _ccsg.TMXObjectImage(this,e):this.sgNode=new _ccsg.TMXObjectShape(this,e,n)},getObjectName:function(){return this.name},getProperty:function(t){return this._properties[t]},getProperties:function(){return this._properties},setObjectName:function(t){this.name=t},setProperties:function(t){this._properties=t}}),_ccsg.TMXObjectImage=_ccsg.Sprite.extend({_container:null,ctor:function(t,e){_ccsg.Sprite.prototype.ctor.call(this),this._container=t,this.initWithMapInfo(e)},initWithMapInfo:function(t){if(!this._container.gid)return!1;for(var e,i=t.getTilesets(),n=i.length-1;n>=0;n--){var r=i[n];if((this._container.gid&cc.TiledMap.TileFlag.FLIPPED_MASK)>>>0>=r.firstGid){e=r;break}}if(!e)return!1;this.setVisible(this._container.objectVisible);var s=cc.textureCache.addImage(cc.path._normalize(r.sourceImage));return this._initWithTileset(s,e),this._initPosWithMapInfo(t),this.setRotation(this._container.objectRotation),(this._container.gid&cc.TiledMap.TileFlag.HORIZONTAL)>>>0&&this.setFlippedX(!0),(this._container.gid&cc.TiledMap.TileFlag.VERTICAL)>>>0&&this.setFlippedY(!0),!0},_initWithTileset:function(t,e){if(!t.isLoaded())return void t.once("load",(function(){this._initWithTileset(t,e)}),this);e.imageSize.width=t.width,e.imageSize.height=t.height;var i=e.rectForGID(this._container.gid);this.initWithTexture(t,i),this.setScaleX(this._container.objectSize.width/i.size.width),this.setScaleY(this._container.objectSize.height/i.size.height)},_initPosWithMapInfo:function(t){var e=t.getOrientation();switch(e){case cc.TiledMap.Orientation.ORTHO:case cc.TiledMap.Orientation.HEX:this.setAnchorPoint(cc.p(0,0)),this.setPosition(this._container.offset.x,this._container._groupSize.height-this._container.offset.y);break;case cc.TiledMap.Orientation.ISO:this.setAnchorPoint(cc.p(.5,0));var i=cc.p(this._container.offset.x/t._tileSize.height,this._container.offset.y/t._tileSize.height),n=cc.p(t._tileSize.width/2*(t._mapSize.width+i.x-i.y),t._tileSize.height/2*(2*t._mapSize.height-i.x-i.y));this.setPosition(n)}}}),_ccsg.TMXObjectShape=cc.DrawNode.extend({_container:null,_color:cc.Color.WHITE,_mapOrientation:0,_mapInfo:null,ctor:function(t,e,i){cc.DrawNode.prototype.ctor.call(this),this.setLineWidth(1),this._container=t,this._color=i,this._mapInfo=e,this._mapOrientation=e.getOrientation(),this._initShape()},_initShape:function(){var t;if(cc.TiledMap.Orientation.ISO!==this._mapOrientation){var e=cc.p(0,this._container._groupSize.height);t=cc.p(e.x+this._container.offset.x,e.y-this._container.offset.y)}else t=this._getPosByOffset(cc.p(0,0));switch(this.setPosition(t),this.setRotation(this._container.objectRotation),this._container.type){case cc.TiledMap.TMXObjectType.RECT:this._drawRect();break;case cc.TiledMap.TMXObjectType.ELLIPSE:this._drawEllipse();break;case cc.TiledMap.TMXObjectType.POLYGON:this._drawPoly(t,!0);break;case cc.TiledMap.TMXObjectType.POLYLINE:this._drawPoly(t,!1)}this.setVisible(this._container.objectVisible)},_getPosByOffset:function(t){var e=this._mapInfo.getMapSize(),i=this._mapInfo.getTileSize(),n=cc.p((this._container.offset.x+t.x)/i.width*2,(this._container.offset.y+t.y)/i.height);return cc.p(i.width/2*(e.width+n.x-n.y),i.height/2*(2*e.height-n.x-n.y))},_drawRect:function(){if(cc.TiledMap.Orientation.ISO!==this._mapOrientation){var t=this._container.objectSize;t.equals(cc.Size.ZERO)?(t=cc.size(20,20),this.setAnchorPoint(cc.p(.5,.5))):this.setAnchorPoint(cc.p(0,1));var e=cc.p(0,0),i=cc.p(t.width,t.height);this.drawRect(e,i,null,this.getLineWidth(),this._color),this.setContentSize(t)}else{if(this._container.objectSize.equals(cc.Size.ZERO))return;var n=this._getPosByOffset(cc.p(0,0)),r=this._getPosByOffset(cc.p(this._container.objectSize.width,0)),s=this._getPosByOffset(cc.p(this._container.objectSize.width,this._container.objectSize.height)),o=this._getPosByOffset(cc.p(0,this._container.objectSize.height)),a=r.x-o.x,c=n.y-s.y;this.setContentSize(cc.size(a,c)),this.setAnchorPoint(cc.p((n.x-o.x)/a,1));var h=cc.p(o.x,s.y);n.subSelf(h),r.subSelf(h),s.subSelf(h),o.subSelf(h),this._container.objectSize.width>0&&(this.drawSegment(n,r,this.getLineWidth(),this._color),this.drawSegment(s,o,this.getLineWidth(),this._color)),this._container.objectSize.height>0&&(this.drawSegment(n,o,this.getLineWidth(),this._color),this.drawSegment(s,r,this.getLineWidth(),this._color))}},_drawEllipse:function(){var t=1,e=1,i=0,n=cc.p(0,0),r=null;if(cc.TiledMap.Orientation.ISO!==this._mapOrientation){var s=this._container.objectSize;s.equals(cc.Size.ZERO)?(s=cc.size(20,20),this.setAnchorPoint(cc.p(.5,.5))):this.setAnchorPoint(cc.p(0,1)),n=cc.p(s.width/2,s.height/2),s.width>s.height?(t=s.width/s.height,i=s.height/2):(e=s.height/s.width,i=s.width/2),r=this,this.setContentSize(s)}else{if(this._container.objectSize.equals(cc.Size.ZERO))return;var o=this._getPosByOffset(cc.p(0,0)),a=this._getPosByOffset(cc.p(this._container.objectSize.width,0)),c=this._getPosByOffset(cc.p(this._container.objectSize.width,this._container.objectSize.height)),h=this._getPosByOffset(cc.p(0,this._container.objectSize.height)),l=a.x-h.x,u=o.y-c.y;this.setContentSize(cc.size(l,u)),this.setAnchorPoint(cc.p((o.x-h.x)/l,1));var _=cc.p(h.x,c.y);o.subSelf(_),a.subSelf(_),c.subSelf(_),h.subSelf(_),this._container.objectSize.width>0&&(this.drawSegment(o,a,this.getLineWidth(),this._color),this.drawSegment(c,h,this.getLineWidth(),this._color)),this._container.objectSize.height>0&&(this.drawSegment(o,h,this.getLineWidth(),this._color),this.drawSegment(c,a,this.getLineWidth(),this._color)),n=this._getPosByOffset(cc.p(this._container.objectSize.width/2,this._container.objectSize.height/2)),n.subSelf(_),r=new cc.DrawNode,r.setLineWidth(this.getLineWidth()),r.setContentSize(cc.size(l,u)),r.setAnchorPoint(cc.p(.5,.5)),r.setPosition(n),this.addChild(r),this._container.objectSize.width>this._container.objectSize.height?(t=this._container.objectSize.width/this._container.objectSize.height,i=this._container.objectSize.height/2):(e=this._container.objectSize.height/this._container.objectSize.width,i=this._container.objectSize.width/2);var d=this._mapInfo.getTileSize(),f=Math.atan(d.width/d.height);i/=Math.sin(f),r.setRotationX(cc.radiansToDegrees(f)),r.setRotationY(90-cc.radiansToDegrees(f))}r.drawCircle(n,i,0,50,!1,this.getLineWidth(),this._color),r.setScaleX(t),r.setScaleY(e)},_drawPoly:function(t,e){var i,n=this._container.getProperties();i=e?n.points:n.polylinePoints;for(var r=[],s=0,o=0,a=0,c=0,h=0,l=i.length;h<l;h++){var u="i[h];r.push(cc.p(u.x,u.y)),s=Math.min(s,u.x),o=Math.min(o,u.y),a=Math.max(a,u.x),c=Math.max(c,u.y)}var" _="0,d=0;if(cc.TiledMap.Orientation.ISO!==this._mapOrientation){_=a-s,d=c-o,this.setAnchorPoint(cc.p(-s/_,c/d));for(var" f="0;f<r.length;f++)r[f]=cc.p(r[f].x-s,-r[f].y+c)}else{var" p="this._getPosByOffset(cc.p(s,c)),m=this._getPosByOffset(cc.p(a,o)),g=this._getPosByOffset(cc.p(0,0));_=m.x-p.x,d=m.y-p.y,this.setAnchorPoint(cc.p((g.x-p.x)/_,(g.y-p.y)/d));for(var" v="0;v<r.length;v++){var" y="this._getPosByOffset(r[v]);r[v]=cc.p(y.x-p.x,y.y-p.y)}}this.setContentSize(cc.size(_,d)),this.drawPoly(r,null,this.getLineWidth(),this._color,!e)}})}),{}],280:[(function(t,e,i){_ccsg.TMXObjectGroup=_ccsg.Node.extend({properties:null,groupName:"",_positionOffset:null,_mapInfo:null,_objects:[],ctor:function(t,e){_ccsg.Node.prototype.ctor.call(this),this._initGroup(t,e)},_initGroup:function(t,e){this.groupName=t.name,this._positionOffset=t.offset,this._mapInfo=e,this.properties=t.getProperties();var" i="e._mapSize,n=e._tileSize;if(e.orientation===cc.TiledMap.Orientation.HEX){var" r="0,s=0;e.getStaggerAxis()===cc.TiledMap.StaggerAxis.STAGGERAXIS_X?(s=n.height*(i.height+.5),r=(n.width+e.getHexSideLength())*Math.floor(i.width/2)+n.width*(i.width%2)):(r=n.width*(i.width+.5),s=(n.height+e.getHexSideLength())*Math.floor(i.height/2)+n.height*(i.height%2)),this.setContentSize(r,s)}else" this.setcontentsize(i.width*n.width,i.height*n.height);this.setanchorpoint(cc.p(0,0)),this.setposition(this._positionoffset.x,-this._positionoffset.y),this.setvisible(t.visible);var="" o="[];t._objects" instanceof="" array&&(o="t._objects),this._objects=[];for(var" a="0,c=o.length;a<c;a++){var" h="o[a],l=new" _ccsg.tmxobject;l.initwithinfo(h,e,this.getcontentsize(),t._color),this._objects.push(l),l.sgnode&&(l.sgnode.setopacity(t._opacity),this.addchild(l.sgnode,a,a))}},getpositionoffset:function(){return="" cc.p(this._positionoffset)},setpositionoffset:function(t){this._positionoffset.x="t.x,this._positionOffset.y=t.y},getProperties:function(){return" this.properties},setproperties:function(t){this.properties="t},getGroupName:function(){return" this.groupname},setgroupname:function(t){this.groupname="t},propertyNamed:function(t){return" this.properties[t]},objectnamed:function(t){return="" this.getobject(t)},getobject:function(t){for(var="" e="0,i=this._objects.length;e<i;e++){var" n="this._objects[e];if(n&&n.getObjectName()===t)return" n}return="" null},getobjects:function(){return="" this._objects}})}),{}],281:[(function(t,e,i){t(".="" ccsgtmxobject.js"),t(".="" cctmxxmlparser.js"),_ccsg.tmxtiledmap="_ccsg.Node.extend({properties:null,mapOrientation:null,_mapSize:null,_tileSize:null,_tileProperties:null,_className:"TMXTiledMap",ctor:function(t,e){_ccsg.Node.prototype.ctor.call(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),void" 0!="=e?this.initWithXML(t,e):void" cc.size(this._mapsize.width,this._mapsize.height)},setmapsize:function(t){this._mapsize.width="t.width,this._mapSize.height=t.height},_getMapWidth:function(){return" this._mapsize.width},_setmapwidth:function(t){this._mapsize.width="t},_getMapHeight:function(){return" this._mapsize.height},_setmapheight:function(t){this._mapsize.height="t},getTileSize:function(){return" cc.size(this._tilesize.width,this._tilesize.height)},settilesize:function(t){this._tilesize.width="t.width,this._tileSize.height=t.height},_getTileWidth:function(){return" this._tilesize.width},_settilewidth:function(t){this._tilesize.width="t},_getTileHeight:function(){return" this._tilesize.height},_settileheight:function(t){this._tilesize.height="t},getMapOrientation:function(){return" this.maporientation},setmaporientation:function(t){this.maporientation="t},getObjectGroups:function(){for(var" t="[],e=this._children,i=0,n=e.length;i<n;i++){var" _ccsg.tmxobjectgroup&&t.push(r)}return="" t},getproperties:function(){return="" cc.tmxmapinfo(t);if(!e)return!1;var="" i&&0!="=i.length||cc.logID(7212),this._buildWithMapInfo(e),!0},initWithXML:function(t,e){this.width=0,this.height=0;var" cc.tmxmapinfo(t,e),n="i.getTilesets();return" n&&0!="=n.length||cc.logID(7213),this._buildWithMapInfo(i),!0},_buildWithMapInfo:function(t){this._mapSize=t.getMapSize(),this._tileSize=t.getTileSize(),this.mapOrientation=t.orientation,this.properties=t.properties,this._tileProperties=t.getTileProperties();for(var">=0;n--){var r=e[n];r&&(r instanceof _ccsg.TMXLayer||r instanceof _ccsg.TMXObjectGroup)&&this.removeChild(r)}var s=0,o=t.getAllChildren();if(o&&o.length>0)for(var a=0,c=o.length;a<c;a++){var h,l="o[a];l" instanceof="" cc.tmxlayerinfo&&l.visible&&(h="this._parseLayer(l,t),this.addChild(h,s,s),this.width=Math.max(this.width,h.width),this.height=Math.max(this.height,h.height),s++),l" cc.tmxobjectgroupinfo&&(h="new" _ccsg.tmxobjectgroup(l,t),this.addchild(h,s,s),s++)}},alllayers:function(){for(var="" t="[],e=this._children,i=0,n=e.length;i<n;i++){var" r="e[i];r&&r" _ccsg.tmxlayer&&t.push(r)}return="" t},getlayer:function(t){if(!t||0="==t.length)throw" new="" error("_ccsg.tmxtiledmap.getlayer():="" layername="" should="" be="" non-null="" or="" non-empty="" string.");for(var="" e="this._children,i=0;i<e.length;i++){var" n="e[i];if(n&&n" _ccsg.tmxlayer&&n.layername="==t)return" n}return="" null},getobjectgroup:function(t){if(!t||0="==t.length)throw" error("_ccsg.tmxtiledmap.getobjectgroup():="" groupname="" _ccsg.tmxobjectgroup&&n.groupname="==t)return" null},getproperty:function(t){return="" this.properties[t.tostring()]},propertiesforgid:function(t){return="" cc.logid(7214),this.getpropertiesforgid[t]},getpropertiesforgid:function(t){return="" this._tileproperties[t]},_parselayer:function(t,e){var="" i="this._tilesetForLayer(t,e),n=new" _ccsg.tmxlayer(i,t,e);return="" t.owntiles="!1,n},_tilesetForLayer:function(t,e){var">=0;r--){var s=n[r];if(s)for(var o=0;o<i.height;o++)for(var a="0;a<i.width;a++){var" c="a+i.width*o,h=t._tiles[c];if(0!==h&&(h&cc.TiledMap.TileFlag.FLIPPED_MASK)">>>0>=s.firstGid)return s}}return cc.logID(7215,t.name),null}});var n=_ccsg.TMXTiledMap.prototype;n.mapWidth,cc.defineGetterSetter(n,"mapWidth",n._getMapWidth,n._setMapWidth),
n.mapHeight,cc.defineGetterSetter(n,"mapHeight",n._getMapHeight,n._setMapHeight),n.tileWidth,cc.defineGetterSetter(n,"tileWidth",n._getTileWidth,n._setTileWidth),n.tileHeight,cc.defineGetterSetter(n,"tileHeight",n._getTileHeight,n._setTileHeight)}),{"./CCSGTMXObject.js":279,"./CCTMXXMLParser.js":284}],282:[(function(t,e,i){var n=null,r=null,s=null,o=null,a=null;_ccsg.TMXLayer.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,n||(n=cc.TiledMap.Orientation,r=cc.TiledMap.TileFlag,s=r.FLIPPED_MASK,o=cc.TiledMap.StaggerAxis,a=cc.TiledMap.StaggerIndex)};var c=_ccsg.TMXLayer.CanvasRenderCmd.prototype=Object.create(_ccsg.Node.CanvasRenderCmd.prototype);c.constructor=_ccsg.TMXLayer.CanvasRenderCmd,c.rendering=function(t,e,i){var c=this._node,h=c._rotationX||c._rotationY,l=c.layerOrientation,u=c.tiles,_=c._opacity/255;if(u&&!(_<=0)){var d="c._mapTileSize.width,f=c._mapTileSize.height,p=c.tileset._tileSize.width/cc.director._contentScaleFactor,m=c.tileset._tileSize.height/cc.director._contentScaleFactor,g=p-d,v=m-f,y=cc.winSize.width,x=cc.winSize.height,T=c._layerSize.height,b=c._layerSize.width,C=c._texGrids,A=c._spriteTiles,S=this._worldTransform,E=c._position.x,w=c._position.y,I=S.a,R=S.b,P=S.c,O=S.d,B=E*I+w*P+S.tx,D=E*R+w*O+S.ty,M=t||cc._renderContext,L=M.getContext(),N=0,F=0,k=b,z=T;cc.macro.ENABLE_TILEDMAP_CULLING&&(h||l!==n.ORTHO||(N=Math.floor(-(B-g*I)/(d*I)),F=Math.floor((D-v*O+f*T*O-x)/(f*O)),k=Math.ceil((y-B+g*I)/(d*I)),z=T-Math.floor(-(D+v*O)/(f*O)),N<0&&(N=0),F<0&&(F=0),k">b&&(k=b),z>T&&(z=T)));var V,G,W,U,j,X,Y,H,q,Z,J,Q,K,$,tt,et,it=F*b,nt=p,rt=m,st=p*I,ot=m*O,at=!1,ct=!1;U=it+N;for(V in A)if(V<u&&a[v])h=a[v]._rendercmd,0===a[v]._localzorder&&h.rendering&&a[v]._visible&&h.rendering(t,e,i);else if(v="">=U)break;M.setTransform(S,e,i),M.setGlobalAlpha(_);var ht,lt,ut,_t,dt;if(l===n.HEX){var ft=c._staggerIndex,pt=c._hexSideLength;ht=c._staggerAxis,lt=c.tileset.tileOffset,ut=ft===a.STAGGERINDEX_ODD?1:-1,_t=ht===o.STAGGERAXIS_X?(d-pt)/2:0,dt=ht===o.STAGGERAXIS_Y?(f-pt)/2:0}for(G=F;G<z;++g){for(w=n;w<k;++w)if(u=it+w,a[u])h=a[u]._rendercmd,0===a[u]._localzorder&&h.rendering&&a[u]._visible&&(h.rendering(t,e,i),m.settransform(s,e,i),m.setglobalalpha(_));else if(j="c.tiles[U],X=C[(j&s)">>>0],X&&(Y=c._textures[X.texId],Y&&Y._htmlElementObj)){switch(l){case n.ORTHO:Z=W*d,J=-(T-G-1)*f;break;case n.ISO:Z=d/2*(b+W-G-1),J=-f/2*(2*T-W-G-2);break;case n.HEX:var mt=ht===o.STAGGERAXIS_Y&&G%2===1?d/2*ut:0;Z=W*(d-_t)+mt+lt.x;var gt=ht===o.STAGGERAXIS_X&&W%2===1?f/2*-ut:0;J=-(T-G-1)*(f-dt)-gt+lt.y}if(Q=Z+p,q=J-m,!h&&l===n.ISO){if(tt=-D+J*O,tt<-x-ot){w+=math.floor(2*(-x-tt) ot)-1;continue}if(et="B+Q*I,et<-st){W+=Math.floor(2*-et/st)-1;continue}if($=B+Z*I,K=-D+q*O,$">y||K>0){W=k;continue}}j>r.DIAGONAL&&(at=(j&r.HORIZONTAL)>>>0,ct=(j&r.VERTICAL)>>>0),at&&(Z=-Q,L.scale(-1,1)),ct&&(q=-J,L.scale(1,-1)),L.drawImage(Y._htmlElementObj,X.x,X.y,X.width,X.height,Z,q,nt,rt),at&&L.scale(-1,1),ct&&L.scale(1,-1),cc.g_NumberOfDraws++}it+=b}for(V in A)V>U&&A[V]&&(H=A[V]._renderCmd,0===A[V]._localZOrder&&H.rendering&&A[V]._visible&&H.rendering(t,e,i))}}}),{}],283:[(function(t,e,i){var n=null,r=null,s=null,o=null,a=null;_ccsg.TMXLayer.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._vertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._color=new Uint32Array(1),this._shaderProgram=cc.shaderCache.programForKey(cc.macro.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST);var e=90*Math.PI/180;this._sin90=Math.sin(e),this._cos90=Math.cos(e),e*=3,this._sin270=Math.sin(e),this._cos270=Math.cos(e),n||(n=cc.TiledMap.Orientation,r=cc.TiledMap.TileFlag,s=r.FLIPPED_MASK,o=cc.TiledMap.StaggerAxis,a=cc.TiledMap.StaggerIndex)};var c=_ccsg.TMXLayer.WebGLRenderCmd.prototype=Object.create(_ccsg.Node.WebGLRenderCmd.prototype);c.constructor=_ccsg.TMXLayer.WebGLRenderCmd,c.uploadData=function(t,e,i){var c=this._node,h=c._rotationX||c._rotationY,l=c.layerOrientation,u=c.tiles;if(!u)return 0;var _=c._mapTileSize.width,d=c._mapTileSize.height,f=c.tileset._tileSize.width/cc.director._contentScaleFactor,p=c.tileset._tileSize.height/cc.director._contentScaleFactor,m=f-_,g=p-d,v=cc.winSize.width,y=cc.winSize.height,x=c._layerSize.height,T=c._layerSize.width,b=c._texGrids,C=c._spriteTiles,A=this._worldTransform,S=A.a,E=A.b,w=A.c,I=A.d,R=A.tx,P=A.ty,O=c._position.x,B=c._position.y,D=O*S+B*w+R,M=O*E+B*I+P,L=c._opacity,N=this._displayedColor.r,F=this._displayedColor.g,k=this._displayedColor.b;if(c._opacityModifyRGB){var z=L/255;N*=z,F*=z,k*=z}this._color[0]=L<<24|k<<16|f<<8|n;var v="0,G=0,W=T,U=x;cc.macro.ENABLE_TILEDMAP_CULLING&&(h||l!==n.ORTHO||(V=Math.floor(-(D-m*S)/(_*S)),G=Math.floor((M-g*I+d*x*I-y)/(d*I)),W=Math.ceil((v-D+m*S)/(_*S)),U=x-Math.floor(-(M+g*I)/(d*I)),V<0&&(V=0),G<0&&(G=0),W">T&&(W=T),U>x&&(U=x)));var j,X,Y,H,q,Z,J,Q,K,$,tt,et,it,nt,rt,st,ot,at,ct,ht=i,lt=G*T,ut=f*S,_t=p*I,dt=S,ft=E,pt=w,mt=I,gt=R,vt=P,yt=!1,xt=!1,Tt=!1,bt=this._vertices;if(l===n.HEX){var Ct=c._staggerIndex,At=c._hexSideLength;rt=c._staggerAxis,st=c.tileset.tileOffset,ct=Ct===a.STAGGERINDEX_ODD?1:-1,ot=rt===o.STAGGERAXIS_X?(_-At)/2:0,at=rt===o.STAGGERAXIS_Y?(d-At)/2:0}for(j=G;j<u;++j){for(x=v;x<w;++x)if(ht+24>t.length&&(cc.renderer._increaseBatchingSize((ht-i)/6,cc.renderer.VertexType.QUAD),cc.renderer._batchRendering(),i=0,ht=0),Y=lt+X,!C[Y]&&(H=c.tiles[Y],q=b[(H&s)>>>0])){switch(l){case n.ORTHO:Q=X*_,K=(x-j-1)*d,Y=c._vertexZ+cc.renderer.assignedZStep*Y/u.length;break;case n.ISO:Q=_/2*(T+X-j-1),K=d/2*(2*x-X-j-2),Y=c._vertexZ+cc.renderer.assignedZStep*(c.height-K)/c.height;break;case n.HEX:var St=rt===o.STAGGERAXIS_Y&&j%2===1?_/2*ct:0;Q=X*(_-ot)+St+st.x;var Et=rt===o.STAGGERAXIS_X&&X%2===1?d/2*-ct:0;K=(x-j-1)*(d-at)+Et-st.y,Y=c._vertexZ+cc.renderer.assignedZStep*(c.height-K)/c.height}if($=Q+f,J=K+p,!h&&l===n.ISO){if(it=M+K*I,it>y+_t){X+=Math.floor(2*(it-y)/_t)-1;continue}if(nt=D+$*S,nt<-ut){x+=math.floor(2*-nt ut)-1;continue}if(et="D+Q*S,tt=M+J*I,et">v||tt<0){x=w;continue}}for(h>r.DIAGONAL&&(yt=!0,xt=(H&r.HORIZONTAL)>>>0,Tt=(H&r.VERTICAL)>>>0),bt[0].x=Q*dt+J*pt+gt,bt[0].y=Q*ft+J*mt+vt,bt[1].x=Q*dt+K*pt+gt,bt[1].y=Q*ft+K*mt+vt,bt[2].x=$*dt+J*pt+gt,bt[2].y=$*ft+J*mt+vt,bt[3].x=$*dt+K*pt+gt,bt[3].y=$*ft+K*mt+vt,Z=0;Z<4;++z){switch(t[ht]=bt[z].x,t[ht+1]=bt[z].y,t[ht+2]=y,e[ht+3]=this._color[0],z){case 0:t[ht+4]="xt?q.r:q.l,t[ht+5]=Tt?q.b:q.t;break;case" 1:t[ht+4]="xt?q.r:q.l,t[ht+5]=Tt?q.t:q.b;break;case" 2:t[ht+4]="xt?q.l:q.r,t[ht+5]=Tt?q.b:q.t;break;case" 3:t[ht+4]="xt?q.l:q.r,t[ht+5]=Tt?q.t:q.b}ht+=6}yt&&(dt=S,ft=E,pt=w,mt=I,gt=R,vt=P,xt=!1,Tt=!1,yt=!1)}lt+=T}return(ht-i)/6}}),{}],284:[(function(t,e,i){function" n(t){if(t.length%4!="=0)return" null;for(var="" e="t.length/4,i=window.Uint32Array?new" uint32array(e):[],n="0;n<e;n++){var" r="4*n;i[n]=t[r]+256*t[r+1]+65536*t[r+2]+t[r+3]*(1<<24)}return" i}cc.tmxlayerinfo="cc._Class.extend({ctor:function(){this.properties={},this.name="",this._layerSize=null,this._tiles=[],this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=cc.p(0,0)},getProperties:function(){return" this.properties},setproperties:function(t){this.properties="t}}),cc.TMXObjectGroupInfo=cc._Class.extend({ctor:function(){this.properties={},this.name="",this._objects=[],this.visible=!0,this._opacity=0,this._color=new" cc.color(255,255,255,255),this.offset="cc.p(0,0),this._draworder="topdown"},getProperties:function(){return" i="e||cc.rect(0,0,0,0);i.width=this._tileSize.width,i.height=this._tileSize.height,t&=cc.TiledMap.TileFlag.FLIPPED_MASK,t-=parseInt(this.firstGid,10);var" n="parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10);return" i.x="parseInt(t%n*(this._tileSize.width+this.spacing)+this.margin,10),i.y=parseInt(parseInt(t/n,10)*(this._tileSize.height+this.spacing)+this.margin,10),i}}),cc.TMXMapInfo=cc.SAXParser.extend({properties:null,orientation:null,parentElement:null,parentGID:null,layerAttrs:0,storingCharacters:!1,tmxFileName:null,currentString:null,_objectGroups:null,_allChildren:null,_mapSize:null,_tileSize:null,_layers:null,_tilesets:null,_tileProperties:null,_resources:"",_staggerAxis:null,_staggerIndex:null,_hexSideLength:0,ctor:function(t,e){cc.SAXParser.prototype.ctor.apply(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),this._layers=[],this._tilesets=[],this._objectGroups=[],this._allChildren=[],this.properties=[],this._tileProperties={},void" 0!="=e?this.initWithXML(t,e):void" this.orientation},setorientation:function(t){this.orientation="t},getStaggerAxis:function(){return" this._staggeraxis},setstaggeraxis:function(t){this._staggeraxis="t},getStaggerIndex:function(){return" this._staggerindex},setstaggerindex:function(t){this._staggerindex="t},getHexSideLength:function(){return" this._hexsidelength},sethexsidelength:function(t){this._hexsidelength="t},getMapSize:function(){return" cc.size(this._mapsize.width,this._mapsize.height)},setmapsize:function(t){this._mapsize.width="t.width,this._mapSize.height=t.height},_getMapWidth:function(){return" this._mapsize.width},_setmapwidth:function(t){this._mapsize.width="t},_getMapHeight:function(){return" this._mapsize.height},_setmapheight:function(t){this._mapsize.height="t},getTileSize:function(){return" cc.size(this._tilesize.width,this._tilesize.height)},settilesize:function(t){this._tilesize.width="t.width,this._tileSize.height=t.height},_getTileWidth:function(){return" this._tilesize.width},_settilewidth:function(t){this._tilesize.width="t},_getTileHeight:function(){return" this._tilesize.height},_settileheight:function(t){this._tilesize.height="t},getLayers:function(){return" this._layers},setlayers:function(t){this._allchildren.push(t),this._layers.push(t)},gettilesets:function(){return="" this._tilesets},settilesets:function(t){this._tilesets.push(t)},getobjectgroups:function(){return="" this._objectgroups},setobjectgroups:function(t){this._allchildren.push(t),this._objectgroups.push(t)},getallchildren:function(){return="" this._allchildren},getparentelement:function(){return="" this.parentelement},setparentelement:function(t){this.parentelement="t},getParentGID:function(){return" this.parentgid},setparentgid:function(t){this.parentgid="t},getLayerAttribs:function(){return" this.layerattrs},setlayerattribs:function(t){this.layerattrs="t},getStoringCharacters:function(){return" this.storingcharacters},setstoringcharacters:function(t){this.storingcharacters="t},getProperties:function(){return" this._internalinit(t,null),this.parsexmlfile(t)},initwithxml:function(t,e){return="" this._internalinit(null,e),this.parsexmlstring(t)},parsexmlfile:function(t,e,i){e="e||!1;var" new="" error("please="" load="" the="" resource="" first="" :="" "+t);var="" r,s,o="this._parseXML(n),a=o.documentElement,c=a.getAttribute("version"),h=a.getAttribute("orientation"),l=a.getAttribute("staggeraxis"),u=a.getAttribute("staggerindex"),_=a.getAttribute("hexsidelength");if("map"===a.nodeName){"1.0"!==c&&null!==c&&cc.logID(7216,c),"orthogonal"===h?this.orientation=cc.TiledMap.Orientation.ORTHO:"isometric"===h?this.orientation=cc.TiledMap.Orientation.ISO:"hexagonal"===h?this.orientation=cc.TiledMap.Orientation.HEX:null!==h&&cc.logID(7217,h),"x"===l?this.setStaggerAxis(cc.TiledMap.StaggerAxis.STAGGERAXIS_X):"y"===l&&this.setStaggerAxis(cc.TiledMap.StaggerAxis.STAGGERAXIS_Y),"odd"===u?this.setStaggerIndex(cc.TiledMap.StaggerIndex.STAGGERINDEX_ODD):"even"===u&&this.setStaggerIndex(cc.TiledMap.StaggerIndex.STAGGERINDEX_EVEN),_&&this.setHexSideLength(parseFloat(_));var" d="cc.size(0,0);d.width=parseFloat(a.getAttribute("width")),d.height=parseFloat(a.getAttribute("height")),this.setMapSize(d),d=cc.size(0,0),d.width=parseFloat(a.getAttribute("tilewidth")),d.height=parseFloat(a.getAttribute("tileheight")),this.setTileSize(d);var" f="a.querySelectorAll("map"> properties >  property");if(f){var p={};for(r=0;r<f.length;r++)p[f[r].getattribute("name")]=f[r].getattribute("value");this.properties=p}}var m="a.getElementsByTagName("tileset");for("map"!==a.nodeName&&(m=[],m.push(a)),r=0;r<m.length;r++){var" g="m[r],v=g.getAttribute("source");if(v){var" y="parseInt(g.getAttribute("firstgid")),x=e?cc.path.join(this._resources,v):cc.path.changeBasename(t,v);this.parseXMLFile(x,!1,y)}else{var" t="new" cc.tmxtilesetinfo;t.name="g.getAttribute("name")||"",i?T.firstGid=i:T.firstGid=parseInt(g.getAttribute("firstgid"))||0,T.spacing=parseInt(g.getAttribute("spacing"))||0,T.margin=parseInt(g.getAttribute("margin"))||0;var" b="cc.size(0,0);b.width=parseFloat(g.getAttribute("tilewidth")),b.height=parseFloat(g.getAttribute("tileheight")),T._tileSize=b;var" c="g.getElementsByTagName("image")[0],A=C.getAttribute("source"),S=-1;if(this.tmxFileName&&(S=this.tmxFileName.lastIndexOf("/")),S!==-1){var" e="this.tmxFileName.substr(0,S+1);T.sourceImage=E+A}else" t.sourceimage="this._resources+(this._resources?"/":"")+A;this.setTilesets(T);var" w="g.getElementsByTagName("tileoffset")[0];if(w){var" i="parseFloat(w.getAttribute("x")),R=parseFloat(w.getAttribute("y"));T.tileOffset=cc.p(I,R)}var" p="g.getElementsByTagName("tile");if(P)for(var" o="0;O<P.length;O++){var" d="B.querySelectorAll("properties"> property");if(D){var M={};for(s=0;s<d.length;s++){var 3="==t.nodeType||8===t.nodeType||4===t.nodeType},_parseLayer:function(t){var" l="D[s].getAttribute("name");M[L]=D[s].getAttribute("value")}this._tileProperties[this.parentGID]=M}}}}var" n="a.childNodes;for(r=0;r<N.length;r++){var" f="N[r];if(!this._shouldIgnoreNode(F)){if("layer"===F.nodeName){var" k="this._parseLayer(F);this.setLayers(k)}if("objectgroup"===F.nodeName){var" z="this._parseObjectGroup(F);this.setObjectGroups(z)}}}return" a},_shouldignorenode:function(t){return="" e="t.getElementsByTagName("data")[0],i=new" cc.tmxlayerinfo;i.name="t.getAttribute("name");var" r="cc.size(0,0);r.width=parseFloat(t.getAttribute("width")),r.height=parseFloat(t.getAttribute("height")),i._layerSize=r;var" s="t.getAttribute("visible");i.visible=!("0"==s);var" o="t.getAttribute("opacity")||1;o?i._opacity=parseInt(255*parseFloat(o)):i._opacity=255,i.offset=cc.p(parseFloat(t.getAttribute("x"))||0,parseFloat(t.getAttribute("y"))||0);var" a="" ;for(v="0;v<e.childNodes.length;v++)a+=e.childNodes[v].nodeValue;a=a.trim();var" c="e.getAttribute("compression"),h=e.getAttribute("encoding");if(c&&"gzip"!==c&&"zlib"!==c)return" cc.logid(7218),null;var="" l;switch(c){case"gzip":l="cc.Codec.unzipBase64AsArray(a,4);break;case"zlib":var" u="new" zlib.inflate(cc.codec.base64.decodeasarray(a,1));l="n(u.decompress());break;case" null:case"":if("base64"="==h)l=cc.Codec.Base64.decodeAsArray(a,4);else" if("csv"="==h){l=[];for(var" _="a.split(","),d=0;d<_.length;d++)l.push(parseInt(_[d]))}else{var" p="0;p<f.length;p++)l.push(parseInt(f[p].getAttribute("gid")))}break;default:this.layerAttrs===cc.TMXLayerInfo.ATTRIB_NONE&&cc.logID(7219)}l&&(i._tiles=new" uint32array(l));var="" m="t.querySelectorAll("properties"> property");if(m){for(var g={},v=0;v<m.length;v++)g[m[v].getattribute("name")]=m[v].getattribute("value");i.properties=g}return i},_parseobjectgroup:function(t){var="" e="new" cc.tmxobjectgroupinfo;e.name="t.getAttribute("name")||"",e.offset=cc.p(parseFloat(t.getAttribute("offsetx")),parseFloat(t.getAttribute("offsety")));var" i="t.getAttribute("opacity")||1;i?e._opacity=parseInt(255*parseFloat(i)):e._opacity=255;var" n="t.getAttribute("visible");n&&0===parseInt(n)&&(e.visible=!1);var" r="t.getAttribute("color");r&&(e._color=cc.hexToColor(r));var" s="t.getAttribute("draworder");s&&(e._draworder=s);var" o="t.querySelectorAll("objectgroup"> properties > property");if(o){var a={};for(l=0;l<o.length;l++)a[o[l].getattribute("name")]=o[l].getattribute("value");e.setproperties(a)}var c="t.querySelectorAll("object"),h=cc.director.getContentScaleFactor();if(c)for(var" l="0;l<c.length;l++){var" u="c[l],_={};_.id=u.getAttribute("id")||0,_.name=u.getAttribute("name")||"",_.width=parseFloat(u.getAttribute("width"))||0,_.height=parseFloat(u.getAttribute("height"))||0,_.x=(u.getAttribute("x")||0)/h,_.y=(u.getAttribute("y")||0)/h,_.rotation=parseFloat(u.getAttribute("rotation"))||0;var" d="u.querySelectorAll("properties"> property");if(d)for(var f=0;f<d.length;f++)_[d[f].getattribute("name")]=d[f].getattribute("value");var p="u.getAttribute("visible");_.visible=!(p&&0===parseInt(p));var" m="u.getAttribute("gid");m&&(_.gid=parseInt(m),_.type=cc.TiledMap.TMXObjectType.IMAGE);var" g="u.querySelectorAll("ellipse");g&&g.length">0&&(_.type=cc.TiledMap.TMXObjectType.ELLIPSE);var v=u.querySelectorAll("polygon");if(v&&v.length>0){_.type=cc.TiledMap.TMXObjectType.POLYGON;var y=v[0].getAttribute("points");y&&(_.points=this._parsePointsString(y))}var x=u.querySelectorAll("polyline");if(x&&x.length>0){_.type=cc.TiledMap.TMXObjectType.POLYLINE;var T=x[0].getAttribute("points");T&&(_.polylinePoints=this._parsePointsString(T))}_.type||(_.type=cc.TiledMap.TMXObjectType.RECT),e._objects.push(_)}return e},_parsePointsString:function(t){if(!t)return null;for(var e=[],i=t.split(" "),n=0;n<i.length;n++){var 0="==e)throw" r="i[n].split(",");e.push({x:parseFloat(r[0]),y:parseFloat(r[1])})}return" e},parsexmlstring:function(t){return="" this.parsexmlfile(t,!0)},gettileproperties:function(){return="" this._tileproperties},settileproperties:function(t){this._tileproperties.push(t)},getcurrentstring:function(){return="" this.currentstring},setcurrentstring:function(t){this.currentstring="t},getTMXFileName:function(){return" this.tmxfilename},settmxfilename:function(t){this.tmxfilename="t},_internalInit:function(t,e){this._tilesets.length=0,this._layers.length=0,this.tmxFileName=t,e&&(this._resources=e),this._objectGroups.length=0,this._allChildren.length=0,this.properties.length=0,this._tileProperties.length=0,this.currentString="",this.storingCharacters=!1,this.layerAttrs=cc.TMXLayerInfo.ATTRIB_NONE,this.parentElement=cc.TiledMap.NONE}});var" new="" cc.tmxmapinfo(t,e)},cc.tmxlayerinfo.attrib_none="1,cc.TMXLayerInfo.ATTRIB_BASE64=2,cc.TMXLayerInfo.ATTRIB_GZIP=4,cc.TMXLayerInfo.ATTRIB_ZLIB=8}),{}],285:[(function(t,e,i){t("./CCSGTMXLayer.js"),t("./CCTMXLayerCanvasRenderCmd.js"),t("./CCTMXLayerWebGLRenderCmd.js");var" n="cc.Class({name:"cc.TiledLayer",extends:cc._SGComponent,onEnable:function(){this._sgNode&&this._sgNode.setVisible(!0)},onDisable:function(){this._sgNode&&this._sgNode.setVisible(!1)},onDestroy:function(){this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null)},_initSgNode:function(){var" t="this._sgNode;if(t){this.enabledInHierarchy||t.setVisible(!1),this._registSizeProvider();var" e="this.node;t.setAnchorPoint(e.getAnchorPoint())}},_replaceSgNode:function(t){t!==this._sgNode&&(this._removeSgNode(),this.node._sizeProvider===this._sgNode&&(this.node._sizeProvider=null),t&&t" instanceof="" _ccsg.tmxlayer?(this._sgnode="t,this._initSgNode()):this._sgNode=null)},getLayerName:function(){return" this._sgnode?this._sgnode.getlayername():""},setlayername:function(t){this._sgnode&&this._sgnode.setlayername(t)},getproperty:function(t){return="" this._sgnode?this._sgnode.getproperty(t):null},getpositionat:function(t,e){return="" this._sgnode?(void="" 0!="=e&&(t=cc.p(t,e)),this._sgNode.getPositionAt(t)):null},removeTileAt:function(t,e){this._sgNode&&(void" error("_ccsg.tmxlayer.settilegid():="" pos="" should="" be="" non-null");var="" r;void="" cc.vec2?(r="e,n=i):r=cc.p(e,i),this._sgNode.setTileGID(t,r,n)}},getTileGIDAt:function(t,e){return" this._sgnode?this._sgnode.gettexture():null},settexture:function(t){this._sgnode&&this._sgnode.settexture(t)},settileopacity:function(t){this._sgnode&&(this._sgnode._opacity="t)},getLayerSize:function(){return" this._sgnode?this._sgnode.getlayersize():cc.size(0,0)},setlayersize:function(t){this._sgnode&&this._sgnode.setlayersize(t)},getmaptilesize:function(){return="" this._sgnode?this._sgnode.getmaptilesize():cc.size(0,0)},setmaptilesize:function(t){this._sgnode&&this._sgnode.setmaptilesize(t)},gettiles:function(){return="" this._sgnode?this._sgnode.gettiles():null},settiles:function(t){this._sgnode&&this._sgnode.settiles(t)},gettileset:function(){return="" this._sgnode?this._sgnode.gettileset():null},settileset:function(t){this._sgnode&&this._sgnode.settileset(t)},getlayerorientation:function(){return="" this._sgnode?this._sgnode.getlayerorientation():0},setlayerorientation:function(t){this._sgnode&&this._sgnode.setlayerorientation(t)},getproperties:function(){return="" this._sgnode?this._sgnode.getproperties():null},setproperties:function(t){this._sgnode&&this._sgnode.setproperties(t)},_tryremovenode:function(){this.node.removecomponent(cc.tiledlayer),1="==this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledLayer=e.exports=n}),{"./CCSGTMXLayer.js":278,"./CCTMXLayerCanvasRenderCmd.js":282,"./CCTMXLayerWebGLRenderCmd.js":283}],286:[(function(t,e,i){t("./CCSGTMXTiledMap.js");var" this._tmxfile},set:function(t,e){this._tmxfile!="=t&&(this._tmxFile=t,this._applyFile())},type:cc.TiledMapAsset}},getMapSize:function(){return" this._sgnode.getmapsize()},setmapsize:function(t){this._sgnode.setmapsize(t)},gettilesize:function(){return="" this._sgnode.gettilesize()},settilesize:function(t){this._sgnode.settilesize(t)},getmaporientation:function(){return="" this._sgnode.getmaporientation()},setmaporientation:function(t){this._sgnode.setmaporientation(t)},getobjectgroups:function(){for(var="" e},getproperties:function(){return="" this._sgnode.getproperties()},setproperties:function(t){this._sgnode.setproperties(t)},initwithtmxfile:function(t){cc.errorid(7200)},initwithxml:function(t,e){cc.errorid(7201)},alllayers:function(){for(var="" e},getlayer:function(t){for(var="" s}return="" null},getobjectgroup:function(t){for(var="" null},getproperty:function(t){return="" this._sgnode.getproperty(t)},getpropertiesforgid:function(t){return="" this._sgnode.getpropertiesforgid(t)},onenable:function(){0="==this._detachedChildren.length&&this._moveLayersInSgNode(this._sgNode),this._super(),this._tmxFile&&this._refreshLayerEntities(),this.node.on("anchor-changed",this._anchorChanged,this),this.node.on("child-added",this._childAdded,this),this.node.on("child-reorder",this._syncChildrenOrder,this)},onDisable:function(){this._super(),this._setLayersEnabled(!1);var" _ccsg.tmxtiledmap},_initsgnode:function(){this._applyfile()},_resetsgsize:function(){this.node.setcontentsize(this._sgnode.getcontentsize()),this._sgnode.setcontentsize(0,0)},_onmaploaded:function(){this._refreshlayerentities(),this._enabled?this._anchorchanged():this._movelayersinsgnode(this._sgnode),this._setlayersenabled(this._enabled),this._resetsgsize()},_setlayersenabled:function(t){for(var="">=0;i--){var n=e[i],r=n.getComponent(cc.TiledLayer);r&&(r.enabled=t)}},_moveLayersInSgNode:function(t){this._detachedChildren.length=0;for(var e=t.getChildren(),i=e.length-1;i>=0;i--){var n=e[i];if(n instanceof _ccsg.TMXLayer||n instanceof _ccsg.TMXObjectGroup){t.removeChild(n);var r=n.getLocalZOrder();this._detachedChildren.push({sgNode:n,zorder:r})}}},_removeLayerEntities:function(){for(var t=this.node.getChildren(),e=t.length-1;e>=0;e--){var i=t[e];if(i.isValid){var n=i.getComponent(cc.TiledLayer);n&&n._tryRemoveNode();var r=i.getComponent(cc.TiledObjectGroup);r&&r._tryRemoveNode()}}},_refreshLayerEntities:function(){var t,e,i=this.node.getChildren(),n=[],r=[],s=[];for(t=0;t<this._detachedchildren.length;t++){var o="this._detachedChildren[t];this._sgNode.addChild(o.sgNode,o.zorder,o.zorder)}this._detachedChildren.length=0;var" a="this._sgNode.allLayers().map((function(t){return" t.getlayername()})),c="this._sgNode.getObjectGroups().map((function(t){return" t.getgroupname()}));for(t="i.length-1;t">=0;t--){var h=i[t],l=h.getComponent(cc.TiledLayer),u=h.getComponent(cc.TiledObjectGroup);if(l){var _=l.getLayerName();if(_||(_=h._name),a.indexOf(_)<0)l._tryremovenode();else{n.push(h);var d="this._sgNode.getLayer(_);l._replaceSgNode(d),l.enabled=!0}}else" if(u){var="" f="u.getGroupName();if(f||(f=h._name),c.indexOf(f)<0)u._tryRemoveNode();else{r.push(h);var" p="this._sgNode.getObjectGroup(f);u._replaceSgNode(p),u.enabled=p.isVisible()}}else" s.push({child:h,index:h.getsiblingindex()})}var="" m="n.map((function(t){var" e="t.getComponent(cc.TiledLayer);return" e.getlayername()}));for(t="0,e=a.length;t<e;t++){var" g="a[t],v=this._sgNode.getLayer(g),y=m.indexOf(g);if(y<0){var" x="this.node.getChildByName(g),T=null;x&&!x.getComponent(cc._SGComponent)?T=x.addComponent(cc.TiledLayer):(x=new" cc.node(g),this.node.addchild(x),t="x.addComponent(cc.TiledLayer)),x&&T||cc.errorID(7202),T._replaceSgNode(v),x.setSiblingIndex(v.getLocalZOrder()),x.setAnchorPoint(this.node.getAnchorPoint())}}var" b="r.map((function(t){var" e.getgroupname()}));for(t="0,e=c.length;t<e;t++){g=c[t];var" c="this._sgNode.getObjectGroup(g);if(y=b.indexOf(g),y<0){x=this.node.getChildByName(g);var" a="null;x&&!x.getComponent(cc._SGComponent)?A=x.addComponent(cc.TiledObjectGroup):(x=new" cc.node(g),this.node.addchild(x),a="x.addComponent(cc.TiledObjectGroup)),x&&A||cc.errorID(7202),A._replaceSgNode(C),x.setSiblingIndex(C.getLocalZOrder()),x.setAnchorPoint(this.node.getAnchorPoint()),A.enabled=C.isVisible()}}var" s="this.node.getChildren(),E=[];for(t=0,e=S.length;t<e;t++)h=S[t],l=h.getComponent(cc.TiledLayer),u=h.getComponent(cc.TiledObjectGroup),(l||u)&&E.push(h._name);var" w="[],I=[],R=this._sgNode.getChildren();for(t=0,e=R.length;t<e;t++)h=R[t],h" instanceof="" _ccsg.tmxlayer?(w.push(h.getlayername()),i.push(h)):h="" _ccsg.tmxobjectgroup&&(w.push(h.getgroupname()),i.push(h));for(t="w.length-1;t">=0;t--){var P=w[t],O=E.indexOf(P);if(t!==O){var B=this.node.getChildByName(P);B.setSiblingIndex(I[t].getLocalZOrder())}}for(t=0,e=s.length;t<e;t++)o=s[t],o.child.setsiblingindex(o.index);this._syncchildrenorder()},_anchorchanged:function(){for(var t="this.node.children,e=this.node.getAnchorPoint(),i=0,n=t.length;i<n;i++){var" r="t[i],s=r.getComponent(cc.TiledLayer);s&&r.setAnchorPoint(e)}},_childAdded:function(t){var" e="t.detail;if(e){var" i="e.getComponent(cc.TiledLayer),n=e.getComponent(cc.TiledObjectGroup);if(!i&&!n){var" n="t[e],r=n.getComponent(cc.TiledLayer),s=n.getComponent(cc.TiledObjectGroup),o=n.getSiblingIndex();r&&r._sgNode&&r._sgNode.setLocalZOrder(o),s&&s._sgNode&&s._sgNode.setLocalZOrder(o),n._sgNode&&n._sgNode.setLocalZOrder(o)}},_applyFile:function(){var" s="t.allLayers(),o=0,a=s.length;o<a;o++)t.removeChild(s[o]);var" c="t.getObjectGroups();for(o=0,a=c.length;o<a;o++)t.removeChild(c[o]);this._detachedChildren.length=0,i._removeLayerEntities()}}});cc.TiledMap=e.exports=h,cc.js.obsolete(cc.TiledMap.prototype,"cc.TiledMap.tmxFile","tmxAsset",!0),cc.js.get(cc.TiledMap.prototype,"mapLoaded",(function(){return" cc.errorid(7203),[]}),!1)}),{".="" ccsgtmxtiledmap.js":281}],287:[(function(t,e,i){var="" instanceof="" _ccsg.tmxobjectgroup?(this._sgnode="t,this._initSgNode()):this._sgNode=null)},getPositionOffset:function(){return" this._sgnode?this._sgnode.getpositionoffset():cc.p(0,0)},setpositionoffset:function(t){this._sgnode&&this._sgnode.setpositionoffset(t)},getproperties:function(){return="" this._sgnode?this._sgnode.getproperties():null},setproperties:function(t){this._sgnode&&this._sgnode.setproperties(t)},getgroupname:function(){return="" this._sgnode?this._sgnode.getgroupname():""},setgroupname:function(t){this._sgnode&&this._sgnode.setgroupname(t)},getproperty:function(t){return="" this._sgnode?this._sgnode.propertynamed(t):null},getobject:function(t){return="" this._sgnode?this._sgnode.getobject(t):null},getobjects:function(){return="" this._sgnode?this._sgnode.getobjects():[]},_tryremovenode:function(){this.node.removecomponent(cc.tiledobjectgroup),1="==this.node._components.length&&0===this.node.getChildren().length&&this.node.removeFromParent()}});cc.TiledObjectGroup=e.exports=n}),{"./CCSGTMXObjectGroup.js":280}],289:[(function(t,e,i){t("./cocos2d/core"),t("./cocos2d/animation"),t("./cocos2d/particle/CCParticleAsset"),t("./cocos2d/particle/CCParticleSystem"),t("./cocos2d/motion-streak/CCMotionStreak"),t("./cocos2d/tilemap/CCTiledMapAsset"),cc.runtime||(t("./cocos2d/tilemap/CCTiledMap"),t("./cocos2d/tilemap/CCTiledLayer")," t(".="" cocos2d="" tilemap="" cctiledobjectgroup")),t(".="" core="" components="" ccstudiocomponent"),t(".="" extensions="" spine"),cc.runtime||t(".="" dragonbones"),t(".="" ccpool="" ccnodepool"),t(".="" ccpool"),t(".="" actions"),t(".="" external="" chipmunk="" chipmunk"),t(".="" deprecated")}),{".="" actions":10,".="" animation":19,".="" core":124,".="" ccstudiocomponent":95,".="" deprecated":239,".="" motion-streak="" ccmotionstreak":254,".="" particle="" ccparticleasset":258,".="" ccparticlesystem":262,".="" cctiledlayer":285,".="" cctiledmap":286,".="" cctiledmapasset":287,".="" cctiledobjectgroup":288,".="" ccnodepool":290,".="" ccpool":291,".="" dragonbones":299,".="" spine":308,".="" chipmunk":311}],290:[(function(t,e,i){cc.nodepool="function(t){this.poolHandlerComp=t,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return" this._pool.length},clear:function(){for(var="" null;var="" i&&i.reuse&&i.reuse.apply(i,arguments),e}},e.exports="cc.NodePool}),{}],291:[(function(t,e,i){var" 0!="=t._running&&!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var" s.reuse&&s.reuse.apply(s,n),n.length="0,s}},drainAllPools:function(){this._pool={}}}}),{}],292:[(function(t,e,i){var">":0});dragonBones.ArmatureDisplay=cc.Class({name:"dragonBones.ArmatureDisplay",extends:cc._RendererUnderSG,editor:!1,properties:{_factory:{default:null,type:dragonBones.CCFactory,serializable:!1},_dragonBonesData:{default:null,type:dragonBones.DragonBonesData,serializable:!1},dragonAsset:{default:null,type:dragonBones.DragonBonesAsset,notify:function(){this._parseDragonAsset(),this._refresh()},tooltip:!1},dragonAtlasAsset:{default:null,type:dragonBones.DragonBonesAtlasAsset,notify:function(){this._parseDragonAtlasAsset(),this._refreshSgNode()},tooltip:!1},_armatureName:"",armatureName:{get:function(){return this._armatureName},set:function(t){this._armatureName=t;var e=this.getAnimationNames(this._armatureName);(!this.animationName||e.indexOf(this.animationName)<0)&&(this.animationname=""),this._refresh()},visible:!1},_animationname:"",animationname:{get:function(){return this._animationname},set:function(t){this._animationname="t},visible:!1},_defaultArmatureIndex:{default:0,notify:function(){var" t="" ;if(this.dragonasset){var="" e;if(this.dragonasset&&(e="this.dragonAsset.getArmatureEnum()),!e)return" cc.errorid(7400,this.name);t="e[this._defaultArmatureIndex]}void" 0!="=t?this.armatureName=t:cc.errorID(7401,this.name)},type:n,visible:!0,editorOnly:!0,displayName:"Armature",tooltip:!1},_animationIndex:{default:0,notify:function(){if(0===this._animationIndex)return" void(this.animationname="" );var="" t;if(this.dragonasset&&(t="this.dragonAsset.getAnimsEnum(this.armatureName)),t){var" e="t[this._animationIndex];void" this.dragonasset&&this.dragonatlasasset&&this.armaturename?this._factory.buildarmaturedisplay(this.armaturename,this._dragonbonesdata.name):null},_initsgnode:function(){var="" void(this._dragonbonesdata="e);this._dragonBonesData=this._factory.parseDragonBonesData(t)}},_parseDragonAtlasAsset:function(){if(this.dragonAtlasAsset){var">0)for(var s in n){var o=n[s];if(o&&o.texture&&o.texture.url===r){i=o;break}}var a=cc.textureCache.getTextureForKey(r);i?i.texture=a:this._factory.parseTextureAtlasData(t,a)}},_refreshSgNode:function(){var t=this,e=null;t._sgNode&&(e=t._sgNode._bubblingListeners,t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var i=t._sgNode=t._createSgNode();i&&(t.enabledInHierarchy||i.setVisible(!1),e&&(i._bubblingListeners=e),t._initSgNode(),t._appendSgNode(i),t._registSizeProvider())},_refresh:function(){this._refreshSgNode()},_updateAnimEnum:!1,_updateArmatureEnum:!1,playAnimation:function(t,e){return this._sgNode?(this.playTimes=void 0===e?-1:e,this.animationName=t,this._sgNode.animation().play(t,this.playTimes)):null},getArmatureNames:function(){return this._dragonBonesData?this._dragonBonesData.armatureNames:[]},getAnimationNames:function(t){var e=[];if(this._dragonBonesData){var i=this._dragonBonesData.getArmature(t);if(i)for(var n in i.animations)i.animations.hasOwnProperty(n)&&e.push(n)}return e},addEventListener:function(t,e,i){this._sgNode&&this._sgNode.addEvent(t,e,i)},removeEventListener:function(t,e,i){this._sgNode&&this._sgNode.removeEvent(t,e,i)},buildArmature:function(t){return this._factory?this._factory.buildArmature(t):null},armature:function(){return this._sgNode?this._sgNode.armature():null}})}),{}],293:[(function(t,e,i){var n=t("../../cocos2d/core/event/event-target");dragonBones.CCArmatureDisplay=cc.Class({name:"dragonBones.CCArmatureDisplay",extends:_ccsg.Node,mixins:[n],_armature:null,_debugDrawer:null,_onClear:function(){this._armature=null},_dispatchEvent:function(t){this.emit(t.type,t)},_debugDraw:function(){if(this._armature){this._debugDrawer||(this._debugDrawer=new cc.DrawNode,this.addChild(this._debugDrawer),this._debugDrawer.setDrawColor(cc.color(255,0,0,255)),this._debugDrawer.setLineWidth(1)),this._debugDrawer.clear();for(var t=this._armature.getBones(),e=0,i=t.length;e<i;++e){var n="t[e],r=Math.max(n.length,5),s=n.globalTransformMatrix.tx,o=-n.globalTransformMatrix.ty,a=s+n.globalTransformMatrix.a*r,c=o-n.globalTransformMatrix.b*r;this._debugDrawer.drawSegment(cc.p(s,o),cc.p(a,c))}}},update:function(t){this._armature&&this._armature.advanceTime(t)},advanceTimeBySelf:function(t){t?this.scheduleUpdate():this.unscheduleUpdate()},hasEvent:function(t){return" this.haseventlistener(t,!1)},addevent:function(t,e,i){this.on(t,e,i)},removeevent:function(t,e,i){this.off(t,e,i)},dispose:function(){this._armature&&(this.advancetimebyself(!1),this._armature.dispose(),this._armature="null)},armature:function(){return" this._armature},animation:function(){return="" this._armature.animation},setdebugbones:function(t){dragonbones.dragonbones.debugdraw="t,t?this.armature().advanceTime(0):this._debugDrawer&&this._debugDrawer.clear()}})}),{"../../cocos2d/core/event/event-target":112}],294:[(function(t,e,i){var" r&&r.advancetimebyself(!0),r},_generatetextureatlasdata:function(t,e){return="" t||(t="n.borrowObject(dragonBones.CCTextureAtlasData)),t.texture=e,t},_generateArmature:function(t){var" e="n.borrowObject(dragonBones.Armature),i=new" dragonbones.ccarmaturedisplay;return="" e._armaturedata="t.armature,e._skinData=t.skin,e._animation=n.borrowObject(dragonBones.Animation),e._display=i,i.setCascadeOpacityEnabled(!0),i.setCascadeColorEnabled(!0),i._armature=e,e._animation._armature=e,e.animation.animations=t.armature.animations,e},_generateSlot:function(t,e){var" i="n.borrowObject(dragonBones.CCSlot),r=e.slot,s=[];i.name=r.name,i._rawDisplay=new" cc.scale9sprite,i._rawdisplay.setrenderingtype(cc.scale9sprite.renderingtype.simple),i._rawdisplay.setanchorpoint(cc.p(0,0)),i._meshdisplay="i._rawDisplay;for(var" o="0,a=e.displays.length;o<a;++o){var" c="e.displays[o];switch(c.type){case" dragonbones.displaytype.image:c.texture||(c.texture="this._getTextureData(t.dataName,c.name)),s.push(i._rawDisplay);break;case" dragonbones.displaytype.mesh:c.texture||(c.texture="this._getTextureData(t.dataName,c.name)),cc._renderType===cc.game.RENDER_TYPE_WEBGL?(i._meshDisplay.setRenderingType(cc.Scale9Sprite.RenderingType.MESH),s.push(i._meshDisplay)):cc.warnID(6200);break;case" dragonbones.displaytype.armature:var="" h="this.buildArmature(c.name,t.dataName);if(h){if(!i.inheritAnimation){var" l="r.actions.length">0?r.actions:h.armatureData.actions;if(l.length>0)for(var u=0,_=l.length;u<_;++u)h._bufferaction(l[u]);else h.animation.play()}c.armature="h.armatureData}s.push(h);break;default:s.push(null)}}return" i._setdisplaylist(s),i._rawdisplay.setlocalzorder(r.zorder),i},gettexturedisplay:function(t,e){var="" i="this._getTextureData(e,t);if(i){if(!i.texture){var" n="i.parent.texture,r=cc.rect(i.region.x,i.region.y,i.region.width,i.region.height),s=cc.p(0,0),o=cc.size(i.region.width,i.region.height);i.texture=new" cc.spriteframe,i.texture.settexture(n,r,i.rotated,s,o)}var="" a="new" cc.scale9sprite;return="" a.initwithspriteframe(i.texture),a}return="" null}}),dragonbones.ccfactory._factory="null,dragonBones.CCFactory.getFactory=function(){return" dragonbones.ccfactory._factory||(dragonbones.ccfactory._factory="new" dragonbones.ccfactory),dragonbones.ccfactory._factory}}),{}],295:[(function(t,e,i){dragonbones.ccslot="cc.Class({name:"dragonBones.CCSlot",extends:dragonBones.Slot,_renderDisplay:null,statics:{toString:function(){return"[class" dragonbones.ccslot]"}},_onclear:function(){dragonbones.slot.prototype._onclear.call(this),this._renderdisplay="null},_onUpdateDisplay:function(){this._rawDisplay||(this._rawDisplay=new" cc.scale9sprite),this._renderdisplay="this._display||this._rawDisplay},_initDisplay:function(t){},_addDisplay:function(){var" t="this._armature._display;t.addChild(this._renderDisplay)},_replaceDisplay:function(t){var" e="this._armature._display,i=t;e.addChild(this._renderDisplay,i.getLocalZOrder()),e.removeChild(i)},_removeDisplay:function(){this._renderDisplay.removeFromParent()},_disposeDisplay:function(t){},_updateVisible:function(){this._renderDisplay.setVisible(this._parent.visible)},_updateZOrder:function(){if(this._renderDisplay._parent)this._renderDisplay.setLocalZOrder(this._zOrder);else{var" instanceof="" cc.scale9sprite)switch(this._blendmode){case="" 0:break;case="" 1:var="" if(this._childarmature)for(var="" r="e[i];r._blendMode=this._blendMode,r._updateBlendMode()}},_updateColor:function(){this._renderDisplay.setOpacity(255*this._colorTransform.alphaMultiplier);var">=0){var t=this._displayIndex<this._displaydataset.displays.length?this._displaydataset.displays[this._displayindex]:null,e=this._displayindex<this._replaceddisplaydataset.length?this._replaceddisplaydataset[this._displayindex]:null,i=e||t,n=i.texture;if(n){var r="n.parent.texture;if(r&&(!n.texture||n.texture.getTexture()!==r)){var" s="cc.rect(n.region.x,n.region.y,n.region.width,n.region.height),o=cc.p(0,0),a=cc.size(n.region.width,n.region.height);n.texture=new" cc.spriteframe,n.texture.settexture(r,s,!1,o,a)}var="" c="this._armature._replacedTexture||(n.texture?n.texture.getTexture():null);if(this._meshData&&this._display===this._meshDisplay){var" h="n.region,l=n.texture.getTexture().getContentSize(),u=[],_=[],d=cc.rect(999999,999999,-999999,-999999);this._meshData!==t.mesh&&t&&t!==i?(this._pivotX=t.transform.x-i.transform.x,this._pivotY=t.transform.y-i.transform.y):(this._pivotX=0,this._pivotY=0);var" f,p;for(f="0,p=this._meshData.uvs.length;f<p;f+=2){var" m="this._meshData.vertices[f],g=this._meshData.vertices[f+1],v=(h.x+this._meshData.uvs[f]*h.width)/l.width,y=(h.y+this._meshData.uvs[f+1]*h.height)/l.height;u.push({x:m,y:-g,u:v,v:y}),d.x">m&&(d.x=m),d.width<m&&(d.width=m),d.y>-g&&(d.y=-g),d.height<-g&&(d.height=-g)}for(d.width-=d.x,d.height-=d.y,f=0,p=this._meshdata.vertexindices.length;f<p;++f)_.push(this._meshdata.vertexindices[f]);var x="{triangles:{verts:u,indices:_},rect:d};this._meshDisplay.setSpriteFrame(n.texture),c!=n.texture.getTexture()&&this._meshDisplay.setTexture(c),this._meshDisplay.setMeshPolygonInfo(x),this._meshDisplay.setContentSize(cc.size(d.width,d.height)),this._meshData.skinned&&(this._meshDisplay.setScale(1,1),this._meshDisplay.setRotationX(0),this._meshDisplay.setRotationY(0),this._meshDisplay.setPosition(0,0)),this._meshDisplay.setAnchorPoint(cc.p(0,0))}else{var" t="this._armature.armatureData.scale;if(this._pivotX=i.pivot.x,this._pivotY=i.pivot.y,i.isRelativePivot){var" b="n.frame||n.region,C=b.width*T,A=b.height*T;!n.frame&&n.rotated&&(C=b.height,A=b.width),this._pivotX*=C,this._pivotY*=A}n.frame&&(this._pivotX+=n.frame.x*T,this._pivotY+=n.frame.y*T),t&&t!==i&&(this._pivotX+=t.transform.x-i.transform.x,this._pivotY+=t.transform.y-i.transform.y),this._pivotY-=n.region.height*T,this._rawDisplay.setSpriteFrame(n.texture),this._rawDisplay.setContentSize(n.texture.getOriginalSize()),c!==n.texture.getTexture()&&this._rawDisplay.setTexture(c),this._blendModeDirty=!0}return" void="" this._updatevisible()}}this._pivotx="0,this._pivotY=0,this._rawDisplay.setTexture(null),this._rawDisplay.setVisible(!1),this._rawDisplay.setPosition(this.origin.x,this.origin.y)},_updateMesh:function(){var" i,n,r="this._ffdVertices.length">0,s=e.triangles.verts,o=cc.rect(999999,999999,-999999,-999999),a=0,c=0,h=0;if(this._meshData.skinned){var l=0;for(i=0,n=this._meshData.vertices.length;i<n;i+=2){a=math.floor(i 2);var="" u="this._meshData.boneIndices[a],_=this._meshData.boneVertices[a],d=this._meshData.weights[a];c=0,h=0;for(var" f="0,p=u.length;f<p;++f){var" m="this._meshBones[u[f]],g=m.globalTransformMatrix,v=d[f],y=0,x=0;r?(y=_[2*f]+this._ffdVertices[l],x=_[2*f+1]+this._ffdVertices[l+1]):(y=_[2*f],x=_[2*f+1]),c+=(g.a*y+g.c*x+g.tx)*v,h+=(g.b*y+g.d*x+g.ty)*v,l+=2}s[a].x=c,s[a].y=-h,o.x">c&&(o.x=c),o.width<c&&(o.width=c),o.y>-h&&(o.y=-h),o.height<-h&&(o.height=-h)}}else if(r){var="" t="this._meshData.vertices;for(i=0,n=this._meshData.vertices.length;i<n;i+=2)a=Math.floor(i/2),c=T[i]+this._ffdVertices[i],h=T[i+1]+this._ffdVertices[i+1],s[a].x=c,s[a].y=-h,o.x">c&&(o.x=c),o.width<c&&(o.width=c),o.y>-h&&(o.y=-h),o.height<-h&&(o.height=-h)}o.width-=o.x,o.height-=o.y,e.rect=o;var b="t.getNodeToParentTransform();t.setContentSize(cc.size(o.width,o.height)),t.setMeshPolygonInfo(e),this._renderDisplay._renderCmd.setNodeToParentTransform(b)}},_updateTransform:function(){var" t="{a:this.globalTransformMatrix.a,b:-this.globalTransformMatrix.b,c:-this.globalTransformMatrix.c,d:this.globalTransformMatrix.d,tx:this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),ty:-(this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY))};this._renderDisplay._renderCmd.setNodeToParentTransform(t)}})}),{}],296:[(function(t,e,i){dragonBones.CCTextureAtlasData=cc.Class({name:"dragonBones.CCTextureAtlasData",extends:dragonBones.TextureAtlasData,texture:null,statics:{toString:function(){return"[class" dragonbones.cctextureatlasdata]"}},_onclear:function(){dragonbones.textureatlasdata.prototype._onclear.call(this),this.texture="null},generateTextureData:function(){return" dragonbones.baseobject.borrowobject(dragonbones.cctexturedata)}}),dragonbones.cctexturedata="cc.Class({name:"dragonBones.CCTextureData",extends:dragonBones.TextureData,texture:null,statics:{toString:function(){return"[class" dragonbones.cctexturedata]"}},_onclear:function(){dragonbones.texturedata.prototype._onclear.call(this),this.texture&&(this.texture.dispose(),this.texture="null)}})}),{}],297:[(function(t,e,i){var" n="cc.Class({name:"dragonBones.DragonBonesAsset",extends:cc.Asset,properties:{_dragonBonesJson:"",dragonBonesJson:{get:function(){return" this._dragonbonesjson},set:function(t){this._dragonbonesjson="t,this.reset()}}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){},getRuntimeData:!1,getArmatureEnum:!1,getAnimsEnum:!1});dragonBones.DragonBonesAsset=e.exports=n}),{}],298:[(function(t,e,i){var" this._atlasjson},set:function(t){this._atlasjson="t}},texture:{default:"",url:cc.Texture2D}},statics:{preventDeferredLoadDependents:!0},createNode:!1});dragonBones.DragonBonesAtlasAsset=e.exports=n}),{}],299:[(function(t,e,i){dragonBones=t("./lib/dragonBones"),dragonBones.DisplayType={Image:0,Armature:1,Mesh:2},dragonBones.ArmatureType={Armature:0,MovieClip:1,Stage:2},dragonBones.ExtensionType={FFD:0,AdjustColor:10,BevelFilter:11,BlurFilter:12,DropShadowFilter:13,GlowFilter:14,GradientBevelFilter:15,GradientGlowFilter:16},dragonBones.EventType={Frame:0,Sound:1},dragonBones.ActionType={Play:0,Stop:1,GotoAndPlay:2,GotoAndStop:3,FadeIn:4,FadeOut:5},dragonBones.AnimationFadeOutMode={None:0,SameLayer:1,SameGroup:2,SameLayerAndGroup:3,All:4},t("./CCFactory"),t("./CCSlot"),t("./CCTextureData"),t("./CCArmatureDisplay"),t("./DragonBonesAsset"),t("./DragonBonesAtlasAsset"),t("./ArmatureDisplay")}),{"./ArmatureDisplay":292,"./CCArmatureDisplay":293,"./CCFactory":294,"./CCSlot":295,"./CCTextureData":296,"./DragonBonesAsset":297,"./DragonBonesAtlasAsset":298,"./lib/dragonBones":300}],300:[(function(t,e,i){var" n,r="this&&this.__extends||function(t,e){function" i(){this.constructor="t}for(var" in="" e)e.hasownproperty(n)&&(t[n]="e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new" i)};!(function(t){var="" e="(function(){function" t(){}return="" t.hasarmature="function(e){return" t._armatures.indexof(e)="">=0},t.addArmature=function(e){e&&t._armatures.indexOf(e)<0&&t._armatures.push(e)},t.removearmature=function(e){if(e){var i="t._armatures.indexOf(e);i">=0&&t._armatures.splice(i,1)}},t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.SECOND_TO_MILLISECOND=1e3,t.NO_TWEEN=100,t.VERSION="4.7.2",t.debug=!1,t.debugDraw=!1,t._armatures=[],t})();t.DragonBones=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(){this.hashCode=t._hashCode++}return t._returnObject=function(e){var i=String(e.constructor),n=null==t._maxCountMap[i]?t._defaultMaxCount:t._maxCountMap[i],r=t._poolsMap[i]=t._poolsMap[i]||[];if(r.length<n){if(!(r.indexof(e)<0))throw new="" error;r.push(e)}},t.setmaxcount="function(e,i){if((i<0||i!=i)&&(i=0),e){var" n="String(e);t._maxCountMap[n]=i;var" r="t._poolsMap[n];r&&r.length">i&&(r.length=i)}else{t._defaultMaxCount=i;for(var n in t._poolsMap)if(null!=t._maxCountMap[n]){t._maxCountMap[n]=i;var r=t._poolsMap[n];r.length>i&&(r.length=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var i=t._poolsMap[String(e)];i&&i.length&&(i.length=0)}else for(var n in t._poolsMap){var i=t._poolsMap[n];i.length=0}},t.borrowObject=function(e){var i=t._poolsMap[String(e)];if(i&&i.length)return i.pop();var n=new e;return n._onClear(),n},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=5e3,t._maxCountMap={},t._poolsMap={},t})();t.BaseObject=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e,i,n,r,s,o,a){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=n,this.alphaOffset=r,this.redOffset=s,this.greenOffset=o,this.blueOffset=a}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t})();t.ColorTransform=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t})();t.Point=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e,i,n,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=s}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty},t.prototype.identity=function(){this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0},t.prototype.concat=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,s=this.tx,o=this.ty,a=t.a,c=t.b,h=t.c,l=t.d,u=t.tx,_=t.ty;this.a=e*a+i*h,this.b=e*c+i*l,this.c=n*a+r*h,this.d=n*c+r*l,this.tx=a*s+h*o+u,this.ty=l*o+c*s+_},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,s=this.ty,o=t*n-e*i;this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*s-n*r)/o,this.ty=-(t*s-e*r)/o},t.prototype.transformPoint=function(t,e,i,n){void 0===n&&(n=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,n||(i.x+=this.tx,i.y+=this.ty)},t})();t.Matrix=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t})();t.Rectangle=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e,i,n,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===s&&(s=1),this.x=t,this.y=e,this.skewX=i,this.skewY=n,this.scaleX=r,this.scaleY=s}return t.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},t.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},t.prototype.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},t.prototype.minus=function(e){return this.x-=e.x,this.y-=e.y,this.skewX=t.normalizeRadian(this.skewX-e.skewX),this.skewY=t.normalizeRadian(this.skewY-e.skewY),this.scaleX/=e.scaleX,this.scaleY/=e.scaleY,this},t.prototype.fromMatrix=function(t){var e=.25*Math.PI,i=this.scaleX,n=this.scaleY;return this.x=t.tx,this.y=t.ty,this.skewX=Math.atan(-t.c/t.d),this.skewY=Math.atan(t.b/t.a),this.skewX!=this.skewX&&(this.skewX=0),this.skewY!=this.skewY&&(this.skewY=0),this.scaleY=this.skewX>-e&&this.skewX<e?t.d math.cos(this.skewx):-t.c="" math.sin(this.skewx),this.scalex="this.skewY">-e&&this.skewY<e?t.a math.cos(this.skewy):t.b="" math.sin(this.skewy),i="">=0&&this.scaleX<0&&(this.scalex=-this.scalex,this.skewy=this.skewy-math.pi),n>=0&&this.scaleY<0&&(this.scaley=-this.scaley,this.skewx=this.skewx-math.pi),this},t.prototype.tomatrix=function(t){return t.a="this.scaleX*Math.cos(this.skewY),t.b=this.scaleX*Math.sin(this.skewY),t.c=-this.scaleY*Math.sin(this.skewX),t.d=this.scaleY*Math.cos(this.skewX),t.tx=this.x,t.ty=this.y,this},Object.defineProperty(t.prototype,"rotation",{get:function(){return" this.skewy},set:function(t){var="" e="t-this.skewY;this.skewX+=e,this.skewY+=e},enumerable:!0,configurable:!0}),t})();t.Transform=e})(n||(n={}));var" n;!(function(t){var="" e(){t.call(this)}return="" r(e,t),e.prototype._onclear="function(){this._isCompleted=!1,this._currentPlayTimes=0,this._currentTime=-1,this._timeline=null,this._isReverse=!1,this._hasAsynchronyTimeline=!1,this._frameRate=0,this._keyFrameCount=0,this._frameCount=0,this._position=0,this._duration=0,this._animationDutation=0,this._timeScale=1,this._timeOffset=0,this._currentFrame=null,this._armature=null,this._animationState=null},e.prototype._onUpdateFrame=function(t){},e.prototype._onArriveAtFrame=function(t){},e.prototype._setCurrentTime=function(t){var">=0,i=1;else if(e._hasAsynchronyTimeline){var n=e._animationState.playTimes,r=n*e._duration;t*=e._timeScale,0!=e._timeOffset&&(t+=e._timeOffset*e._animationDutation),n>0&&(t>=r||t<=-r)?(e._iscompleted=!0,i=n,t=t<0?0:e._duration):(e._iscompleted=!1,t<0?(i=math.floor(-t e._duration),t="e._duration-" -t%e._duration):(i="Math.floor(t/e._duration),t%=e._duration),n">0&&i>n&&(i=n)),t+=e._position}else e._isCompleted=e._animationState._timeline._isCompleted,i=e._animationState._timeline._currentPlayTimes;return e._currentTime!=t&&(e._isReverse=e._currentTime>t&&e._currentPlayTimes==i,e._currentTime=t,e._currentPlayTimes=i,e._animationState._onFadeInComplete&&(e._currentFrame=null),!0)},e.prototype.fadeIn=function(t,e,i,n){this._armature=t,this._animationState=e,this._timeline=i;var r=this==this._animationState._timeline;this._hasAsynchronyTimeline=r||this._animationState.animationData.hasAsynchronyTimeline,this._frameRate=this._armature.armatureData.frameRate,this._keyFrameCount=this._timeline.frames.length,this._frameCount=this._animationState.animationData.frameCount,this._position=this._animationState._position,this._duration=this._animationState._duration,this._animationDutation=this._animationState.animationData.duration,this._timeScale=r?1:1/this._timeline.scale,this._timeOffset=r?0:this._timeline.offset},e.prototype.fadeOut=function(){},e.prototype.update=function(t){var e=this;if(!e._isCompleted&&e._setCurrentTime(t)){var i=e._keyFrameCount>1?Math.floor(e._currentTime*e._frameRate):0,n=e._timeline.frames[i];e._currentFrame!=n&&(e._currentFrame=n,e._onArriveAtFrame(!0)),e._onUpdateFrame(!0)}},e})(t.BaseObject);t.TimelineState=e;var i=(function(e){function i(){e.call(this)}return r(i,e),i._getEasingValue=function(t,e){if(t<=0)return 0;if(t="">=1)return 1;var i=1;if(e>2)return t;if(e>1)i=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)i=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,i=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,i=Math.acos(1-2*t)/Math.PI,e-=1}return(i-t)*e+t},i._getEasingCurveValue=function(t,e){if(t<=0)return 0;if(t="">=1)return 1;var i=e.length+1,n=Math.floor(t*i),r=0==n?0:e[n-1],s=n==i-1?1:e[n];return r+(s-r)*(t-n/i)},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},i.prototype._onArriveAtFrame=function(e){var i=this;i._tweenEasing=i._currentFrame.tweenEasing,i._curve=i._currentFrame.curve,(i._keyFrameCount<=1||i._currentframe.next==i._timeline.frames[0]&&(i._tweeneasing!=t.dragonbones.no_tween||i._curve)&&i._animationstate.playtimes>0&&i._animationState.currentPlayTimes==i._animationState.playTimes-1)&&(i._tweenEasing=t.DragonBones.NO_TWEEN,i._curve=null)},i.prototype._onUpdateFrame=function(e){var n=this;n._tweenEasing!=t.DragonBones.NO_TWEEN?(n._tweenProgress=(n._currentTime-n._currentFrame.position+n._position)/n._currentFrame.duration,0!=n._tweenEasing&&(n._tweenProgress=i._getEasingValue(n._tweenProgress,n._tweenEasing))):n._curve?(n._tweenProgress=(n._currentTime-n._currentFrame.position+n._position)/n._currentFrame.duration,n._tweenProgress=i._getEasingCurveValue(n._tweenProgress,n._curve)):n._tweenProgress=0},i.prototype._updateExtensionKeyFrame=function(t,e,i){var n=0;if(t.type==e.type)for(var r=0,s=t.tweens.length;r<s;++r){var o="e.tweens[r]-t.tweens[r];i.tweens[r]=o,o">0&&(n=2)}if(0==n){i.type!=t.type&&(n=1,i.type=t.type),i.tweens.length!=t.tweens.length&&(n=1,i.tweens.length=t.tweens.length),i.keys.length!=t.keys.length&&(n=1,i.keys.length=t.keys.length);for(var r=0,s=t.keys.length;r<s;++r){var a="t.keys[r];i.keys[r]!=a&&(n=1,i.keys[r]=a)}}return" n},i})(e);t.tweentimelinestate="i})(n||(n={}));var" n;!(function(t){var="" e="(function(e){function" i(){e.call(this),this._animations="{},this._animationNames=[],this._animationStates=[]}return" r(i,e),i._sortanimationstate="function(t,e){return" t.layer="">e.layer?-1:1},i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t in this._animations)delete this._animations[t];for(var t=0,e=this._animationStates.length;t<e;++t)this._animationstates[t].returntopool();this.timescale=1,this._animationstatedirty=!1,this._armature=null,this._isplaying=!1,this._time=0,this._duration=0,this._lastanimationstate=null,this._animationnames.length=0,this._animationstates.length=0},i.prototype._fadeout=function(t,e,i,n,r){var s="0,o=this._animationStates.length,a=null;switch(n){case" 1:for(;s<o;++s)a="this._animationStates[s],a.layer==e&&a.fadeOut(t,r);break;case" 2:for(;s<o;++s)a="this._animationStates[s],a.group==i&&a.fadeOut(t,r);break;case" 4:for(;s<o;++s)a="this._animationStates[s],0==t?a.returnToPool():a.fadeOut(t,r);0==t&&(this._animationStates.length=0);break;case" 3:for(;s<o;++s)a="this._animationStates[s],a.layer==e&&a.group==i&&a.fadeOut(t,r);break;case" 0:}},i.prototype._updateffdtimelinestates="function(){for(var" t="0,e=this._animationStates.length;t<e;++t)this._animationStates[t]._updateFFDTimelineStates()},i.prototype._advanceTime=function(t){var" e="this;if(e._isPlaying){t<0&&(t=-t);var" i="e._animationStates.length;if(1==i){var" n="e._animationStates[0];n._fadeState">0&&n._fadeProgress<=0?(n.returntopool(),e._animationstates.length=0,e._animationstatedirty=!0,e._lastanimationstate=null):n._advancetime(t,1,0); }else="" if(i="">1)for(var r=e._animationStates[0]._layer,s=1,o=0,a=1,c=0,h=0;c<i;++c){var n="e._animationStates[c];n._fadeState">0&&n._fadeProgress<=0?(h++,n.returntopool(),e._animationstatedirty=!0,e._lastanimationstate==n&&(c-h>=0?e._lastAnimationState=e._animationStates[c-h]:e._lastAnimationState=null)):(h>0&&(e._animationStates[c-h]=n),r!=n._layer&&(r=n._layer,o>=s?s=0:s-=o,o=0),n._advanceTime(t,s,a),n._weightResult>0&&(o+=n._weightResult,a++)),c==i-1&&h>0&&(e._animationStates.length-=h)}}},i.prototype.reset=function(){for(var t=0,e=this._animationStates.length;t<e;++t)this._animationstates[t].returntopool();this._isplaying=!1,this._lastanimationstate=null,this._animationstates.length=0},i.prototype.stop=function(t){if(void 0="==t&&(t=null),t){var" e="this.getState(t);e&&e.stop()}else" this._isplaying="!1},i.prototype.play=function(t,e){void" i="null;if(t)i=this.fadeIn(t,0,e,0,null,4);else" if(this._lastanimationstate)this._isplaying&&(this._lastanimationstate.isplaying||this._lastanimationstate.iscompleted)?i="this.fadeIn(this._lastAnimationState.name,0,e,0,null,4):(this._isPlaying=!0,this._lastAnimationState.play());else{var" n="this._armature.armatureData.defaultAnimation;n&&(i=this.fadeIn(n.name,0,e,0,null,4))}return" i},i.prototype.fadein="function(e,n,r,s,o,a,c,h,l,u){void" _="this._animations[e];if(!_)return" this._time="0,this._duration=0,console.warn("Non-existent" animation.","dragonbones:="" "+this._armature.armaturedata.parent.name,"armature:="" "+this._armature.name,"animation:="" "+e),null;this._isplaying="!0,this._time!=this._time&&(this._time=0),this._duration!=this._duration&&(this._duration=0),(n!=n||n<0)&&(n=this._lastAnimationState?_.fadeInTime:0),r<0&&(r=_.playTimes),this._fadeOut(n,s,o,a,l);var" d="this._duration">0?0:this._time,f=this._duration>0?this._time:_.position,p=this._duration>0?this._duration:_.duration;this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._layer=s,this._lastAnimationState._group=o,this._lastAnimationState.additiveBlending=c,this._lastAnimationState.displayControl=h,this._lastAnimationState._fadeIn(this._armature,_.animation||_,e,r,f,p,d,1/_.scale,n,u),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._time=0,this._duration=0,this._armature._cacheFrameIndex=-1,this._animationStates.length>1&&this._animationStates.sort(i._sortAnimationState);for(var m=this._armature.getSlots(),g=0,v=m.length;g<v;++g){var 0="==e&&(e=0),void" y="m[g];if(y.inheritAnimation){var" x="y.childArmature;x&&x.animation.hasAnimation(e)&&!x.animation.getState(e)&&x.animation.fadeIn(e)}}return" n<="0&&this._armature.advanceTime(0),this._lastAnimationState},i.prototype.gotoAndPlayByTime=function(t,e,i,n){void" r="this._animations[t];return" r&&(this._time="e,this._duration=n-e,this._duration<0?this._duration=0:this._duration">r.duration-this._time&&(this._duration=r.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndPlayByFrame=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=-1),void 0===n&&(n=0);var r=this._animations[t];return r&&(this._time=r.duration*e/r.frameCount,this._duration<0?this._duration=0:this._duration>r.duration-this._time&&(this._duration=r.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndPlayByProgress=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=-1),void 0===n&&(n=0);var r=this._animations[t];return r&&(this._time=r.duration*(e>0?e:0),this._duration<0?this._duration=0:this._duration>r.duration-this._time&&(this._duration=r.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return i&&i.stop(),i},i.prototype.getState=function(t){for(var e=0,i=this._animationStates.length;e<i;++e){var n="this._animationStates[e];if(n.name==t)return" n}return="" null},i.prototype.hasanimation="function(t){return" null!="this._animations[t]},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return" this._animationstates.length="">1?this._isPlaying&&!this.isCompleted:this._lastAnimationState?this._isPlaying&&this._lastAnimationState.isPlaying:this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;t<e;++t)if(!this._animationstates[t].iscompleted)return!1;return!0}return!1},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"lastanimationname",{get:function(){return 0="==e&&(e=-1),void" this._lastanimationstate?this._lastanimationstate.name:null},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"lastanimationstate",{get:function(){return="" this._lastanimationstate},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"animationnames",{get:function(){return="" this._animationnames},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"animations",{get:function(){return="" this._animations},set:function(t){if(this._animations!="t){for(var" e="" in="" this._animations)delete="" this._animations[e];if(this._animationnames.length="0,t)for(var" t)this._animations[e]="t[e],this._animationNames.push(e)}},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,n,r,s,o,a,c){void" h="this.fadeIn(t,e,n,r,s,o,!1,!0,a,c);return" h&&i&&i="">0&&(h.timeScale=h.totalTime/i),h},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){for(var t=[],e=0,i=this._animationNames.length;e<i;++e)t.push(this._animations[this._animationnames[e]]);return t},enumerable:!0,configurable:!0}),i})(t.baseobject);t.animation="e})(n||(n={}));var" n;!(function(t){var="" e="(function(e){function" i(){e.call(this),this._bonemask="[],this._boneTimelines=[],this._slotTimelines=[],this._ffdTimelines=[],this.autoTween=!1}return" r(i,e),i.tostring="function(){return"[class" dragonbones.animationstate]"},i.prototype._onclear="function(){for(var" t="0,e=this._boneTimelines.length;t<e;++t)this._boneTimelines[t].returnToPool();for(var" i="{},n={},r=0,s=this._boneTimelines.length;r<s;++r){var" o="this._boneTimelines[r];i[o.bone.name]=o}for(var" a="this._armature.getBones(),r=0,s=a.length;r<s;++r){var" c="a[r],h=c.name,l=this._animationData.getBoneTimeline(h);if(l&&this.containsBoneMask(h)){var" i[h]:(o="t.BaseObject.borrowObject(t.BoneTimelineState),o.bone=c,o.fadeIn(this._armature,this,l,e),this._boneTimelines.push(o))}}for(var" r="" in="" i){var="" u="this._slotTimelines[r];n[u.slot.name]=u}for(var" _="this._armature.getSlots(),r=0,s=_.length;r<s;++r){var" d="_[r],f=d.name,p=d.parent.name,m=this._animationData.getSlotTimeline(f);if(m&&this.containsBoneMask(p)&&this._fadeState<=0){var" n[f]:(u="t.BaseObject.borrowObject(t.SlotTimelineState),u.slot=d,u.fadeIn(this._armature,this,m,e),this._slotTimelines.push(u))}}for(var" n){var="" n="0;if(n=i._fadeTime">=i.fadeTotalTime?i._fadeState>0?0:1:i._fadeTime>0?i._fadeState>0?1-i._fadeTime/i.fadeTotalTime:i._fadeTime/i.fadeTotalTime:i._fadeState>0?1:0,i._fadeProgress!=n){i._fadeProgress=n;var r=i._armature._display;if(i._fadeTime<=e)if(i._fadestate>0){if(r.hasEvent(t.EventObject.FADE_OUT)){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this,i._armature._bufferEvent(s,t.EventObject.FADE_OUT)}}else if(r.hasEvent(t.EventObject.FADE_IN)){var o=t.BaseObject.borrowObject(t.EventObject);o.animationState=this,i._armature._bufferEvent(o,t.EventObject.FADE_IN)}if(i._fadeTime>=i.fadeTotalTime)if(i._fadeState>0){if(r.hasEvent(t.EventObject.FADE_OUT_COMPLETE)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=this,i._armature._bufferEvent(a,t.EventObject.FADE_OUT_COMPLETE)}}else if(i._onFadeInComplete=!0,i._isPausePlayhead=!1,i._fadeState=0,r.hasEvent(t.EventObject.FADE_IN_COMPLETE)){var c=t.BaseObject.borrowObject(t.EventObject);c.animationState=this,i._armature._bufferEvent(c,t.EventObject.FADE_IN_COMPLETE)}}},i.prototype._isDisabled=function(t){return!(this.displayControl&&(!t.displayController||t.displayController==this._name||t.displayController==this._group))},i.prototype._fadeIn=function(e,n,r,s,o,a,c,h,l,u){this._armature=e,this._animationData=n,this._name=r,this.actionEnabled=i.stateActionEnabled,this.playTimes=s,this.timeScale=h,this.fadeTotalTime=l,this._fadeState=-1,this._position=o,this._duration=a,this._time=c,this._isPausePlayhead=u,this.fadeTotalTime<=0&&(this._fadeprogress=.999999),this._timeline=t.baseobject.borrowobject(t.animationtimelinestate),this._timeline.fadein(this._armature,this,this._animationdata,this._time),this._animationdata.zordertimeline&&(this._zordertimeline=t.baseobject.borrowobject(t.zordertimelinestate),this._zordertimeline.fadein(this._armature,this,this._animationdata.zordertimeline,this._time)),this._updatetimelinestates()},i.prototype._updateffdtimelinestates=function(){var e="this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var" i="{},n=0,r=this._ffdTimelines.length;n<r;++n){var" s="this._ffdTimelines[n];i[s.slot.name]=s}for(var" o="this._armature.getSlots(),n=0,r=o.length;n<r;++n){var" a="o[n],c=a.name,h=a.parent.name,l=a.displayData;if(l&&a._meshData&&a._meshData==l.mesh){var" u="this._animationData.getFFDTimeline(this._armature._skinData.name,c,l.share&&l.inheritAnimation?l.share.name:l.name);if(u&&this.containsBoneMask(h)){var" i[c]:(s="t.BaseObject.borrowObject(t.FFDTimelineState),s.slot=a,s.fadeIn(this._armature,this,u,e),this._ffdTimelines.push(s))}else{for(var" _="0,d=a._ffdVertices.length;_<d;++_)a._ffdVertices[_]=0;a._ffdDirty=!0}}}for(var" n="" in="" i){var="" r="n._animationData.cacheFrameRate,s=n._fadeProgress">=1&&0==i&&r>0,o=!0,a=!0,c=2*r;if(c=s?Math.floor(n._time*c)/c:n._time,n._timeline.update(c),n._animationData.hasAsynchronyTimeline||(c=n._timeline._currentTime),n._zOrderTimeline&&n._zOrderTimeline.update(c),s){var h=Math.floor(n._timeline._currentTime*r);if(n._armature._cacheFrameIndex==h)o=!1,a=!1;else{if(n._armature._cacheFrameIndex=h,n._armature._animation._animationStateDirty){n._armature._animation._animationStateDirty=!1;for(var l=0,u=n._boneTimelines.length;l<u;++l){var _="n._boneTimelines[l];_.bone._cacheFrames=_._timeline.cachedFrames}for(var" l="0,u=n._slotTimelines.length;l<u;++l){var" d="n._slotTimelines[l];d.slot._cacheFrames=d._timeline.cachedFrames}}n._animationData.cachedFrames[h]?a=!1:n._animationData.cachedFrames[h]=!0}}else" n._armature._cacheframeindex="-1;if(o){if(a)for(var">=0&&n._fadeProgress>=1&&n._timeline._isCompleted&&n.fadeOut(n.autoFadeOutTime)},i.prototype.play=function(){this._isPlaying=!0},i.prototype.stop=function(){this._isPlaying=!1},i.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),(t<0||t!=t)&&(t=0),this._ispauseplayhead=e,this._fadestate>0){if(t>t-this._fadeTime)return}else{this._fadeState=1,(t<=0||this._fadeprogress<=0)&&(this._fadeprogress=1e-6);for(var i="0,n=this._boneTimelines.length;i<n;++i)this._boneTimelines[i].fadeOut();for(var">1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},i.prototype.containsBoneMask=function(t){return!this._boneMask.length||this._boneMask.indexOf(t)>=0},i.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(i){if(this._boneMask.indexOf(t)<0&&this._animationdata.getbonetimeline(t)&&this._bonemask.push(t),e)for(var 0="==e&&(e=!0);var" n="this._armature.getBones(),r=0,s=n.length;r<s;++r){var" o="n[r],a=o.name;this._boneMask.indexOf(a)<0&&this._animationData.getBoneTimeline(a)&&i.contains(o)&&this._boneMask.push(a)}this._updateTimelineStates()}},i.prototype.removeBoneMask=function(t,e){void" i="this._boneMask.indexOf(t);if(i">=0&&this._boneMask.splice(i,1),e){var n=this._armature.getBone(t);if(n)for(var r=this._armature.getBones(),s=0,o=r.length;s<o;++s){var a="r[s],c=a.name,h=this._boneMask.indexOf(c);h">=0&&n.contains(a)&&this._boneMask.splice(h,1)}}this._updateTimelineStates()},i.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},Object.defineProperty(i.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){return this._timeline._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._timeline._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._timeline._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._timeline._currentTime},set:function(t){(t<0||t!=t)&&(t=0);var e="this._timeline._currentPlayTimes-(this._timeline._isCompleted?1:0);if(t=t%this._duration+e*this._duration,this._time!=t){this._time=t,this._timeline.setCurrentTime(this._time),this._zOrderTimeline&&(this._zOrderTimeline._isCompleted=!1);for(var" i="0,n=this._boneTimelines.length;i<n;++i)this._boneTimelines[i]._isCompleted=!1;for(var" this._animationdata},enumerable:!0,configurable:!0}),i.stateactionenabled="!0,i})(t.BaseObject);t.AnimationState=e})(n||(n={}));var" n;!(function(t){var="" i(){e.call(this)}return="" r(i,e),i.tostring="function(){return"[class" dragonbones.animationtimelinestate]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this._isStarted=!1},i.prototype._onCrossFrame=function(e){var" n="e.actions,r=0,s=n.length;r<s;++r)i._armature._bufferAction(n[r]);for(var" o="i._armature._display,a=e.events,r=0,s=a.length;r<s;++r){var" c="a[r],h="";switch(c.type){case" 10:h="t.EventObject.FRAME_EVENT;break;case" 11:h="t.EventObject.SOUND_EVENT}if((11==c.type?i._armature._eventManager:o).hasEvent(h)){var" l="t.BaseObject.borrowObject(t.EventObject);l.name=c.name,l.animationState=i._animationState,l.frame=e,l.data=c,c.bone&&(l.bone=i._armature.getBone(c.bone.name)),c.slot&&(l.slot=i._armature.getSlot(c.slot.name)),i._armature._bufferEvent(l,h)}}}},i.prototype.fadeIn=function(t,i,n,r){e.prototype.fadeIn.call(this,t,i,n,r),this._currentTime=r},i.prototype.update=function(e){var" s="i._armature._display;if(!i._isStarted&&(i._isStarted=!0,s.hasEvent(t.EventObject.START))){var">0){var a=i._keyFrameCount>1?Math.floor(i._currentTime*i._frameRate):0,c=i._timeline.frames[a];if(i._currentFrame!=c)if(i._keyFrameCount>1){var h=i._currentFrame;if(i._currentFrame=c,!h){var l=Math.floor(n*i._frameRate);h=i._timeline.frames[l],i._isReverse||(n<=h.position||r!=i._currentplaytimes)&&(h=h.prev)}if(i._isreverse)for(;h!=c;)i._oncrossframe(h),h=h.prev;else for(;h!="c;)h=h.next,i._onCrossFrame(h)}else" i._currentframe="c,i._onCrossFrame(i._currentFrame)}if(r!=i._currentPlayTimes){if(s.hasEvent(t.EventObject.LOOP_COMPLETE)){var" o="t.BaseObject.borrowObject(t.EventObject);o.animationState=i._animationState,i._armature._bufferEvent(o,t.EventObject.LOOP_COMPLETE)}if(i._isCompleted&&s.hasEvent(t.EventObject.COMPLETE)){var" i="(function(t){function" e(){t.call(this)}return="" r(e,t),e.tostring="function(){return"[class" dragonbones.zordertimelinestate]"},e.prototype._onarriveatframe="function(e){var" n="(function(e){function" i(){e.call(this),this._transform="new" t.transform,this._currenttransform="new" t.transform,this._durationtransform="new" t.transform}return="" r(i,e),i.tostring="function(){return"[class" dragonbones.bonetimelinestate]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.bone=null,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._boneTransform=null,this._originalTransform=null,this._transform.identity(),this._currentTransform.identity(),this._durationTransform.identity()},i.prototype._onArriveAtFrame=function(i){var">1&&(n._tweenEasing!=t.DragonBones.NO_TWEEN||n._curve)){var r=n._currentFrame.next,s=r.transform;n._durationTransform.x=s.x-n._currentTransform.x,n._durationTransform.y=s.y-n._currentTransform.y,0==n._durationTransform.x&&0==n._durationTransform.y||(n._tweenTransform=2);var o=n._currentFrame.tweenRotate;if(o==o){if(o)if(o>0?s.skewY>=n._currentTransform.skewY:s.skewY<=n._currenttransform.skewy){var a="o">0?o-1:o+1;n._durationTransform.skewX=s.skewX-n._currentTransform.skewX+t.DragonBones.PI_D*a,n._durationTransform.skewY=s.skewY-n._currentTransform.skewY+t.DragonBones.PI_D*a}else n._durationTransform.skewX=s.skewX-n._currentTransform.skewX+t.DragonBones.PI_D*o,n._durationTransform.skewY=s.skewY-n._currentTransform.skewY+t.DragonBones.PI_D*o;else n._durationTransform.skewX=t.Transform.normalizeRadian(s.skewX-n._currentTransform.skewX),n._durationTransform.skewY=t.Transform.normalizeRadian(s.skewY-n._currentTransform.skewY);0==n._durationTransform.skewX&&0==n._durationTransform.skewY||(n._tweenRotate=2)}else n._durationTransform.skewX=0,n._durationTransform.skewY=0;n._currentFrame.tweenScale?(n._durationTransform.scaleX=s.scaleX-n._currentTransform.scaleX,n._durationTransform.scaleY=s.scaleY-n._currentTransform.scaleY,0==n._durationTransform.scaleX&&0==n._durationTransform.scaleY||(n._tweenScale=2)):(n._durationTransform.scaleX=0,n._durationTransform.scaleY=0)}else n._durationTransform.x=0,n._durationTransform.y=0,n._durationTransform.skewX=0,n._durationTransform.skewY=0,n._durationTransform.scaleX=0,n._durationTransform.scaleY=0},i.prototype._onUpdateFrame=function(t){var i=this;if(i._tweenTransform||i._tweenRotate||i._tweenScale){e.prototype._onUpdateFrame.call(this,t);var n=0;i._tweenTransform&&(1==i._tweenTransform?(i._tweenTransform=0,n=0):n=i._tweenProgress,i._animationState.additiveBlending?(i._transform.x=i._currentTransform.x+i._durationTransform.x*n,i._transform.y=i._currentTransform.y+i._durationTransform.y*n):(i._transform.x=i._originalTransform.x+i._currentTransform.x+i._durationTransform.x*n,i._transform.y=i._originalTransform.y+i._currentTransform.y+i._durationTransform.y*n)),i._tweenRotate&&(1==i._tweenRotate?(i._tweenRotate=0,n=0):n=i._tweenProgress,i._animationState.additiveBlending?(i._transform.skewX=i._currentTransform.skewX+i._durationTransform.skewX*n,i._transform.skewY=i._currentTransform.skewY+i._durationTransform.skewY*n):(i._transform.skewX=i._originalTransform.skewX+i._currentTransform.skewX+i._durationTransform.skewX*n,i._transform.skewY=i._originalTransform.skewY+i._currentTransform.skewY+i._durationTransform.skewY*n)),i._tweenScale&&(1==i._tweenScale?(i._tweenScale=0,n=0):n=i._tweenProgress,i._animationState.additiveBlending?(i._transform.scaleX=i._currentTransform.scaleX+i._durationTransform.scaleX*n,i._transform.scaleY=i._currentTransform.scaleY+i._durationTransform.scaleY*n):(i._transform.scaleX=i._originalTransform.scaleX*(i._currentTransform.scaleX+i._durationTransform.scaleX*n),i._transform.scaleY=i._originalTransform.scaleY*(i._currentTransform.scaleY+i._durationTransform.scaleY*n))),i.bone.invalidUpdate()}},i.prototype.fadeIn=function(t,i,n,r){e.prototype.fadeIn.call(this,t,i,n,r),this._originalTransform=this._timeline.originalTransform,this._boneTransform=this.bone._animationPose},i.prototype.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},i.prototype.update=function(t){var i=this;e.prototype.update.call(this,t);var n=i._animationState._weightResult;n>0&&(0==i.bone._blendIndex?(i._boneTransform.x=i._transform.x*n,i._boneTransform.y=i._transform.y*n,i._boneTransform.skewX=i._transform.skewX*n,i._boneTransform.skewY=i._transform.skewY*n,i._boneTransform.scaleX=(i._transform.scaleX-1)*n+1,i._boneTransform.scaleY=(i._transform.scaleY-1)*n+1):(i._boneTransform.x+=i._transform.x*n,i._boneTransform.y+=i._transform.y*n,i._boneTransform.skewX+=i._transform.skewX*n,i._boneTransform.skewY+=i._transform.skewY*n,i._boneTransform.scaleX+=(i._transform.scaleX-1)*n,i._boneTransform.scaleY+=(i._transform.scaleY-1)*n),i.bone._blendIndex++,0!=i._animationState._fadeState&&i.bone.invalidUpdate())},i})(t.TweenTimelineState);t.BoneTimelineState=n;var s=(function(e){function i(){e.call(this),this._color=new t.ColorTransform,this._durationColor=new t.ColorTransform}return r(i,e),i.toString=function(){return"[class dragonBones.SlotTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._slotColor=null,this._color.identity(),this._durationColor.identity()},i.prototype._onArriveAtFrame=function(i){var n=this;if(e.prototype._onArriveAtFrame.call(this,i),n._animationState._isDisabled(n.slot))return n._tweenEasing=t.DragonBones.NO_TWEEN,n._curve=null,void(n._tweenColor=0);n._animationState._fadeState>=0&&(n.slot._setDisplayIndex(n._currentFrame.displayIndex),n.slot._updateMeshData(!0)),n._tweenColor=0;var r=n._currentFrame.color;if(n._keyFrameCount>1&&(n._tweenEasing!=t.DragonBones.NO_TWEEN||n._curve)){var s=n._currentFrame.next,o=s.color;r!=o&&s.displayIndex>=0&&(n._durationColor.alphaMultiplier=o.alphaMultiplier-r.alphaMultiplier,n._durationColor.redMultiplier=o.redMultiplier-r.redMultiplier,n._durationColor.greenMultiplier=o.greenMultiplier-r.greenMultiplier,n._durationColor.blueMultiplier=o.blueMultiplier-r.blueMultiplier,n._durationColor.alphaOffset=o.alphaOffset-r.alphaOffset,n._durationColor.redOffset=o.redOffset-r.redOffset,n._durationColor.greenOffset=o.greenOffset-r.greenOffset,n._durationColor.blueOffset=o.blueOffset-r.blueOffset,0==n._durationColor.alphaMultiplier&&0==n._durationColor.redMultiplier&&0==n._durationColor.greenMultiplier&&0==n._durationColor.blueMultiplier&&0==n._durationColor.alphaOffset&&0==n._durationColor.redOffset&&0==n._durationColor.greenOffset&&0==n._durationColor.blueOffset||(n._tweenColor=2))}0==n._tweenColor&&(n._slotColor.alphaMultiplier==r.alphaMultiplier&&n._slotColor.redMultiplier==r.redMultiplier&&n._slotColor.greenMultiplier==r.greenMultiplier&&n._slotColor.blueMultiplier==r.blueMultiplier&&n._slotColor.alphaOffset==r.alphaOffset&&n._slotColor.redOffset==r.redOffset&&n._slotColor.greenOffset==r.greenOffset&&n._slotColor.blueOffset==r.blueOffset||(n._tweenColor=1))},i.prototype._onUpdateFrame=function(t){var i=this;e.prototype._onUpdateFrame.call(this,t);var n=0;if(i._tweenColor){1==i._tweenColor?(i._tweenColor=0,n=0):n=i._tweenProgress;var r=i._currentFrame.color;i._color.alphaMultiplier=r.alphaMultiplier+i._durationColor.alphaMultiplier*n,i._color.redMultiplier=r.redMultiplier+i._durationColor.redMultiplier*n,i._color.greenMultiplier=r.greenMultiplier+i._durationColor.greenMultiplier*n,i._color.blueMultiplier=r.blueMultiplier+i._durationColor.blueMultiplier*n,i._color.alphaOffset=r.alphaOffset+i._durationColor.alphaOffset*n,i._color.redOffset=r.redOffset+i._durationColor.redOffset*n,i._color.greenOffset=r.greenOffset+i._durationColor.greenOffset*n,i._color.blueOffset=r.blueOffset+i._durationColor.blueOffset*n,i._colorDirty=!0}},i.prototype.fadeIn=function(t,i,n,r){e.prototype.fadeIn.call(this,t,i,n,r),this._slotColor=this.slot._colorTransform},i.prototype.fadeOut=function(){this._tweenColor=0},i.prototype.update=function(t){var i=this;if(e.prototype.update.call(this,t),0!=i._tweenColor||i._colorDirty){var n=i._animationState._weightResult;if(n>0)if(0!=i._animationState._fadeState){var r=Math.pow(i._animationState._fadeProgress,4);i._slotColor.alphaMultiplier+=(i._color.alphaMultiplier-i._slotColor.alphaMultiplier)*r,i._slotColor.redMultiplier+=(i._color.redMultiplier-i._slotColor.redMultiplier)*r,i._slotColor.greenMultiplier+=(i._color.greenMultiplier-i._slotColor.greenMultiplier)*r,i._slotColor.blueMultiplier+=(i._color.blueMultiplier-i._slotColor.blueMultiplier)*r,i._slotColor.alphaOffset+=(i._color.alphaOffset-i._slotColor.alphaOffset)*r,i._slotColor.redOffset+=(i._color.redOffset-i._slotColor.redOffset)*r,i._slotColor.greenOffset+=(i._color.greenOffset-i._slotColor.greenOffset)*r,i._slotColor.blueOffset+=(i._color.blueOffset-i._slotColor.blueOffset)*r,i.slot._colorDirty=!0}else i._colorDirty&&(i._colorDirty=!1,i._slotColor.alphaMultiplier=i._color.alphaMultiplier,i._slotColor.redMultiplier=i._color.redMultiplier,i._slotColor.greenMultiplier=i._color.greenMultiplier,i._slotColor.blueMultiplier=i._color.blueMultiplier,i._slotColor.alphaOffset=i._color.alphaOffset,i._slotColor.redOffset=i._color.redOffset,i._slotColor.greenOffset=i._color.greenOffset,i._slotColor.blueOffset=i._color.blueOffset,i.slot._colorDirty=!0)}},i})(t.TweenTimelineState);t.SlotTimelineState=s;var o=(function(e){function i(){e.call(this),this._ffdVertices=[]}return r(i,e),i.toString=function(){return"[class dragonBones.FFDTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._tweenFFD=0,this._slotFFDVertices=null,this._durationFFDFrame&&(this._durationFFDFrame.returnToPool(),this._durationFFDFrame=null),this._ffdVertices.length=0},i.prototype._onArriveAtFrame=function(i){var n=this;if(e.prototype._onArriveAtFrame.call(this,i),n._tweenFFD=0,(n._tweenEasing!=t.DragonBones.NO_TWEEN||n._curve)&&(n._tweenFFD=n._updateExtensionKeyFrame(n._currentFrame,n._currentFrame.next,n._durationFFDFrame)),0==n._tweenFFD)for(var r=n._currentFrame.tweens,s=0,o=r.length;s<o;++s)if(n._slotffdvertices[s]!=r[s]){n._tweenffd=1;break}},i.prototype._onupdateframe=function(t){var i="this;e.prototype._onUpdateFrame.call(this,t);var" n="0;if(0!=i._tweenFFD){1==i._tweenFFD?(i._tweenFFD=0,n=0):n=i._tweenProgress;for(var" r="i._currentFrame.tweens,s=i._durationFFDFrame.tweens,o=0,a=r.length;o<a;++o)i._ffdVertices[o]=r[o]+s[o]*n;i.slot._ffdDirty=!0}},i.prototype.fadeIn=function(i,n,r,s){e.prototype.fadeIn.call(this,i,n,r,s),this._slotFFDVertices=this.slot._ffdVertices,this._durationFFDFrame=t.BaseObject.borrowObject(t.ExtensionFrameData),this._durationFFDFrame.tweens.length=this._slotFFDVertices.length,this._ffdVertices.length=this._slotFFDVertices.length;for(var" o="0,a=this._durationFFDFrame.tweens.length;o<a;++o)this._durationFFDFrame.tweens[o]=0;for(var">0){if(0==i.slot._blendIndex)for(var r=0,s=i._ffdVertices.length;r<s;++r)i._slotffdvertices[r]=i._ffdvertices[r]*n;else for(var="" r="0,s=i._ffdVertices.length;r<s;++r)i._slotFFDVertices[r]+=i._ffdVertices[r]*n;i.slot._blendIndex++,0!=i._animationState._fadeState&&(i.slot._ffdDirty=!0)}},i})(t.TweenTimelineState);t.FFDTimelineState=o})(n||(n={}));var" n;!(function(t){var="" e="(function(){function" e(){this.time="(new" date).gettime()="" t.dragonbones.second_to_millisecond,this.timescale="1,this._animatebles=[]}return" object.defineproperty(e,"clock",{get:function(){return="" e._clock||(e._clock="new" e),e._clock},enumerable:!0,configurable:!0}),e.prototype.advancetime="function(e){if(e!=e&&(e=0),e<0&&(e=(new" t.dragonbones.second_to_millisecond-this.time),e*="this.timeScale,e<0?this.time-=e:this.time+=e,e){for(var" i="0,n=0,r=this._animatebles.length;i<r;++i){var" s="this._animatebles[i];s?(n">0&&(this._animatebles[i-n]=s,this._animatebles[i]=null),s.advanceTime(e)):n++}if(n>0){for(r=this._animatebles.length;i<r;++i){var s="this._animatebles[i];s?this._animatebles[i-n]=s:n++}this._animatebles.length-=n}}},e.prototype.contains=function(t){return" this._animatebles.indexof(t)="">=0},e.prototype.add=function(e){e&&this._animatebles.indexOf(e)<0&&(this._animatebles.push(e),t.dragonbones.debug&&e instanceof="" t.armature&&t.dragonbones.addarmature(e))},e.prototype.remove="function(e){var" i="this._animatebles.indexOf(e);i">=0&&(this._animatebles[i]=null,
t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.removeArmature(e))},e.prototype.clear=function(){for(var t=0,e=this._animatebles.length;t<e;++t)this._animatebles[t]=null},e._clock=null,e})();t.worldclock=e})(n||(n={}));var n;!(function(t){var="" e="(function(e){function" i(){e.call(this),this.global="new" t.transform,this.origin="new" t.transform,this.offset="new" t.transform,this._globaltransformmatrix="new" t.matrix}return="" r(i,e),i.prototype._onclear="function(){this.userData=null,this.name=null,this.globalTransformMatrix=this._globalTransformMatrix,this.global.identity(),this.origin.identity(),this.offset.identity(),this._armature=null,this._parent=null,this._globalTransformMatrix.identity()},i.prototype._setArmature=function(t){this._armature=t},i.prototype._setParent=function(t){this._parent=t},Object.defineProperty(i.prototype,"armature",{get:function(){return" this._armature},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"parent",{get:function(){return="" this._parent},enumerable:!0,configurable:!0}),i})(t.baseobject);t.transformobject="e})(n||(n={}));var" i(){e.call(this),this._bones="[],this._slots=[],this._actions=[],this._events=[],this.enableCache=!1}return" r(i,e),i.tostring="function(){return"[class" dragonbones.armature]"},i._onsortslots="function(t,e){return" t._zorder="">e._zOrder?1:-1},i.prototype._onClear=function(){for(var t=0,e=this._bones.length;t<e;++t)this._bones[t].returntopool();for(var t="0,e=this._slots.length;t<e;++t)this._slots[t].returnToPool();for(var" e="this._bones.concat(),i=0,n=0;for(this._bones.length=0;n<t;){var" r="e[i++];i">=t&&(i=0),this._bones.indexOf(r)>=0||r.parent&&this._bones.indexOf(r.parent)<0||r.ik&&this._bones.indexof(r.ik)<0||(r.ik&&r.ikchain>0&&r.ikChainIndex==r.ikChain?this._bones.splice(this._bones.indexOf(r.parent)+1,0,r):this._bones.push(r),n++)}}},i.prototype._sortSlots=function(){this._slots.sort(i._onSortSlots)},i.prototype._doAction=function(t){switch(t.type){case 0:this._animation.play(t.data[0],t.data[1]);break;case 1:this._animation.stop(t.data[0]);break;case 2:this._animation.gotoAndPlayByTime(t.data[0],t.data[1],t.data[2]);break;case 3:this._animation.gotoAndStopByTime(t.data[0],t.data[1]);break;case 4:this._animation.fadeIn(t.data[0],t.data[1],t.data[2]);break;case 5:}},i.prototype._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesdirty=!0,this._bones.push(t))},i.prototype._removebonefrombonelist=function(t){var e="this._bones.indexOf(t);e">=0&&this._bones.splice(e,1)},i.prototype._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsdirty=!0,this._slots.push(t))},i.prototype._removeslotfromslotlist=function(t){var e="this._slots.indexOf(t);e">=0&&this._slots.splice(e,1)},i.prototype._sortZOrder=function(t){for(var e=this._armatureData.sortedSlots,i=t.length<1,n=0,r=e.length;n<r;++n){var s="i?n:t[n],o=e[s],a=this.getSlot(o.name);a&&a._setZorder(n)}this._slotsDirty=!0},i.prototype._bufferAction=function(t){this._actions.push(t)},i.prototype._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},i.prototype.dispose=function(){this._delayDispose=!0,!this._lockDispose&&this._animation&&this.returnToPool()},i.prototype.advanceTime=function(e){var" i="this;if(!i._animation)throw" new="" error("the="" armature="" has="" been="" disposed.");var="" n="e*i._animation.timeScale;i._animation._advanceTime(n),i._bonesDirty&&(i._bonesDirty=!1,i._sortBones()),i._slotsDirty&&(i._slotsDirty=!1,i._sortSlots());for(var" r="0,s=i._bones.length;r<s;++r)i._bones[r]._update(i._cacheFrameIndex);for(var" o="i._slots[r];o._update(i._cacheFrameIndex);var" a="o._childArmature;a&&(o.inheritAnimation?a.advanceTime(n):a.advanceTime(e))}if((t.DragonBones.debugDraw||i._debugDraw)&&(i._debugDraw=t.DragonBones.debugDraw,i._display._debugDraw(i._debugDraw)),!i._lockDispose){if(i._lockDispose=!0,i._events.length">0){for(var r=0,s=i._events.length;r<s;++r){var c="i._events[r];c.type==t.EventObject.SOUND_EVENT?this._eventManager._dispatchEvent(c):i._display._dispatchEvent(c),c.returnToPool()}i._events.length=0}if(i._actions.length">0){for(var r=0,s=i._actions.length;r<s;++r){var 0="==i&&(i=0);for(var" h="i._actions[r];if(h.slot){var" o="i.getSlot(h.slot.name);if(o){var" a="o._childArmature;a&&a._doAction(h)}}else" if(h.bone)for(var="" l="0,u=i._slots.length;l<u;++l){var" this._doaction(h)}i._actions.length="0}i._lockDispose=!1}i._delayDispose&&i.returnToPool()},i.prototype.containsPoint=function(t,e,i){void" n="0,r=this._slots.length;n<r;++n){var" s="this._slots[n];if(s.containsPoint(t,e,i))return" s}return="" null},i.prototype.intersectssegment="function(t,e,i,n,r,s,o,a){void" c="t==i,h=0,l=0,u=0,_=0,d=0,f=0,p=0,m=0,g=null,v=null,y=0,x=this._slots.length;y<x;++y){var" t="this._slots[y],b=T.intersectsSegment(t,e,i,n,r,s,o,a);if(b">0){if(!s&&!o){g=T;break}if(s){var C=c?s.y-e:s.x-t;C<0&&(c=-c),(!g||c<h)&&(h=c,u=s.x,_=s.y,g=t,a&&(p=a.x))}if(o){var c="o.x-t;C<0&&(C=-C),(!v||C">l)&&(l=C,d=o.x,f=o.y,v=T,a&&(m=a.y))}}}return g&&s&&(s.x=u,s.y=_,a&&(a.x=p)),v&&o&&(o.x=d,o.y=f,a&&(a.y=m)),g},i.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var i=this.getBone(t);if(i&&(i.invalidUpdate(),e))for(var n=0,r=this._slots.length;n<r;++n){var 0="==e&&(e=null),!t)throw" s="this._slots[n];s.parent==i&&s.invalidUpdate()}}else{for(var" n="0,r=this._bones.length;n<r;++n)this._bones[n].invalidUpdate();if(e)for(var" e="0,i=this._bones.length;e<i;++e){var" n}return="" null},i.prototype.getbonebydisplay="function(t){var" e?e.parent:null},i.prototype.getslot="function(t){for(var" null},i.prototype.getslotbydisplay="function(t){if(t)for(var" null},i.prototype.replacetexture="function(t){this.replacedTexture=t},i.prototype.getBones=function(){return" this._bones},i.prototype.getslots="function(){return" this._slots},object.defineproperty(i.prototype,"name",{get:function(){return="" this._armaturedata?this._armaturedata.name:null},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"armaturedata",{get:function(){return="" this._armaturedata},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"animation",{get:function(){return="" this._animation},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"display",{get:function(){return="" this._display},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"parent",{get:function(){return="" this._parent},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"cacheframerate",{get:function(){return="" this._armaturedata.cacheframerate},set:function(t){if(this._armaturedata.cacheframerate!="t){this._armatureData.cacheFrames(t);for(var" this._replacedtexture},set:function(t){this._display._onreplacetexture(t),this._replacedtexture="t;for(var" this._display.hasevent(t)},i.prototype.addeventlistener="function(t,e,i){this._display.addEvent(t,e,i)},i.prototype.removeEventListener=function(t,e,i){this._display.removeEvent(t,e,i)},i.prototype.addBone=function(t,e){if(void" new="" error;t._setarmature(this),t._setparent(e?this.getbone(e):null)},i.prototype.addslot="function(t,e){var" i="this.getBone(e);if(!i)throw" error;t._setarmature(this),t._setparent(i)},i.prototype.removebone="function(t){if(!t||t.armature!=this)throw" error;t._setparent(null),t._setarmature(null)},i.prototype.removeslot="function(t){if(!t||t.armature!=this)throw" error;t._setparent(null),t._setarmature(null)},i.prototype.getdisplay="function(){return" this._display},i})(t.baseobject);t.armature="e})(n||(n={}));var" n;!(function(t){var="" i(){e.call(this),this._animationpose="new" t.transform,this._bones="[],this._slots=[]}return" r(i,e),i.tostring="function(){return"[class" dragonbones.bone]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.ikBendPositive=!1,this.ikWeight=0,this.length=0,this._transformDirty=2,this._blendIndex=0,this._cacheFrames=null,this._animationPose.identity(),this._visible=!0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._bones.length=0,this._slots.length=0},i.prototype._updateGlobalTransformMatrix=function(){if(this._parent){var" t="this._parent.global.skewY,e=this._parent.globalTransformMatrix;if(this.inheritScale)this.inheritRotation||(this.global.skewX-=t,this.global.skewY-=t),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(e),this.inheritTranslation||(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),this.global.fromMatrix(this.globalTransformMatrix);else{if(this.inheritTranslation){var" this.global.tomatrix(this.globaltransformmatrix)},i.prototype._computeika="function(){var" l="o*o+a*a,u=Math.sqrt(l),_=0;if(s+h<=u||u+s<=h||u+h<=s)_=Math.atan2(e.y-t.y,e.x-t.x)+this._parent.offset.skewY,s+h<=u||h<s&&(_+=Math.PI);else{var" d="(c-r+l)/(2*l),f=Math.sqrt(c-d*d*l)/u,p=t.x+o*d,m=t.y+a*d,g=-a*f,v=o*f;this.ikBendPositive?(this.global.x=p-g,this.global.y=m-v):(this.global.x=p+g,this.global.y=m+v),_=Math.atan2(this.global.y-t.y,this.global.x-t.x)+this._parent.offset.skewY}_=(_-t.skewY)*this.ikWeight,t.skewX+=_,t.skewY+=_,t.toMatrix(this._parent.globalTransformMatrix),this._parent._transformDirty=1,this.global.x=t.x+Math.cos(t.skewY)*h,this.global.y=t.y+Math.sin(t.skewY)*h;var" y="(Math.atan2(e.y-this.global.y,e.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(n,i))*this.ikWeight;this.global.skewX+=y,this.global.skewY+=y,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._setArmature=function(t){if(this._armature!=t){this._ik=null;var" o="i[n];o.parent==this&&o._setArmature(this._armature)}}},i.prototype._setIK=function(t,e,i){if(t){if(e==i){var" for(var="" r="t;r.ik&&r.ikChain;){if(n.contains(r.ik)){t=null,e=0,i=0;break}r=r.parent}}}else">=0){var n=i._cacheFrames[e];i.globalTransformMatrix==n?i._transformDirty=0:n?(i._transformDirty=2,i.globalTransformMatrix=n):2==i._transformDirty||i._parent&&0!=i._parent._transformDirty||i._ik&&i.ikWeight>0&&0!=i._ik._transformDirty?(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix):i.globalTransformMatrix!=i._globalTransformMatrix?(i._transformDirty=0,i._cacheFrames[e]=i.globalTransformMatrix):(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix)}else(2==i._transformDirty||i._parent&&0!=i._parent._transformDirty||i._ik&&i.ikWeight>0&&0!=i._ik._transformDirty)&&(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix);0!=i._transformDirty&&(2==i._transformDirty?(i._transformDirty=1,i.globalTransformMatrix==i._globalTransformMatrix&&(i.global.x=i.origin.x+i.offset.x+i._animationPose.x,i.global.y=i.origin.y+i.offset.y+i._animationPose.y,i.global.skewX=i.origin.skewX+i.offset.skewX+i._animationPose.skewX,i.global.skewY=i.origin.skewY+i.offset.skewY+i._animationPose.skewY,i.global.scaleX=i.origin.scaleX*i.offset.scaleX*i._animationPose.scaleX,i.global.scaleY=i.origin.scaleY*i.offset.scaleY*i._animationPose.scaleY,i._updateGlobalTransformMatrix(),i._ik&&i._ikChainIndex==i._ikChain&&i.ikWeight>0&&(i.inheritTranslation&&i._ikChain>0&&i._parent?i._computeIKB():i._computeIKA()),e>=0&&!i._cacheFrames[e]&&(i.globalTransformMatrix=t.BoneTimelineData.cacheFrame(i._cacheFrames,e,i._globalTransformMatrix)))):i._transformDirty=0)},i.prototype.invalidUpdate=function(){this._transformDirty=2},i.prototype.contains=function(t){if(t){if(t==this)return!1;for(var e=t;e!=this&&e;)e=e.parent;return e==this}return!1},i.prototype.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,i=t.length;e<i;++e){var n="t[e];n.parent==this&&this._bones.push(n)}return" this._bones},i.prototype.getslots="function(){this._slots.length=0;for(var" t="this._armature.getSlots(),e=0,i=t.length;e<i;++e){var" this._slots},object.defineproperty(i.prototype,"ikchain",{get:function(){return="" this._ikchain},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"ikchainindex",{get:function(){return="" this._ikchainindex},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"ik",{get:function(){return="" this._ik},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"visible",{get:function(){return="" this._visible},set:function(t){if(this._visible!="t){this._visible=t;for(var" e="this._armature.getSlots(),i=0,n=e.length;i<n;++i){var" r="e[i];r._parent==this&&r._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){for(var" n}return="" null},enumerable:!0,configurable:!0}),i})(t.transformobject);t.bone="e})(n||(n={}));var" n;!(function(t){var="" i(){e.call(this),this._colortransform="new" t.colortransform,this._ffdvertices="[],this._replacedDisplayDataSet=[],this._localMatrix=new" t.matrix,this._displaylist="[],this._meshBones=[]}return" r(i,e),i.prototype._onclear="function(){e.prototype._onClear.call(this);for(var" i="[],n=0,r=this._displayList.length;n<r;++n){var" s="this._displayList[n];s!=this._rawDisplay&&s!=this._meshDisplay&&i.indexOf(s)<0&&i.push(s)}for(var" instanceof="" t.armature?s.dispose():this._disposedisplay(s)}this._meshdisplay&&this._meshdisplay!="this._rawDisplay&&this._disposeDisplay(this._meshDisplay),this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.inheritAnimation=!0,this.displayController=null,this._blendIndex=0,this._displayDataSet=null,this._meshData=null,this._childArmature=null,this._rawDisplay=null,this._meshDisplay=null,this._cacheFrames=null,this._colorTransform.identity(),this._ffdVertices.length=0,this._replacedDisplayDataSet.length=0,this._zOrderDirty=!1,this._displayDirty=!1,this._colorDirty=!1,this._blendModeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._ffdDirty=!1,this._zOrder=0,this._displayIndex=-2,this._pivotX=0,this._pivotY=0,this._blendMode=0,this._display=null,this._localMatrix.identity(),this._displayList.length=0,this._meshBones.length=0},i.prototype._isMeshBonesUpdate=function(){for(var" o="n.frame||n.region,a=o.width*s,c=o.height*s;n.rotated&&(a=o.height,c=o.width),this._pivotX*=a,this._pivotY*=c}n.frame&&(this._pivotX+=n.frame.x*s,this._pivotY+=n.frame.y*s)}r&&(t.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,e.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y)},i.prototype._updateDisplay=function(){var">=0&&this._displayIndex<this._displaylist.length?(this._display=this._displaylist[this._displayindex],this._display instanceof="" t.armature?(this._childarmature="this._display,this._display=this._childArmature._display):this._childArmature=null):(this._display=null,this._childArmature=null);var" n="this._display||this._rawDisplay;if(n!=e&&(this._onUpdateDisplay(),e?this._replaceDisplay(e):this._addDisplay(),this._blendModeDirty=!0,this._colorDirty=!0),this._displayDataSet&&this._displayIndex">=0&&this._displayIndex<this._displaydataset.displays.length&&(this.origin.copyfrom(this._displaydataset.displays[this._displayindex].transform),this._origindirty=!0),this._updatemeshdata(!1),n!=this._rawdisplay&&n!=this._meshdisplay||this._updateframe(),this._childarmature!=i&&(i&&(i._parent=null,this.inheritanimation&&i.animation.reset()),this._childarmature&&(this._childarmature._parent=this,this.inheritanimation))){if(0==this._childarmature.cacheframerate){var r="this._armature.cacheFrameRate;0!=r&&(this._childArmature.cacheFrameRate=r)}var" s="this._armature.armatureData.getSlot(this.name),o=s.actions.length">0?s.actions:this._childArmature.armatureData.actions;if(o.length>0)for(var a=0,c=o.length;a<c;++a)this._childarmature._bufferaction(o[a]);else this._childarmature.animation.play()}},i.prototype._updatelocaltransformmatrix="function(){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)},i.prototype._updateGlobalTransformMatrix=function(){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),this.global.fromMatrix(this.globalTransformMatrix)},i.prototype._setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},i.prototype._updateMeshData=function(t){var" e="this._meshData,i=null;if(this._display&&this._display==this._meshDisplay&&this._displayIndex">=0){i=this._displayDataSet&&this._displayIndex<this._displaydataset.displays.length?this._displaydataset.displays[this._displayindex].mesh:null;var n="this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,r=n?n.mesh:null;this._meshData=r||i}else" this._meshdata="null;if(this._meshData!=e){if(this._meshData&&this._meshData==i){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var" s="0,o=this._meshBones.length;s<o;++s)this._meshBones[s]=this._armature.getBone(this._meshData.bones[s].name);for(var" a="0,s=0,o=this._meshData.boneIndices.length;s<o;++s)a+=this._meshData.boneIndices[s].length;this._ffdVertices.length=2*a}else" this._meshbones.length="0,this._ffdVertices.length=this._meshData.vertices.length;for(var" i="this;if(i._blendIndex=0,i._zOrderDirty&&(i._zOrderDirty=!1,i._updateZOrder()),i._displayDirty&&(i._displayDirty=!1,i._updateDisplay()),i._display&&(i._blendModeDirty&&(i._blendModeDirty=!1,i._updateBlendMode()),i._colorDirty&&(i._colorDirty=!1,i._updateColor()),!i._meshData||((i._ffdDirty||i._meshData.skinned&&i._isMeshBonesUpdate())&&(i._ffdDirty=!1,i._updateMesh()),!i._meshData.skinned))){if(i._originDirty&&(i._originDirty=!1,i._transformDirty=!0,i._updateLocalTransformMatrix()),e">=0&&i._cacheFrames){var n=i._cacheFrames[e];i.globalTransformMatrix==n?i._transformDirty=!1:n?(i._transformDirty=!0,i.globalTransformMatrix=n):i._transformDirty||0!=i._parent._transformDirty?(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix):i.globalTransformMatrix!=i._globalTransformMatrix?(i._transformDirty=!1,i._cacheFrames[e]=i.globalTransformMatrix):(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix)}else(i._transformDirty||0!=i._parent._transformDirty)&&(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix);i._transformDirty&&(i._transformDirty=!1,i.globalTransformMatrix==i._globalTransformMatrix&&(i._updateGlobalTransformMatrix(),e>=0&&i._cacheFrames&&!i._cacheFrames[e]&&(i.globalTransformMatrix=t.SlotTimelineData.cacheFrame(i._cacheFrames,e,i._globalTransformMatrix))),i._updateTransform())}},i.prototype._setDisplayList=function(e){if(e&&e.length>0){this._displayList.length!=e.length&&(this._displayList.length=e.length);for(var i=0,n=e.length;i<n;++i){var r="e[i];r&&r!=this._rawDisplay&&r!=this._meshDisplay&&!(r" instanceof="" t.armature)&&this._displaylist.indexof(r)<0&&this._initdisplay(r),this._displaylist[i]="r}}else" this._displaylist.length="">0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displaylist.length?this._displaydirty=this._display!=this._displaylist[this._displayindex]:this._displaydirty=null!=this._display,this._displaydirty},i.prototype._setzorder=function(t){return 0="==n&&(n=0);var" this._zorder="=t,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setDisplayIndex=function(t){return" this._displayindex!="t&&(this._displayIndex=t,this._displayDirty=!0,this._displayDirty)},i.prototype._setBlendMode=function(t){return" this._blendmode!="t&&(this._blendMode=t,this._blendModeDirty=!0,!0)},i.prototype._setColor=function(t){return" this._colortransform.copyfrom(t),this._colordirty="!0,!0},i.prototype.containsPoint=function(t,e,n){void" r="this.displayData;return!(!r||!r.boundingBox||n&&r.color!=n)&&(0==this._blendIndex&&(this._blendIndex=1,this._updateLocalTransformMatrix(),this._updateGlobalTransformMatrix()),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),r.boundingBox.containsPoint(i._helpPoint.x,i._helpPoint.y))},i.prototype.intersectsSegment=function(t,e,n,r,s,o,a,c){void" h="this.displayData;if(!h||!h.boundingBox||s&&h.color!=s)return" 0;0="=this._blendIndex&&(this._blendIndex=1,this._updateLocalTransformMatrix(),this._updateGlobalTransformMatrix()),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),t=i._helpPoint.x,e=i._helpPoint.y,i._helpMatrix.transformPoint(n,r,i._helpPoint),n=i._helpPoint.x,r=i._helpPoint.y;var" l="h.boundingBox.intersectsSegment(t,e,n,r,o,a,c);return">0&&(1==l||2==l?o?(this.globalTransformMatrix.transformPoint(o.x,o.y,o),a&&(a.x=o.x,a.y=o.y)):a&&this.globalTransformMatrix.transformPoint(a.x,a.y,a):(o&&this.globalTransformMatrix.transformPoint(o.x,o.y,o),a&&this.globalTransformMatrix.transformPoint(a.x,a.y,a)),c&&(this.globalTransformMatrix.transformPoint(Math.cos(c.x),Math.sin(c.x),i._helpPoint,!0),c.x=Math.atan2(i._helpPoint.y,i._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(c.y),Math.sin(c.y),i._helpPoint,!0),c.y=Math.atan2(i._helpPoint.y,i._helpPoint.x))),l},i.prototype.invalidUpdate=function(){this._displayDirty=!0},Object.defineProperty(i.prototype,"displayData",{get:function(){return this._displayIndex<0||this._displayindex>=this._displayDataSet.displays.length?null:this._displayDataSet.displays[this._displayIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this._update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),n=[];this._setDisplayList(e)&&this._update(-1);for(var r=0,s=i.length;r<s;++r){var o="i[r];o&&o!=this._rawDisplay&&o!=this._meshDisplay&&this._displayList.indexOf(o)<0&&n.indexOf(o)<0&&n.push(o)}for(var" r="0,s=n.length;r<s;++r){var" instanceof="" t.armature?o.dispose():this._disposedisplay(o)}},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"display",{get:function(){return="" this._display},set:function(t){if(this._display!="t){var" e="this._displayList.length;if(this._displayIndex<0&&0==e&&(this._displayIndex=0),!(this._displayIndex<0)){var" i="this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return" this._childarmature},set:function(t){this._childarmature!="t&&(t&&t.display.advanceTimeBySelf(!1),this.display=t)},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return" this._display},i.prototype.setdisplay="function(t){this.display=t},i._helpPoint=new" t.point,i._helpmatrix="new" t.matrix,i})(t.transformobject);t.slot="e})(n||(n={}));var" n;!(function(t){var="" e(){t.call(this)}return="" r(e,t),e.tostring="function(){return"[class" dragonbones.eventobject]"},e.prototype._onclear="function(){this.type=null,this.name=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.frame=null,this.data=null,this.userData=null},e.prototype.getInt=function(t){return" this.data?this.data.ints[t]:0},e.prototype.getfloat="function(t){return" this.data?this.data.floats[t]:0},e.prototype.getstring="function(t){return" this.data?this.data.strings[t]:null},e.start="start" ,e.loop_complete="loopComplete" ,e.complete="complete" ,e.fade_in="fadeIn" ,e.fade_in_complete="fadeInComplete" ,e.fade_out="fadeOut" ,e.fade_out_complete="fadeOutComplete" ,e.frame_event="frameEvent" ,e.sound_event="soundEvent" ,e})(t.baseobject);t.eventobject="e})(n||(n={}));var" e(){t.call(this),this.frames="[]}return" dragonbones.timelinedata]"},e.prototype._onclear="function(){for(var" t="null,e=0,i=this.frames.length;e<i;++e){var" n="this.frames[e];t&&n!=t&&t.returnToPool(),t=n}this.scale=1,this.offset=0,this.frames.length=0},e})(t.BaseObject);t.TimelineData=e;var" e(){t.apply(this,arguments)}return="" dragonbones.zordertimelinedata]"},e})(e);t.zordertimelinedata="i;var" i(){e.call(this),this.originaltransform="new" t.transform,this.cachedframes="[]}return" r(i,e),i.cacheframe="function(e,i,n){var" t.matrix;return="" r.copyfrom(n),r},i.tostring="function(){return"[class" dragonbones.bonetimelinedata]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.bone=null,this.originalTransform.identity(),this.cachedFrames.length=0},i.prototype.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i})(e);t.BoneTimelineData=n;var" s="(function(e){function" i(){e.call(this),this.cachedframes="[]}return" dragonbones.slottimelinedata]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.slot=null,this.cachedFrames.length=0},i.prototype.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i})(e);t.SlotTimelineData=s;var" dragonbones.ffdtimelinedata]"},e.prototype._onclear="function(){t.prototype._onClear.call(this),this.skin=null,this.slot=null,this.display=null},e})(e);t.FFDTimelineData=o})(n||(n={}));var" e(){t.call(this),this.bonetimelines="{},this.slotTimelines={},this.ffdTimelines={},this.cachedFrames=[]}return" dragonbones.animationdata]"},e.prototype._onclear="function(){t.prototype._onClear.call(this),this.zOrderTimeline&&this.zOrderTimeline.returnToPool();for(var" in="" this.bonetimelines)this.bonetimelines[e].returntopool(),delete="" this.bonetimelines[e];for(var="" this.slottimelines)this.slottimelines[e].returntopool(),delete="" this.slottimelines[e];for(var="" this.ffdtimelines){for(var="" this.ffdtimelines[e])for(var="" this.ffdtimelines[e][i])this.ffdtimelines[e][i][n].returntopool();delete="" this.ffdtimelines[e]}this.hasasynchronytimeline="!1,this.frameCount=0,this.playTimes=0,this.position=0,this.duration=0,this.fadeInTime=0,this.cacheFrameRate=0,this.name=null,this.animation=null,this.zOrderTimeline=null,this.cachedFrames.length=0},e.prototype.cacheFrames=function(t){if(!this.animation){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var" this.bonetimelines)this.bonetimelines[i].cacheframes(e);for(var="" this.slottimelines)this.slottimelines[i].cacheframes(e)}},e.prototype.addbonetimeline="function(t){if(!t||!t.bone||this.boneTimelines[t.bone.name])throw" new="" error;this.bonetimelines[t.bone.name]="t},e.prototype.addSlotTimeline=function(t){if(!t||!t.slot||this.slotTimelines[t.slot.name])throw" error;this.slottimelines[t.slot.name]="t},e.prototype.addFFDTimeline=function(t){if(!(t&&t.skin&&t.slot&&t.display))throw" error;var="" error;i[t.display.name]="t},e.prototype.getBoneTimeline=function(t){return" this.bonetimelines[t]},e.prototype.getslottimeline="function(t){return" this.slottimelines[t]},e.prototype.getffdtimeline="function(t,e,i){var" r[i]}return="" null},e})(t.timelinedata);t.animationdata="e})(n||(n={}));var" i(){e.call(this),this.aabb="new" t.rectangle,this.bones="{},this.slots={},this.skins={},this.animations={},this.actions=[],this._sortedBones=[]," this._sortedslots="[],this._bonesChildren={}}return" r(i,e),i._onsortslots="function(t,e){return" t.zorder="">e.zOrder?1:-1},i.toString=function(){return"[class dragonBones.ArmatureData]"},i.prototype._onClear=function(){for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];for(var t=0,e=this.actions.length;t<e;++t)this.actions[t].returntopool();this.framerate=0,this.type=-1,this.name=null,this.parent=null,this.userdata=null,this.aabb.clear(),this.actions.length=0,this.cacheframerate=0,this.scale=1;for(var t="" in="" this._boneschildren)delete="" this._boneschildren[t];this._bonedirty="!1,this._slotDirty=!1,this._defaultSkin=null,this._defaultAnimation=null,this._sortedBones.length=0,this._sortedSlots.length=0},i.prototype._sortBones=function(){var" e="this._sortedBones.concat(),i=0,n=0;for(this._sortedBones.length=0;n<t;){var" r="e[i++];i">=t&&(i=0),this._sortedBones.indexOf(r)>=0||r.parent&&this._sortedBones.indexOf(r.parent)<0||r.ik&&this._sortedbones.indexof(r.ik)<0||(r.ik&&r.chain>0&&r.chainIndex==r.chain?this._sortedBones.splice(this._sortedBones.indexOf(r.parent)+1,0,r):this._sortedBones.push(r),n++)}}},i.prototype._sortSlots=function(){this._sortedSlots.sort(i._onSortSlots)},i.prototype.cacheFrames=function(t){if(this.cacheFrameRate!=t){this.cacheFrameRate=t;for(var e in this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)}},i.prototype.addBone=function(t,e){if(!t||!t.name||this.bones[t.name])throw new Error;if(e){var i=this.getBone(e);i?t.parent=i:(this._bonesChildren[e]=this._bonesChildren[e]||[]).push(t)}var n=this._bonesChildren[t.name];if(n){for(var r=0,s=n.length;r<s;++r)n[r].parent=t;delete this._boneschildren[t.name]}this.bones[t.name]="t,this._sortedBones.push(t),this._boneDirty=!0},i.prototype.addSlot=function(t){if(!t||!t.name||this.slots[t.name])throw" new="" error;this.slots[t.name]="t,this._sortedSlots.push(t),this._slotDirty=!0},i.prototype.addSkin=function(t){if(!t||!t.name||this.skins[t.name])throw" error;this.skins[t.name]="t,this._defaultSkin||(this._defaultSkin=t)},i.prototype.addAnimation=function(t){if(!t||!t.name||this.animations[t.name])throw" error;this.animations[t.name]="t,this._defaultAnimation||(this._defaultAnimation=t)},i.prototype.getBone=function(t){return" this.bones[t]},i.prototype.getslot="function(t){return" this.slots[t]},i.prototype.getskin="function(t){return" t?this.skins[t]:this._defaultskin},i.prototype.getanimation="function(t){return" t?this.animations[t]:this._defaultanimation},object.defineproperty(i.prototype,"sortedbones",{get:function(){return="" this._bonedirty&&(this._bonedirty="!1,this._sortBones()),this._sortedBones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedSlots",{get:function(){return" this._slotdirty&&(this._slotdirty="!1,this._sortSlots()),this._sortedSlots},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultSkin",{get:function(){return" this._defaultskin},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"defaultanimation",{get:function(){return="" this._defaultanimation},enumerable:!0,configurable:!0}),i})(t.baseobject);t.armaturedata="e;var" i="(function(e){function" i(){e.call(this),this.transform="new" t.transform}return="" r(i,e),i.tostring="function(){return"[class" dragonbones.bonedata]"},i.prototype._onclear="function(){this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.parent=null,this.ik=null,this.transform.identity()},i})(t.BaseObject);t.BoneData=i;var" n="(function(e){function" i(){e.call(this),this.actions="[]}return" r(i,e),i.generatecolor="function(){return" t.colortransform},i.tostring="function(){return"[class" dragonbones.slotdata]"},i.prototype._onclear="function(){for(var" t="0,e=this.actions.length;t<e;++t)this.actions[t].returnToPool();this.displayIndex=0,this.zOrder=0,this.blendMode=0,this.name=null,this.parent=null,this.color=null,this.actions.length=0},i.DEFAULT_COLOR=new" t.colortransform,i})(t.baseobject);t.slotdata="n;var" s="(function(t){function" e(){t.call(this),this.slots="{}}return" r(e,t),e.tostring="function(){return"[class" dragonbones.skindata]"},e.prototype._onclear="function(){for(var" in="" this.slots)this.slots[t].returntopool(),delete="" this.slots[t];this.name="null},e.prototype.addSlot=function(t){if(!t||!t.slot||this.slots[t.slot.name])throw" error;this.slots[t.slot.name]="t},e.prototype.getSlot=function(t){return" this.slots[t]},e})(t.baseobject);t.skindata="s;var" o="(function(t){function" e(){t.call(this),this.displays="[]}return" dragonbones.slotdisplaydataset]"},e.prototype._onclear="function(){for(var" a="(function(e){function" i(){e.call(this),this.pivot="new" t.point,this.transform="new" dragonbones.displaydata]"},i.prototype._onclear="function(){this.mesh&&!this.share&&this.mesh.returnToPool(),this.boundingBox&&this.boundingBox.returnToPool(),this.isRelativePivot=!1,this.type=-1,this.inheritAnimation=!0,this.color=0,this.name=null,this.path=null,this.texture=null,this.armature=null,this.mesh=null,this.share=null,this.boundingBox=null,this.pivot.clear(),this.transform.identity()},i})(t.BaseObject);t.DisplayData=a;var" c="(function(e){function" i(){e.call(this),this.slotpose="new" t.matrix,this.uvs="[],this.vertices=[],this.vertexIndices=[],this.boneIndices=[],this.weights=[],this.boneVertices=[],this.bones=[],this.inverseBindPose=[]}return" dragonbones.meshdata]"},i.prototype._onclear="function(){this.skinned=!1,this.slotPose.identity(),this.uvs.length=0,this.vertices.length=0,this.vertexIndices.length=0,this.boneIndices.length=0,this.weights.length=0,this.boneVertices.length=0,this.bones.length=0,this.inverseBindPose.length=0},i})(t.BaseObject);t.MeshData=c;var" h="(function(t){function" e(){t.call(this),this.x="0,this.y=0,this.width=0,this.height=0,this.vertices=[]}return" dragonbones.boundingboxdata]"},e._computeoutcode="function(t,e,i,n,r,s){var" t<i?o|="1:t">r&&(o|=2),e<n?o|=4:e>s&&(o|=8),o},e.segmentIntersectsRectangle=function(t,i,n,r,s,o,a,c,h,l,u){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null);var _=t>s&&t<a&&i>o&&i<c,d=n>s&&n<a&&r>o&&r<c;if(_&&d)return-1;for(var 0="==c&&(c=null),void" f="0,p=e._computeOutCode(t,i,s,o,a,c),m=e._computeOutCode(n,r,s,o,a,c);;){if(!(p|m)){f=2;break}if(p&m)break;var" g="0,v=0,y=0,x=p?p:m;4&x?(g=t+(n-t)*(o-i)/(r-i),v=o,u&&(y=.5*-Math.PI)):8&x?(g=t+(n-t)*(c-i)/(r-i),v=c,u&&(y=.5*Math.PI)):2&x?(v=i+(r-i)*(a-t)/(n-t),g=a,u&&(y=0)):1&x&&(v=i+(r-i)*(s-t)/(n-t),g=s,u&&(y=Math.PI)),x==p?(t=g,i=v,p=e._computeOutCode(t,i,s,o,a,c),u&&(u.x=y)):(n=g,r=v,m=e._computeOutCode(n,r,s,o,a,c),u&&(u.y=y))}return" f&&(_?(f="2,h&&(h.x=n,h.y=r),l&&(l.x=n,l.y=n),u&&(u.x=u.y+Math.PI)):d?(f=1,h&&(h.x=t,h.y=i),l&&(l.x=t,l.y=i),u&&(u.y=u.x+Math.PI)):(f=3,h&&(h.x=t,h.y=i),l&&(l.x=n,l.y=r))),f},e.segmentIntersectsEllipse=function(t,e,i,n,r,s,o,a,c,h,l){void" u="o/a,_=u*u;e*=u,n*=u;var" d="i-t,f=n-e,p=Math.sqrt(d*d+f*f),m=d/p,g=f/p,v=(r-t)*m+(s-e)*g,y=v*v,x=t*t+e*e,T=o*o,b=T-x+y,C=0;if(b">=0){var A=Math.sqrt(b),S=v-A,E=v+A,w=S<0?-1:s<=p?0:1,i=e<0?-1:e<=p?0:1,r=w*i;if(r<0)return-1;0==r&&(w==-1?(c=2,i=t+e*m,n=(e+e*g) 0="==s&&(s=null),void" u,c&&(c.x="i,c.y=n),h&&(h.x=i,h.y=n),l&&(l.x=Math.atan2(n/T*_,i/T),l.y=l.x+Math.PI)):1==I?(C=1,t+=S*m,e=(e+S*g)/u,c&&(c.x=t,c.y=e),h&&(h.x=t,h.y=e),l&&(l.x=Math.atan2(e/T*_,t/T),l.y=l.x+Math.PI)):(C=3,c&&(c.x=t+S*m,c.y=(e+S*g)/u,l&&(l.x=Math.atan2(c.y/T*_,c.x/T))),h&&(h.x=t+E*m,h.y=(e+E*g)/u,l&&(l.y=Math.atan2(h.y/T*_,h.x/T)))))}return" c},e.segmentintersectspolygon="function(t,e,i,n,r,s,o,a){void" c="r.length,h=t-i,l=e-n,u=t*n-e*i,_=0,d=r[c-2],f=r[c-1],p=0,m=0,g=0,v=0,y=0,x=0,T=0;T<c;T+=2){var" b="r[T],C=r[T+1];d==b&&(d=b+.01),f==C&&(f=C+.01);var" a="d-b,S=f-C,E=d*C-f*b,w=h*S-l*A,I=(u*A-h*E)/w;if((I">=d&&I<=b||i>=b&&I<=d)&&(0==h||i>=t&&I<=i||i>=i&&I<=t)){var r="(u*S-l*E)/w;if((R">=f&&R<=c||r>=C&&R<=f)&&(0==l||r>=e&&R<=n||r>=n&&R<=e)){if(!o){g=i,v=r,y=i,x=r,_++,a&&(a.x=math.atan2(c-f,b-d)-.5*math.pi,a.y=a.x);break}var p="I-t;P<0&&(P=-P),0==_?(p=P,m=P,g=I,v=R,y=I,x=R,a&&(a.x=Math.atan2(C-f,b-d)-.5*Math.PI,a.y=a.x)):(P<p&&(p=P,g=I,v=R,a&&(a.x=Math.atan2(C-f,b-d)-.5*Math.PI)),P">m&&(m=P,y=I,x=R,a&&(a.y=Math.atan2(C-f,b-d)-.5*Math.PI))),_++}}d=b,f=C}return 1==_?(s&&(s.x=g,s.y=v),o&&(o.x=g,o.y=v),a&&(a.y=a.x+Math.PI)):_>1&&(_++,s&&(s.x=g,s.y=v),o&&(o.x=y,o.y=x)),_},e.prototype._onClear=function(){this.type=-1,this.x=0,this.y=0,this.width=0,this.height=0,this.vertices.length=0},e.prototype.containsPoint=function(t,e){var i=!1;if(2==this.type){if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var n="0,r=this.vertices.length,s=r-2;n<r;n+=2){var" o="this.vertices[s+1],a=this.vertices[n+1];if(a<e&&o">=e||o<e&&a>=e){var c=this.vertices[s],h=this.vertices[n];(e-a)*(c-h)/(o-a)+h<t&&(i=!i)}s=n}}else{var l=".5*this.width;if(t">=-l&&t<=l){var u=".5*this.height;e">=-u&&e<=u&&(1==this.type?(e*=l 0="==s&&(s=null),void" u,i="Math.sqrt(t*t+e*e)<=l):i=!0)}}return" i},e.prototype.intersectssegment="function(t,i,n,r,s,o,a){void" c="0;switch(this.type){case" 0:var="" h=".5*this.width,l=.5*this.height;c=e.segmentIntersectsRectangle(t,i,n,r,-h,-l,h,l,s,o,a);break;case" 1:c="e.segmentIntersectsEllipse(t,i,n,r,0,0,.5*this.width,.5*this.height,s,o,a);break;case" 2:0!="e.segmentIntersectsRectangle(t,i,n,r,this.x,this.y,this.width,this.height,null,null)&&(c=e.segmentIntersectsPolygon(t,i,n,r,this.vertices,s,o,a))}return" c},e})(t.baseobject);t.boundingboxdata="h})(n||(n={}));var" n;!(function(t){var="" e="(function(t){function" e(){t.call(this),this.armatures="{},this._armatureNames=[]}return" r(e,t),e.tostring="function(){return"[class" dragonbones.dragonbonesdata]"},e.prototype._onclear="function(){for(var" t="" in="" this.armatures)this.armatures[t].returntopool(),delete="" this.armatures[t];this.autosearch="!1,this.frameRate=0,this.name=null,this._armatureNames.length=0},e.prototype.getArmature=function(t){return" this.armatures[t]},e.prototype.addarmature="function(t){if(!t||!t.name||this.armatures[t.name])throw" new="" error;this.armatures[t.name]="t,this._armatureNames.push(t.name),t.parent=this},Object.defineProperty(e.prototype,"armatureNames",{get:function(){return" this._armaturenames},enumerable:!0,configurable:!0}),e.prototype.dispose="function(){this.returnToPool()},e})(t.BaseObject);t.DragonBonesData=e})(n||(n={}));var" e(){t.call(this),this.data="[]}return" dragonbones.actiondata]"},e.prototype._onclear="function(){this.type=-1,this.bone=null,this.slot=null,this.data.length=0},e})(t.BaseObject);t.ActionData=e;var" i="(function(t){function" e(){t.call(this),this.ints="[],this.floats=[],this.strings=[]}return" dragonbones.eventdata]"},e.prototype._onclear="function(){this.type=-1,this.name=null,this.ints.length=0,this.floats.length=0,this.strings.length=0,this.bone=null,this.slot=null},e})(t.BaseObject);t.EventData=i;var" n="(function(t){function" e(){t.call(this)}return="" r(e,t),e.prototype._onclear="function(){this.position=0,this.duration=0,this.prev=null,this.next=null},e})(t.BaseObject);t.FrameData=n;var" s="(function(e){function" i(){e.call(this)}return="" r(i,e),i._getcurvepoint="function(t,e,i,n,r,s,o,a,c,h){var" l="1-c,u=l*l,_=c*c,d=l*u,f=3*c*u,p=3*l*_,m=c*_;h.x=d*t+f*i+p*r+m*o,h.y=d*e+f*n+p*s+m*a},i.samplingEasingCurve=function(e,n){for(var" r="e.length,s=new" t.point,o="-2,a=0,c=n.length;a<c;++a){for(var">=0&&o+6<r,u=l?e[o]:0,_=l?e[o+1]:0,d=e[o+2],f=e[o+3],p=e[o+4],m=e[o+5],g=l?e[o+6]:1,v=l?e[o+7]:1,y=0,x=1;x-y>.01;){var T=(x+y)/2;i._getCurvePoint(u,_,d,f,p,m,g,v,T,s),h-s.x>0?y=T:x=T}n[a]=s.y}},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},i})(n);t.TweenFrameData=s;var o=(function(t){function e(){t.call(this),this.actions=[],this.events=[]}return r(e,t),e.toString=function(){return"[class dragonBones.AnimationFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions.length;e<i;++e)this.actions[e].returntopool();for(var e="0,i=this.events.length;e<i;++e)this.events[e].returnToPool();this.actions.length=0,this.events.length=0},e})(n);t.AnimationFrameData=o;var" a="(function(t){function" e(){t.call(this),this.zorder="[]}return" r(e,t),e.prototype._onclear="function(){t.prototype._onClear.call(this),this.zOrder.length=0},e})(n);t.ZOrderFrameData=a;var" c="(function(e){function" i(){e.call(this),this.transform="new" t.transform}return="" r(i,e),i.tostring="function(){return"[class" dragonbones.boneframedata]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.transform.identity()},i})(s);t.BoneFrameData=c;var" h="(function(e){function" i(){e.call(this)}return="" r(i,e),i.generatecolor="function(){return" new="" t.colortransform},i.tostring="function(){return"[class" dragonbones.slotframedata]"},i.prototype._onclear="function(){e.prototype._onClear.call(this),this.displayIndex=0,this.color=null},i.DEFAULT_COLOR=new" t.colortransform,i})(s);t.slotframedata="h;var" l="(function(t){function" e(){t.call(this),this.tweens="[],this.keys=[]}return" r(e,t),e.tostring="function(){return"[class" dragonbones.extensionframedata]"},e.prototype._onclear="function(){t.prototype._onClear.call(this),this.type=-1,this.tweens.length=0,this.keys.length=0},e})(s);t.ExtensionFrameData=l})(n||(n={}));var" n;!(function(t){var="" e(){this._data="null,this._armature=null,this._skin=null,this._slotDisplayDataSet=null,this._animation=null,this._timeline=null,this._isOldData=!1,this._isGlobalTransform=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._timelinePivot=new" t.point,this._helppoint="new" t.point,this._helptransforma="new" t.transform,this._helptransformb="new" t.transform,this._helpmatrix="new" t.matrix,this._rawbones="[]}return" e._getarmaturetype="function(t){switch(t.toLowerCase()){case"stage":return" 2;case"armature":return="" 0;case"movieclip":return="" 1;default:return-1}},e._getdisplaytype="function(t){switch(t.toLowerCase()){case"image":return" 0;case"mesh":return="" 1;case"boundingbox":return="" 3;default:return-1}},e._getboundingboxtype="function(t){switch(t.toLowerCase()){case"rectangle":return" 0;case"ellipse":return="" 1;case"polygon":return="" 2;default:return-1}},e._getblendmode="function(t){switch(t.toLowerCase()){case"normal":return" 0;case"add":return="" 1;case"alpha":return="" 2;case"darken":return="" 3;case"difference":return="" 4;case"erase":return="" 5;case"hardlight":return="" 6;case"invert":return="" 7;case"layer":return="" 8;case"lighten":return="" 9;case"multiply":return="" 10;case"overlay":return="" 11;case"screen":return="" 12;case"subtract":return="" 13;default:return-1}},e._getactiontype="function(t){switch(t.toLowerCase()){case"play":return" 0;case"stop":return="" 1;case"gotoandplay":return="" 2;case"gotoandstop":return="" 3;case"fadein":return="" 4;case"fadeout":return="" 5;default:return-1}},e.prototype._gettimelineframematrix="function(e,i,n,r){var" s="Math.floor(n*e.frameCount/e.duration);if(1==i.frames.length||s">=i.frames.length)r.copyFrom(i.frames[0].transform);else{var o=i.frames[s],a=0;o.tweenEasing!=t.DragonBones.NO_TWEEN?(a=(n-o.position)/o.duration,0!=o.tweenEasing&&(a=t.TweenTimelineState._getEasingValue(a,o.tweenEasing))):o.curve&&(a=(n-o.position)/o.duration,a=t.TweenTimelineState._getEasingCurveValue(a,o.curve));var c=o.next;r.x=c.transform.x-o.transform.x,r.y=c.transform.y-o.transform.y,r.skewX=t.Transform.normalizeRadian(c.transform.skewX-o.transform.skewX),r.skewY=t.Transform.normalizeRadian(c.transform.skewY-o.transform.skewY),r.scaleX=c.transform.scaleX-o.transform.scaleX,r.scaleY=c.transform.scaleY-o.transform.scaleY,r.x=o.transform.x+r.x*a,r.y=o.transform.y+r.y*a,r.skewX=o.transform.skewX+r.skewX*a,r.skewY=o.transform.skewY+r.skewY*a,r.scaleX=o.transform.scaleX+r.scaleX*a,r.scaleY=o.transform.scaleY+r.scaleY*a}r.add(i.originalTransform)},e.prototype._globalToLocal=function(t){for(var e=new Array,i=t.sortedBones.concat().reverse(),n=0,r=i.length;n<r;++n){var s="i[n];s.parent&&(s.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(s.transform.x,s.transform.y,this._helpPoint),s.transform.x=this._helpPoint.x,s.transform.y=this._helpPoint.y,s.transform.rotation-=s.parent.transform.rotation);for(var" o="" in="" t.animations){var="" a="t.animations[o],c=a.getBoneTimeline(s.name);if(c){var" h="s.parent?a.getBoneTimeline(s.parent.name):null;this._helpTransformB.copyFrom(c.originalTransform),e.length=0;for(var" l="0,u=c.frames.length;l<u;++l){var" _="c.frames[l];e.indexOf(_)">=0||(e.push(_),h?(this._getTimelineFrameMatrix(a,h,_.position,this._helpTransformA),_.transform.add(this._helpTransformB),this._helpTransformA.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(_.transform.x,_.transform.y,this._helpPoint),_.transform.x=this._helpPoint.x,_.transform.y=this._helpPoint.y,_.transform.rotation-=this._helpTransformA.rotation):_.transform.add(this._helpTransformB),_.transform.minus(s.transform),0==l?(c.originalTransform.copyFrom(_.transform),_.transform.identity()):_.transform.minus(c.originalTransform))}}}}},e.prototype._mergeFrameToAnimationTimeline=function(e,i,n){var r=Math.floor(e*this._armature.frameRate),s=this._animation.frames;if(0==s.length){var o=t.BaseObject.borrowObject(t.AnimationFrameData);if(o.position=0,this._animation.frameCount>1){s.length=this._animation.frameCount+1;var a=t.BaseObject.borrowObject(t.AnimationFrameData);a.position=this._animation.frameCount/this._armature.frameRate,s[0]=o,s[this._animation.frameCount]=a}}var c=null,h=s[r];if(!h||0!=r&&s[r-1]!=h.prev){c=t.BaseObject.borrowObject(t.AnimationFrameData),c.position=r/this._armature.frameRate,s[r]=c;for(var l=r+1,u=s.length;l<u;++l)h&&s[l]==h&&(s[l]=null)}else 0="==n&&(n=1);for(var" c="h;if(i)for(var" l="0,u=i.length;l<u;++l)c.actions.push(i[l]);if(n)for(var" _="null,d=null,l=0,u=s.length;l<u;++l){var" f="s[l];f&&d!=f?(d=f,_&&(d.prev=_,_.next=d,_.duration=d.position-_.position),_=d):s[l]=_}d.duration=this._animation.duration-d.position,d=s[0],_.next=d,d.prev=_},e.parseDragonBonesData=function(e){return" t.objectdataparser.getinstance().parsedragonbonesdata(e)},e.parsetextureatlasdata="function(i,n){void" r="{},s=i[e.SUB_TEXTURE],o=0,a=s.length;o<a;o++){var" t.rectangle,u="null;l.x=c[e.X]/n,l.y=c[e.Y]/n,l.width=c[e.WIDTH]/n,l.height=c[e.HEIGHT]/n,e.FRAME_WIDTH" in="" c&&(u="new" t.rectangle,u.x="c[e.FRAME_X]/n,u.y=c[e.FRAME_Y]/n,u.width=c[e.FRAME_WIDTH]/n,u.height=c[e.FRAME_HEIGHT]/n),r[h]={region:l,frame:u,rotated:!1}}return" r},e.data_version_2_3="2.3" ,e.data_version_3_0="3.0" ,e.data_version_4_0="4.0" ,e.data_version="4.5" ,e.texture_atlas="TextureAtlas" ,e.sub_texture="SubTexture" ,e.format="format" ,e.image_path="imagePath" ,e.width="width" ,e.height="height" ,e.rotated="rotated" ,e.frame_x="frameX" ,e.frame_y="frameY" ,e.frame_width="frameWidth" ,e.frame_height="frameHeight" ,e.dradon_bones="dragonBones" ,e.armature="armature" ,e.bone="bone" ,e.ik="ik" ,e.slot="slot" ,e.skin="skin" ,e.display="display" ,e.animation="animation" ,e.z_order="zOrder" ,e.ffd="ffd" ,e.frame="frame" ,e.events="events" ,e.actions="actions" ,e.ints="ints" ,e.floats="floats" ,e.strings="strings" ,e.pivot="pivot" ,e.transform="transform" ,e.aabb="aabb" ,e.color="color" ,e.filter="filter" ,e.version="version" ,e.is_global="isGlobal" ,e.frame_rate="frameRate" ,e.type="type" ,e.sub_type="subType" ,e.name="name" ,e.parent="parent" ,e.share="share" ,e.length="length" ,e.data="data" ,e.display_index="displayIndex" ,e.blend_mode="blendMode" ,e.inherit_translation="inheritTranslation" ,e.inherit_rotation="inheritRotation" ,e.inherit_scale="inheritScale" ,e.inherit_animation="inheritAnimation" ,e.target="target" ,e.bend_positive="bendPositive" ,e.chain="chain" ,e.weight="weight" ,e.fade_in_time="fadeInTime" ,e.play_times="playTimes" ,e.scale="scale" ,e.offset="offset" ,e.position="position" ,e.duration="duration" ,e.tween_easing="tweenEasing" ,e.tween_rotate="tweenRotate" ,e.tween_scale="tweenScale" ,e.curve="curve" ,e.guide_curve="guideCurve" ,e.event="event" ,e.sound="sound" ,e.action="action" ,e.default_actions="defaultActions" ,e.x="x" ,e.y="y" ,e.skew_x="skX" ,e.skew_y="skY" ,e.scale_x="scX" ,e.scale_y="scY" ,e.alpha_offset="aO" ,e.red_offset="rO" ,e.green_offset="gO" ,e.blue_offset="bO" ,e.alpha_multiplier="aM" ,e.red_multiplier="rM" ,e.green_multiplier="gM" ,e.blue_multiplier="bM" ,e.uvs="uvs" ,e.vertices="vertices" ,e.triangles="triangles" ,e.weights="weights" ,e.slot_pose="slotPose" ,e.bone_pose="bonePose" ,e.tween="tween" ,e.key="key" ,e.color_transform="colorTransform" ,e.timeline="timeline" ,e.pivot_x="pX" ,e.pivot_y="pY" ,e.z="z" ,e.loop="loop" ,e.auto_tween="autoTween" ,e.hide="hide" ,e})();t.dataparser="e})(n||(n={}));var" n;!(function(t){var="" e="(function(e){function" i(){e.call(this)}return="" r(i,e),i._getboolean="function(t,e,i){if(e" t){var="" n="t[e],r=typeof" n;if("boolean"="=r)return" n;if("string"!="r)return!!n;switch(n){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return" i},i._getnumber="function(t,e,i){if(e" null="=n||"NaN"==n?i:+n||0}return" i},i._getstring="function(t,e,i){return" t?string(t[e]):i},i._getparameter="function(t,e,i){return" t.length="">e?t[e]:i},i.prototype._parseArmature=function(e,n){var r=t.BaseObject.borrowObject(t.ArmatureData);if(r.name=i._getString(e,i.NAME,null),r.frameRate=i._getNumber(e,i.FRAME_RATE,this._data.frameRate)||this._data.frameRate,r.scale=n,i.TYPE in e&&"string"==typeof e[i.TYPE]?r.type=i._getArmatureType(e[i.TYPE]):r.type=i._getNumber(e,i.TYPE,0),this._armature=r,this._rawBones.length=0,i.AABB in e){var s=e[i.AABB];r.aabb.x=i._getNumber(s,i.X,0),r.aabb.y=i._getNumber(s,i.Y,0),r.aabb.width=i._getNumber(s,i.WIDTH,0),r.aabb.height=i._getNumber(s,i.HEIGHT,0)}if(i.BONE in e)for(var o=e[i.BONE],a=0,c=o.length;a<c;++a){var h="o[a],l=this._parseBone(h);r.addBone(l,i._getString(h,i.PARENT,null)),this._rawBones.push(l)}if(i.IK" in="" e)for(var="" u="e[i.IK],a=0,c=u.length;a<c;++a)this._parseIK(u[a]);if(i.SLOT" _="e[i.SLOT],d=0,a=0,c=_.length;a<c;++a)r.addSlot(this._parseSlot(_[a],d++));if(i.SKIN" f="e[i.SKIN],a=0,c=f.length;a<c;++a)r.addSkin(this._parseSkin(f[a]));if(i.ANIMATION" p="e[i.ANIMATION],a=0,c=p.length;a<c;++a)r.addAnimation(this._parseAnimation(p[a]));return(i.ACTIONS" e||i.default_actions="" e)&&this._parseactiondata(e,r.actions,null,null),this._isolddata&&this._isglobaltransform&&this._globaltolocal(r),this._armature="null,this._rawBones.length=0,r},i.prototype._parseBone=function(e){var" n="t.BaseObject.borrowObject(t.BoneData);return" n.name="i._getString(e,i.NAME,null),n.inheritTranslation=i._getBoolean(e,i.INHERIT_TRANSLATION,!0),n.inheritRotation=i._getBoolean(e,i.INHERIT_ROTATION,!0),n.inheritScale=i._getBoolean(e,i.INHERIT_SCALE,!0),n.length=i._getNumber(e,i.LENGTH,0)*this._armature.scale,i.TRANSFORM" e&&this._parsetransform(e[i.transform],n.transform),this._isolddata&&(n.inheritscale="!1),n},i.prototype._parseIK=function(t){var" e="this._armature.getBone(i._getString(t,i.BONE" t?i.bone:i.name,null));e&&(e.ik="this._armature.getBone(i._getString(t,i.TARGET,null)),e.bendPositive=i._getBoolean(t,i.BEND_POSITIVE,!0),e.chain=i._getNumber(t,i.CHAIN,0),e.weight=i._getNumber(t,i.WEIGHT,1),e.chain">0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},i.prototype._parseSlot=function(e,n){var r=t.BaseObject.borrowObject(t.SlotData);return r.name=i._getString(e,i.NAME,null),r.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),r.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),r.zOrder=i._getNumber(e,i.Z,n),i.COLOR in e||i.COLOR_TRANSFORM in e?(r.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],r.color)):r.color=t.SlotData.DEFAULT_COLOR,i.BLEND_MODE in e&&"string"==typeof e[i.BLEND_MODE]?r.blendMode=i._getBlendMode(e[i.BLEND_MODE]):r.blendMode=i._getNumber(e,i.BLEND_MODE,0),(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,r.actions,null,null),this._isOldData&&(i.COLOR_TRANSFORM in e?(r.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR_TRANSFORM],r.color)):r.color=t.SlotData.DEFAULT_COLOR),r},i.prototype._parseSkin=function(e){var n=t.BaseObject.borrowObject(t.SkinData);if(n.name=i._getString(e,i.NAME,"__default")||"__default",i.SLOT in e){this._skin=n;for(var r=e[i.SLOT],s=0,o=0,a=r.length;o<a;++o)this._isolddata&&this._armature.addslot(this._parseslot(r[o],s++)),n.addslot(this._parseslotdisplayset(r[o]));this._skin=null}return n},i.prototype._parseslotdisplayset="function(e){var" n="t.BaseObject.borrowObject(t.SlotDisplayDataSet);if(n.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),i.DISPLAY" in="" e){var="" r="e[i.DISPLAY],s=n.displays;this._slotDisplayDataSet=n;for(var" o="0,a=r.length;o<a;++o)s.push(this._parseDisplay(r[o]));this._slotDisplayDataSet=null}return" n},i.prototype._parsedisplay="function(e){var" e&&"string"="=typeof" e[i.type]?n.type="i._getDisplayType(e[i.TYPE]):n.type=i._getNumber(e,i.TYPE,0),n.isRelativePivot=!0,i.PIVOT" if(this._isolddata){var="" s="e[i.TRANSFORM];n.isRelativePivot=!1,n.pivot.x=i._getNumber(s,i.PIVOT_X,0)*this._armature.scale,n.pivot.y=i._getNumber(s,i.PIVOT_Y,0)*this._armature.scale}else" n.pivot.x=".5,n.pivot.y=.5;switch(i.TRANSFORM" e&&this._parsetransform(e[i.transform],n.transform),n.type){case="" 0:break;case="" 1:break;case="" 2:var="" a="0,c=this._slotDisplayDataSet.displays.length;a<c;++a){var" h="this._slotDisplayDataSet.displays[a];if(h.name==o){n.share=h,n.mesh=h.mesh;break}}else" n.mesh="this._parseMesh(e);break;case" 3:n.boundingbox="this._BoundingBox(e)}return" n},i.prototype._boundingbox="function(e){var" e[i.sub_type]?n.type="i._getBoundingBoxType(e[i.SUB_TYPE]):n.type=i._getNumber(e,i.SUB_TYPE,0),n.type){case" 0:case="" 1:n.width="i._getNumber(e,i.WIDTH,0),n.height=i._getNumber(e,i.HEIGHT,0);break;case" 2:if(i.vertices="">n.width&&(n.width=c),h<n.y?n.y=h:h>n.height&&(n.height=h))}}}return n},i.prototype._parseMesh=function(e){var n=t.BaseObject.borrowObject(t.MeshData),r=e[i.VERTICES],s=e[i.UVS],o=e[i.TRIANGLES],a=Math.floor(r.length/2),c=Math.floor(o.length/3),h=new Array(this._armature.sortedBones.length);if(n.skinned=i.WEIGHTS in e&&e[i.WEIGHTS].length>0,n.uvs.length=2*a,n.vertices.length=2*a,n.vertexIndices.length=3*c,n.skinned){if(n.boneIndices.length=a,n.weights.length=a,n.boneVertices.length=a,i.SLOT_POSE in e){var l=e[i.SLOT_POSE];n.slotPose.a=l[0],n.slotPose.b=l[1],n.slotPose.c=l[2],n.slotPose.d=l[3],n.slotPose.tx=l[4]*this._armature.scale,n.slotPose.ty=l[5]*this._armature.scale}if(i.BONE_POSE in e)for(var u=e[i.BONE_POSE],_=0,d=u.length;_<d;_+=7){var 1="=n.scale&&0==n.offset||(this._animation.hasAsynchronyTimeline=!0),this._isOldData&&(i.PIVOT_X" f="u[_],p=h[f]=new" t.matrix;p.a="u[_+1],p.b=u[_+2],p.c=u[_+3],p.d=u[_+4],p.tx=u[_+5]*this._armature.scale,p.ty=u[_+6]*this._armature.scale,p.invert()}}for(var" _="0,m=0,d=r.length;_<d;_+=2){var" g="_+1,v=_/2,y=n.vertices[_]=r[_]*this._armature.scale,x=n.vertices[g]=r[g]*this._armature.scale;if(n.uvs[_]=s[_],n.uvs[g]=s[g],n.skinned){var" t="e[i.WEIGHTS],b=T[m],C=n.boneIndices[v]=new" array(b),a="n.weights[v]=new" array(b),s="n.boneVertices[v]=new" array(2*b);n.slotpose.transformpoint(y,x,this._helppoint),y="n.vertices[_]=this._helpPoint.x,x=n.vertices[g]=this._helpPoint.y;for(var" e="0;E<b;++E){var" w="m+1+2*E,f=T[w],I=this._rawBones[f],R=n.bones.indexOf(I);R<0&&(R=n.bones.length,n.bones[R]=I,n.inverseBindPose[R]=h[f]),n.inverseBindPose[R].transformPoint(y,x,this._helpPoint),C[E]=R,A[E]=T[w+1],S[2*E]=this._helpPoint.x,S[2*E+1]=this._helpPoint.y}m+=2*b+1}}for(var" n},i.prototype._parseanimation="function(e){var" n="t.BaseObject.borrowObject(t.AnimationData);n.name=i._getString(e,i.NAME,"__default")||"__default",n.frameCount=Math.max(i._getNumber(e,i.DURATION,1),1),n.position=i._getNumber(e,i.POSITION,0)/this._armature.frameRate,n.duration=n.frameCount/this._armature.frameRate,n.playTimes=i._getNumber(e,i.PLAY_TIMES,1),n.fadeInTime=i._getNumber(e,i.FADE_IN_TIME,0),this._animation=n;var" r="i._getString(e,i.ANIMATION,null);if(r)return" n.animation="this._armature.getAnimation(r),!n.animation,n;if(this._parseTimeline(e,n,this._parseAnimationFrame),i.Z_ORDER" in="" e&&(n.zordertimeline="t.BaseObject.borrowObject(t.ZOrderTimelineData),this._parseTimeline(e[i.Z_ORDER],n.zOrderTimeline,this._parseZOrderFrame)),i.BONE" e)for(var="" s="e[i.BONE],o=0,a=s.length;o<a;++o)n.addBoneTimeline(this._parseBoneTimeline(s[o]));if(i.SLOT" c="e[i.SLOT],o=0,a=c.length;o<a;++o)n.addSlotTimeline(this._parseSlotTimeline(c[o]));if(i.FFD" h="e[i.FFD],o=0,a=h.length;o<a;++o)n.addFFDTimeline(this._parseFFDTimeline(h[o]));if(this._isOldData){if(this._isAutoTween=i._getBoolean(e,i.AUTO_TWEEN,!0),this._animationTweenEasing=i._getNumber(e,i.TWEEN_EASING,0)||0,n.playTimes=i._getNumber(e,i.LOOP,1),i.TIMELINE" l="e[i.TIMELINE],o=0,a=l.length;o<a;++o){var" u="l[o];n.addBoneTimeline(this._parseBoneTimeline(u)),n.addSlotTimeline(this._parseSlotTimeline(u))}}else" this._isautotween="!1,this._animationTweenEasing=0;for(var" o="" this._armature.bones){var="" d="t.BaseObject.borrowObject(t.BoneTimelineData),f=t.BaseObject.borrowObject(t.BoneFrameData);d.bone=_,d.frames[0]=f,n.addBoneTimeline(d)}}for(var" this._armature.slots){var="" p="this._armature.slots[o];if(!n.getSlotTimeline(p.name)){var" m="t.BaseObject.borrowObject(t.SlotTimelineData),g=t.BaseObject.borrowObject(t.SlotFrameData);m.slot=p,g.displayIndex=p.displayIndex,p.color==t.SlotData.DEFAULT_COLOR?g.color=t.SlotFrameData.DEFAULT_COLOR:(g.color=t.SlotFrameData.generateColor(),g.color.copyFrom(p.color)),m.frames[0]=g,n.addSlotTimeline(m),this._isOldData&&(g.displayIndex=-1)}}return" this._animation="null,n},i.prototype._parseBoneTimeline=function(e){var" e||i.pivot_y="" e)?(this._timelinepivot.x="i._getNumber(e,i.PIVOT_X,0),this._timelinePivot.y=i._getNumber(e,i.PIVOT_Y,0)):this._timelinePivot.clear(),n},i.prototype._parseSlotTimeline=function(e){var" n.slot="this._armature.getSlot(i._getString(e,i.NAME,null)),this._parseTimeline(e,n,this._parseSlotFrame),1==n.scale&&0==n.offset||(this._animation.hasAsynchronyTimeline=!0),n},i.prototype._parseFFDTimeline=function(e){" var="" a="n.slot.displays[s];if(a.mesh&&a.name==r){n.display=a;break}}return" this._parsetimeline(e,n,this._parseffdframe),n},i.prototype._parseanimationframe="function(e,n,r){var" this._parseframe(e,s,n,r),(i.action="" e||i.actions="" e)&&this._parseactiondata(e,s.actions,null,null),(i.event="" e||i.sound="" e)&&this._parseeventdata(e,s.events,null,null),s},i.prototype._parsezorderframe="function(e,n,r){var">0){var a=this._armature.sortedSlots.length,c=new Array(a-o.length/2);s.zOrder.length=a;for(var h=0;h<a;++h)s.zorder[h]=-1;for(var l="0,u=0,_=0,d=o.length;_<d;_+=2){for(var" f="o[_],p=o[_+1];l!=f;)c[u++]=l++;s.zOrder[l+p]=l++}for(;l<a;)c[u++]=l++;for(var" m="a;m--;)s.zOrder[m]==-1&&(s.zOrder[m]=c[--u])}return" s},i.prototype._parseboneframe="function(e,n,r){var" s="t.BaseObject.borrowObject(t.BoneFrameData);if(s.tweenRotate=i._getNumber(e,i.TWEEN_ROTATE,0),s.tweenScale=i._getBoolean(e,i.TWEEN_SCALE,!0),this._parseTweenFrame(e,s,n,r),i.TRANSFORM" in="" e){var="" o="e[i.TRANSFORM];this._parseTransform(o,s.transform),this._isOldData&&(this._helpPoint.x=this._timelinePivot.x+i._getNumber(o,i.PIVOT_X,0),this._helpPoint.y=this._timelinePivot.y+i._getNumber(o,i.PIVOT_Y,0),s.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),s.transform.x+=this._helpPoint.x,s.transform.y+=this._helpPoint.y)}var" a="this._timeline.bone,c=new" array,h="new" array;if(i.action="" e||i.actions="" e||i.sound="" e)&&this._parseeventdata(e,h,a,null),(c.length="">0||h.length>0)&&this._mergeFrameToAnimationTimeline(s.position,c,h),s},i.prototype._parseSlotFrame=function(e,n,r){var s=t.BaseObject.borrowObject(t.SlotFrameData);if(s.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),this._parseTweenFrame(e,s,n,r),i.COLOR in e||i.COLOR_TRANSFORM in e?(s.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],s.color)):s.color=t.SlotFrameData.DEFAULT_COLOR,this._isOldData)i._getBoolean(e,i.HIDE,!1)&&(s.displayIndex=-1);else if(i.ACTION in e||i.ACTIONS in e){var o=this._timeline.slot,a=new Array;this._parseActionData(e,a,o.parent,o),this._mergeFrameToAnimationTimeline(s.position,a,null)}return s},i.prototype._parseFFDFrame=function(e,n,r){var s=this._timeline,o=s.display.mesh,a=t.BaseObject.borrowObject(t.ExtensionFrameData);a.type=i._getNumber(e,i.TYPE,0),this._parseTweenFrame(e,a,n,r);for(var c=e[i.VERTICES],h=i._getNumber(e,i.OFFSET,0),l=0,u=0,_=0,d=o.vertices.length;_<d;_+=2)if(!c||_<h||_-h>=c.length?(l=0,u=0):(l=c[_-h]*this._armature.scale,u=c[_+1-h]*this._armature.scale),o.skinned){o.slotPose.transformPoint(l,u,this._helpPoint,!0),l=this._helpPoint.x,u=this._helpPoint.y;for(var f=o.boneIndices[_/2],p=0,m=f.length;p<m;++p){var g="f[p];o.inverseBindPose[g].transformPoint(l,u,this._helpPoint,!0),a.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else" a.tweens.push(l,u);return="" a},i.prototype._parsetweenframe="function(e,n,r,s){this._parseFrame(e,n,r,s),n.duration">0?(i.TWEEN_EASING in e?n.tweenEasing=i._getNumber(e,i.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isOldData?n.tweenEasing=this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN:n.tweenEasing=t.DragonBones.NO_TWEEN,this._isOldData&&1==this._animation.scale&&1==this._timeline.scale&&n.duration*this._armature.frameRate<2&&(n.tweeneasing=t.dragonbones.no_tween),s>0&&i.CURVE in e&&(n.curve=new Array(2*s-1),t.TweenFrameData.samplingEasingCurve(e[i.CURVE],n.curve))):(n.tweenEasing=t.DragonBones.NO_TWEEN,n.curve=null)},i.prototype._parseFrame=function(t,e,i,n){e.position=i/this._armature.frameRate,e.duration=n/this._armature.frameRate},i.prototype._parseTimeline=function(e,n,r){if(n.scale=i._getNumber(e,i.SCALE,1),n.offset=i._getNumber(e,i.OFFSET,0),i.FRAME in e){this._timeline=n;var s=e[i.FRAME];if(1==s.length)n.frames.length=1,n.frames[0]=r.call(this,s[0],0,i._getNumber(s[0],i.DURATION,1));else if(s.length>1){n.frames.length=this._animation.frameCount+1;for(var o=0,a=0,c=null,h=null,l=0,u=0,_=n.frames.length;l<_;++l){if(o+a<=l&&u<s.length){var 0="==n&&(n=1),e){var" d="s[u++];o=l,a=i._getNumber(d,i.DURATION,1),c=r.call(this,d,o,a),h&&(h.next=c,c.prev=h,this._isOldData&&h" instanceof="" t.tweenframedata&&i._getnumber(d,i.display_index,0)="=-1&&(h.tweenEasing=t.DragonBones.NO_TWEEN)),h=c}n.frames[l]=c}c.duration=this._animation.duration-c.position,c=n.frames[0],h.next=c,c.prev=h,this._isOldData&&h" t.tweenframedata&&i._getnumber(s[0],i.display_index,0)="=-1&&(h.tweenEasing=t.DragonBones.NO_TWEEN)}this._timeline=null}},i.prototype._parseActionData=function(e,n,r,s){var" o="e[i.ACTION]||e[i.ACTIONS]||e[i.DEFAULT_ACTIONS];if("string"==typeof" o){var="" a="t.BaseObject.borrowObject(t.ActionData);a.type=4,a.bone=r,a.slot=s,a.data[0]=o,a.data[1]=-1,a.data[2]=-1,n.push(a)}else" if(o="" array)for(var="" c="0,h=o.length;c<h;++c){var" l="o[c],u=l" array,a="t.BaseObject.borrowObject(t.ActionData),_=u?i._getParameter(l,1,null):i._getString(l,"gotoAndPlay",null);if(u){var" d?a.type="i._getActionType(d):a.type=i._getParameter(l,0,4)}else" a.type="2;switch(a.type){case" 0:a.data[0]="_,a.data[1]=u?i._getParameter(l,2,-1):-1;break;case" 1:a.data[0]="_;break;case" 2:a.data[0]="_,a.data[1]=u?i._getParameter(l,2,0):0,a.data[2]=u?i._getParameter(l,3,-1):-1;break;case" 3:a.data[0]="_,a.data[1]=u?i._getParameter(l,2,0):0;break;case" 4:a.data[0]="_,a.data[1]=u?i._getParameter(l,2,-1):-1,a.data[2]=u?i._getParameter(l,3,-1):-1;break;case" 5:a.data[0]="_,a.data[1]=u?i._getParameter(l,2,0):0}a.bone=r,a.slot=s,n.push(a)}},i.prototype._parseEventData=function(e,n,r,s){if(i.SOUND" in="" e){var="" e)for(var="" u="c[h],_=i._getString(u,i.BONE,null),a=t.BaseObject.borrowObject(t.EventData);if(a.type=10,a.name=i._getString(u,i.NAME,null),a.bone=this._armature.getBone(_),i.INTS" u)for(var="" m="u[i.FLOATS],g=0,v=m.length;g<v;++g)a.floats.push(i._getParameter(m,g,0));if(i.STRINGS" y="u[i.STRINGS],x=0,T=y.length;x<T;++x)a.strings.push(i._getParameter(y,x,null));n.push(a)}},i.prototype._parseTransform=function(e,n){n.x=i._getNumber(e,i.X,0)*this._armature.scale,n.y=i._getNumber(e,i.Y,0)*this._armature.scale,n.skewX=i._getNumber(e,i.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN,n.skewY=i._getNumber(e,i.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN,n.scaleX=i._getNumber(e,i.SCALE_X,1),n.scaleY=i._getNumber(e,i.SCALE_Y,1)},i.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*i._getNumber(t,i.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*i._getNumber(t,i.RED_MULTIPLIER,100),e.greenMultiplier=.01*i._getNumber(t,i.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*i._getNumber(t,i.BLUE_MULTIPLIER,100),e.alphaOffset=i._getNumber(t,i.ALPHA_OFFSET,0),e.redOffset=i._getNumber(t,i.RED_OFFSET,0),e.greenOffset=i._getNumber(t,i.GREEN_OFFSET,0),e.blueOffset=i._getNumber(t,i.BLUE_OFFSET,0)},i.prototype.parseDragonBonesData=function(e,n){if(void" r="i._getString(e,i.VERSION,null);if(this._isOldData=r==i.DATA_VERSION_2_3||r==i.DATA_VERSION_3_0,this._isOldData?this._isGlobalTransform=i._getBoolean(e,i.IS_GLOBAL,!0):this._isGlobalTransform=!1,r==i.DATA_VERSION||r==i.DATA_VERSION_4_0||this._isOldData){var" s="t.BaseObject.borrowObject(t.DragonBonesData);if(s.name=i._getString(e,i.NAME,null),s.frameRate=i._getNumber(e,i.FRAME_RATE,24)||24,i.ARMATURE" e){this._data="s;for(var" s}throw="" new="" error("nonsupport="" data="" version.")}throw="" error("no="" data.")},i.prototype.parsetextureatlasdata="function(e,n,r){if(void" data.");if(n.name="i._getString(e,i.NAME,null),n.imagePath=i._getString(e,i.IMAGE_PATH,null),r">0?n.scale=r:r=n.scale=i._getNumber(e,i.SCALE,n.scale),r=1/r,i.SUB_TEXTURE in e)for(var s=e[i.SUB_TEXTURE],o=0,a=s.length;o<a;++o){var c="s[o],h=n.generateTextureData();h.name=i._getString(c,i.NAME,null),h.rotated=i._getBoolean(c,i.ROTATED,!1),h.region.x=i._getNumber(c,i.X,0)*r,h.region.y=i._getNumber(c,i.Y,0)*r,h.region.width=i._getNumber(c,i.WIDTH,0)*r,h.region.height=i._getNumber(c,i.HEIGHT,0)*r;var" l="i._getNumber(c,i.FRAME_WIDTH,-1),u=i._getNumber(c,i.FRAME_HEIGHT,-1);l">0&&u>0&&(h.frame=t.TextureData.generateRectangle(),h.frame.x=i._getNumber(c,i.FRAME_X,0)*r,h.frame.y=i._getNumber(c,i.FRAME_Y,0)*r,h.frame.width=l*r,h.frame.height=u*r),n.addTexture(h)}},i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i._instance=null,i})(t.DataParser);t.ObjectDataParser=e})(n||(n={}));var n;!(function(t){var e=(function(t){function e(){t.call(this),this.textures={}}return r(e,t),e.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.scale=1,this.name=null,this.imagePath=null},e.prototype.addTexture=function(t){if(!t||!t.name||this.textures[t.name])throw new Error;this.textures[t.name]=t,t.parent=this},e.prototype.getTexture=function(t){return this.textures[t]},e})(t.BaseObject);t.TextureAtlasData=e;var i=(function(e){function i(){e.call(this),this.region=new t.Rectangle}return r(i,e),i.generateRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name=null,this.frame=null,this.parent=null,this.region.clear()},i})(t.BaseObject);t.TextureData=i})(n||(n={}));var n;!(function(t){var e=(function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dataParser=null,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dataParser=i,this._dataParser||(e._defaultParser||(e._defaultParser=new t.ObjectDataParser),this._dataParser=e._defaultParser)}return e.prototype._getTextureData=function(t,e){var i=this._textureAtlasDataMap[t];if(i)for(var n=0,r=i.length;n<r;++n){var s="i[n].getTexture(e);if(s)return" s}if(this.autosearch)for(var="" n="" in="" this._textureatlasdatamap){i="this._textureAtlasDataMap[n];for(var" o="0,a=i.length;o<a;++o){var" c="i[o];if(c.autoSearch){var" s}}}return="" null},e.prototype._fillbuildarmaturepackage="function(t,e,i,n,r){var" a="" this._dragonbonesdatamap)if(s="this._dragonBonesDataMap[a],(!e||s.autoSearch)&&(o=s.getArmature(i))){e=a;break}return!!o&&(t.dataName=e,t.textureAtlasName=r,t.data=s,t.armature=o,t.skin=o.getSkin(n),t.skin||(t.skin=o.defaultSkin),!0)},e.prototype._buildBones=function(e,i){for(var" i="t.skin,n=t.armature.defaultSkin,r={};for(var" n.slots){var="" i.slots){var="" h="a[s],o=r[h.name];if(o){var" l="this._generateSlot(t,o,e);l&&(l._displayDataSet=o,l._setDisplayIndex(h.displayIndex),l._setBlendMode(h.blendMode),l._setColor(h.color),e.addSlot(l,h.parent.name))}}},e.prototype._replaceSlotDisplay=function(t,e,i,n){if(n<0&&(n=i.displayIndex),n">=0){var r=i.displayList;if(r.length<=n&&(r.length=n+1),i._replaceddisplaydataset.length<=n&&(i._replaceddisplaydataset.length=n+1),i._replaceddisplaydataset[n]=e,1==e.type){var 0="==e&&(e=null),void" s="this.buildArmature(e.path,t.dataName,null,t.textureAtlasName);r[n]=s}else" e.texture&&!t.textureatlasname||(e.texture="this._getTextureData(t.textureAtlasName||t.dataName,e.path)),e.mesh||n<i._displayDataSet.displays.length&&i._displayDataSet.displays[n].mesh?r[n]=i.meshDisplay:r[n]=i.rawDisplay;i.displayList=r,i.invalidUpdate()}},e.prototype.parseDragonBonesData=function(t,e,i){void" n="this._dataParser.parseDragonBonesData(t,i);return" this.adddragonbonesdata(n,e),n},e.prototype.parsetextureatlasdata="function(t,e,i,n){void" r="this._generateTextureAtlasData(null,null);return" this._dataparser.parsetextureatlasdata(t,r,n),this._generatetextureatlasdata(r,e),this.addtextureatlasdata(r,i),r},e.prototype.getdragonbonesdata="function(t){return" this._dragonbonesdatamap[t]},e.prototype.adddragonbonesdata="function(t,e){if(void" new="" error;e="e||t.name,e?this._dragonBonesDataMap[e]?console.warn("Same" name="" data.",e):this._dragonbonesdatamap[e]="t:console.warn("Unnamed" data.")},e.prototype.removedragonbonesdata="function(e,i){void" o="t.DragonBones._armatures[r];if(o.armatureData.parent==n)throw" error("armaturedata:="" "+o.armaturedata.name+"="" dragonbonesdata:="" "+e)}n.returntopool()}delete="" this._dragonbonesdatamap[e]}},e.prototype.gettextureatlasdata="function(t){return" this._textureatlasdatamap[t]},e.prototype.addtextureatlasdata="function(t,e){if(void" error;if(e="e||t.name){var" i="this._textureAtlasDataMap[e]=this._textureAtlasDataMap[e]||[];i.indexOf(t)<0&&i.push(t)}else" console.warn("unnamed="" data.")},e.prototype.removetextureatlasdata="function(t,e){void" this._textureatlasdatamap[t]}},e.prototype.clear="function(t){void" e="" in="" this._dragonbonesdatamap)t&&this._dragonbonesdatamap[e].returntopool(),delete="" this._dragonbonesdatamap[e];for(var="" this._textureatlasdatamap){if(t)for(var="" this._textureatlasdatamap[e]}},e.prototype.buildarmature="function(t,e,i,n){void" this._buildbones(r,s),this._buildslots(r,s),s.advancetime(0),s}return="" console.warn("no="" armature="" data.",t,e||""),null},e.prototype.copyanimationstoarmature="function(e,i,n,r,s){void" a="o.armature;if(s)e.animation.animations=a.animations;else{var" c="{};for(var" h="" e.animation.animations)c[h]="e.animation.animations[h];for(var" a.animations)c[h]="a.animations[h];e.animation.animations=c}if(o.skin){for(var" l="e.getSlots(),u=0,_=l.length;u<_;++u)for(var" d="l[u],f=d.displayList,p=0,m=f.length;p<m;++p){var" g="f[p];if(g" instanceof="" t.armature){var="" v="o.skin.getSlot(d.name).displays;if(p<v.length){var" y="v[p];1==y.type&&this.copyAnimationsToArmature(g,y.path,n,r,s)}}}return!0}}return!1},e.prototype.replaceSlotDisplay=function(t,e,i,n,r,s){void" this._dragonbonesdatamap},e.prototype.getalltextureatlasdata="function(){return" this._textureatlasdatamap},e._defaultparser="null,e})();t.BaseFactory=e})(n||(n={})),e.exports=n}),{}],301:[(function(t,e,i){var" cc._rendertype="==cc.game.RENDER_TYPE_CANVAS?new" sp._sgskeleton.canvasrendercmd(this):new="" sp._sgskeleton.webglrendercmd(this)},init:function(){_ccsg.node.prototype.init.call(this),this._premultipliedalpha="cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this.scheduleUpdate()},setDebugSlotsEnabled:function(t){this._debugSlots=t},getDebugSlotsEnabled:function(){return" this._debugslots},setdebugbonesenabled:function(t){this._debugbones="t},getDebugBonesEnabled:function(){return" this._debugbones},settimescale:function(t){this._timescale="t},getTimeScale:function(){return" this._timescale},initwithargs:function(t,e,i){var="" r,s,o,a="t,c=e;if(cc.js.isString(a)){if(cc.js.isString(c)){var" n.textureatlas(h,sp._atlasloader.load.bind(sp._atlasloader))}else="" n.atlasattachmentloader(s),u="new" n.skeletonjson(l);u.scale="i;var" _="cc.loader.getRes(a);r=u.readSkeletonData(_),s.dispose(u),o=!0}else" t="cc.macro.FLT_MAX,e=cc.macro.FLT_MAX,i=cc.macro.FLT_MIN,r=cc.macro.FLT_MIN,s=this.getScaleX(),o=this.getScaleY(),a=[],c=this._skeleton.slots,h=n.RegionAttachment,l=0,u=c.length;l<u;++l){var" n.regionattachment&&(a="d.updateWorldVertices(_,!1),t=Math.min(t,a[h.X1]*s,a[h.X4]*s,a[h.X2]*s,a[h.X3]*s),e=Math.min(e,a[h.Y1]*o,a[h.Y4]*o,a[h.Y2]*o,a[h.Y3]*o),i=Math.max(i,a[h.X1]*s,a[h.X4]*s,a[h.X2]*s,a[h.X3]*s),r=Math.max(r,a[h.Y1]*o,a[h.Y4]*o,a[h.Y2]*o,a[h.Y3]*o))}var" f="this.getPosition();return" cc.rect(f.x+t,f.y+e,i-t,r-e)},updateworldtransform:function(){this._skeleton.updateworldtransform()},settosetuppose:function(){this._skeleton.settosetuppose()},setbonestosetuppose:function(){this._skeleton.setbonestosetuppose()},setslotstosetuppose:function(){this._skeleton.setslotstosetuppose()},findbone:function(t){return="" this._skeleton.findbone(t)},findslot:function(t){return="" this._skeleton.findslot(t)},setskin:function(t){return="" this._skeleton.setskinbyname(t)},getattachment:function(t,e){return="" this._skeleton.getattachmentbyname(t,e)},setattachment:function(t,e){this._skeleton.setattachment(t,e)},setpremultipliedalpha:function(t){this._premultipliedalpha="t},isPremultipliedAlpha:function(){return" this._premultipliedalpha},setskeletondata:function(t,e){null!="t.width&&null!=t.height&&this.setContentSize(t.width/cc.director.getContentScaleFactor(),t.height/cc.director.getContentScaleFactor()),this._skeleton=new" n.skeleton(t),this._skeleton.updateworldtransform(),this._rootbone="this._skeleton.getRootBone(),this._ownsSkeletonData=e,this._renderCmd._createChildFormSkeletonData()},getTextureAtlas:function(t){return" t.region},getblendfunc:function(){return="" this._blendfunc},setblendfunc:function(t,e){var="" cc.textureatlas(i,128),t.width="i.getPixelWidth(),t.height=i.getPixelHeight()},sp._atlasPage_createTexture_canvas=function(t,e){t._texture=cc.textureCache.addImage(e)},sp._atlasPage_disposeTexture=function(t){t.rendererObject.release()},sp._atlasLoader={spAtlasFile:null,setAtlasFile:function(t){this.spAtlasFile=t},load:function(t){var" sp.skeletontexture({width:i.getpixelwidth(),height:i.getpixelheight()});return="" n.setrealtexture(i),n},unload:function(t){}},sp.trackentrylisteners="function(t,e,i,n,r,s){this.startListener=t||null,this.endListener=e||null,this.completeListener=i||null,this.eventListener=n||null,this.interruptListener=r||null,this.disposeListener=s||null,this.callback=null,this.callbackTarget=null,this.skeletonNode=null};var" t.listener||(t.listener="new" sp.trackentrylisteners),t.listener},sp._sgskeletonanimation="sp._SGSkeleton.extend({_state:null,_ownsAnimationStateData:!1,_listener:null,init:function(){sp._SGSkeleton.prototype.init.call(this),this._ownsAnimationStateData=!0,this.setAnimationStateData(new" n.animationstatedata(this._skeleton.data))},setanimationstatedata:function(t){var="" n.animationstate(t);this._listener="new" sp.trackentrylisteners,e.rendererobject="this,e.addListener(this._listener),this._state=e},setMix:function(t,e,i){this._state.data.setMixWith(t,e,i)},setAnimationListener:function(t,e){this._listener.callbackTarget=t,this._listener.callback=e,this._listener.skeletonNode=this},setAnimation:function(t,e,i){var" n?this._state.setanimationwith(t,n,i):(cc.logid(7509,e),null)},addanimation:function(t,e,i,n){n="null==n?0:n;var" r?this._state.addanimationwith(t,r,i,n):(cc.logid(7510,e),null)},findanimation:function(t){return="" this._skeleton.data.findanimation(t)},getcurrent:function(t){return="" this._state.getcurrent(t)},cleartracks:function(){this._state.cleartracks()},cleartrack:function(t){this._state.cleartrack(t)},update:function(t){this._super(t),t*="this._timeScale,this._renderCmd.setDirtyFlag(_ccsg.Node._dirtyFlags.contentDirty),this._state.update(t),this._state.apply(this._skeleton),this._skeleton.updateWorldTransform(),this._renderCmd._updateChild()},setStartListener:function(t){this._listener.startListener=t},setInterruptListener:function(t){this._listener.interruptListener=t},setEndListener:function(t){this._listener.endListener=t},setDisposeListener:function(t){this._listener.disposeListener=t},setCompleteListener:function(t){this._listener.completeListener=t},setEventListener:function(t){this._listener.eventListener=t},setTrackStartListener:function(t,e){sp.TrackEntryListeners.getListeners(t).startListener=e},setTrackInterruptListener:function(t,e){sp.TrackEntryListeners.getListeners(t).interruptListener=e},setTrackEndListener:function(t,e){sp.TrackEntryListeners.getListeners(t).endListener=e},setTrackDisposeListener:function(t,e){sp.TrackEntryListeners.getListeners(t).disposeListener=e},setTrackCompleteListener:function(t,e){sp.TrackEntryListeners.getListeners(t).completeListener=e},setTrackEventListener:function(t,e){sp.TrackEntryListeners.getListeners(t).eventListener=e},getState:function(){return" this._state}})}),{}],303:[(function(t,e,i){var="" r,s,o,a,c="this._node;t=t||cc._renderContext;var" u,_="cc._drawingUtil;if(c._debugSlots){_.setDrawColor(0,0,255,255),_.setLineWidth(1);var" n.regionattachment&&(u="o.attachment,this._updateRegionAttachmentSlot(u,o,d),_.drawPoly(d,4,!0))}if(c._debugBones){var" f;for(_.setlinewidth(2),_.setdrawcolor(255,0,0,255),r="0,s=h.bones.length;r<s;r++){f=h.bones[r];var" p="f.data.length*f.a+f.worldX,m=f.data.length*f.c+f.worldY;_.drawLine({x:f.worldX,y:f.worldY},{x:p,y:m})}for(_.setPointSize(4),_.setDrawColor(0,0,255,255),r=0,s=h.bones.length;r<s;r++)f=h.bones[r],_.drawPoint({x:f.worldX,y:f.worldY}),0===r&&_.setDrawColor(0,255,0,255)}}},r.updateStatus=function(){this.originUpdateStatus(),this._updateCurrentRegions(),this._regionFlag=_ccsg.Node.CanvasRenderCmd.RegionStatus.DirtyDouble,this._dirtyFlag&=~_ccsg.Node._dirtyFlags.contentDirty},r.getLocalBB=function(){return" this._node.getboundingbox()},r._updateregionattachmentslot="function(t,e,i){if(i){var" t,e,i="this._node,r=i._skeleton,s=0,o=r.slots.length;s<o;s++){var" _ccsg.node;a._slotnode="h,c" n.regionattachment?(t="c.region.name,e=this._createSprite(a,c),a.currentSprite=e,a.currentSpriteName=t,h.addChild(e)):c" n.meshattachment}},r._createsprite="function(t,e){var" cc.rect(i.x,i.y,i.width,i.height),s="new" _ccsg.sprite;return="" s.initwithtexture(n,r,i.rotate,!1),s._rect.width="e.width,s._rect.height=e.height,s.setContentSize(e.width,e.height),s.setRotation(-e.rotation),s.setScale(i.width/i.originalWidth*e.scaleX,i.height/i.originalHeight*e.scaleY),t.sprites=t.sprites||{},t.sprites[i.name]=s,s},r._updateChild=function(){var" t,e,i,r,s,o,a,c,h="this._node._skeleton,l=h.slots,u=this._displayedColor,_=this._displayedOpacity;for(t=0,e=l.length;t<e;t++)if(o=l[t],a=o.attachment,c=o._slotNode,a){if(a" n.regionattachment){if(a.region&&(!o.currentspritename||o.currentspritename!="=a.name)){var" 0!="=o.currentSprite&&o.currentSprite.setVisible(!1),o.sprites=o.sprites||{},void" m="0|u.r*o.color.r,g=0|u.g*o.color.g,v=0|u.b*o.color.b;i.setColor(cc.color(m,g,v)),i._renderCmd._updateColor()}else" if(!(a="" n.meshattachment)){c.setvisible(!1);continue}c.setvisible(!0)}else="" c.setvisible(!1)}}),{}],304:[(function(t,e,i){sp.skeletontexture="cc.Class({name:"sp.SkeletonTexture",extends:sp.spine.Texture,_texture:null,setRealTexture:function(t){this._texture=t},getRealTexture:function(){return" this._texture},setfilters:function(t,e){if(cc._rendertype="==cc.game.RENDER_TYPE_WEBGL){var" cc.math.matrix4,this._matrix.identity(),this.vertextype="cc.renderer.VertexType.CUSTOM,this.setShaderProgram(cc.shaderCache.programForKey(cc.macro.SHADER_POSITION_TEXTURECOLOR))};var" r,s,o,a,c,h="this._node,l=this._displayedColor,u=h._skeleton,_=h._premultipliedAlpha,d=-1,f=!1,p=0,m=this._worldTransform,g=this._matrix.mat;g[0]=m.a,g[4]=m.c,g[12]=m.tx,g[1]=m.b,g[5]=m.d,g[13]=m.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),u.r=l.r/255,u.g=l.g/255,u.b=l.b/255,u.a=this._displayedOpacity/255,_&&(u.r*=u.a,u.g*=u.a,u.b*=u.a);var" n.regionattachment)y="6;else{if(!(s" n.meshattachment))continue;y="s.regionUVs.length/2}if(0!==y){var" x="h.getTextureAtlas(s);f||(r=x,d=o.data.blendMode,cc.renderer._updateBatchedInfo(r.texture.getRealTexture(),this._getBlendFunc(d,_),this.getShaderProgram()),f=!0),(6*(p+y)">t.length||r!==x||d!==o.data.blendMode)&&(cc.renderer._batchRendering(),i=0,p=0,r=x,d=o.data.blendMode,cc.renderer._updateBatchedInfo(r.texture.getRealTexture(),this._getBlendFunc(d,_),this.getShaderProgram()));var T=null;if(s instanceof n.RegionAttachment)T=this._uploadRegionAttachmentData(s,o,_,t,e,i);else{if(!(s instanceof n.MeshAttachment))continue;this._uploadMeshAttachmentData(s,o,_,t,e,i)}this._node._debugSlots&&(v[a]=T),s instanceof n.RegionAttachment?cc.renderer._increaseBatchingSize(y,cc.renderer.VertexType.TRIANGLE):cc.renderer._increaseBatchingSize(y,cc.renderer.VertexType.CUSTOM,s.triangles),p+=y,i+=6*y}}if(p>0&&cc.renderer._batchRendering(),h._debugBones||h._debugSlots){cc.math.glMatrixMode(cc.math.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._matrix;var b=cc._drawingUtil;if(h._debugSlots&&v&&v.length>0)for(b.setDrawColor(0,0,255,255),b.setLineWidth(1),a=0,c=u.slots.length;a<c;a++){var c="v[a];C&&b.drawPoly(C,4,!0)}if(h._debugBones){var" a;for(b.setlinewidth(2),b.setdrawcolor(255,0,0,255),a="0,c=u.bones.length;a<c;a++){A=u.bones[a];var" s="A.data.length*A.a+A.worldX,E=A.data.length*A.c+A.worldY;b.drawLine(cc.p(A.worldX,A.worldY),cc.p(S,E))}for(b.setPointSize(4),b.setDrawColor(0,0,255,255),a=0,c=u.bones.length;a<c;a++)A=u.bones[a],b.drawPoint(cc.p(A.worldX,A.worldY)),0==a&&b.setDrawColor(0,255,0,255)}cc.math.glPopMatrix()}return" 0},r._getblendfunc="function(t,e){var" i="{};switch(t){" case="" n.blendmode.normal:i.src="e?cc.macro.ONE:cc.macro.SRC_ALPHA,i.dst=cc.macro.ONE_MINUS_SRC_ALPHA;break;case" n.blendmode.additive:i.src="e?cc.macro.ONE:cc.macro.SRC_ALPHA,i.dst=cc.macro.ONE;break;case" n.blendmode.multiply:i.src="cc.macro.DST_COLOR,i.dst=cc.macro.ONE_MINUS_SRC_ALPHA;break;case" n.blendmode.screen:i.src="cc.macro.ONE,i.dst=cc.macro.ONE_MINUS_SRC_COLOR;break;default:i=this._node._blendFunc}return" i},r._createchildformskeletondata="function(){},r._updateChild=function(){},r._uploadRegionAttachmentData=function(t,e,i,r,s,o){for(var" a="this._displayedColor,c=a.r,h=a.g,l=a.b,u=this._displayedOpacity,_=t.updateWorldVertices(e,i),d=o,f=0;f<6;f++){var" p="f<4?f%3:f-2,m=_[8*p+2]*c,g=_[8*p+3]*h,v=_[8*p+4]*l,y=_[8*p+5]*u,x=y<<24|v<<16|g<<8|m;r[d]=_[8*p],r[d+1]=_[8*p+1],r[d+2]=this._node.vertexZ,s[d+3]=x,r[d+4]=_[8*p+6],r[d+5]=_[8*p+7],d+=6}if(this._node._debugSlots){var" t="n.RegionAttachment;return[cc.p(_[T.X1],_[T.Y1]),cc.p(_[T.X2],_[T.Y2]),cc.p(_[T.X3],_[T.Y3]),cc.p(_[T.X4],_[T.Y4])]}},r._uploadMeshAttachmentData=function(t,e,i,n,r,s){for(var" o="t.updateWorldVertices(e,i),a=s,c=this._displayedColor,h=c.r,l=c.g,u=c.b,_=this._displayedOpacity,d=0,f=o.length;d<f;d+=8){var" n="cc.Enum({default:-1}),r=cc.Enum({"<None">":0});sp.Skeleton=cc.Class({name:"sp.Skeleton",extends:cc._RendererUnderSG,editor:!1,properties:{_startListener:{default:null,serializable:!1},_endListener:{default:null,serializable:!1},_completeListener:{default:null,serializable:!1},_eventListener:{default:null,serializable:!1},_disposeListener:{default:null,serializable:!1},_interruptListener:{default:null,serializable:!1},_paused:!1,paused:{get:function(){return this._paused},set:function(t){this._paused=t,this._sgNode&&(t?this._sgNode.pause():this._sgNode.resume())},visible:!1},skeletonData:{default:null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._refresh()},tooltip:!1},defaultSkin:{default:"",visible:!1},defaultAnimation:{default:"",visible:!1},animation:{get:function(){var t=this.getCurrent(0);return t&&t.animation.name||""},set:function(t){this.defaultAnimation=t,t?this.setAnimation(0,t,this.loop):(this.clearTrack(0),this.setToSetupPose())},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData&&this.defaultSkin){var t=this.skeletonData.getSkinsEnum();if(t){var e=t[this.defaultSkin];if(void 0!==e)return e}}return 0},set:function(t){var e;if(this.skeletonData&&(e=this.skeletonData.getSkinsEnum()),!e)return cc.errorID("",this.name);var i=e[t];void 0!==i?this.defaultSkin=i:cc.errorID(7501,this.name)},type:n,visible:!0,displayName:"Default Skin",tooltip:!1},_animationIndex:{get:function(){var t=this.animation;if(this.skeletonData&&t){var e=this.skeletonData.getAnimsEnum();if(e){var i=e[t];if(void 0!==i)return i}}return 0},set:function(t){if(0===t)return void(this.animation="");var e;if(this.skeletonData&&(e=this.skeletonData.getAnimsEnum()),!e)return cc.errorID(7502,this.name);var i=e[t];void 0!==i?this.animation=i:cc.errorID(7503,this.name)},type:r,visible:!0,displayName:"Animation",tooltip:!1},loop:{default:!0,tooltip:!1},_premultipliedAlpha:!0,premultipliedAlpha:{get:function(){return this._premultipliedAlpha},set:function(t){this._premultipliedAlpha=t,this._sgNode&&this._sgNode.setPremultipliedAlpha(t)},tooltip:!1},timeScale:{default:1,notify:function(){this._sgNode&&this._sgNode.setTimeScale(this.timeScale)},tooltip:!1},debugSlots:{default:!1,notify:function(){this._sgNode&&this._sgNode.setDebugSlotsEnabled(this.debugSlots)},editorOnly:!0,tooltip:!1},debugBones:{default:!1,notify:function(){this._sgNode&&this._sgNode.setDebugBonesEnabled(this.debugBones)},editorOnly:!0,tooltip:!1}},__preload:function(){this.node.setContentSize(0,0),this._refresh()},_createSgNode:function(){if(this.skeletonData){var t=this.skeletonData.getRuntimeData();if(t)try{return new sp._SGSkeletonAnimation(t,null,this.skeletonData.scale)}catch(t){cc._throw(t)}}return null},_initSgNode:function(){var t=this._sgNode;t.setTimeScale(this.timeScale);var e=this;if(t.onEnter=function(){_ccsg.Node.prototype.onEnter.call(this),e._paused&&this.pause()},this._startListener&&this.setStartListener(this._startListener),this._endListener&&this.setEndListener(this._endListener),this._completeListener&&this.setCompleteListener(this._completeListener),this._eventListener&&this.setEventListener(this._eventListener),this._interruptListener&&this.setInterruptListener(this._interruptListener),this._disposeListener&&this.setDisposeListener(this._disposeListener),this.defaultSkin)try{t.setSkin(this.defaultSkin)}catch(t){cc._throw(t)}t.setPremultipliedAlpha(this._premultipliedAlpha),this.animation=this.defaultAnimation},_getLocalBounds:!1,updateWorldTransform:function(){this._sgNode&&this._sgNode.updateWorldTransform()},setToSetupPose:function(){this._sgNode&&this._sgNode.setToSetupPose()},setBonesToSetupPose:function(){this._sgNode&&this._sgNode.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._sgNode&&this._sgNode.setSlotsToSetupPose()},findBone:function(t){return this._sgNode?this._sgNode.findBone(t):null},findSlot:function(t){return this._sgNode?this._sgNode.findSlot(t):null},setSkin:function(t){return this._sgNode?this._sgNode.setSkin(t):null},getAttachment:function(t,e){return this._sgNode?this._sgNode.getAttachment(t,e):null},setAttachment:function(t,e){this._sgNode&&this._sgNode.setAttachment(t,e)},setSkeletonData:function(t,e){this._sgNode&&this._sgNode.setSkeletonData(t,e)},setAnimationStateData:function(t){if(this._sgNode)return this._sgNode.setAnimationStateData(t)},setMix:function(t,e,i){this._sgNode&&this._sgNode.setMix(t,e,i)},setAnimationListener:function(t,e){this._sgNode&&this._sgNode.setAnimationListener(t,e)},setAnimation:function(t,e,i){if(this._sgNode){var n=this._sgNode.setAnimation(t,e,i);return n}return null},_sample:function(){this._sgNode&&this._sgNode.update(0)},addAnimation:function(t,e,i,n){return this._sgNode?this._sgNode.addAnimation(t,e,i,n):null},findAnimation:function(t){return this._sgNode?this._sgNode.findAnimation(t):null},getCurrent:function(t){return this._sgNode?this._sgNode.getCurrent(t):null},clearTracks:function(){this._sgNode&&this._sgNode.clearTracks()},clearTrack:function(t){this._sgNode&&this._sgNode.clearTrack(t)},_updateAnimEnum:!1,_updateSkinEnum:!1,setStartListener:function(t){this._startListener=t,this._sgNode&&this._sgNode.setStartListener(t)},setInterruptListener:function(t){this._interruptListener=t,this._sgNode&&this._sgNode.setInterruptListener(t)},setEndListener:function(t){this._endListener=t,this._sgNode&&this._sgNode.setEndListener(t)},setDisposeListener:function(t){this._disposeListener=t,this._sgNode&&this._sgNode.setDisposeListener(t)},setCompleteListener:function(t){this._completeListener=t,this._sgNode&&this._sgNode.setCompleteListener(t)},setEventListener:function(t){this._eventListener=t,this._sgNode&&this._sgNode.setEventListener(t)},setTrackStartListener:function(t,e){this._sgNode&&this._sgNode.setTrackStartListener(t,e)},setTrackInterruptListener:function(t,e){this._sgNode&&this._sgNode.setTrackInterruptListener(t,e)},setTrackEndListener:function(t,e){this._sgNode&&this._sgNode.setTrackEndListener(t,e)},setTrackDisposeListener:function(t,e){this._sgNode&&this._sgNode.setTrackDisposeListener(t,e)},setTrackCompleteListener:function(t,e){this._sgNode&&this._sgNode.setTrackCompleteListener(t,e)},setTrackEventListener:function(t,e){this._sgNode&&this._sgNode.setTrackEventListener(t,e)},getState:function(){if(this._sgNode)return this._sgNode.getState()},_refresh:function(){var t=this;t._sgNode&&(t.node._sizeProvider===t._sgNode&&(t.node._sizeProvider=null),t._removeSgNode(),t._sgNode=null);var e=t._sgNode=t._createSgNode();e&&(t.enabledInHierarchy||e.setVisible(!1),e.setContentSize(0,0),t._initSgNode(),t._appendSgNode(e),t._registSizeProvider())}})}),{}],307:[(function(t,e,i){var n=cc.Class({ctor:function(){this.asset=arguments[0]},getTexture:function(t){for(var e=this.asset.textures,i=0;i<e.length;i++){var n="e[i];if(n.endsWith(t)){var" r="cc.textureCache.addImage(n),s=new" sp.skeletontexture({width:r.getpixelwidth(),height:r.getpixelheight()});return="" s.setrealtexture(r),s}}return="" null},load:function(t){var="" e="this.getTexture(t);return" e?e:(cc.errorid(7506,t),null)},unload:function(t){}}),r="cc.Class({name:"sp.SkeletonData",extends:cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJson:{get:function(){return" this._skeletonjson},set:function(t){this._skeletonjson="t,this.reset()}},_atlasText:"",atlasText:{get:function(){return" this._atlastext},set:function(t){this._atlastext="t,this.reset()}},atlasUrl:{default:"",url:cc.RawAsset},textures:{default:[],url:[cc.Texture2D]},scale:1},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){this._skeletonCache=null,this._atlasCache=null},getRuntimeData:function(t){if(this._skeletonCache)return" this._skeletoncache;if(!(this.textures&&this.textures.length="">0))return t||cc.errorID(7507,this.name),null;var e=this._getAtlas(t);if(!e)return null;var i=new sp.spine.AtlasAttachmentLoader(e),n=new sp.spine.SkeletonJson(i);n.scale=this.scale;var r=this.skeletonJson;return this._skeletonCache=n.readSkeletonData(r),e.dispose(n),this._skeletonCache},getSkinsEnum:!1,getAnimsEnum:!1,_getAtlas:function(t){if(this._atlasCache)return this._atlasCache;if(!this.atlasText)return t||cc.errorID(7508,this.name),null;var e=new n(this);return this._atlasCache=new sp.spine.TextureAtlas(this.atlasText,e.load.bind(e))}});sp.SkeletonData=e.exports=r}),{}],308:[(function(t,e,i){sp={},sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5}),sp.spine=t("./lib/spine"),t("./SGSkeletonTexture"),t("./SGSkeleton"),t("./SGSkeletonCanvasRenderCmd"),t("./SGSkeletonWebGLRenderCmd"),t("./SGSkeletonAnimation"),t("./SkeletonData"),t("./Skeleton")}),{"./SGSkeleton":301,"./SGSkeletonAnimation":302,"./SGSkeletonCanvasRenderCmd":303,"./SGSkeletonTexture":304,"./SGSkeletonWebGLRenderCmd":305,"./Skeleton":306,"./SkeletonData":307,"./lib/spine":309}],309:[(function(t,e,i){var n,r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};!(function(t){var e=(function(){function t(t,e,i){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=i}return t.prototype.apply=function(t,e,i,n,r,s,o,a){if(null==t)throw new Error("skeleton cannot be null.");n&&0!=this.duration&&(i%=this.duration,e>0&&(e%=this.duration));for(var c=this.timelines,h=0,l=c.length;h<l;h++)c[h].apply(t,e,i,r,s,o,a)},t.binarysearch=function(t,e,i){void 0="==i&&(i=1);var" n="0,r=t.length/i-2;if(0==r)return" i;for(var="" s="r">>>1;;){if(t[(s+1)*i]<=e?n=s+1:r=s,n==r)return(n+1)*i;s=n+r>>>1}},t.linearSearch=function(t,e,i){for(var n=0,r=t.length-i;n<=r;n+=i)if(t[n]>e)return n;return-1},t})();t.Animation=e,(function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix"})(t.TimelineType||(t.TimelineType={}));var i=t.TimelineType,n=(function(){function e(i){if(i<=0)throw new="" error("framecount="" must="" be=""> 0: "+i);this.curves=t.Utils.newFloatArray((i-1)*e.BEZIER_SIZE)}return e.prototype.getFrameCount=function(){return this.curves.length/e.BEZIER_SIZE+1},e.prototype.setLinear=function(t){this.curves[t*e.BEZIER_SIZE]=e.LINEAR},e.prototype.setStepped=function(t){this.curves[t*e.BEZIER_SIZE]=e.STEPPED},e.prototype.getCurveType=function(t){var i=t*e.BEZIER_SIZE;if(i==this.curves.length)return e.LINEAR;var n=this.curves[i];return n==e.LINEAR?e.LINEAR:n==e.STEPPED?e.STEPPED:e.BEZIER},e.prototype.setCurve=function(t,i,n,r,s){var o=.03*(2*-i+r),a=.03*(2*-n+s),c=.006*(3*(i-r)+1),h=.006*(3*(n-s)+1),l=2*o+c,u=2*a+h,_=.3*i+o+.16666667*c,d=.3*n+a+.16666667*h,f=t*e.BEZIER_SIZE,p=this.curves;p[f++]=e.BEZIER;for(var m=_,g=d,v=f+e.BEZIER_SIZE-1;f<v;f+=2)p[f]=m,p[f+1]=g,_+=l,d+=u,l+=c,u+=h,m+=_,g+=d},e.prototype.getcurvepercent=function(i,n){n=t.mathutils.clamp(n,0,1);var r="this.curves,s=i*e.BEZIER_SIZE,o=r[s];if(o==e.LINEAR)return" n;if(o="=e.STEPPED)return" 0;s++;for(var="" a="0,c=s,h=s+e.BEZIER_SIZE-1;s<h;s+=2)if(a=r[s],a">=n){var l=void 0,u=void 0;return s==c?(l=0,u=0):(l=r[s-2],u=r[s-1]),u+(r[s+1]-u)*(n-l)/(a-l)}var _=r[s-1];return _+(1-_)*(n-a)/(1-a)},e.LINEAR=0,e.STEPPED=1,e.BEZIER=2,e.BEZIER_SIZE=19,e})();t.CurveTimeline=n;var s=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e<<1)}return r(s,n),s.prototype.getpropertyid="function(){return(i.rotate<<24)+this.boneIndex},s.prototype.setFrame=function(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+s.ROTATION]=i},s.prototype.apply=function(t,i,n,r,o,a,c){var" h="this.frames,l=t.bones[this.boneIndex];if(n<h[0])return" void(a&&(l.rotation="l.data.rotation));if(n">=h[h.length-s.ENTRIES])if(a)l.rotation=l.data.rotation+h[h.length+s.PREV_ROTATION]*o;else{var u=l.data.rotation+h[h.length+s.PREV_ROTATION]-l.rotation;u-=360*(16384-(16384.499999999996-u/360|0)),l.rotation+=u*o}else{var _=e.binarySearch(h,n,s.ENTRIES),d=h[_+s.PREV_ROTATION],f=h[_],p=this.getCurvePercent((_>>1)-1,1-(n-f)/(h[_+s.PREV_TIME]-f)),m=h[_+s.ROTATION]-d;m-=360*(16384-(16384.499999999996-m/360|0)),m=d+m*p,a?(m-=360*(16384-(16384.499999999996-m/360|0)),l.rotation=l.data.rotation+m*o):(m=l.data.rotation+m-l.rotation,m-=360*(16384-(16384.499999999996-m/360|0)),l.rotation+=m*o)}},s.ENTRIES=2,s.PREV_TIME=-2,s.PREV_ROTATION=-1,s.ROTATION=1,s})(n);t.RotateTimeline=s;var o=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e*s.ENTRIES)}return r(s,n),s.prototype.getPropertyId=function(){return(i.translate<<24)+this.boneindex},s.prototype.setframe=function(t,e,i,n){t*=s.entries,this.frames[t]=e,this.frames[t+s.x]=i,this.frames[t+s.y]=n},s.prototype.apply=function(t,i,n,r,o,a,c){var h="this.frames,l=t.bones[this.boneIndex];if(n<h[0])return" void(a&&(l.x="l.data.x,l.y=l.data.y));var" u="0,_=0;if(n">=h[h.length-s.ENTRIES])u=h[h.length+s.PREV_X],_=h[h.length+s.PREV_Y];else{var d=e.binarySearch(h,n,s.ENTRIES);u=h[d+s.PREV_X],_=h[d+s.PREV_Y];var f=h[d],p=this.getCurvePercent(d/s.ENTRIES-1,1-(n-f)/(h[d+s.PREV_TIME]-f));u+=(h[d+s.X]-u)*p,_+=(h[d+s.Y]-_)*p}a?(l.x=l.data.x+u*o,l.y=l.data.y+_*o):(l.x+=(l.data.x+u-l.x)*o,l.y+=(l.data.y+_-l.y)*o)},s.ENTRIES=3,s.PREV_TIME=-3,s.PREV_X=-2,s.PREV_Y=-1,s.X=1,s.Y=2,s})(n);t.TranslateTimeline=o;var a=(function(n){function s(t){n.call(this,t)}return r(s,n),s.prototype.getPropertyId=function(){return(i.scale<<24)+this.boneindex},s.prototype.apply=function(i,n,r,o,a,c,h){var l="this.frames,u=i.bones[this.boneIndex];if(r<l[0])return" void(c&&(u.scalex="u.data.scaleX,u.scaleY=u.data.scaleY));var" _="0,d=0;if(r">=l[l.length-s.ENTRIES])_=l[l.length+s.PREV_X]*u.data.scaleX,d=l[l.length+s.PREV_Y]*u.data.scaleY;else{var f=e.binarySearch(l,r,s.ENTRIES);_=l[f+s.PREV_X],d=l[f+s.PREV_Y];var p=l[f],m=this.getCurvePercent(f/s.ENTRIES-1,1-(r-p)/(l[f+s.PREV_TIME]-p));_=(_+(l[f+s.X]-_)*m)*u.data.scaleX,d=(d+(l[f+s.Y]-d)*m)*u.data.scaleY}if(1==a)u.scaleX=_,u.scaleY=d;else{var g=0,v=0;c?(g=u.data.scaleX,v=u.data.scaleY):(g=u.scaleX,v=u.scaleY),h?(_=Math.abs(_)*t.MathUtils.signum(g),d=Math.abs(d)*t.MathUtils.signum(v)):(g=Math.abs(g)*t.MathUtils.signum(_),v=Math.abs(v)*t.MathUtils.signum(d)),u.scaleX=g+(_-g)*a,u.scaleY=v+(d-v)*a}},s})(o);t.ScaleTimeline=a;var c=(function(t){function n(e){t.call(this,e)}return r(n,t),n.prototype.getPropertyId=function(){return(i.shear<<24)+this.boneindex},n.prototype.apply=function(t,i,r,s,o,a,c){var h="this.frames,l=t.bones[this.boneIndex];if(r<h[0])return" void(a&&(l.shearx="l.data.shearX,l.shearY=l.data.shearY));var" u="0,_=0;if(r">=h[h.length-n.ENTRIES])u=h[h.length+n.PREV_X],_=h[h.length+n.PREV_Y];else{var d=e.binarySearch(h,r,n.ENTRIES);u=h[d+n.PREV_X],_=h[d+n.PREV_Y];var f=h[d],p=this.getCurvePercent(d/n.ENTRIES-1,1-(r-f)/(h[d+n.PREV_TIME]-f));u+=(h[d+n.X]-u)*p,_+=(h[d+n.Y]-_)*p}a?(l.shearX=l.data.shearX+u*o,l.shearY=l.data.shearY+_*o):(l.shearX+=(l.data.shearX+u-l.shearX)*o,l.shearY+=(l.data.shearY+_-l.shearY)*o)},n})(o);t.ShearTimeline=c;var h=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e*s.ENTRIES)}return r(s,n),s.prototype.getPropertyId=function(){return(i.color<<24)+this.slotindex},s.prototype.setframe=function(t,e,i,n,r,o){t*=s.entries,this.frames[t]=e,this.frames[t+s.r]=i,this.frames[t+s.g]=n,this.frames[t+s.b]=r,this.frames[t+s.a]=o},s.prototype.apply=function(t,i,n,r,o,a,c){var h="t.slots[this.slotIndex],l=this.frames;if(n<l[0])return" void(a&&h.color.setfromcolor(h.data.color));var="" u="0,_=0,d=0,f=0;if(n">=l[l.length-s.ENTRIES]){var p=l.length;u=l[p+s.PREV_R],_=l[p+s.PREV_G],d=l[p+s.PREV_B],f=l[p+s.PREV_A]}else{var m=e.binarySearch(l,n,s.ENTRIES);u=l[m+s.PREV_R],_=l[m+s.PREV_G],d=l[m+s.PREV_B],f=l[m+s.PREV_A];var g=l[m],v=this.getCurvePercent(m/s.ENTRIES-1,1-(n-g)/(l[m+s.PREV_TIME]-g));u+=(l[m+s.R]-u)*v,_+=(l[m+s.G]-_)*v,d+=(l[m+s.B]-d)*v,f+=(l[m+s.A]-f)*v}if(1==o)h.color.set(u,_,d,f);else{var y=h.color;a&&y.setFromColor(h.data.color),y.add((u-y.r)*o,(_-y.g)*o,(d-y.b)*o,(f-y.a)*o)}},s.ENTRIES=5,s.PREV_TIME=-5,s.PREV_R=-4,s.PREV_G=-3,s.PREV_B=-2,s.PREV_A=-1,s.R=1,s.G=2,s.B=3,s.A=4,s})(n);t.ColorTimeline=h;var l=(function(){function n(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}return n.prototype.getPropertyId=function(){return(i.attachment<<24)+this.slotindex},n.prototype.getframecount=function(){return this.frames.length},n.prototype.setframe="function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},n.prototype.apply=function(t,i,n,r,s,o,a){var" c="t.slots[this.slotIndex];if(a&&o){var" h="c.data.attachmentName;return" void="" c.setattachment(null="=h?null:t.getAttachment(this.slotIndex,h))}var" l="this.frames;if(n<l[0]){if(o){var" u="c.data.attachmentName;c.setAttachment(null==u?null:t.getAttachment(this.slotIndex,u))}}else{var" _="0;_=n">=l[l.length-1]?l.length-1:e.binarySearch(l,n,1)-1;var d=this.attachmentNames[_];t.slots[this.slotIndex].setAttachment(null==d?null:t.getAttachment(this.slotIndex,d))}},n})();t.AttachmentTimeline=l;var u=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e),this.frameVertices=new Array(e)}return r(s,n),s.prototype.getPropertyId=function(){return(i.deform<<24)+this.slotindex},s.prototype.setframe=function(t,e,i){this.frames[t]=e,this.framevertices[t]=i},s.prototype.apply=function(i,n,r,s,o,a,c){var h="i.slots[this.slotIndex],l=h.getAttachment();if(l" instanceof="" t.vertexattachment&&l.applydeform(this.attachment)){var="" u="this.frames,_=h.attachmentVertices;if(r<u[0])return" void(a&&t.utils.setarraysize(_,0));var="" d="this.frameVertices,f=d[0].length;_.length!=f&&(o=1);var" p="t.Utils.setArraySize(_,f);if(r">=u[u.length-1]){var m=d[u.length-1];if(1==o)t.Utils.arrayCopy(m,0,p,0,f);else if(a){var g=l;if(null==g.bones)for(var v=g.vertices,y=0;y<f;y++){var x="v[y];p[y]=x+(m[y]-x)*o}else" for(var="" y="0;y<f;y++)p[y]=m[y]*o}else" t="e.binarySearch(u,r),b=d[T-1],C=d[T],A=u[T],S=this.getCurvePercent(T-1,1-(r-A)/(u[T-1]-A));if(1==o)for(var" e="b[y];p[y]=E+(C[y]-E)*S}else" if(a){var="" g="l;if(null==g.bones)for(var" v="g.vertices,y=0;y<f;y++){var" _="(function(){function" n(e){this.frames="t.Utils.newFloatArray(e),this.events=new" array(e)}return="" n.prototype.getpropertyid="function(){return" i.event<<24},n.prototype.getframecount="function(){return" this.frames.length},n.prototype.setframe="function(t,e){this.frames[t]=e.time,this.events[t]=e},n.prototype.apply=function(t,i,n,r,s,o,a){if(null!=r){var" c="this.frames,h=this.frames.length;if(i">n)this.apply(t,i,Number.MAX_VALUE,r,s,o,a),i=-1;else if(i>=c[h-1])return;if(!(n<c[0])){var l="0;if(i<c[0])l=0;else{l=e.binarySearch(c,i);for(var" u="c[l];l">0&&c[l-1]==u;)l--}for(;l<h&&n>=c[l];l++)r.push(this.events[l])}}},n})();t.EventTimeline=_;var d=(function(){function n(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}return n.prototype.getPropertyId=function(){return i.drawOrder<<24},n.prototype.getframecount=function(){return this.frames.length},n.prototype.setframe="function(t,e,i){this.frames[t]=e,this.drawOrders[t]=i},n.prototype.apply=function(i,n,r,s,o,a,c){var" h="i.drawOrder,l=i.slots;if(c&&a)return" void="" t.utils.arraycopy(i.slots,0,i.draworder,0,i.slots.length);var="" u="this.frames;if(r<u[0])return" void(a&&t.utils.arraycopy(i.slots,0,i.draworder,0,i.slots.length));var="" _="0;_=r">=u[u.length-1]?u.length-1:e.binarySearch(u,r)-1;var d=this.drawOrders[_];if(null==d)t.Utils.arrayCopy(l,0,h,0,l.length);else for(var f=0,p=d.length;f<p;f++)h[f]=l[d[f]]},n})();t.drawordertimeline=d;var f="(function(n){function" s(e){n.call(this,e),this.frames="t.Utils.newFloatArray(e*s.ENTRIES)}return" r(s,n),s.prototype.getpropertyid="function(){return(i.ikConstraint<<24)+this.ikConstraintIndex},s.prototype.setFrame=function(t,e,i,n){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.MIX]=i,this.frames[t+s.BEND_DIRECTION]=n},s.prototype.apply=function(t,i,n,r,o,a,c){var" h="this.frames,l=t.ikConstraints[this.ikConstraintIndex];if(n<h[0])return" void(a&&(l.mix="l.data.mix,l.bendDirection=l.data.bendDirection));if(n">=h[h.length-s.ENTRIES])return void(a?(l.mix=l.data.mix+(h[h.length+s.PREV_MIX]-l.data.mix)*o,l.bendDirection=c?l.data.bendDirection:h[h.length+s.PREV_BEND_DIRECTION]):(l.mix+=(h[h.length+s.PREV_MIX]-l.mix)*o,c||(l.bendDirection=h[h.length+s.PREV_BEND_DIRECTION])));var u=e.binarySearch(h,n,s.ENTRIES),_=h[u+s.PREV_MIX],d=h[u],f=this.getCurvePercent(u/s.ENTRIES-1,1-(n-d)/(h[u+s.PREV_TIME]-d));a?(l.mix=l.data.mix+(_+(h[u+s.MIX]-_)*f-l.data.mix)*o,l.bendDirection=c?l.data.bendDirection:h[u+s.PREV_BEND_DIRECTION]):(l.mix+=(_+(h[u+s.MIX]-_)*f-l.mix)*o,c||(l.bendDirection=h[u+s.PREV_BEND_DIRECTION]))},s.ENTRIES=3,s.PREV_TIME=-3,s.PREV_MIX=-2,s.PREV_BEND_DIRECTION=-1,s.MIX=1,s.BEND_DIRECTION=2,s})(n);t.IkConstraintTimeline=f;var p=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e*s.ENTRIES)}return r(s,n),s.prototype.getPropertyId=function(){return(i.transformConstraint<<24)+this.transformconstraintindex},s.prototype.setframe=function(t,e,i,n,r,o){t*=s.entries,this.frames[t]=e,this.frames[t+s.rotate]=i,this.frames[t+s.translate]=n,this.frames[t+s.scale]=r,this.frames[t+s.shear]=o},s.prototype.apply=function(t,i,n,r,o,a,c){var h="this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(n<h[0]){if(a){var" u="l.data;l.rotateMix=u.rotateMix,l.translateMix=u.rotateMix,l.scaleMix=u.scaleMix,l.shearMix=u.shearMix}}else{var" _="0,d=0,f=0,p=0;if(n">=h[h.length-s.ENTRIES]){var m=h.length;_=h[m+s.PREV_ROTATE],d=h[m+s.PREV_TRANSLATE],f=h[m+s.PREV_SCALE],p=h[m+s.PREV_SHEAR]}else{var g=e.binarySearch(h,n,s.ENTRIES);_=h[g+s.PREV_ROTATE],d=h[g+s.PREV_TRANSLATE],f=h[g+s.PREV_SCALE],p=h[g+s.PREV_SHEAR];var v=h[g],y=this.getCurvePercent(g/s.ENTRIES-1,1-(n-v)/(h[g+s.PREV_TIME]-v));_+=(h[g+s.ROTATE]-_)*y,d+=(h[g+s.TRANSLATE]-d)*y,f+=(h[g+s.SCALE]-f)*y,p+=(h[g+s.SHEAR]-p)*y}if(a){var u=l.data;l.rotateMix=u.rotateMix+(_-u.rotateMix)*o,l.translateMix=u.translateMix+(d-u.translateMix)*o,l.scaleMix=u.scaleMix+(f-u.scaleMix)*o,l.shearMix=u.shearMix+(p-u.shearMix)*o}else l.rotateMix+=(_-l.rotateMix)*o,l.translateMix+=(d-l.translateMix)*o,l.scaleMix+=(f-l.scaleMix)*o,l.shearMix+=(p-l.shearMix)*o}},s.ENTRIES=5,s.PREV_TIME=-5,s.PREV_ROTATE=-4,s.PREV_TRANSLATE=-3,s.PREV_SCALE=-2,s.PREV_SHEAR=-1,s.ROTATE=1,s.TRANSLATE=2,s.SCALE=3,s.SHEAR=4,s})(n);t.TransformConstraintTimeline=p;var m=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e*s.ENTRIES)}return r(s,n),s.prototype.getPropertyId=function(){return(i.pathConstraintPosition<<24)+this.pathconstraintindex},s.prototype.setframe=function(t,e,i){t*=s.entries,this.frames[t]=e,this.frames[t+s.value]=i},s.prototype.apply=function(t,i,n,r,o,a,c){var h="this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(n<h[0])return" void(a&&(l.position="l.data.position));var" u="0;if(n">=h[h.length-s.ENTRIES])u=h[h.length+s.PREV_VALUE];else{var _=e.binarySearch(h,n,s.ENTRIES);u=h[_+s.PREV_VALUE];var d=h[_],f=this.getCurvePercent(_/s.ENTRIES-1,1-(n-d)/(h[_+s.PREV_TIME]-d));u+=(h[_+s.VALUE]-u)*f}a?l.position=l.data.position+(u-l.data.position)*o:l.position+=(u-l.position)*o},s.ENTRIES=2,s.PREV_TIME=-2,s.PREV_VALUE=-1,s.VALUE=1,s})(n);t.PathConstraintPositionTimeline=m;var g=(function(t){function n(e){t.call(this,e)}return r(n,t),n.prototype.getPropertyId=function(){return(i.pathConstraintSpacing<<24)+this.pathconstraintindex},n.prototype.apply=function(t,i,r,s,o,a,c){var h="this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(r<h[0])return" void(a&&(l.spacing="l.data.spacing));var" u="0;if(r">=h[h.length-n.ENTRIES])u=h[h.length+n.PREV_VALUE];else{var _=e.binarySearch(h,r,n.ENTRIES);u=h[_+n.PREV_VALUE];var d=h[_],f=this.getCurvePercent(_/n.ENTRIES-1,1-(r-d)/(h[_+n.PREV_TIME]-d));u+=(h[_+n.VALUE]-u)*f}a?l.spacing=l.data.spacing+(u-l.data.spacing)*o:l.spacing+=(u-l.spacing)*o},n})(m);t.PathConstraintSpacingTimeline=g;var v=(function(n){function s(e){n.call(this,e),this.frames=t.Utils.newFloatArray(e*s.ENTRIES)}return r(s,n),s.prototype.getPropertyId=function(){return(i.pathConstraintMix<<24)+this.pathconstraintindex},s.prototype.setframe=function(t,e,i,n){t*=s.entries,this.frames[t]=e,this.frames[t+s.rotate]=i,this.frames[t+s.translate]=n},s.prototype.apply=function(t,i,n,r,o,a,c){var h="this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(n<h[0])return" void(a&&(l.rotatemix="l.data.rotateMix,l.translateMix=l.data.translateMix));var" u="0,_=0;if(n">=h[h.length-s.ENTRIES])u=h[h.length+s.PREV_ROTATE],_=h[h.length+s.PREV_TRANSLATE];else{var d=e.binarySearch(h,n,s.ENTRIES);u=h[d+s.PREV_ROTATE],_=h[d+s.PREV_TRANSLATE];var f=h[d],p=this.getCurvePercent(d/s.ENTRIES-1,1-(n-f)/(h[d+s.PREV_TIME]-f));u+=(h[d+s.ROTATE]-u)*p,_+=(h[d+s.TRANSLATE]-_)*p}a?(l.rotateMix=l.data.rotateMix+(u-l.data.rotateMix)*o,l.translateMix=l.data.translateMix+(_-l.data.translateMix)*o):(l.rotateMix+=(u-l.rotateMix)*o,l.translateMix+=(_-l.translateMix)*o)},s.ENTRIES=3,s.PREV_TIME=-3,s.PREV_ROTATE=-2,s.PREV_TRANSLATE=-1,s.ROTATE=1,s.TRANSLATE=2,s})(n);t.PathConstraintMixTimeline=v})(n||(n={}));var n;!(function(t){var e=(function(){function e(e){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new n(this),this.propertyIDs=new t.IntSet,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new t.Pool(function(){return new i}),this.data=e}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,i=0,n=e.length;i<n;i++){var r="e[i];if(null!=r){r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;var" s="t*r.timeScale;if(r.delay">0){if(r.delay-=s,r.delay>0)continue;s=-r.delay,r.delay=0}var o=r.next;if(null!=o){var a=r.trackLast-o.delay;if(a>=0){for(o.delay=0,o.trackTime=a+t*o.timeScale,r.trackTime+=s,this.setCurrent(i,o,!0);null!=o.mixingFrom;)o.mixTime+=s,o=o.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&null==r.mixingFrom){e[i]=null,this.queue.end(r),this.disposeNext(r);continue}this.updateMixingFrom(r,t),r.trackTime+=s}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var i=t.mixingFrom;if(null!=i){if(this.updateMixingFrom(i,e),t.mixTime>=t.mixDuration&&null!=i.mixingFrom&&t.mixTime>0)return t.mixingFrom=null,void this.queue.end(i);i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,i.trackTime+=e*i.timeScale,t.mixTime+=e*i.timeScale}},e.prototype.apply=function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,n=this.tracks,r=0,s=n.length;r<s;r++){var o="n[r];if(!(null==o||o.delay">0)){var a=o.alpha;null!=o.mixingFrom?a*=this.applyMixingFrom(o,e):o.trackTime>=o.trackEnd&&(a=0);var c=o.animationLast,h=o.getAnimationTime(),l=o.animation.timelines.length,u=o.animation.timelines;if(1==a)for(var _=0;_<l;_++)u[_].apply(e,c,h,i,1,!0,!1);else{var d="0==o.timelinesRotation.length;d&&t.Utils.setArraySize(o.timelinesRotation,l<<1,null);for(var" f="o.timelinesRotation,p=o.timelinesFirst,_=0;_<l;_++){var" m="u[_];m" instanceof="" t.rotatetimeline?this.applyrotatetimeline(m,e,h,a,p[_],f,_<<1,d):m.apply(e,c,h,i,a,p[_],!1)}}this.queueevents(o,h),i.length="0,o.nextAnimationLast=h,o.nextTrackLast=o.trackTime}}this.queue.drain()},e.prototype.applyMixingFrom=function(e,i){var" n="e.mixingFrom;null!=n.mixingFrom&&this.applyMixingFrom(n,i);var" r="0;0==e.mixDuration?r=1:(r=e.mixTime/e.mixDuration,r">1&&(r=1));var s=r<n.eventthreshold?this.events:null,o=r<n.attachmentthreshold,a=r<n.draworderthreshold,c=n.animationlast,h=n.getanimationtime(),l=n.animation.timelines.length,u=n.animation.timelines,_=n.timelinesfirst,d=n.alpha*e.mixalpha*(1-r),f=0==n.timelinesrotation.length;f&&t.utils.setarraysize(n.timelinesrotation,l<<1,null);for(var p="n.timelinesRotation,m=0;m<l;m++){var" g="u[m],v=_[m];if(g" instanceof="" t.rotatetimeline)this.applyrotatetimeline(g,i,h,d,v,p,m<<1,f);else{if(!v){if(!o&&g="" t.attachmenttimeline)continue;if(!a&&g="" t.drawordertimeline)continue}g.apply(i,c,h,s,d,v,!0)}}return="" e.mixduration="">0&&this.queueEvents(n,h),this.events.length=0,n.nextAnimationLast=h,n.nextTrackLast=n.trackTime,r},e.prototype.applyRotateTimeline=function(e,i,n,r,s,o,a,c){if(c&&(o[a]=0),1==r)return void e.apply(i,0,n,null,1,s,!1);var h=e,l=h.frames,u=i.bones[h.boneIndex];if(n<l[0])return void(s&&(u.rotation="u.data.rotation));var" _="0;if(n">=l[l.length-t.RotateTimeline.ENTRIES])_=u.data.rotation+l[l.length+t.RotateTimeline.PREV_ROTATION];else{var d=t.Animation.binarySearch(l,n,t.RotateTimeline.ENTRIES),f=l[d+t.RotateTimeline.PREV_ROTATION],p=l[d],m=h.getCurvePercent((d>>1)-1,1-(n-p)/(l[d+t.RotateTimeline.PREV_TIME]-p));_=l[d+t.RotateTimeline.ROTATION]-f,_-=360*(16384-(16384.499999999996-_/360|0)),_=f+_*m+u.data.rotation,_-=360*(16384-(16384.499999999996-_/360|0))}var g=s?u.data.rotation:u.rotation,v=0,y=_-g;if(0==y)v=o[a];else{y-=360*(16384-(16384.499999999996-y/360|0));var x=0,T=0;c?(x=0,T=y):(x=o[a],T=o[a+1]);var b=y>0,C=x>=0;t.MathUtils.signum(T)!=t.MathUtils.signum(y)&&Math.abs(T)<=90&&(math.abs(x)>180&&(x+=360*t.MathUtils.signum(x)),C=b),v=y+x-x%360,C!=b&&(v+=360*t.MathUtils.signum(x)),o[a]=v}o[a+1]=y,g+=v*r,u.rotation=g-360*(16384-(16384.499999999996-g/360|0))},e.prototype.queueEvents=function(t,e){for(var i=t.animationStart,n=t.animationEnd,r=n-i,s=t.trackLast%r,o=this.events,a=0,c=o.length;a<c;a++){var h="o[a];if(h.time<s)break;h.time">n||this.queue.event(t,h)}for((t.loop?s>t.trackTime%r:e>=n&&t.animationLast<n)&&this.queue.complete(t);a<c;a++){var l="o[a];l.time<i||this.queue.event(t,o[a])}},e.prototype.clearTracks=function(){this.queue.drainDisabled=!0;for(var" t="0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=!1,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t">=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var i=e;;){var n=i.mixingFrom;if(null==n)break;this.queue.end(n),i.mixingFrom=null,i=n}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,i){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(i&&this.queue.interrupt(n),e.mixingFrom=n,e.mixTime=0,
n.timelinesRotation.length=0,null!=n.mixingFrom&&n.mixDuration>0&&(e.mixAlpha*=Math.min(n.mixTime/n.mixDuration,1))),this.queue.start(e)},e.prototype.setAnimation=function(t,e,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,n,i)},e.prototype.setAnimationWith=function(t,e,i){if(null==e)throw new Error("animation cannot be null.");var n=!0,r=this.expandToIndex(t);null!=r&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));var s=this.trackEntry(t,e,i,r);return this.setCurrent(t,s,n),this.queue.drain(),s},e.prototype.addAnimation=function(t,e,i,n){var r=this.data.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,i,n)},e.prototype.addAnimationWith=function(t,e,i,n){if(null==e)throw new Error("animation cannot be null.");var r=this.expandToIndex(t);if(null!=r)for(;null!=r.next;)r=r.next;var s=this.trackEntry(t,e,i,r);if(null==r)this.setCurrent(t,s,!0),this.queue.drain();else if(r.next=s,n<=0){var o="r.animationEnd-r.animationStart;0!=o?n+=o*(1+(r.trackTime/o|0))-this.data.getMix(r.animation,e):n=0}return" s.delay="n,s},e.prototype.setEmptyAnimation=function(t,i){var" n="this.setAnimationWith(t,e.emptyAnimation,!1);return" n.mixduration="i,n.trackEnd=i,n},e.prototype.addEmptyAnimation=function(t,i,n){n<=0&&(n-=i);var" r="this.addAnimationWith(t,e.emptyAnimation,!1,n);return" r.mixduration="i,r.trackEnd=i,r},e.prototype.setEmptyAnimations=function(t){this.queue.drainDisabled=!0;for(var" e="0,i=this.tracks.length;e<i;e++){var" e<this.tracks.length?this.tracks[e]:(t.utils.ensurearraycapacity(this.tracks,e-this.tracks.length+1,null),this.tracks.length="e+1,null)},e.prototype.trackEntry=function(t,e,i,n){var" r.trackindex="t,r.animation=e,r.loop=i,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixAlpha=1,r.mixTime=0,r.mixDuration=null==n?0:this.data.getMix(n.animation,e),r},e.prototype.disposeNext=function(t){for(var" t="this.propertyIDs,e=0,i=this.tracks.length;for(t.clear();e<i;e++){var" this.settimelinesfirst(e.mixingfrom),void="" this.checktimelinesusage(e,e.timelinesfirst);for(var="" i="this.propertyIDs,n=e.animation.timelines,r=n.length,s=t.Utils.setArraySize(e.timelinesFirst,r,!1),o=0;o<r;o++)i.add(n[o].getPropertyId()),s[o]=!0},e.prototype.checkTimelinesFirst=function(t){null!=t.mixingFrom&&this.checkTimelinesFirst(t.mixingFrom),this.checkTimelinesUsage(t,t.timelinesFirst)},e.prototype.checkTimelinesUsage=function(e,i){for(var">=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.emptyAnimation=new t.Animation("<empty>",[],0),e})();t.AnimationState=e;var i=(function(){function t(){this.timelinesFirst=new Array,this.timelinesRotation=new Array}return t.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.animation=null,this.listener=null,this.timelinesFirst.length=0,this.timelinesRotation.length=0},t.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},t.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},t.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},t.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},t})();t.TrackEntry=i;var n=(function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(r.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(r.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(r.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(r.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(r.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(r.event),this.objects.push(t),this.objects.push(e)},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,i=0;i<t.length;i+=2){var 0="==n?this.defaultMix:n},t})();t.AnimationStateData=e})(n||(n={}));var" n="t[i],s=t[i+1];switch(n){case" r.start:null!="s.listener&&s.listener.start&&s.listener.start(s);for(var" o="0;o<e.length;o++)e[o].start&&e[o].start(s);break;case" r.interrupt:null!="s.listener&&s.listener.interrupt&&s.listener.interrupt(s);for(var" r.end:null!="s.listener&&s.listener.end&&s.listener.end(s);for(var" r.dispose:null!="s.listener&&s.listener.dispose&&s.listener.dispose(s);for(var" r.complete:null!="s.listener&&s.listener.complete&&s.listener.complete(s);for(var" r.event:var="" a="t[i++" +2];null!="s.listener&&s.listener.event&&s.listener.event(s,a);for(var" r="t.EventType,s=(function(){function" t(){}return="" t.prototype.start="function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t})();t.AnimationStateAdapter2=s})(n||(n={}));var" n;!(function(t){var="" e="(function(){function" t(t){if(this.animationtomixtime="{},this.defaultMix=0,null==t)throw" new="" error("skeletondata="" cannot="" be="" null.");this.skeletondata="t}return" t.prototype.setmix="function(t,e,i){var" error("animation="" not="" found:="" "+t);var="" "+e);this.setmixwith(n,r,i)},t.prototype.setmixwith="function(t,e,i){if(null==t)throw" error("from="" null.");if(null="=e)throw" error("to="" null.");var="" i="t.name+e.name,n=this.animationToMixTime[i];return" void="" t(t,e){void="" t.prototype.loadtext="function(t,e,i){var" xmlhttprequest;r.onreadystatechange="function(){r.readyState==XMLHttpRequest.DONE&&(r.status">=200&&r.status<300?(n.assets[t]=r.responsetext,e&&e(t,r.responsetext)):(n.errors[t]="couldn't 0="==e&&(e=null),void" load="" text="" "+t+":="" status="" "+r.status+",="" "+r.responsetext,i&&i(t,"couldn't="" "+r.responsetext)),n.toload--,n.loaded++)},r.open("get",t,!0),r.send()},t.prototype.loadtexture="function(t,e,i){var" n="this;void" r="new" image;r.crossorigin="anonymous" ,r.src="t,r.onload=function(i){var" s="n.textureLoader(r);n.assets[t]=s,n.toLoad--,n.loaded++,e&&e(t,r)},r.onerror=function(e){n.errors[t]="Couldn't" image="" "+t,n.toload--,n.loaded++,i&&i(t,"couldn't="" "+t)}},t.prototype.get="function(t){return" t="this.pathPrefix+t,this.assets[t]},t.prototype.remove=function(t){t=this.pathPrefix+t;var" e="this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},t.prototype.removeAll=function(){for(var" in="" this.assets){var="" this.toload},t.prototype.getloaded="function(){return" this.loaded},t.prototype.dispose="function(){this.removeAll()},t.prototype.hasErrors=function(){return" object.keys(this.errors).length="">0},t.prototype.getErrors=function(){return this.errors},t})();t.AssetManager=e})(n||(n={}));var n;!(function(t){var e=(function(){function e(t){this.atlas=t}return e.prototype.newRegionAttachment=function(e,i,n){var r=this.atlas.findRegion(n);if(null==r)throw new Error("Region not found in atlas: "+n+" (region attachment: "+i+")");r.renderObject=r;var s=new t.RegionAttachment(i);return s.setRegion(r),s},e.prototype.newMeshAttachment=function(e,i,n){var r=this.atlas.findRegion(n);if(null==r)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+i+")");r.renderObject=r;var s=new t.MeshAttachment(i);return s.region=r,s},e.prototype.newBoundingBoxAttachment=function(e,i){return new t.BoundingBoxAttachment(i)},e.prototype.newPathAttachment=function(e,i){return new t.PathAttachment(i)},e})();t.AtlasAttachmentLoader=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t){if(null==t)throw new Error("name cannot be null.");this.name=t}return t})();t.Attachment=e;var i=(function(t){function e(e){t.call(this,e),this.worldVerticesLength=0}return r(e,t),e.prototype.computeWorldVertices=function(t,e){this.computeWorldVerticesWith(t,0,this.worldVerticesLength,e,0)},e.prototype.computeWorldVerticesWith=function(t,e,i,n,r){i+=r;var s=t.bone.skeleton,o=t.attachmentVertices,a=this.vertices,c=this.bones;if(null!=c){for(var h=0,l=0,u=0;u<e;u+=2){var _="c[h];h+=_+1,l+=_}var" d="s.bones;if(0==o.length)for(var" f="r,p=3*l;f<i;f+=2){var" m="0,g=0,_=c[h++];for(_+=h;h<_;h++,p+=3){var" v="d[c[h]],y=a[p],x=a[p+1],T=a[p+2];m+=(y*v.a+x*v.b+v.worldX)*T,g+=(y*v.c+x*v.d+v.worldY)*T}n[f]=m,n[f+1]=g}else" for(var="" b="o,f=r,p=3*l,C=l<<1;f<i;f+=2){var">0&&(a=o);for(var v=t.bone,A=v.worldX,S=v.worldY,E=v.a,p=v.b,w=v.c,I=v.d,R=e,f=r;f<i;r+=2,f+=2){var y="a[R],x=a[R+1];n[f]=y*E+x*p+A,n[f+1]=y*w+x*I+S}}},e.prototype.applyDeform=function(t){return" this="=t},e})(e);t.VertexAttachment=i})(n||(n={}));var" n;!(function(t){!(function(t){t[t.region="0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path"})(t.AttachmentType||(t.AttachmentType={}));t.AttachmentType})(n||(n={}));var" n;!(function(t){var="" e="(function(e){function" i(i){e.call(this,i),this.color="new" t.color(1,1,1,1)}return="" r(i,e),i})(t.vertexattachment);t.boundingboxattachment="e})(n||(n={}));var" t.color(1,1,1,1),this.inheritdeform="!1,this.tempColor=new" t.color(0,0,0,0)}return="" r(i,e),i.prototype.updateuvs="function(){var">>1);null!=this.worldVertices&&this.worldVertices.length==n||(this.worldVertices=t.Utils.newFloatArray(n));var r=0,s=0,o=0,a=0;if(null==this.region?(r=s=0,o=a=1):(r=this.region.u,s=this.region.v,o=this.region.u2-r,a=this.region.v2-s),this.region.rotate)for(var c=0,h=6;c<i;c+=2,h+=8)this.worldvertices[h]=r+e[c+1]*o,this.worldvertices[h+1]=s+a-e[c]*a;else for(var="" c="0,h=6;c<i;c+=2,h+=8)this.worldVertices[h]=r+e[c]*o,this.worldVertices[h+1]=s+e[c+1]*a},i.prototype.updateWorldVertices=function(t,e){var" i="t.bone.skeleton,n=i.color,r=t.color,s=this.color,o=n.a*r.a*s.a,a=e?o:1,c=this.tempColor;c.set(n.r*r.r*s.r*a,n.g*r.g*s.g*a,n.b*r.b*s.b*a,o);var" h="t.attachmentVertices,l=this.vertices,u=this.worldVertices,_=this.bones;if(null==_){var" d="l.length;h.length">0&&(l=h);for(var f=t.bone,p=f.worldX,m=f.worldY,g=f.a,v=f.b,y=f.c,x=f.d,T=0,b=0;T<d;t+=2,b+=8){var c="l[T],A=l[T+1];u[b]=C*g+A*v+p,u[b+1]=C*y+A*x+m,u[b+2]=c.r,u[b+3]=c.g,u[b+4]=c.b,u[b+5]=c.a}return" u}var="" s="i.bones;if(0==h.length)for(var" b="0,T=0,v=0,E=_.length;T<E;b+=8){for(var" w="0,I=0,R=_[T++]+T;T<R;T++,v+=3){var" f="S[_[T]],C=l[v],A=l[v+1],P=l[v+2];w+=(C*f.a+A*f.b+f.worldX)*P,I+=(C*f.c+A*f.d+f.worldY)*P}u[b]=w,u[b+1]=I,u[b+2]=c.r,u[b+3]=c.g,u[b+4]=c.b,u[b+5]=c.a}else" for(var="" o="h,b=0,T=0,v=0,B=0,E=_.length;T<E;b+=8){for(var" u},i.prototype.applydeform="function(t){return" this="=t||this.inheritDeform&&this.parentMesh==t},i.prototype.getParentMesh=function(){return" this.parentmesh},i.prototype.setparentmesh="function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength)},i})(t.VertexAttachment);t.MeshAttachment=e})(n||(n={}));var" n;!(function(t){var="" e="(function(e){function" i(i){e.call(this,i),this.closed="!1,this.constantSpeed=!1,this.color=new" t.color(1,1,1,1)}return="" r(i,e),i})(t.vertexattachment);t.pathattachment="e})(n||(n={}));var" i(i){e.call(this,i),this.x="0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new" t.color(1,1,1,1),this.offset="t.Utils.newFloatArray(8),this.vertices=t.Utils.newFloatArray(32),this.tempColor=new" r(i,e),i.prototype.setregion="function(t){var" t="this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,s=n+this.region.width*t,o=r+this.region.height*e,a=this.rotation*Math.PI/180,c=Math.cos(a),h=Math.sin(a),l=n*c+this.x,u=n*h,_=r*c+this.y,d=r*h,f=s*c+this.x,p=s*h,m=o*c+this.y,g=o*h,v=this.offset;v[i.OX1]=l-d,v[i.OY1]=_+u,v[i.OX2]=l-g,v[i.OY2]=m+u,v[i.OX3]=f-g,v[i.OY3]=m+p,v[i.OX4]=f-d,v[i.OY4]=_+p},i.prototype.updateWorldVertices=function(t,e){var" n="t.bone.skeleton,r=n.color,s=t.color,o=this.color,a=r.a*s.a*o.a,c=e?a:1,h=this.tempColor;h.set(r.r*s.r*o.r*c,r.g*s.g*o.g*c,r.b*s.b*o.b*c,a);var" l="this.vertices,u=this.offset,_=t.bone,d=_.worldX,f=_.worldY,p=_.a,m=_.b,g=_.c,v=_.d,y=0,x=0;return" y="u[i.OX1],x=u[i.OY1],l[i.X1]=y*p+x*m+d,l[i.Y1]=y*g+x*v+f,l[i.C1R]=h.r,l[i.C1G]=h.g,l[i.C1B]=h.b,l[i.C1A]=h.a,y=u[i.OX2],x=u[i.OY2],l[i.X2]=y*p+x*m+d,l[i.Y2]=y*g+x*v+f,l[i.C2R]=h.r,l[i.C2G]=h.g,l[i.C2B]=h.b,l[i.C2A]=h.a,y=u[i.OX3],x=u[i.OY3],l[i.X3]=y*p+x*m+d,l[i.Y3]=y*g+x*v+f,l[i.C3R]=h.r,l[i.C3G]=h.g,l[i.C3B]=h.b,l[i.C3A]=h.a,y=u[i.OX4],x=u[i.OY4],l[i.X4]=y*p+x*m+d,l[i.Y4]=y*g+x*v+f,l[i.C4R]=h.r,l[i.C4G]=h.g,l[i.C4B]=h.b,l[i.C4A]=h.a,l},i.OX1=0,i.OY1=1,i.OX2=2,i.OY2=3,i.OX3=4,i.OY3=5,i.OX4=6,i.OY4=7,i.X1=0,i.Y1=1,i.C1R=2,i.C1G=3,i.C1B=4,i.C1A=5,i.U1=6,i.V1=7,i.X2=8,i.Y2=9,i.C2R=10,i.C2G=11,i.C2B=12,i.C2A=13,i.U2=14,i.V2=15,i.X3=16,i.Y3=17,i.C3R=18,i.C3G=19,i.C3B=20,i.C3A=21,i.U3=22,i.V3=23,i.X4=24,i.Y4=25,i.C4R=26,i.C4G=27,i.C4B=28,i.C4A=29,i.U4=30,i.V4=31,i})(t.Attachment);t.RegionAttachment=e})(n||(n={}));var" n;!(function(t){!(function(t){t[t.normal="0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"})(t.BlendMode||(t.BlendMode={}));t.BlendMode})(n||(n={}));var" e(t,e,i){if(this.children="new" array,this.x="0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.worldX=0,this.c=0,this.d=0,this.worldY=0,this.sorted=!1,null==t)throw" new="" error("data="" cannot="" be="" null.");if(null="=e)throw" error("skeleton="" null.");this.data="t,this.skeleton=e,this.parent=i,this.setToSetupPose()}return" e.prototype.update="function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,i,n,r,s,o,a){this.ax=e,this.ay=i,this.arotation=n,this.ascaleX=r,this.ascaleY=s,this.ashearX=o,this.ashearY=a,this.appliedValid=!0;var" h="n+90+a,l=t.MathUtils.cosDeg(n+o)*r,u=t.MathUtils.cosDeg(h)*s,_=t.MathUtils.sinDeg(n+o)*r,d=t.MathUtils.sinDeg(h)*s,f=this.skeleton;return" f.flipx&&(e="-e,l=-l,u=-u),f.flipY&&(i=-i,_=-_,d=-d),this.a=l,this.b=u,this.c=_,this.d=d,this.worldX=e+f.x,void(this.worldY=i+f.y)}var" p="c.a,m=c.b,g=c.c,v=c.d;switch(this.worldX=p*e+m*i+c.worldX,this.worldY=g*e+v*i+c.worldY,this.data.transformMode){case" t.transformmode.normal:var="" this.a="p*l+m*_,this.b=p*u+m*d,this.c=g*l+v*_,void(this.d=g*u+v*d);case" t.transformmode.onlytranslation:var="" t.transformmode.norotationorreflection:var="">1e-4?(y=Math.abs(p*v-m*g)/y,m=g*y,v=p*y,x=Math.atan2(g,p)*t.MathUtils.radDeg):(p=0,g=0,x=90-Math.atan2(v,m)*t.MathUtils.radDeg);var T=n+o-x,b=n+a-x+90,l=t.MathUtils.cosDeg(T)*r,u=t.MathUtils.cosDeg(b)*s,_=t.MathUtils.sinDeg(T)*r,d=t.MathUtils.sinDeg(b)*s;this.a=p*l-m*_,this.b=p*u-m*d,this.c=g*l+v*_,this.d=g*u+v*d;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var C=t.MathUtils.cosDeg(n),A=t.MathUtils.sinDeg(n),S=p*C+m*A,E=g*C+v*A,y=Math.sqrt(S*S+E*E);y>1e-5&&(y=1/y),S*=y,E*=y,y=Math.sqrt(S*S+E*E);var w=Math.PI/2+Math.atan2(E,S),I=Math.cos(w)*y,R=Math.sin(w)*y,l=t.MathUtils.cosDeg(o)*r,u=t.MathUtils.cosDeg(90+a)*s,_=t.MathUtils.sinDeg(o)*r,d=t.MathUtils.sinDeg(90+a)*s;return this.a=S*l+I*_,this.b=S*u+I*d,this.c=E*l+R*_,this.d=E*u+R*d,void((this.data.transformMode!=t.TransformMode.NoScaleOrReflection?p*v-m*g<0:this.skeleton.flipx!=this.skeleton.flipy)&&(this.b=-this.b,this.d=-this.d))}this.skeleton.flipx&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipy&&(this.c=-this.c,this.d=-this.d)},e.prototype.settosetuppose=function(){var t="this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return" math.atan2(this.c,this.a)*t.mathutils.raddeg},e.prototype.getworldrotationy="function(){return" math.atan2(this.d,this.b)*t.mathutils.raddeg},e.prototype.getworldscalex="function(){return" math.sqrt(this.a*this.a+this.c*this.c)},e.prototype.getworldscaley="function(){return" math.sqrt(this.b*this.b+this.d*this.d)},e.prototype.worldtolocalrotationx="function(){var" e="this.parent;if(null==e)return" this.arotation;var="" i="e.a,n=e.b,r=e.c,s=e.d,o=this.a,a=this.c;return" math.atan2(i*a-r*o,s*o-n*a)*t.mathutils.raddeg},e.prototype.worldtolocalrotationy="function(){var" math.atan2(i*a-r*o,s*o-n*a)*t.mathutils.raddeg},e.prototype.rotateworld="function(e){var" this.ax="this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*t.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*t.MathUtils.radDeg);var" h="o*s,l=o*i,u=o*n,_=o*r,d=h*this.a-u*this.c,f=h*this.b-u*this.d,p=l*this.c-_*this.a,m=l*this.d-_*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+p*p),this.ascaleX">1e-4){var g=d*m-f*p;this.ascaleY=g/this.ascaleX,this.ashearY=Math.atan2(d*f+p*m,g)*t.MathUtils.radDeg,this.arotation=Math.atan2(p,d)*t.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,f)*t.MathUtils.radDeg},e.prototype.worldToLocal=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,s=1/(e*r-i*n),o=t.x-this.worldX,a=t.y-this.worldY;return t.x=o*r*s-a*i*s,t.y=a*e*s-o*n*s,t},e.prototype.localToWorld=function(t){var e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t},e})();t.Bone=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=i.Normal,t<0)throw new="" error("index="" must="" be="">= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}return t})();t.BoneData=e,(function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"})(t.TransformMode||(t.TransformMode={}));var i=t.TransformMode})(n||(n={}));var n;!(function(t){var e=(function(){function t(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}return t})();t.Event=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t){this.name=t}return t})();t.EventData=e})(n||(n={}));var n;!(function(t){var e=(function(){function e(t,e){if(this.mix=1,this.bendDirection=0,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=new Array;for(var i=0;i<t.bones.length;i++)this.bones.push(e.findbone(t.bones[i].name));this.target=e.findbone(t.target.name)}return e.prototype.getorder="function(){return" this.data.order},e.prototype.apply="function(){this.update()},e.prototype.update=function(){var" t="this.target,e=this.bones;switch(e.length){case" 1:this.apply1(e[0],t.worldx,t.worldy,this.mix);break;case="" 2:this.apply2(e[0],e[1],t.worldx,t.worldy,this.benddirection,this.mix)}},e.prototype.apply1="function(e,i,n,r){e.appliedValid||e.updateAppliedTransform();var" s="e.parent,o=1/(s.a*s.d-s.b*s.c),a=i-s.worldX,c=n-s.worldY,h=(a*s.d-c*s.b)*o-e.ax,l=(c*s.a-a*s.c)*o-e.ay,u=Math.atan2(l,h)*t.MathUtils.radDeg-e.ashearX-e.arotation;e.ascaleX<0&&(u+=180),u">180?u-=360:u<-180&&(u+=360),e.updateworldtransformwith(e.ax,e.ay,e.arotation+u*r,e.ascalex,e.ascaley,e.ashearx,e.asheary)},e.prototype.apply2=function(e,i,n,r,s,o){if(0==o)return void="" i.updateworldtransform();e.appliedvalid||e.updateappliedtransform(),i.appliedvalid||i.updateappliedtransform();var="" a="e.ax,c=e.ay,h=e.ascaleX,l=e.ascaleY,u=i.ascaleX,_=0,d=0,f=0;h<0?(h=-h,_=180,f=-1):(_=0,f=1),l<0&&(l=-l,f=-f),u<0?(u=-u,d=180):d=0;var" p="i.ax,m=0,g=0,v=0,y=e.a,x=e.b,T=e.c,b=e.d,C=Math.abs(h-l)<=1e-4;C?(m=i.ay,g=y*p+x*m+e.worldX,v=T*p+b*m+e.worldY):(m=0,g=y*p+e.worldX,v=T*p+e.worldY);var" s="1/(y*b-x*T),E=n-A.worldX,w=r-A.worldY,I=(E*b-w*x)*S-a,R=(w*y-E*T)*S-c;E=g-A.worldX,w=v-A.worldY;var" n="(I*I+R*R-B*B-D*D)/(2*B*D);N<-1?N=-1:N">1&&(N=1),L=Math.acos(N)*s,y=B+D*N,x=D*Math.sin(L),M=Math.atan2(R*y-I*x,I*y+R*x)}else{y=h*D,x=l*D;var F=y*y,k=x*x,z=I*I+R*R,V=Math.atan2(R,I);T=k*B*B+F*z-F*k;var G=-2*k*B,W=k-F;if(b=G*G-4*W*T,b>=0){var U=Math.sqrt(b);G<0&&(u=-u),u=-(g+u) 2;var="" j="U/W,X=T/U,Y=Math.abs(j)<Math.abs(X)?j:X;if(Y*Y<=z){w=Math.sqrt(z-Y*Y)*s,M=V-Math.atan2(w,Y),L=Math.atan2(w/l,(Y-B)/h);break" t}}var="" h="0,q=Number.MAX_VALUE,Z=0,J=0,Q=0,K=0,$=0,tt=0;E=B+y,b=E*E,b">K&&(Q=0,K=b,$=E),E=B-y,b=E*E,b<q&&(h=t.mathutils.pi,q=b,z=e);var et="Math.acos(-y*B/(F-k));E=y*Math.cos(et)+B,w=x*Math.sin(et),b=E*E+w*w,b<q&&(H=et,q=b,Z=E,J=w),b">K&&(Q=et,K=b,$=E,tt=w),z<=(q+k) 2?(m="V-Math.atan2(J*s,Z),L=H*s):(M=V-Math.atan2(tt*s,$),L=Q*s)}var" it="Math.atan2(m,p)*f,nt=e.arotation;M=(M-it)*t.MathUtils.radDeg+_-nt,M">180?M-=360:M<-180&&(m+=360),e.updateworldtransformwith(a,c,nt+m*o,e.ascalex,e.ascaley,0,0),nt=i.arotation,l=((l+it)*t.mathutils.raddeg-i.ashearx)*f+d-nt,l>180?L-=360:L<-180&&(l+=360),i.updateworldtransformwith(p,m,nt+l*o,i.ascalex,i.ascaley,i.ashearx,i.asheary)},e})();t.ikconstraint=e})(n||(n={}));var n;!(function(t){var="" e="(function(){function" t(t){this.order="0,this.bones=new" array,this.benddirection="1,this.mix=1,this.name=t}return" t})();t.ikconstraintdata="e})(n||(n={}));var" e(t,e){if(this.position="0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new" array,this.positions="new" array,this.world="new" array,this.curves="new" array,this.lengths="new" array,this.segments="new" array,null="=t)throw" new="" error("data="" cannot="" be="" null.");if(null="=e)throw" error("skeleton="" null.");this.data="t,this.bones=new" array;for(var="" i="0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return" e.prototype.apply="function(){this.update()},e.prototype.update=function(){var" instanceof="" t.pathattachment){var="">0,s=i>0;if(r||s){var o=this.data,a=o.spacingMode,c=a==t.SpacingMode.Length,h=o.rotateMode,l=h==t.RotateMode.Tangent,u=h==t.RotateMode.ChainScale,_=this.bones.length,d=l?_:_+1,f=this.bones,p=t.Utils.setArraySize(this.spaces,d),m=null,g=this.spacing;if(u||c){u&&(m=t.Utils.setArraySize(this.lengths,_));for(var v=0,y=d-1;v<y;){var x="f[v],T=x.data.length,b=T*x.a,C=T*x.c;T=Math.sqrt(b*b+C*C),u&&(m[v]=T),p[++v]=c?Math.max(0,T+g):g}}else" for(var="" v="1;v<d;v++)p[v]=g;var" a="this.computeWorldPositions(e,d,l,o.positionMode==t.PositionMode.Percent,a==t.SpacingMode.Percent),S=A[0],E=A[1],w=o.offsetRotation,I=!1;if(0==w)I=h==t.RotateMode.Chain;else{I=!1;var" r="this.target.bone;w*=R.a*R.d-R.b*R.c">0?t.MathUtils.degRad:-t.MathUtils.degRad}for(var v=0,R=3;v<_;v++,r+=3){var x="f[v];x.worldX+=(S-x.worldX)*n,x.worldY+=(E-x.worldY)*n;var" b="A[R],C=A[R+1],P=b-S,O=C-E;if(u){var" d="(Math.sqrt(P*P+O*O)/B-1)*i+1;x.a*=D,x.c*=D}}if(S=b,E=C,s){var" m="x.a,L=x.b,N=x.c,F=x.d,k=0,z=0,V=0;if(k=l?A[R-1]:0==p[v+1]?A[R+2]:Math.atan2(O,P),k-=Math.atan2(N,M),I){z=Math.cos(k),V=Math.sin(k);var" g="x.data.length;S+=(G*(z*M-V*N)-P)*i,E+=(G*(V*M+z*N)-O)*i}else" k+="w;k">t.MathUtils.PI?k-=t.MathUtils.PI2:k<-t.mathutils.pi&&(k+=t.mathutils.pi2),k*=i,z=math.cos(k),v=math.sin(k),x.a=z*m-v*n,x.b=z*l-v*f,x.c=v*m+z*n,x.d=v*l+z*f}x.appliedvalid=!1}}}},e.prototype.computeworldpositions=function(i,n,r,s,o){var a="this.target,c=this.position,h=this.spaces,l=t.Utils.setArraySize(this.positions,3*n+2),u=null,_=i.closed,d=i.worldVerticesLength,f=d/6,p=e.NONE;if(!i.constantSpeed){var" m="i.lengths;f-=_?1:2;var" g="m[f];if(s&&(c*=g),o)for(var" v="0;v<n;v++)h[v]*=g;u=t.Utils.setArraySize(this.world,8);for(var" t="h[v];c+=T;var" b="c;if(_)b%=g,b<0&&(b+=g),x=0;else{if(b<0){p!=e.BEFORE&&(p=e.BEFORE,i.computeWorldVerticesWith(a,2,4,u,0)),this.addBeforePosition(b,u,0,l,y);continue}if(b">g){p!=e.AFTER&&(p=e.AFTER,i.computeWorldVerticesWith(a,d-6,4,u,0)),this.addAfterPosition(b-g,u,0,l,y);continue}}for(;;x++){var C=m[x];if(!(b>C)){if(0==x)b/=C;else{var A=m[x-1];b=(b-A)/(C-A)}break}}x!=p&&(p=x,_&&x==f?(i.computeWorldVerticesWith(a,d-4,4,u,0),i.computeWorldVerticesWith(a,0,4,u,4)):i.computeWorldVerticesWith(a,6*x+2,8,u,0)),this.addCurvePosition(b,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,y,r||v>0&&0==T)}return l}_?(d+=2,u=t.Utils.setArraySize(this.world,d),i.computeWorldVerticesWith(a,2,d-4,u,0),i.computeWorldVerticesWith(a,0,2,u,d-4),u[d-2]=u[0],u[d-1]=u[1]):(f--,d-=4,u=t.Utils.setArraySize(this.world,d),i.computeWorldVerticesWith(a,2,d,u,0));for(var S=t.Utils.setArraySize(this.curves,f),E=0,w=u[0],I=u[1],R=0,P=0,O=0,B=0,D=0,M=0,L=0,N=0,F=0,k=0,z=0,V=0,G=0,W=0,v=0,U=2;v<f;v++,u+=6)r=u[u],p=u[u+1],o=u[u+2],b=u[u+3],d=u[u+4],m=u[u+5],l=.1875*(w-2*r+o),n=.1875*(i-2*p+b),f=.09375*(3*(r-o)-w+d),k=.09375*(3*(p-b)-i+m),z=2*l+f,v=2*n+k,g=.75*(r-w)+l+.16666667*f,w=.75*(p-i)+n+.16666667*k,e+=math.sqrt(g*g+w*w),g+=z,w+=v,z+=f,v+=k,e+=math.sqrt(g*g+w*w),g+=z,w+=v,e+=math.sqrt(g*g+w*w),g+=z+f,w+=v+k,e+=math.sqrt(g*g+w*w),s[v]=e,w=d,i=m;if(s&&(c*=e),o)for(var v="0;v<n;v++)h[v]*=E;for(var" j="this.segments,X=0,v=0,y=0,x=0,Y=0;v<n;v++,y+=3){var" t="h[v];c+=T;var" b="c;if(_)b%=E,b<0&&(b+=E),x=0;else{if(b<0){this.addBeforePosition(b,u,0,l,y);continue}if(b">E){this.addAfterPosition(b-E,u,d-4,l,y);continue}}for(;;x++){var H=S[x];if(!(b>H)){if(0==x)b/=H;else{var A=S[x-1];b=(b-A)/(H-A)}break}}if(x!=p){p=x;var q=6*x;for(w=u[q],I=u[q+1],R=u[q+2],P=u[q+3],O=u[q+4],B=u[q+5],D=u[q+6],M=u[q+7],L=.03*(w-2*R+O),N=.03*(I-2*P+B),F=.006*(3*(R-O)-w+D),k=.006*(3*(P-B)-I+M),z=2*L+F,V=2*N+k,G=.3*(R-w)+L+.16666667*F,W=.3*(P-I)+N+.16666667*k,X=Math.sqrt(G*G+W*W),j[0]=X,q=1;q<8;q++)g+=z,w+=v,z+=f,v+=k,x+=math.sqrt(g*g+w*w),j[q]=x;g+=z,w+=v,x+=math.sqrt(g*g+w*w),j[8]=x,g+=z+f,w+=v+k,x+=math.sqrt(g*g+w*w),j[9]=x,y=0}for(b*=x;;y++){var z="j[Y];if(!(b">Z)){if(0==Y)b/=Z;else{var A=j[Y-1];b=Y+(b-A)/(Z-A)}break}}this.addCurvePosition(.1*b,w,I,R,P,O,B,D,M,l,y,r||v>0&&0==T)}return l},e.prototype.addBeforePosition=function(t,e,i,n,r){var s=e[i],o=e[i+1],a=e[i+2]-s,c=e[i+3]-o,h=Math.atan2(c,a);n[r]=s+t*Math.cos(h),n[r+1]=o+t*Math.sin(h),n[r+2]=h},e.prototype.addAfterPosition=function(t,e,i,n,r){var s=e[i+2],o=e[i+3],a=s-e[i],c=o-e[i+1],h=Math.atan2(c,a);n[r]=s+t*Math.cos(h),n[r+1]=o+t*Math.sin(h),n[r+2]=h},e.prototype.addCurvePosition=function(t,e,i,n,r,s,o,a,c,h,l,u){(0==t||isNaN(t))&&(t=1e-4);var _=t*t,d=_*t,f=1-t,p=f*f,m=p*f,g=f*t,v=3*g,y=f*v,x=v*t,T=e*m+n*y+s*x+a*d,b=i*m+r*y+o*x+c*d;h[l]=T,h[l+1]=b,u&&(h[l+2]=Math.atan2(b-(i*p+r*g*2+o*_),T-(e*p+n*g*2+s*_)))},e.prototype.getOrder=function(){return this.data.order},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e})();t.PathConstraint=e})(n||(n={}));var n;!(function(t){var e=(function(){function t(t){this.order=0,this.bones=new Array,this.name=t}return t})();t.PathConstraintData=e,(function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"})(t.PositionMode||(t.PositionMode={}));t.PositionMode;!(function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"})(t.SpacingMode||(t.SpacingMode={}));t.SpacingMode;!(function(t){
t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"})(t.RotateMode||(t.RotateMode={}));t.RotateMode})(n||(n={}));var n;!(function(t){var e=(function(){function t(t){this.toLoad=new Array,this.assets={},this.clientId=t}return t.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},t})(),i=(function(){function t(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}return t.prototype.queueAsset=function(t,i,n){var r=this.clientAssets[t];return null!==r&&void 0!==r||(r=new e(t),this.clientAssets[t]=r),null!==i&&(r.textureLoader=i),r.toLoad.push(n),this.queuedAssets[n]!==n&&(this.queuedAssets[n]=n,!0)},t.prototype.loadText=function(t,e){var i=this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(n.status>=200&&n.status<300?i.rawassets[e]=n.responsetext:i.errors[e]="couldn't load="" text="" "+e+":="" status="" "+n.status+",="" "+n.responsetext)},n.open("get",e,!0),n.send()}},t.prototype.loadjson="function(t,e){var" i="this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var" n="new" xmlhttprequest;n.onreadystatechange="function(){n.readyState==XMLHttpRequest.DONE&&(n.status">=200&&n.status<300?i.rawassets[e]=json.parse(n.responsetext):i.errors[e]="couldn't 0="==i||i.assets[e]},t.prototype.updateClientAssets=function(t){for(var" load="" text="" "+e+":="" status="" "+n.status+",="" "+n.responsetext)},n.open("get",e,!0),n.send()}},t.prototype.loadtexture="function(t,e,i){var" n="this;if(i=this.pathPrefix+i,this.queueAsset(t,e,i)){var" r="new" image;r.src="i,r.crossOrigin="anonymous",r.onload=function(t){n.rawAssets[i]=r},r.onerror=function(t){n.errors[i]="Couldn't" image="" "+i}}},t.prototype.get="function(t,e){e=this.pathPrefix+e;var" i="this.clientAssets[t];return" null="==i||void" e="0;e<t.toLoad.length;e++){var" instanceof="" htmlimageelement?t.assets[i]="t.textureLoader(r):t.assets[i]=r}}},t.prototype.isLoadingComplete=function(t){var" object.keys(this.errors).length="">0},t.prototype.getErrors=function(){return this.errors},t})();t.SharedAssetManager=i})(n||(n={}));var n;!(function(t){var e=(function(){function e(e){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var i=0;i<e.bones.length;i++){var n="e.bones[i],r=void" 0;if(null="=n.parent)r=new" t.bone(n,this,null);else{var="" s="this.bones[n.parent.index];r=new" t.bone(n,this,s),s.children.push(r)}this.bones.push(r)}this.slots="new" array,this.draworder="new" array;for(var="" i="0;i<e.slots.length;i++){var" o="e.slots[i],r=this.bones[o.boneData.index],a=new" t.slot(o,r);this.slots.push(a),this.draworder.push(a)}this.ikconstraints="new" c="e.ikConstraints[i];this.ikConstraints.push(new" t.ikconstraint(c,this))}this.transformconstraints="new" h="e.transformConstraints[i];this.transformConstraints.push(new" t.transformconstraint(h,this))}this.pathconstraints="new" l="e.pathConstraints[i];this.pathConstraints.push(new" t.pathconstraint(l,this))}this.color="new" t.color(1,1,1,1),this.updatecache()}return="" e.prototype.updatecache="function(){var" t="this._updateCache;t.length=0;for(var" e="this.bones,i=0,n=e.length;i<n;i++)e[i].sorted=!1;var" r="this.ikConstraints,s=this.transformConstraints,o=this.pathConstraints,a=r.length,c=s.length,h=o.length,l=a+c+h;t:for(var" u="0;u<a;u++){var" _="r[u];if(_.data.order==i){this.sortIkConstraint(_);continue" t}}for(var="" t}}}for(var="">1){var r=i[i.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(n.children),i[i.length-1].sorted=!0},e.prototype.sortPathConstraint=function(e){var i=e.target,n=i.data.index,r=i.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,r),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,r);for(var s=0,o=this.data.skins.length;s<o;s++)this.sortpathconstraintattachment(this.data.skins[s],n,r);var 0="=this.bones.length?null:this.bones[0]},e.prototype.findBone=function(t){if(null==t)throw" a="i.getAttachment();a" instanceof="" t.pathattachment&&this.sortpathconstraintattachmentwith(a,r);for(var="" c="e.bones,h=c.length,s=0;s<h;s++)this.sortBone(c[s]);this._updateCache.push(e);for(var" s="0;s<h;s++)this.sortReset(c[s].children);for(var" e="t.bones,i=e.length,n=0;n<i;n++)this.sortBone(e[n]);this._updateCache.push(t);for(var" n="0;n<i;n++)this.sortReset(e[n].children);for(var" r="" in="" n)this.sortpathconstraintattachmentwith(n[r],i)},e.prototype.sortpathconstraintattachmentwith="function(e,i){if(e" t.pathattachment){var="" for(var="" o="n[s++],a=s+o;s<a;s++){var" t="this.updateCacheReset,e=0,i=t.length;e<i;e++){var" i="0,n=e.length;i<n;i++)e[i].setToSetupPose()},e.prototype.getRootBone=function(){return" new="" error("bonename="" cannot="" be="" null.");for(var="" r}return="" null},e.prototype.findboneindex="function(t){if(null==t)throw" i;return-1},e.prototype.findslot="function(t){if(null==t)throw" error("slotname="" null},e.prototype.findslotindex="function(t){if(null==t)throw" i;return-1},e.prototype.setskinbyname="function(t){var" error("skin="" not="" found:="" "+t);this.setskin(e)},e.prototype.setskin="function(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else" this.getattachment(this.data.findslotindex(t),e)},e.prototype.getattachment="function(t,e){if(null==e)throw" error("attachmentname="" null.");if(null!="this.skin){var" i}return="" null!="this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},e.prototype.setAttachment=function(t,e){if(null==t)throw" error("attachment="" "+e+",="" for="" slot:="" "+t);return="" void="" s.setattachment(o)}}throw="" error("slot="" "+t)},e.prototype.findikconstraint="function(t){if(null==t)throw" error("constraintname="" null},e.prototype.findtransformconstraint="function(t){if(null==t)throw" null},e.prototype.findpathconstraint="function(t){if(null==t)throw" null},e.prototype.getbounds="function(e,i){if(null==e)throw" error("offset="" null.");if(null="=i)throw" error("size="" l="n[c],u=null,_=l.getAttachment();if(_" t.regionattachment?u="_.updateWorldVertices(l,!1):_" t.meshattachment&&(u="_.updateWorldVertices(l,!0)),null!=u)for(var" d="0,f=u.length;d<f;d+=8){var" p="u[d],m=u[d+1];r=Math.min(r,p),s=Math.min(s,m),o=Math.max(o,p),a=Math.max(a,m)}}e.set(r,s),i.set(o-r,a-s)},e.prototype.update=function(t){this.time+=t},e})();t.Skeleton=e})(n||(n={}));var" n;!(function(t){var="" e(){this.minx="0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new" array,this.polygons="new" array,this.polygonpool="new" t.pool(function(){return="" t.utils.newfloatarray(16)})}return="" e.prototype.update="function(e,i){if(null==e)throw" error("skeleton="" null.");var="" h="o[c],l=h.getAttachment();if(l" t.boundingboxattachment){var="" u="l;n.push(u);var" _="s.obtain();_.length!=u.worldVerticesLength&&(_=t.Utils.newFloatArray(u.worldVerticesLength)),r.push(_),u.computeWorldVertices(h,_)}}i?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},e.prototype.aabbCompute=function(){for(var">=this.minX&&t<=this.maxx&&e>=this.minY&&e<=this.maxy},e.prototype.aabbintersectssegment=function(t,e,i,n){var r="this.minX,s=this.minY,o=this.maxX,a=this.maxY;if(t<=r&&i<=r||e<=s&&n<=s||t">=o&&i>=o||e>=a&&n>=a)return!1;var c=(n-e)/(i-t),h=c*(r-t)+e;if(h>s&&h<a)return!0;if(h=c*(o-t)+e,h>s&&h<a)return!0;var l="(s-e)/c+t;return">r&&l<o||(l=(a-e) c+t,l="">r&&l<o)},e.prototype.aabbintersectsskeleton=function(t){return this.minx<t.maxx&&this.maxx="">t.minX&&this.minY<t.maxy&&this.maxy>t.minY},e.prototype.containsPoint=function(t,e){for(var i=this.polygons,n=0,r=i.length;n<r;n++)if(this.containspointpolygon(i[n],t,e))return this.boundingboxes[n];return="" null},e.prototype.containspointpolygon="function(t,e,i){for(var" n="t,r=t.length,s=r-2,o=!1,a=0;a<r;a+=2){var" c="n[a+1],h=n[s+1];if(c<i&&h">=i||h<i&&c>=i){var l=n[a];l+(i-c)/(h-c)*(n[s]-l)<e&&(o=!o)}s=a}return o},e.prototype.intersectssegment="function(t,e,i,n){for(var" r="this.polygons,s=0,o=r.length;s<o;s++)if(this.intersectsSegmentPolygon(r[s],t,e,i,n))return" this.boundingboxes[s];return="" null},e.prototype.intersectssegmentpolygon="function(t,e,i,n,r){for(var" s="t,o=t.length,a=e-n,c=i-r,h=e*r-i*n,l=s[o-2],u=s[o-1],_=0;_<o;_+=2){var" d="s[_],f=s[_+1],p=l*f-u*d,m=l-d,g=u-f,v=a*g-c*m,y=(h*m-a*p)/v;if((y">=l&&y<=d||y>=d&&y<=l)&&(y>=e&&y<=n||y>=n&&y<=e)){var x="(h*g-c*p)/v;if((x">=u&&x<=f||x>=f&&x<=u)&&(x>=i&&x<=r||x>=r&&x<=i))return!0}l=d,u=f}return!1},e.prototype.getpolygon=function(t){if(null==t)throw new="" error("boundingbox="" cannot="" be="" null.");var="" e="this.boundingBoxes.indexOf(t);return" this.maxx-this.minx},e.prototype.getheight="function(){return" this.maxy-this.miny},e})();t.skeletonbounds="e})(n||(n={}));var" n;!(function(t){var="" t(){this.bones="new" array,this.slots="new" array,this.skins="new" array,this.events="new" array,this.animations="new" array,this.ikconstraints="new" array,this.transformconstraints="new" array,this.pathconstraints="new" array,this.fps="0}return" t.prototype.findbone="function(t){if(null==t)throw" error("bonename="" null.");for(var="" r="e[i];if(r.name==t)return" r}return="" null},t.prototype.findboneindex="function(t){if(null==t)throw" i;return-1},t.prototype.findslot="function(t){if(null==t)throw" error("slotname="" null},t.prototype.findslotindex="function(t){if(null==t)throw" i;return-1},t.prototype.findskin="function(t){if(null==t)throw" error("skinname="" null},t.prototype.findevent="function(t){if(null==t)throw" error("eventdataname="" null},t.prototype.findanimation="function(t){if(null==t)throw" error("animationname="" null},t.prototype.findikconstraint="function(t){if(null==t)throw" error("constraintname="" null},t.prototype.findtransformconstraint="function(t){if(null==t)throw" null},t.prototype.findpathconstraint="function(t){if(null==t)throw" null},t.prototype.findpathconstraintindex="function(t){if(null==t)throw" error("pathconstraintname="" i;return-1},t})();t.skeletondata="e})(n||(n={}));var" e(t){this.scale="1,this.linkedMeshes=new" array,this.attachmentloader="t}return" e.prototype.readskeletondata="function(i){var" n="this.scale,r=new" t.skeletondata,s="string" =="typeof" i?json.parse(i):i,o="s.skeleton;if(null!=o&&(r.hash=o.hash,r.version=o.spine,r.width=o.width,r.height=o.height,r.fps=o.fps,r.imagesPath=o.images),s.bones)for(var" a="0;a<s.bones.length;a++){var" c="s.bones[a],h=null,l=this.getValue(c,"parent",null);if(null!=l&&(h=r.findBone(l),null==h))throw" error("parent="" bone="" not="" found:="" "+l);var="" u="new" t.bonedata(r.bones.length,c.name,h);u.length="this.getValue(c,"length",0)*n,u.x=this.getValue(c,"x",0)*n,u.y=this.getValue(c,"y",0)*n,u.rotation=this.getValue(c,"rotation",0),u.scaleX=this.getValue(c,"scaleX",1),u.scaleY=this.getValue(c,"scaleY",1),u.shearX=this.getValue(c,"shearX",0),u.shearY=this.getValue(c,"shearY",0),u.transformMode=e.transformModeFromString(this.getValue(c,"transform","normal")),r.bones.push(u)}if(s.slots)for(var" _="s.slots[a],d=_.name,f=_.bone,p=r.findBone(f);if(null==p)throw" error("slot="" "+f);var="" t.slotdata(r.slots.length,d,p),m="this.getValue(_,"color",null);null!=m&&u.color.setFromString(m),u.attachmentName=this.getValue(_,"attachment",null),u.blendMode=e.blendModeFromString(this.getValue(_,"blend","normal")),r.slots.push(u)}if(s.ik)for(var" g="s.ik[a],u=new" t.ikconstraintdata(g.name);u.order="this.getValue(g,"order",0);for(var" v="0;v<g.bones.length;v++){var" f="g.bones[v],y=r.findBone(f);if(null==y)throw" error("ik="" "+f);u.bones.push(y)}var="" x="g.target;if(u.target=r.findBone(x),null==u.target)throw" target="" "+x);u.benddirection="this.getValue(g,"bendPositive",!0)?1:-1,u.mix=this.getValue(g,"mix",1),r.ikConstraints.push(u)}if(s.transform)for(var" t.transformconstraintdata(g.name);u.order="this.getValue(g,"order",0);for(var" error("transform="" constraint="" "+x);u.offsetrotation="this.getValue(g,"rotation",0),u.offsetX=this.getValue(g,"x",0)*n,u.offsetY=this.getValue(g,"y",0)*n,u.offsetScaleX=this.getValue(g,"scaleX",0),u.offsetScaleY=this.getValue(g,"scaleY",0),u.offsetShearY=this.getValue(g,"shearY",0),u.rotateMix=this.getValue(g,"rotateMix",1),u.translateMix=this.getValue(g,"translateMix",1),u.scaleMix=this.getValue(g,"scaleMix",1),u.shearMix=this.getValue(g,"shearMix",1),r.transformConstraints.push(u)}if(s.path)for(var" t.pathconstraintdata(g.name);u.order="this.getValue(g,"order",0);for(var" error("path="" slot="" "+x);u.positionmode="e.positionModeFromString(this.getValue(g,"positionMode","percent")),u.spacingMode=e.spacingModeFromString(this.getValue(g,"spacingMode","length")),u.rotateMode=e.rotateModeFromString(this.getValue(g,"rotateMode","tangent")),u.offsetRotation=this.getValue(g,"rotation",0),u.position=this.getValue(g,"position",0),u.positionMode==t.PositionMode.Fixed&&(u.position*=n),u.spacing=this.getValue(g,"spacing",0),u.spacingMode!=t.SpacingMode.Length&&u.spacingMode!=t.SpacingMode.Fixed||(u.spacing*=n),u.rotateMix=this.getValue(g,"rotateMix",1),u.translateMix=this.getValue(g,"translateMix",1),r.pathConstraints.push(u)}if(s.skins)for(var" t="" in="" s.skins){var="" b="s.skins[T],C=new" t.skin(t);for(var="" d="" b){var="" "+d);var="" s="" _){var="" i="this.linkedMeshes[a],C=null==I.skin?r.defaultSkin:r.findSkin(I.skin);if(null==C)throw" error("skin="" "+i.skin);var="" mesh="" "+i.parent);i.mesh.setparentmesh(r),i.mesh.updateuvs()}if(this.linkedmeshes.length="0,s.events)for(var" p="" s.events){var="" o="s.events[P],u=new" t.eventdata(p);u.intvalue="this.getValue(O,"int",0),u.floatValue=this.getValue(O,"float",0),u.stringValue=this.getValue(O,"string",""),r.events.push(u)}if(s.animations)for(var" s.animations){var="" r},e.prototype.readattachment="function(e,n,r,s){var" null;h.path="c,h.x=this.getValue(e,"x",0)*o,h.y=this.getValue(e,"y",0)*o,h.scaleX=this.getValue(e,"scaleX",1),h.scaleY=this.getValue(e,"scaleY",1),h.rotation=this.getValue(e,"rotation",0),h.width=e.width*o,h.height=e.height*o;var" l="this.getValue(e,"color",null);return" null!="l&&h.color.setFromString(l),h.updateOffset(),h;case"boundingbox":var" null;this.readvertices(e,u,e.vertexcount<<1);var="" null;_.path="c;var" _.inheritdeform="this.getValue(e,"deform",!0),this.linkedMeshes.push(new" i(_,this.getvalue(e,"skin",null),r,d)),_;var="" this.readvertices(e,_,f.length),_.triangles="e.triangles,_.regionUVs=f,_.updateUVs(),_.hullLength=2*this.getValue(e,"hull",0),_;case"path":var" null;c.closed="this.getValue(e,"closed",!1),c.constantSpeed=this.getValue(e,"constantSpeed",!0);var" m="t.Utils.newArray(p/3,0),g=0;g<e.lengths.length;g++)m[g++]=e.lengths[g]*o;c.lengths=m;var" null},e.prototype.readvertices="function(e,i,n){var" void(i.vertices="t.Utils.toFloatArray(s))}for(var" array,h="new" array,o="0,a=s.length;o<a;){var" e.slots){var="" "+a);for(var="" c){var="" t.colortimeline(u.length);_.slotindex="h;for(var" t.color;m.setfromstring(p.color),_.setframe(d,p.time,m.r,m.g,m.b,m.a),this.readcurve(p,_,d),d++}s.push(_),o="Math.max(o,_.frames[(_.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if(!(l="attachment"))throw" error("invalid="" timeline="" type="" for="" slot:="" "+l+"="" ("+a+")");var="" t.attachmenttimeline(u.length);_.slotindex="h;for(var" e.bones){var="" error("bone="" "+g);for(var="" v){var="" t.rotatetimeline(u.length);_.boneindex="y;for(var" bone:="" ("+g+")");var="" t.scaletimeline(u.length):"shear"="==l?_=new" t.sheartimeline(u.length):(_="new" t.translatetimeline(u.length),x="r),_.boneIndex=y;for(var" e.ik){var="" t.ikconstrainttimeline(a.length);_.ikconstraintindex="n.ikConstraints.indexOf(S);for(var" e.transform){var="" t.transformconstrainttimeline(a.length);_.transformconstraintindex="n.transformConstraints.indexOf(S);for(var" e.paths){var="" "+c);var="" w="n.pathConstraints[E];for(var" a){var="" t.pathconstraintspacingtimeline(u.length),w.spacingmode!="t.SpacingMode.Length&&w.spacingMode!=t.SpacingMode.Fixed||(x=r)):(_=new" t.pathconstraintpositiontimeline(u.length),w.positionmode="=t.PositionMode.Fixed&&(x=r)),_.pathConstraintIndex=E;for(var" if("mix"="==l){var" t.pathconstraintmixtimeline(u.length);_.pathconstraintindex="E;for(var" e.deform){var="" "+i);for(var="" r){var="" "+c.name);for(var="" error("deform="" attachment="" "+u.name);var="" t.deformtimeline(u.length);_.slotindex="h,_.attachment=O;for(var" 0,f="this.getValue(p,"vertices",null);if(null==F)N=B?t.Utils.newFloatArray(M):D;else{N=t.Utils.newFloatArray(M);var" k="this.getValue(p,"offset",0);if(t.Utils.arrayCopy(F,0,N,k,F.length),1!=r)for(var" t.drawordertimeline(v.length),g="n.slots.length,d=0,L=0;L<V.length;L++){var" q="j[f],h=n.findSlotIndex(q.slot);if(h==-1)throw" "+q.slot);for(;y!="h;)X[H++]=Y++;U[Y+q.offset]=Y++}for(;Y<G;)X[H++]=Y++;for(var">=0;f--)U[f]==-1&&(U[f]=X[--H])}_.setFrame(d++,W.time,U)}s.push(_),o=Math.max(o,_.frames[_.getFrameCount()-1])}if(e.events){for(var _=new t.EventTimeline(e.events.length),d=0,f=0;f<e.events.length;f++){var z="e.events[f],J=n.findEvent(Z.name);if(null==J)throw" new="" error("event="" not="" found:="" "+z.name);var="" q="new" t.event(z.time,j);q.intvalue="this.getValue(Z,"int",J.intValue),Q.floatValue=this.getValue(Z,"float",J.floatValue),Q.stringValue=this.getValue(Z,"string",J.stringValue),_.setFrame(d++,Q)}s.push(_),o=Math.max(o,_.frames[_.getFrameCount()-1])}if(isNaN(o))throw" error("error="" while="" parsing="" animation,="" duration="" is="" nan");n.animations.push(new="" t.animation(i,s,o))},e.prototype.readcurve="function(t,e,i){if(t.curve)if("stepped"===t.curve)e.setStepped(i);else" if("[object="" array]"="==Object.prototype.toString.call(t.curve)){var" n="t.curve;e.setCurve(i,n[0],n[1],n[2],n[3])}},e.prototype.getValue=function(t,e,i){return" void="" 0!="=t[e]?t[e]:i},e.blendModeFromString=function(e){if(e=e.toLowerCase(),"normal"==e)return" t.blendmode.normal;if("additive"="=e)return" t.blendmode.additive;if("multiply"="=e)return" t.blendmode.multiply;if("screen"="=e)return" t.blendmode.screen;throw="" error("unknown="" blend="" mode:="" "+e)},e.positionmodefromstring="function(e){if(e=e.toLowerCase(),"fixed"==e)return" t.positionmode.fixed;if("percent"="=e)return" t.positionmode.percent;throw="" position="" "+e)},e.spacingmodefromstring="function(e){if(e=e.toLowerCase(),"length"==e)return" t.spacingmode.length;if("fixed"="=e)return" t.spacingmode.fixed;if("percent"="=e)return" t.spacingmode.percent;throw="" "+e)},e.rotatemodefromstring="function(e){if(e=e.toLowerCase(),"tangent"==e)return" t.rotatemode.tangent;if("chain"="=e)return" t.rotatemode.chain;if("chainscale"="=e)return" t.rotatemode.chainscale;throw="" rotate="" "+e)},e.transformmodefromstring="function(e){if(e=e.toLowerCase(),"normal"==e)return" t.transformmode.normal;if("onlytranslation"="=e)return" t.transformmode.onlytranslation;if("norotationorreflection"="=e)return" t.transformmode.norotationorreflection;if("noscale"="=e)return" t.transformmode.noscale;if("noscaleorreflection"="=e)return" t.transformmode.noscaleorreflection;throw="" transform="" "+e)},e})();t.skeletonjson="e;var" i="(function(){function" t(t,e,i,n){this.mesh="t,this.skin=e,this.slotIndex=i,this.parent=n}return" t})()})(n||(n="{}));var" n;!(function(t){var="" e="(function(){function" t(t){if(this.attachments="new" array,null="=t)throw" error("name="" cannot="" be="" null.");this.name="t}return" t.prototype.addattachment="function(t,e,i){if(null==i)throw" error("attachment="" null.");var="">=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i},t.prototype.getAttachment=function(t,e){var i=this.attachments[t];return i?i[e]:null},t.prototype.attachAll=function(t,e){for(var i=0,n=0;n<t.slots.length;n++){var r="t.slots[n],s=r.getAttachment();if(s&&i<e.attachments.length){var" o="e.attachments[i];for(var" a="" in="" o){var="" c="o[a];if(s==c){var" h="this.getAttachment(i,a);null!=h&&r.setAttachment(h);break}}}i++}},t})();t.Skin=e})(n||(n={}));var" n;!(function(t){var="" e="(function(){function" e(e,i){if(this.attachmentvertices="new" array,null="=e)throw" new="" error("data="" cannot="" be="" null.");if(null="=i)throw" error("bone="" null.");this.data="e,this.bone=i,this.color=new" t.color,this.settosetuppose()}return="" e.prototype.getattachment="function(){return" this.attachment},e.prototype.setattachment="function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},e.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},e.prototype.getAttachmentTime=function(){return" this.bone.skeleton.time-this.attachmenttime},e.prototype.settosetuppose="function(){this.color.setFromColor(this.data.color),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},e})();t.Slot=e})(n||(n={}));var" e(e,i,n){if(this.color="new" t.color(1,1,1,1),e<0)throw="" error("index="" must="">= 0.");if(null==i)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=e,this.name=i,this.boneData=n}return e})();t.SlotData=e})(n||(n={}));var n;!(function(t){
var e=(function(){function t(t){this._image=t}return t.prototype.getImage=function(){return this._image},t.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return i.Nearest;case"linear":return i.Linear;case"mipmap":return i.MipMap;case"mipmapnearestnearest":return i.MipMapNearestNearest;case"mipmaplinearnearest":return i.MipMapLinearNearest;case"mipmapnearestlinear":return i.MipMapNearestLinear;case"mipmaplinearlinear":return i.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},t.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return n.MirroredRepeat;case"clamptoedge":return n.ClampToEdge;case"repeat":return n.Repeat;default:throw new Error("Unknown texture wrap "+t)}},t})();t.Texture=e,(function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"})(t.TextureFilter||(t.TextureFilter={}));var i=t.TextureFilter;!(function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"})(t.TextureWrap||(t.TextureWrap={}));var n=t.TextureWrap,r=(function(){function t(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}return t})();t.TextureRegion=r})(n||(n={}));var n;!(function(t){var e=(function(){function e(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}return e.prototype.load=function(e,r){if(null==r)throw new Error("textureLoader cannot be null.");for(var o=new i(e),a=new Array(4),c=null;;){var h=o.readLine();if(null==h)break;if(h=h.trim(),0==h.length)c=null;else if(c){var l=new s;l.name=h,l.page=c,l.rotate="true"==o.readValue(),o.readTuple(a);var u=parseInt(a[0]),_=parseInt(a[1]);o.readTuple(a);var d=parseInt(a[0]),f=parseInt(a[1]);l.u=u/c.width,l.v=_/c.height,l.rotate?(l.u2=(u+f)/c.width,l.v2=(_+d)/c.height):(l.u2=(u+d)/c.width,l.v2=(_+f)/c.height),l.x=u,l.y=_,l.width=Math.abs(d),l.height=Math.abs(f),4==o.readTuple(a)&&4==o.readTuple(a)&&o.readTuple(a),l.originalWidth=parseInt(a[0]),l.originalHeight=parseInt(a[1]),o.readTuple(a),l.offsetX=parseInt(a[0]),l.offsetY=parseInt(a[1]),l.index=parseInt(o.readValue()),l.texture=c.texture,this.regions.push(l)}else{c=new n,c.name=h,2==o.readTuple(a)&&(c.width=parseInt(a[0]),c.height=parseInt(a[1]),o.readTuple(a)),o.readTuple(a),c.minFilter=t.Texture.filterFromString(a[0]),c.magFilter=t.Texture.filterFromString(a[1]);var p=o.readValue();c.uWrap=t.TextureWrap.ClampToEdge,c.vWrap=t.TextureWrap.ClampToEdge,"x"==p?c.uWrap=t.TextureWrap.Repeat:"y"==p?c.vWrap=t.TextureWrap.Repeat:"xy"==p&&(c.uWrap=c.vWrap=t.TextureWrap.Repeat),c.texture=r(h),c.texture.setFilters(c.minFilter,c.magFilter),c.texture.setWraps(c.uWrap,c.vWrap),c.width=c.texture.getImage().width,c.height=c.texture.getImage().height,this.pages.push(c)}}},e.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return="" null},e.prototype.dispose="function(){for(var" t="0;t<this.pages.length;t++)this.pages[t].texture.dispose()},e})();t.TextureAtlas=e;var" i="(function(){function" t(t){this.index="0,this.lines=t.split(/\r\n|\r|\n/)}return" t.prototype.readline="function(){return" this.index="">=this.lines.length?null:this.lines[this.index++]},t.prototype.readValue=function(){var t=this.readLine(),e=t.indexOf(":");if(e==-1)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()},t.prototype.readTuple=function(t){var e=this.readLine(),i=e.indexOf(":");if(i==-1)throw new Error("Invalid line: "+e);for(var n=0,r=i+1;n<3;n++){var s="e.indexOf(",",r);if(s==-1)break;t[n]=e.substr(r,s-r).trim(),r=s+1}return" t[n]="e.substring(r).trim(),n+1},t})(),n=(function(){function" t(){}return="" t})();t.textureatlaspage="n;var" e(){t.apply(this,arguments)}return="" r(e,t),e})(t.textureregion);t.textureatlasregion="s})(n||(n={}));var" n;!(function(t){var="" e="(function(){function" e(e,i){if(this.rotatemix="0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new" t.vector2,null="=e)throw" new="" error("data="" cannot="" be="" null.");if(null="=i)throw" error("skeleton="" null.");this.data="e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new" array;for(var="" n="0;n<e.bones.length;n++)this.bones.push(i.findBone(e.bones[n].name));this.target=i.findBone(e.target.name)}return" e.prototype.apply="function(){this.update()},e.prototype.update=function(){for(var">0?t.MathUtils.degRad:-t.MathUtils.degRad,u=this.data.offsetRotation*l,_=this.data.offsetShearY*l,d=this.bones,f=0,p=d.length;f<p;f++){var m="d[f],g=!1;if(0!=e){var" v="m.a,y=m.b,x=m.c,T=m.d,b=Math.atan2(c,o)-Math.atan2(x,v)+u;b">t.MathUtils.PI?b-=t.MathUtils.PI2:b<-t.mathutils.pi&&(b+=t.mathutils.pi2),b*=e;var c="Math.cos(b),A=Math.sin(b);m.a=C*v-A*x,m.b=C*y-A*T,m.c=A*v+C*x,m.d=A*y+C*T,g=!0}if(0!=i){var" s="this.temp;s.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),m.worldX+=(S.x-m.worldX)*i,m.worldY+=(S.y-m.worldY)*i,g=!0}if(n">0){var E=Math.sqrt(m.a*m.a+m.c*m.c),w=Math.sqrt(o*o+c*c);E>1e-5&&(E=(E+(w-E+this.data.offsetScaleX)*n)/E),m.a*=E,m.c*=E,E=Math.sqrt(m.b*m.b+m.d*m.d),w=Math.sqrt(a*a+h*h),E>1e-5&&(E=(E+(w-E+this.data.offsetScaleY)*n)/E),m.b*=E,m.d*=E,g=!0}if(r>0){var y=m.b,T=m.d,I=Math.atan2(T,y),b=Math.atan2(h,a)-Math.atan2(c,o)-(I-Math.atan2(m.c,m.a));b>t.MathUtils.PI?b-=t.MathUtils.PI2:b<-t.mathutils.pi&&(b+=t.mathutils.pi2),b=i+(b+_)*r;var 0="==t&&(t=0),void" e="Math.sqrt(y*y+T*T);m.b=Math.cos(b)*E,m.d=Math.sin(b)*E,g=!0}g&&(m.appliedValid=!1)}},e.prototype.getOrder=function(){return" this.data.order},e})();t.transformconstraint="e})(n||(n={}));var" n;!(function(t){var="" t(t){if(this.order="0,this.bones=new" array,this.rotatemix="0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,null==t)throw" new="" error("name="" cannot="" be="" null.");this.name="t}return" t})();t.transformconstraintdata="e})(n||(n={}));var" t(){this.array="new" array}return="" t.prototype.add="function(t){var" this.array[0|t]="0|t,!e},t.prototype.contains=function(t){return" void="" 0!="this.array[0|t]},t.prototype.remove=function(t){this.array[0|t]=void" 0},t.prototype.clear="function(){this.array.length=0},t})();t.IntSet=e;var" i="(function(){function" t(t,e,i,n){void="" t.prototype.set="function(t,e,i,n){return" this.r="t,this.g=e,this.b=i,this.a=n,this.clamp(),this},t.prototype.setFromColor=function(t){return" t="#" =="t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this},t.prototype.add=function(t,e,i,n){return" this.r+="t,this.g+=e,this.b+=i,this.a+=n,this.clamp(),this},t.prototype.clamp=function(){return" this.r<0?this.r="0:this.r">1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},t.WHITE=new t(1,1,1,1),t.RED=new t(1,0,0,1),t.GREEN=new t(0,1,0,1),t.BLUE=new t(0,0,1,1),t.MAGENTA=new t(1,0,1,1),t})();t.Color=i;var n=(function(){function t(){}return t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t.cosDeg=function(e){return Math.cos(e*t.degRad)},t.sinDeg=function(e){return Math.sin(e*t.degRad)},t.signum=function(t){return t>0?1:t<0?-1:0},t.toint=function(t){return t="">0?Math.floor(t):Math.ceil(t)},t.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},t.pi=3.1415927,t.pi2=2*t.pi,t.radianstodegrees=180 0="==i&&(i=0);var" t.pi,t.raddeg="t.radiansToDegrees,t.degreesToRadians=t.PI/180,t.degRad=t.degreesToRadians,t})();t.MathUtils=n;var" r="(function(){function" t(){}return="" t.arraycopy="function(t,e,i,n,r){for(var" s="e,o=n;s<e+r;s++,o++)i[o]=t[s]},t.setArraySize=function(t,e,i){void" n="t.length;if(n==e)return" t;if(t.length="e,n<e)for(var" t},t.ensurearraycapacity="function(e,i,n){return" void="">=i?e:t.setArraySize(e,i,n)},t.newArray=function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i},t.newfloatarray="function(e){if(t.SUPPORTS_TYPED_ARRAYS)return" new="" float32array(e);for(var="" i="new" array(e),n="0;n<i.length;n++)i[n]=0;return" i},t.tofloatarray="function(e){return" t.supports_typed_arrays?new="" float32array(e):e},t.supports_typed_arrays="undefined" !="typeof" float32array,t})();t.utils="r;var" s="(function(){function" t(){}return="" t.logbones="function(t){for(var" e="0;e<t.bones.length;e++){var" "+i.a+",="" "+i.b+",="" "+i.c+",="" "+i.d+",="" "+i.worldx+",="" "+i.worldy)}},t})();t.debugutils="s;var" o="(function(){function" t(t){this.items="new" array,this.instantiator="t}return" t.prototype.obtain="function(){return" this.items.length="">0?this.items.pop():this.instantiator()},t.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},t.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},t.prototype.clear=function(){this.items.length=0},t})();t.pool=o;var 0="==t&&(t=0),void" a="(function(){function" t(t,e){void="" t.prototype.set="function(t,e){return" this.x="t,this.y=e,this},t.prototype.length=function(){var" t="this.x,e=this.y;return" math.sqrt(t*t+e*e)},t.prototype.normalize="function(){var" 0!="t&&(this.x/=t,this.y/=t),this},t})();t.Vector2=a;var" c="(function(){function" t(){this.maxdelta=".064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return" t.prototype.update="function(){var">this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},t})();t.TimeKeeper=c})(n||(n={})),e.exports=n}),{}],310:[(function(t,e,i){!(function(){"use strict";function t(t){t||console.log("Assertion failed! Pls debug.")}function i(t,e,i){this.major=t,this.minor=e,this.revision=i}function n(t){return isFinite(t)&&!isNaN(t)}function r(t,e){"undefined"!=typeof t?(this.x=t,this.y=e):this.x=this.y=0}function s(t,e,i){"undefined"!=typeof t&&(this.x=t,this.y=e,this.z=i)}function o(t,e){this.ex=t?t.Clone():new r,this.ey=e?e.Clone():new r}function a(t,e,i){this.ex=t?t.Clone():new s,this.ey=e?e.Clone():new s,this.ez=i?i.Clone():new s}function c(t,e){"undefined"!=typeof e?(this.s=t,this.c=e):"undefined"!=typeof t&&this.Set(t)}function h(t,e){this.p=new r,this.q=new c,t&&(this.p.Assign(t),this.q.Assign(e))}function l(){this.localCenter=new r,this.c0=new r,this.c=new r}function u(t,e){return t.x*e.x+t.y*e.y}function _(t,e){return t.x*e.y-t.y*e.x}function d(t,e){return new r(e*t.y,-e*t.x)}function f(t,e){return new r(-t*e.y,t*e.x)}function p(t,e){return new r(t.ex.x*e.x+t.ey.x*e.y,t.ex.y*e.x+t.ey.y*e.y)}function m(t,e){return new r(u(e,t.ex),u(e,t.ey))}function g(t,e){var i=r.Subtract(t,e);return i.Length()}function v(t,e){var i=r.Subtract(t,e);return u(i,i)}function y(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function x(t,e){return new s(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}function T(t,e){return new o(p(t,e.ex),p(t,e.ey))}function b(t,e){var i=new r(u(t.ex,e.ex),u(t.ey,e.ex)),n=new r(u(t.ex,e.ey),u(t.ey,e.ey));return new o(i,n)}function C(t,e){return s.Add(s.Add(s.Multiply(e.x,t.ex),s.Multiply(e.y,t.ey)),s.Multiply(e.z,t.ez))}function A(t,e){return new r(t.ex.x*e.x+t.ey.x*e.y,t.ex.y*e.x+t.ey.y*e.y)}function S(t,e){var i=new c;return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}function E(t,e){var i=new c;return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}function w(t,e){return new r(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)}function I(t,e){return new r(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}function R(t,e){return new r(t.q.c*e.x-t.q.s*e.y+t.p.x,t.q.s*e.x+t.q.c*e.y+t.p.y)}function P(t,e){var i=e.x-t.p.x,n=e.y-t.p.y,s=t.q.c*i+t.q.s*n,o=-t.q.s*i+t.q.c*n;return new r(s,o)}function O(t,e){var i=new h;return i.q=S(t.q,e.q),i.p=r.Add(w(t.q,e.p),t.p),i}function B(t,e){var i=new h;i.q=E(t.q,e.q);var n=e.p.x-t.p.x,r=e.p.y-t.p.y;return i.p.x=t.q.c*n+t.q.s*r,i.p.y=-t.q.s*n+t.q.c*r,i}function D(t){return new r(Ii(t.x),Ii(t.y))}function M(t){return new o(D(t.ex),D(t.ey))}function L(t,e){return new r(Ri(t.x,e.x),Ri(t.y,e.y))}function N(t,e){return new r(Pi(t.x,e.x),Pi(t.y,e.y))}function F(t,e,i){return Pi(e,Ri(t,i))}function k(t,e,i){return N(e,L(t,i))}function z(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1}function V(t){var e=t>0&&0==(t&t-1);return e}function G(t,e){var i=Math.random();return i="undefined"!=typeof t?(e-t)*i+t:2*i-1}function W(t,e,i){this.r=t||0,this.g=e||0,this.b=i||0}function U(){}function j(){this.Reset()}function X(){this.mass=0,this.center=new r,this.I=0}function Y(){this.m_type=0,this.m_radius=0}function H(){this.parent.call(this),this.m_type=Y.e_circle,this.m_radius=0,this.m_p=new r,Object.seal(this)}function q(){this.parent.call(this),this.m_type=Y.e_edge,this.m_radius=si,this.m_vertex0=new r,this.m_vertex1=new r,this.m_vertex2=new r,this.m_vertex3=new r,this.m_hasVertex0=!1,this.m_hasVertex3=!1,Object.seal(this)}function Z(){this.parent.call(this),this.m_type=Y.e_chain,this.m_radius=si,this.m_prevVertex=new r,this.m_nextVertex=new r,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.Clear(),Object.seal(this)}function J(){this.parent.call(this),this.m_type=Y.e_polygon,this.m_radius=si,this.m_count=0,this.m_centroid=new r,this.m_vertices=new Array(ti),this.m_normals=new Array(ti),Object.seal(this)}function Q(){this.proxyIdA=0,this.proxyIdB=0}function K(t,e){return t.proxyIdA==e.proxyIdA?t.proxyIdB-e.proxyIdB:t.proxyIdA-e.proxyIdA}function $(){this.m_tree=new Ot,this.m_queryProxyId=0,this.m_proxyCount=0,this.m_pairCount=0,this.m_pairBuffer=[],this.m_moveCount=0,this.m_moveBuffer=[]}function tt(){this.m_vertices=null,this.m_count=0,this.m_radius=0}function et(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}function it(){this.proxyA=new tt,this.proxyB=new tt,this.transformA=new h,this.transformB=new h,this.useRadii=!1}function nt(){this.pointA=new r,this.pointB=new r,this.distance=0,this.iterations=0}function rt(){this.wA=new r,this.wB=new r,this.w=new r,this.a=0,this.indexA=0,this.indexB=0}function st(){this.m_v=[new rt,new rt,new rt],this.m_count=0}function ot(e,i,n){++ot.b2_gjkCalls;var r=n.proxyA,s=n.proxyB,o=n.transformA,a=n.transformB;Oi.ReadCache(i,r,o,s,a);for(var c=Oi.m_v,h=20,l=[0,0,0],u=[0,0,0],_=0,d=Je,f=d,p=0;p<h;){_=oi.m_count;for(var m="0;m<_;++m)l[m]=c[m].indexA,u[m]=c[m].indexB;switch(Oi.m_count){case" 1:break;case="" 2:oi.solve2();break;case="" 3:oi.solve3();break;default:t(!1)}if(3="=Oi.m_count)break;if(Oi.GetClosestPoint(Di),f=Di.LengthSquared(),d=f,Oi.GetSearchDirection(Di),Di.LengthSquared()<Qe*Qe)break;var" v="c[Oi.m_count];v.indexA=r.GetSupport(o.q.c*-Di.x+o.q.s*-Di.y,-o.q.s*-Di.x+o.q.c*-Di.y);var" y="r.GetVertex(v.indexA);v.wA.x=o.q.c*y.x-o.q.s*y.y+o.p.x,v.wA.y=o.q.s*y.x+o.q.c*y.y+o.p.y,v.indexB=s.GetSupport(a.q.c*Di.x+a.q.s*Di.y,-a.q.s*Di.x+a.q.c*Di.y);var" x="s.GetVertex(v.indexB);v.wB.x=a.q.c*x.x-a.q.s*x.y+a.p.x,v.wB.y=a.q.s*x.x+a.q.c*x.y+a.p.y,v.w.x=v.wB.x-v.wA.x,v.w.y=v.wB.y-v.wA.y,++p,++ot.b2_gjkIters;for(var" t="!1,m=0;m<_;++m)if(v.indexA==l[m]&&v.indexB==u[m]){T=!0;break}if(T)break;++Oi.m_count}if(ot.b2_gjkMaxIters=Pi(ot.b2_gjkMaxIters,p),Oi.GetWitnessPoints(e.pointA,e.pointB),e.distance=g(e.pointA,e.pointB),e.iterations=p,Oi.WriteCache(i),n.useRadii){var" b="r.m_radius,C=s.m_radius;if(e.distance">b+C&&e.distance>Qe)e.distance-=b+C,Bi.x=e.pointB.x-e.pointA.x,Bi.y=e.pointB.y-e.pointA.y,Bi.Normalize(),e.pointA.x+=b*Bi.x,e.pointA.y+=b*Bi.y,e.pointB.x-=C*Bi.x,e.pointB.y-=C*Bi.y;else{var A=.5*(e.pointA.x+e.pointB.x),S=.5*(e.pointA.y+e.pointB.y);e.pointA.x=A,e.pointA.y=S,e.pointB.x=A,e.pointB.y=S,e.distance=0}}}function at(){}function ct(){this.localPoint=new r,this.normalImpulse=0,this.tangentImpulse=0,this.id=new at}function ht(){this.points=new Array($e),this.localNormal=new r,this.localPoint=new r,this.type=0,this.pointCount=0}function lt(){this.normal=new r,this.points=new Array($e),this.separations=new Array($e)}function ut(t,e,i,n){for(var r=0;r<$e;++r)t[r]=ht.b2_nullstate,e[r]=ht.b2_nullstate;for(var r="0;r<i.pointCount;++r){var" s="i.points[r].id;t[r]=ht.b2_removeState;for(var" o="0;o<n.pointCount;++o)if(n.points[o].id.Get()==s.Get()){t[r]=ht.b2_persistState;break}}for(var" _t(){this.v="new" r,this.id="new" at}function="" dt(){this.p1="new" r,this.p2="new" r,this.maxfraction="0}function" ft(){this.normal="new" r,this.fraction="0}function" pt(){this.lowerbound="new" r,this.upperbound="new" r}function="" mt(t,e,i,n,r){t.pointcount="0;var">_*_||(t.type=ht.e_circles,t.localPoint.x=e.m_p.x,t.localPoint.y=e.m_p.y,t.localNormal.x=t.localNormal.y=0,t.pointCount=1,t.points[0]=new ct,t.points[0].localPoint.x=n.m_p.x,t.points[0].localPoint.y=n.m_p.y,t.points[0].id.Reset())}function gt(t,e,i,n,r){t.pointCount=0;for(var s=R(r,n.m_p),o=P(i,s),a=0,c=-Je,h=e.m_radius+n.m_radius,l=e.m_count,u=e.m_vertices,_=e.m_normals,d=0;d<l;++d){var f="_[d].x*(o.x-u[d].x)+_[d].y*(o.y-u[d].y);if(f">h)return;f>c&&(c=f,a=d)}var p=a,m=p+1<l?p+1:0,g=u[p],y=u[m];if(c<qe)return t.pointcount="1,t.type=ht.e_faceA,t.localNormal.x=_[a].x,t.localNormal.y=_[a].y,t.localPoint.x=.5*(g.x+y.x),t.localPoint.y=.5*(g.y+y.y),t.points[0]=new" ct,t.points[0].localpoint.x="n.m_p.x,t.points[0].localPoint.y=n.m_p.y,void" t.points[0].id.reset();var="" x="(o.x-g.x)*(y.x-g.x)+(o.y-g.y)*(y.y-g.y),T=(o.x-y.x)*(g.x-y.x)+(o.y-y.y)*(g.y-y.y);if(x<=0){if(v(o,g)">h*h)return;t.pointCount=1,t.type=ht.e_faceA,t.localNormal.x=o.x-g.x,t.localNormal.y=o.y-g.y,t.localNormal.Normalize(),t.localPoint.x=g.x,t.localPoint.y=g.y,t.points[0]=new ct,t.points[0].localPoint.x=n.m_p.x,t.points[0].localPoint.y=n.m_p.y,t.points[0].id.Reset()}else if(T<=0){if(v(o,y)>h*h)return;t.pointCount=1,t.type=ht.e_faceA,t.localNormal.x=o.x-y.x,t.localNormal.y=o.y-y.y,t.localNormal.Normalize(),t.localPoint.x=y.x,t.localPoint.y=y.y,t.points[0]=new ct,t.points[0].localPoint.x=n.m_p.x,t.points[0].localPoint.y=n.m_p.y,t.points[0].id.Reset()}else{var b=.5*(g.x+y.x),C=.5*(g.y+y.y),c=(o.x-b)*_[p].x+(o.y-C)*_[p].y;if(c>h)return;t.pointCount=1,t.type=ht.e_faceA,t.localNormal.x=_[p].x,t.localNormal.y=_[p].y,t.localPoint.x=b,t.localPoint.y=C,t.points[0]=new ct,t.points[0].localPoint.x=n.m_p.x,t.points[0].localPoint.y=n.m_p.y,t.points[0].id.Reset()}}function vt(t,e,i,n,r){for(var s=e.m_count,o=n.m_count,a=e.m_normals,c=e.m_vertices,h=n.m_vertices,l=B(r,i),u=0,_=-Je,d=0;d<s;++d){for(var f="l.q.c*a[d].x-l.q.s*a[d].y,p=l.q.s*a[d].x+l.q.c*a[d].y,m=l.q.c*c[d].x-l.q.s*c[d].y+l.p.x,g=l.q.s*c[d].x+l.q.c*c[d].y+l.p.y,v=Je,y=0;y<o;++y){var" x="f*(h[y].x-m)+p*(h[y].y-g);x<v&&(v=x)}v">_&&(_=v,u=d)}return t[0]=u,_}function yt(e,i,n,r,s,o){var a=i.m_normals,c=s.m_count,h=s.m_vertices,l=s.m_normals;t(0<=r&&r<i.m_count);for(var u="n.q.c*a[r].x-n.q.s*a[r].y,_=n.q.s*a[r].x+n.q.c*a[r].y,d=o.q.c*u+o.q.s*_,f=-o.q.s*u+o.q.c*_,p=0,m=Je,g=0;g<c;++g){var" v="d*l[g].x+f*l[g].y;v<m&&(m=v,p=g)}var" y="p,x=y+1<c?y+1:0;e[0].v.x=o.q.c*h[y].x-o.q.s*h[y].y+o.p.x,e[0].v.y=o.q.s*h[y].x+o.q.c*h[y].y+o.p.y,e[0].id.indexA=r,e[0].id.indexB=y,e[0].id.typeA=at.e_face,e[0].id.typeB=at.e_vertex,e[1].v.x=o.q.c*h[x].x-o.q.s*h[x].y+o.p.x,e[1].v.y=o.q.s*h[x].x+o.q.c*h[x].y+o.p.y,e[1].id.indexA=r,e[1].id.indexB=x,e[1].id.typeA=at.e_face,e[1].id.typeB=at.e_vertex}function" xt(t,e,i,n,r){t.pointcount="0;var" s="e.m_radius+n.m_radius,o=[0],a=vt(o,e,i,n,r);if(!(a">s)){var c=[0],h=vt(c,n,r,e,i);if(!(h>s)){var l,u,_,d,f=0,p=0,m=.1*ni;h>a+m?(l=n,u=e,_=r,d=i,f=c[0],t.type=ht.e_faceB,p=1):(l=e,u=n,_=i,d=r,f=o[0],t.type=ht.e_faceA,p=0),yt(xt._local_incidentEdges,l,_,f,u,d);var g=l.m_count,v=l.m_vertices,y=f,x=f+1<g?f+1:0,t=v[y],b=v[x];xt._localtangent.x=b.x-t.x,xt._localtangent.y=b.y-t.y,xt._localtangent.normalize();var c="1*xt._localTangent.y,A=-1*xt._localTangent.x,S=.5*(T.x+b.x),E=.5*(T.y+b.y),w=_.q.c*xt._localTangent.x-_.q.s*xt._localTangent.y,I=_.q.s*xt._localTangent.x+_.q.c*xt._localTangent.y,O=1*I,B=-1*w;T=R(_,T),b=R(_,b);var" d,m="O*T.x+B*T.y,L=-(w*T.x+I*T.y)+s,N=w*b.x+I*b.y+s,F=new" array(2),k="new" array(2);if(d="wt(F,xt._local_incidentEdges,-w,-I,L,y),!(D<2||(D=wt(k,F,w,I,N,x),D<2))){t.localNormal.x=C,t.localNormal.y=A,t.localPoint.x=S,t.localPoint.y=E;for(var" z="0,V=0;V<$e;++V){var" g="O*k[V].v.x+B*k[V].v.y-M;if(G<=s){var" w="t.points[z]=new" ct;if(w.localpoint.assign(p(d,k[v].v)),w.id.assign(k[v].id),p){var="" u="new" at;u.assign(w.id),w.id.indexa="U.indexB,W.id.indexB=U.indexA,W.id.typeA=U.typeB,W.id.typeB=U.typeA}++z}}t.pointCount=z}}}}function" tt(e,i,n,r,s){e.pointcount="0;var" o="P(n,R(s,r.m_p)),a=i.m_vertex1,c=i.m_vertex2,h=c.x-a.x,l=c.y-a.y,u=h*(c.x-o.x)+l*(c.y-o.y),_=h*(o.x-a.x)+l*(o.y-a.y),d=i.m_radius+r.m_radius,f=new" at;if(f.indexb="0,f.typeB=at.e_vertex,_<=0){var" p="a,m=o.x-p.x,g=o.y-p.y,v=m*m+g*g;if(v">d*d)return;if(i.m_hasVertex0){var y=i.m_vertex0,x=a,T=x.x-y.x,b=x.y-y.y,C=T*(x.x-o.x)+b*(x.y-o.y);if(C>0)return}return f.indexA=0,f.typeA=at.e_vertex,e.pointCount=1,e.type=ht.e_circles,e.localNormal.x=e.localNormal.y=0,e.localPoint.x=p.x,e.localPoint.y=p.y,e.points[0]=new ct,e.points[0].id.Assign(f),e.points[0].localPoint.x=r.m_p.x,void(e.points[0].localPoint.y=r.m_p.y)}if(u<=0){var p="c,m=o.x-p.x,g=o.y-p.y,v=m*m+g*g;if(v">d*d)return;if(i.m_hasVertex3){var A=i.m_vertex3,S=c,E=A.x-S.x,w=A.y-S.y,I=E*(o.x-S.x)+w*(o.y-S.y);if(I>0)return}return f.indexA=1,f.typeA=at.e_vertex,e.pointCount=1,e.type=ht.e_circles,e.localNormal.x=e.localNormal.y=0,e.localPoint.x=p.x,e.localPoint.y=p.y,e.points[0]=new ct,e.points[0].id.Assign(f),e.points[0].localPoint.x=r.m_p.x,void(e.points[0].localPoint.y=r.m_p.y)}var O=h*h+l*l;t(O>0);var B=1/O*(u*a.x+_*c.x),D=1/O*(u*a.y+_*c.y),m=o.x-B,g=o.y-D,v=m*m+g*g;if(!(v>d*d)){var M=-l,L=h;M*(o.x-a.x)+L*(o.y-a.y)<0&&(m=-m,l=-l),f.indexa=0,f.typea=at.e_face,e.pointcount=1,e.type=ht.e_facea,e.localnormal.x=m,e.localnormal.y=l,e.localnormal.normalize(),e.localpoint.x=a.x,e.localpoint.y=a.y,e.points[0]=new ct,e.points[0].id.assign(f),e.points[0].localpoint.x="r.m_p.x,e.points[0].localPoint.y=r.m_p.y}}function" bt(){this.type="0,this.index=0,this.separation=0}function" ct(){this.vertices="new" array(ti),this.normals="new" array(ti),this.count="0}function" at(){this.i1="0,this.i2=0,this.v1=new" r,this.v2="new" r,this.normal="new" r,this.sidenormal1="new" r,this.sideoffset1="0,this.sideNormal2=new" r,this.sideoffset2="0}function" st(){this.m_polygonb="new" ct,this.m_xf="new" h,this.m_centroidb="new" r,this.m_v0="new" r,this.m_v1="new" r,this.m_v2="new" r,this.m_v3="new" r,this.m_normal0="new" r,this.m_normal1="new" r,this.m_normal2="new" r,this.m_normal="new" r,this.m_type1="0,this.m_type2=0,this.m_lowerLimit=new" r,this.m_upperlimit="new" r,this.m_radius="0,this.m_front=!1}function" et(t,e,i,n,r){et.collider.collide(t,e,i,n,r)}function="" wt(t,e,i,n,r,s){var="" o="0,a=i*e[0].v.x+n*e[0].v.y-r,c=i*e[1].v.x+n*e[1].v.y-r;if(a<=0&&(t[o++]=e[0]),c<=0&&(t[o++]=e[1]),a*c<0){var" h="a/(a-c);t[o]=new" _t,t[o].v.x="e[0].v.x+h*(e[1].v.x-e[0].v.x),t[o].v.y=e[0].v.y+h*(e[1].v.y-e[0].v.y),t[o].id.indexA=s,t[o].id.indexB=e[0].id.indexB,t[o].id.typeA=at.e_vertex,t[o].id.typeB=at.e_face,++o}return" o}function="" it(t,e,i,n,r,s){return="" it.input.proxya.set(t,e),it.input.proxyb.set(i,n),it.input.transforma="r,It.input.transformB=s,It.input.useRadii=!0,It.cache.count=0,ot(It.output,It.cache,It.input),It.output.distance<10*Qe}function" rt(t,e){return!(e.lowerbound.x-t.upperbound.x="">0||e.lowerBound.y-t.upperBound.y>0||t.lowerBound.x-e.upperBound.x>0||t.lowerBound.y-e.upperBound.y>0)}function Pt(){this.aabb=new pt,this.userData=null,this.parent=0,this.child1=this.child2=this.height=0}function Ot(){this.m_root=Mi,this.m_nodeCapacity=16,this.m_nodeCount=0,this.m_nodes=new Array(this.m_nodeCapacity);for(var t=0;t<this.m_nodecapacity-1;++t)this.m_nodes[t]=new pt,this.m_nodes[t].parent="t+1,this.m_nodes[t].height=-1;this.m_nodes[this.m_nodeCapacity-1]=new" pt,this.m_nodes[this.m_nodecapacity-1].parent="Mi,this.m_nodes[this.m_nodeCapacity-1].height=-1,this.m_freeList=0,this.m_path=0,this.m_insertionCount=0}function" bt(){this.proxya="new" tt,this.proxyb="new" tt,this.sweepa="new" l,this.sweepb="new" l,this.tmax="0}function" dt(){this.state="0,this.t=0}function" mt(){this.m_proxya="null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=0,this.m_localPoint=new" r,this.m_axis="new" r}function="" lt(e,i){fi.start(),++lt.b2_toicalls,e.state="Dt.e_unknown,e.t=i.tMax;var" n="i.proxyA,r=i.proxyB;Lt._temp_sweepA.Assign(i.sweepA),Lt._temp_sweepB.Assign(i.sweepB),Lt._temp_sweepA.Normalize(),Lt._temp_sweepB.Normalize();var" s="i.tMax,o=n.m_radius+r.m_radius,a=Pi(ni,o-3*ni),c=.25*ni;t(a">c);var h=0,l=20,u=0,_=new et;_.count=0;var d=new it;for(d.proxyA.Assign(i.proxyA),d.proxyB.Assign(i.proxyB),d.useRadii=!1;;){Lt._temp_sweepA.GetTransform(d.transformA,h),Lt._temp_sweepB.GetTransform(d.transformB,h);var f=new nt;if(ot(f,_,d),f.distance<=0){e.state=dt.e_overlapped,e.t=0;break}if(f.distance<a+c){e.state=dt.e_touching,e.t=h;break}var p="new" mt;p.initialize(_,n,lt._temp_sweepa,r,lt._temp_sweepb,h);for(var="" m="!1,g=s,v=0;;){var" y="[],x=p.FindMinSeparation(y,g);if(x">a+c){e.state=Dt.e_separated,e.t=s,m=!0;break}if(x>a-c){h=g;break}var T=p.Evaluate(y[0],y[1],h);if(T<a-c){e.state=dt.e_failed,e.t=h,m=!0;break}if(t<=a+c){e.state=dt.e_touching,e.t=h,m=!0;break}for(var b="0,C=h,A=g;;){var" s;s="1&b?C+(a-T)*(A-C)/(x-T):.5*(C+A),++b,++Lt.b2_toiRootIters;var" e="p.Evaluate(y[0],y[1],S);if(Ii(E-a)<c){g=S;break}if(E">a?(C=S,T=E):(A=S,x=E),50==b)break}if(Lt.b2_toiMaxRootIters=Pi(Lt.b2_toiMaxRootIters,b),++v,v==ti)break}if(++u,++Lt.b2_toiIters,m)break;if(u==l){e.state=Dt.e_failed,e.t=h;break}}Lt.b2_toiMaxIters=Pi(Lt.b2_toiMaxIters,u),Fi.stop(),Lt.b2_toiMaxTime=Pi(Lt.b2_toiMaxTime,Fi.elapsedTime),Lt.b2_toiTime+=Fi.elapsedTime}function Nt(){this.type=Ft.b2_staticBody,this.position=new r(0,0),this.angle=0,this.linearVelocity=new r(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.active=!0,this.userData=null,this.gravityScale=1,Object.seal(this)}function Ft(e,i){t(e.position.IsValid()),t(e.linearVelocity.IsValid()),t(n(e.angle)),t(n(e.angularVelocity)),t(n(e.angularDamping)&&e.angularDamping>=0),t(n(e.linearDamping)&&e.linearDamping>=0),this.m_islandIndex=0,this.m_flags=0,e.bullet&&(this.m_flags|=Ft.e_bulletFlag),e.fixedRotation&&(this.m_flags|=Ft.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=Ft.e_autoSleepFlag),e.awake&&(this.m_flags|=Ft.e_awakeFlag),e.active&&(this.m_flags|=Ft.e_activeFlag),this.m_world=i,this.m_xf=new h,this.m_xf.p.Assign(e.position),this.m_xf.q.Set(e.angle),this.m_sweep=new l,this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Assign(this.m_xf.p),this.m_sweep.c.Assign(this.m_xf.p),this.m_sweep.a0=e.angle,this.m_sweep.a=e.angle,this.m_sweep.alpha0=0,this.m_jointList=null,this.m_contactList=null,this.m_prev=null,this.m_next=null,this.m_linearVelocity=e.linearVelocity.Clone(),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_force=new r,this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type==Ft.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}function kt(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}function zt(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new kt,Object.seal(this)}function Vt(){this.aabb=new pt,this.fixture=null,this.childIndex=0,this.proxyId=0}function Gt(){this.m_userData=null,this.m_body=null,this.m_next=null,this.m_proxies=null,this.m_proxyCount=0,this.m_shape=null,this.m_density=0,this.m_filter=new kt,this.m_isSensor=!1,this.m_friction=0,this.m_restitution=0}function Wt(){}function Ut(){}function jt(){this.normalImpulses=new Array($e),this.tangentImpulses=new Array($e),this.count=0}function Xt(){}function Yt(){}function Ht(){}function qt(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1}function Zt(){this.c=new r,this.a=0}function Jt(){this.v=new r,this.w=0}function Qt(){this.step=new qt,this.positions=null,this.velocities=null}function Kt(t){this.m_contactManager=new de,this.m_destructionListener=null,this.g_debugDraw=null,this.m_bodyList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_allowSleep=!0,this.m_gravity=t,this.m_flags=Kt.e_clearForces,this.m_inv_dt0=0,this.p_step=new qt,this.p_island=new xe}function $t(){this.broadPhase=null,this.callback=null}function te(){this.broadPhase=null,this.callback=null}function ee(t,e){return Ei(t*e)}function ie(t,e){return t>e?t:e}function ne(){this.fcn=null,this.primary=!1}function re(){this.other=null,this.contact=null,this.prev=null,this.next=null}function se(){this.m_nodeA=new re,this.m_nodeB=new re,this.m_manifold=new ht}function oe(){this.parent.call(this)}function ae(){this.parent.call(this)}function ce(){this.parent.call(this)}function he(){this.parent.call(this)}function le(){this.parent.call(this)}function ue(){this.parent.call(this)}function _e(){this.parent.call(this)}function de(){this.m_broadPhase=new $,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=ji,this.m_contactListener=Xi}function fe(){this.rA=new r,this.rB=new r,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function pe(){this.localPoints=new Array($e),this.localNormal=new r,this.localPoint=new r,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new r,this.localCenterB=new r,this.invIA=0,this.invIB=0,this.type=0,this.radiusA=0,this.radiusB=0,this.pointCount=0}function me(){this.points=new Array($e);for(var t=0;t<this.points.length;++t)this.points[t]=new fe;this.normal="new" r,this.normalmass="new" o,this.k="new" o,this.indexa="0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}function" ge(){this.normal="new" r,this.point="new" r,this.separation="0}function" ve(){this.step="new" qt,this.contacts="null,this.count=0,this.positions=null,this.velocities=null}function" ye(){this.m_positionconstraints="[],this.m_velocityConstraints=[]}function" xe(){this.m_bodies="[],this.m_contacts=[],this.m_joints=[],this.m_velocities=[],this.m_positions=[]}function" te(){this.linear="new" r,this.angulara="0,this.angularB=0}function" be(){this.other="null,this.joint=null,this.prev=null,this.next=null}function" ce(){this.type="Ae.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1}function" ae(e){t(e.bodya!="e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_index=0,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData,this.m_edgeA=new" be,this.m_edgea.joint="null,this.m_edgeA.other=null,this.m_edgeA.prev=null,this.m_edgeA.next=null,this.m_edgeB=new" be,this.m_edgeb.joint="null," this.m_edgeb.other="null,this.m_edgeB.prev=null,this.m_edgeB.next=null}function" se(){this.parent.call(this),this.type="Ae.e_revoluteJoint,this.localAnchorA=new" r,this.localanchorb="new" r,this.referenceangle="0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1,Object.seal(this)}function" ee(t){this.parent.call(this,t),this.m_localanchora="t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_referenceAngle=t.referenceAngle,this.m_impulse=new" s,this.m_motorimpulse="0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=Ae.e_inactiveLimit,this.m_indexA=0,this.m_indexB=0,this.m_rA=new" r,this.m_rb="new" r,this.m_localcentera="new" r,this.m_localcenterb="new" r,this.m_invmassa="0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new" a,this.m_motormass="0}function" we(){this.parent.call(this),this.type="Ae.e_mouseJoint,this.target=new" r(0,0),this.maxforce="0,this.frequencyHz=5,this.dampingRatio=.7,Object.seal(this)}function" ie(e){this.parent.call(this,e),t(e.target.isvalid()),t(n(e.maxforce)&&e.maxforce="">=0),t(n(e.frequencyHz)&&e.frequencyHz>=0),t(n(e.dampingRatio)&&e.dampingRatio>=0),this.m_targetA=e.target.Clone(),this.m_localAnchorB=P(this.m_bodyB.GetTransform(),this.m_targetA),this.m_maxForce=e.maxForce,this.m_impulse=new r,this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_indexA=0,this.m_indexB=0,this.m_rB=new r,this.m_localCenterB=new r,this.m_invMassB=0,this.m_invIB=0,this.m_mass=new o,this.m_C=new r}function Re(){this.parent.call(this),this.type=Ae.e_distanceJoint,this.localAnchorA=new r(0,0),this.localAnchorB=new r(0,0),this.length=1,this.frequencyHz=0,this.dampingRatio=0,Object.seal(this)}function Pe(t){this.parent.call(this,t),this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new r,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0}function Oe(){this.parent.call(this),this.type=Ae.e_prismaticJoint,this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0,Object.seal(this)}function Be(t){this.parent.call(this,t),this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_localXAxisA=t.localAxisA.Clone(),this.m_localXAxisA.Normalize(),this.m_localYAxisA=f(1,this.m_localXAxisA),this.m_referenceAngle=t.referenceAngle,this.m_impulse=new s,this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=Ae.e_inactiveLimit,this.m_axis=new r,this.m_perp=new r,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_s1=0,this.m_s2=0,this.m_a1=0,this.m_a2=0,this.m_K=new a,this.m_motorMass=0}function De(){this.parent.call(this),this.type=Ae.e_frictionJoint,this.localAnchorA=new r,this.localAnchorB=new r,this.maxForce=0,this.maxTorque=0,Object.seal(this)}function Me(t){this.parent.call(this,t),this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_linearImpulse=new r,this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_indexA=0,this.m_indexB=0,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new o,this.m_angularMass=0}function Le(){this.parent.call(this),this.type=Ae.e_weldJoint,this.localAnchorA=new r(0,0),this.localAnchorB=new r(0,0),this.referenceAngle=0,this.frequencyHz=0,this.dampingRatio=0,Object.seal(this)}function Ne(t){this.parent.call(this,t),this.m_bias=0,this.m_gamma=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new a,this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_referenceAngle=t.referenceAngle,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=new s}function Fe(){this.parent.call(this),this.type=Ae.e_wheelJoint,this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r(1,0),this.enableMotor=!1,this.maxMotorTorque=0,this.motorSpeed=0,this.frequencyHz=2,this.dampingRatio=.7,Object.seal(this)}function ke(t){this.parent.call(this,t),this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_localXAxisA=t.localAxisA.Clone(),this.m_localYAxisA=f(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_ax=new r,this.m_ay=new r,this.m_sAx=this.m_sBx=0,this.m_sAy=this.m_sBy=0}function ze(){this.parent.call(this),this.type=Ae.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1,Object.seal(this)}function Ve(e){this.parent.call(this,e),this.m_joint1=e.joint1,this.m_joint2=e.joint2,this.m_typeA=this.m_joint1.GetType(),this.m_typeB=this.m_joint2.GetType(),t(this.m_typeA==Ae.e_revoluteJoint||this.m_typeA==Ae.e_prismaticJoint),t(this.m_typeB==Ae.e_revoluteJoint||this.m_typeB==Ae.e_prismaticJoint);var i,n;this.m_bodyC=this.m_joint1.GetBodyA(),this.m_bodyA=this.m_joint1.GetBodyB();var s=this.m_bodyA.m_xf,o=this.m_bodyA.m_sweep.a,a=this.m_bodyC.m_xf,c=this.m_bodyC.m_sweep.a;if(this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_localAnchorC=new r,this.m_localAnchorD=new r,this.m_localAxisC=new r,this.m_localAxisD=new r,this.m_typeA==Ae.e_revoluteJoint){var h=e.joint1;this.m_localAnchorC.Assign(h.m_localAnchorA),this.m_localAnchorA.Assign(h.m_localAnchorB),this.m_referenceAngleA=h.m_referenceAngle,this.m_localAxisC.SetZero(),i=o-c-this.m_referenceAngleA}else{var l=e.joint1;this.m_localAnchorC.Assign(l.m_localAnchorA),this.m_localAnchorA.Assign(l.m_localAnchorB),this.m_referenceAngleA=l.m_referenceAngle,this.m_localAxisC.Assign(l.m_localXAxisA);var _=this.m_localAnchorC,d=I(a.q,r.Add(w(s.q,this.m_localAnchorA),r.Subtract(s.p,a.p)));i=u(r.Subtract(d,_),this.m_localAxisC)}this.m_bodyD=this.m_joint2.GetBodyA(),this.m_bodyB=this.m_joint2.GetBodyB();var f=this.m_bodyB.m_xf,p=this.m_bodyB.m_sweep.a,m=this.m_bodyD.m_xf,g=this.m_bodyD.m_sweep.a;if(this.m_typeB==Ae.e_revoluteJoint){var h=e.joint2;this.m_localAnchorD.Assign(h.m_localAnchorA),this.m_localAnchorB.Assign(h.m_localAnchorB),this.m_referenceAngleB=h.m_referenceAngle,this.m_localAxisD.SetZero(),n=p-g-this.m_referenceAngleB}else{var l=e.joint2;this.m_localAnchorD.Assign(l.m_localAnchorA),this.m_localAnchorB.Assign(l.m_localAnchorB),this.m_referenceAngleB=l.m_referenceAngle,this.m_localAxisD.Assign(l.m_localXAxisA);var v=this.m_localAnchorD,y=I(m.q,r.Add(w(f.q,this.m_localAnchorB),r.Subtract(f.p,m.p)));n=u(r.Subtract(y,v),this.m_localAxisD)}this.m_ratio=e.ratio,this.m_constant=i+this.m_ratio*n,this.m_impulse=0,this.m_indexA=this.m_indexB=this.m_indexC=this.m_indexD=0,this.m_lcA=new r,this.m_lcB=new r,this.m_lcC=new r,this.m_lcD=new r,this.m_mA=this.m_mB=this.m_mC=this.m_mD=0,this.m_iA=this.m_iB=this.m_iC=this.m_iD=0,this.m_JvAC=new r,this.m_JvBD=new r,this.m_JwA=this.m_JwB=this.m_JwC=this.m_JwD=0,this.m_mass=0}function Ge(){this.parent.call(this),this.type=Ae.e_motorJoint,this.linearOffset=new r,this.angularOffset=0,this.maxForce=1,this.maxTorque=1,this.correctionFactor=.3,Object.seal(this)}function We(t){this.parent.call(this,t),this.m_linearOffset=t.linearOffset.Clone(),this.m_angularOffset=t.angularOffset,this.m_linearImpulse=new r,this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_indexA=0,this.m_indexB=0,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_linearError=new r,this.m_angularError=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new o,this.m_angularMass=0}function Ue(){this.parent.call(this),this.type=Ae.e_pulleyJoint,this.groundAnchorA=new r(-1,1),this.groundAnchorB=new r(1,1),this.localAnchorA=new r(-1,0),this.localAnchorB=new r(1,0),this.lengthA=0,this.lengthB=0,this.ratio=1,this.collideConnected=!0,Object.seal(this)}function je(e){this.parent.call(this,e),this.m_indexA=0,this.m_indexB=0,this.m_uA=new r,this.m_uB=new r,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_groundAnchorA=e.groundAnchorA.Clone(),this.m_groundAnchorB=e.groundAnchorB.Clone(),this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_lengthA=e.lengthA,this.m_lengthB=e.lengthB,t(0!=e.ratio),this.m_ratio=e.ratio,this.m_constant=e.lengthA+this.m_ratio*e.lengthB,this.m_impulse=0}function Xe(){this.parent.call(this),this.type=Ae.e_ropeJoint,this.localAnchorA=new r(-1,0),this.localAnchorB=new r(1,0),this.maxLength=0,Object.seal(this)}function Ye(t){this.parent.call(this,t),this.m_localAnchorA=t.localAnchorA.Clone(),this.m_localAnchorB=t.localAnchorB.Clone(),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_state=Ae.e_inactiveLimit,this.m_length=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new r,this.m_rA=new r,this.m_rB=new r,this.m_localCenterA=new r,this.m_localCenterB=new r,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0}function He(){this.vertices=null,this.count=0,this.masses=null,this.gravity=new r,this.damping=.1,this.k2=.9,this.k3=.1}function qe(){this.m_count=0,this.m_ps=null,this.m_p0s=null,this.m_vs=null,this.m_ims=null,this.m_Ls=null,this.m_as=null,this.m_damping=0,this.m_gravity=new r,this.m_k2=1,this.m_k3=.1}Function.prototype._extend=function(t){this.prototype.parent=t;for(var e in t.prototype)this.prototype[e]||(this.prototype[e]=t.prototype[e])},Function.prototype._implement=function(t){return this._extend(t)};var Ze=(function(){function t(t,e){this.name=t,this.parent=e,this.children={},this.startTime=0,this.elapsedTime=0,this.totalTime=0,this.running=!1,this.childrenCount=0}function e(e,i){if(!o)throw new Error("late profile creation not allowed");var n=new t(e,i||"root");return o.push(n),n}function i(t){t.childrenCount--,delete t.children[t.name]}function n(t,e){if(t.name===e.parent)return t;for(var i in t.children){var r;if(r=n(t.children[i],e))return r}return null}function r(){for(;o.length;){var t=o.pop();(t.parentNode=n(a,t))?(t.parentNode.children[t.name]=t,t.parentNode.childrenCount++):o.unshift(t)}o=null}function s(){a.reset(!0)}"undefined"==typeof performance&&(window.performance={now:function(){return+new Date}}),t.prototype={start:function(){this.startTime=performance.now(),this.running=!0},stop:function(t){if(this.running){this.running=!1,this.elapsedTime+=performance.now()-this.startTime,t&&this.start();for(var e in this.children)this.children[e].stop()}},reset:function(t){t||(this.running=!0,this.totalTime+=this.elapsedTime,this.start()),this.elapsedTime=0;for(var e in this.children)this.children[e].reset(!0)}};var o=[],a=new t("root");return{create:e,destroy:i,init:r,reset:s,profileRoot:a}})(),Je=Number.MAX_VALUE,Qe=2.220446049250313e-16,Ke=Math.PI,$e=2,ti=8,ei=.1,ii=2,ni=.005,ri=2/180*Ke,si=2*ni,oi=8,ai=32,ci=1,hi=.2,li=8/180*Ke,ui=2,_i=ui*ui,di=.5*Ke,fi=di*di,pi=.2,mi=.75,gi=.5,vi=.01,yi=2/180*Ke;i.prototype={toString:function(){return this.major+"."+this.minor+"."+this.revision}};var xi=new i(2,3,1),Ti=Math.sqrt,bi=Math.atan2,Ci=Math.sin,Ai=Math.cos,Si=Math.floor,Ei=(Math.ceil,Ti),wi=bi;r.prototype={Clone:function(){return new r(this.x,this.y)},SetZero:function(){return this.x=0,this.y=0,this},Set:function(t,e){return this.x=t,this.y=e,this},Assign:function(t){return this.x=t.x,this.y=t.y,this},Negate:function(){var t=new r;return t.Set(-this.x,-this.y),t},get_i:function(t){switch(t){case 0:return this.x;case 1:return this.y}},set_i:function(t,e){switch(t){case 0:return this.x=e;case 1:return this.y=e}},Add:function(t){return this.x+=t.x,this.y+=t.y,this},Subtract:function(t){return this.x-=t.x,this.y-=t.y,this},Multiply:function(t){return this.x*=t,this.y*=t,this},Length:function(){return Ei(this.x*this.x+this.y*this.y)},LengthSquared:function(){return this.x*this.x+this.y*this.y},Normalize:function(){var t=this.Length();if(t<qe)return 0;var="" e="1/t;return" this.x*="e,this.y*=e,t},IsValid:function(){return" n(this.x)&&n(this.y)},skew:function(){return="" new="" r(-this.y,this.x)},_serialize:function(t){var="" e[0]="this.x,e[1]=this.y,e},_deserialize:function(t){this.x=t[0],this.y=t[1]}},r.Add=function(t,e){return" r(t.x+e.x,t.y+e.y)},r.subtract="function(t,e){return" r(t.x-e.x,t.y-e.y)},r.equals="function(t,e){return" t.x="=e.x&&t.y==e.y},r.Multiply=function(t,e){return" r(t*e.x,t*e.y)},r.negate="function(t){return" r(-t.x,-t.y)},s.prototype="{Clone:function(){return" s(this.x,this.y,this.z)},setzero:function(){this.x="0,this.y=0,this.z=0},Set:function(t,e,i){this.x=t,this.y=e,this.z=i},Negate:function(){var" t="new" s;return="" t.set(-this.x,-this.y,-this.z),t},add:function(t){this.x+="t.x,this.y+=t.y,this.z+=t.z},Subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},Multiply:function(t){this.x*=t,this.y*=t,this.z*=t},Invert:function(){return" this.x="-this.x,this.y=-this.y,this.z=-this.z,this},x:0,y:0,z:0},s.Multiply=function(t,e){return" s(t*e.x,t*e.y,t*e.z)},s.add="function(t,e){return" s(t.x+e.x,t.y+e.y,t.z+e.z)},s.subtract="function(t,e){return" s(t.x-e.x,t.y-e.y,t.z-e.z)},o.prototype="{Set:function(t,e){this.ex.Assign(t),this.ey.Assign(e)},Assign:function(t){this.ex.Assign(t.ex),this.ey.Assign(t.ey)},SetIdentity:function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},SetZero:function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},GetInverse:function(){var" o,s="t*n-e*i;return" 0!="s&&(s=1/s),r.ex.x=s*n,r.ey.x=-s*e,r.ex.y=-s*i,r.ey.y=s*t,r},Solve:function(t){var" a="new" r;return="" a.x="o*(s*t.x-i*t.y),a.y=o*(e*t.y-n*t.x),a}},o.Add=function(t,e){return" o(r.add(t.ex,e.ex),r.add(t.ey,e.ey))},a.prototype="{SetZero:function(){this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero()},Solve33:function(t){var" i="new" i.x="e*y(t,x(this.ey,this.ez)),i.y=e*y(this.ex,x(t,this.ez)),i.z=e*y(this.ex,x(this.ey,t)),i},Solve22:function(t){var" c(this.s,this.c)},assign:function(t){this.s="t.s,this.c=t.c},Set:function(t){this.s=Ci(t),this.c=Ai(t)},SetIdentity:function(){this.s=0,this.c=1},GetAngle:function(){return" wi(this.s,this.c)},getxaxis:function(){return="" r(this.c,this.s)},getyaxis:function(){return="" r(-this.s,this.c)},s:0,c:1},h.prototype="{Clone:function(){var" h(this.p,this.q);return="" t},assign:function(t){this.p.assign(t.p),this.q.assign(t.q)},setidentity:function(){this.p.setzero(),this.q.setidentity()},set:function(t,e){this.p.assign(t),this.q.set(e)}},l.prototype="{Assign:function(t){this.localCenter.Assign(t.localCenter),this.c0.Assign(t.c0),this.c.Assign(t.c),this.a=t.a,this.a0=t.a0,this.alpha0=t.alpha0},Clone:function(){var" l;return="" t.localcenter.assign(this.localcenter),t.c0.assign(this.c0),t.c.assign(this.c),t.a="this.a,t.a0=this.a0,t.alpha0=this.alpha0,t},GetTransform:function(t,e){t.p.x=(1-e)*this.c0.x+e*this.c.x,t.p.y=(1-e)*this.c0.y+e*this.c.y;var" ii="Math.abs,Ri=Math.min,Pi=Math.max;W.prototype={Set:function(t,e,i){this.r=t,this.g=e,this.b=i}},U.prototype={ClearDraw:function(){},SetFlags:function(t){this.m_drawFlags=t},GetFlags:function(){return" this.m_drawflags},appendflags:function(t){this.m_drawflags|="t},ClearFlags:function(t){this.m_drawFlags&=~t},ToggleFlags:function(t){this.m_drawFlags^=t},DrawPolygon:function(t,e,i){},DrawSolidPolygon:function(t,e,i){},DrawCircle:function(t,e,i){},DrawSolidCircle:function(t,e,i,n){},DrawSegment:function(t,e,i){},DrawTransform:function(t){},m_drawFlags:0},U.e_shapeBit=1,U.e_jointBit=2,U.e_aabbBit=4,U.e_centerOfMassBit=8,U.e_contactPoints=16,U.e_contactNormals=32,U.e_contactImpulses=64,U.e_frictionImpulses=128,U.e_statistics=256,U.e_profile=512,U.e_pairBit=1024,"undefined"==typeof" performance&&(window.performance="{now:function(){return+new" date}}),j.prototype="{Reset:function(){this.m_start=performance.now()},GetMilliseconds:function(){return" performance.now()-this.m_start}},y.prototype="{Clone:function(){},GetType:function(){return" this.m_type},getchildcount:function(){},testpoint:function(t,e){},raycast:function(t,e,i,n){},computeaabb:function(t,e,i){},computemass:function(t,e){},_serialize:function(t){var="" e.m_type="this.m_type,e.m_radius=this.m_radius,e},_deserialize:function(t){this.m_radius=t.m_radius}},Y.e_circle=0,Y.e_edge=1,Y.e_polygon=2,Y.e_chain=3,Y.e_typeCount=4,H.prototype={Clone:function(){var" h;return="" t.m_radius="this.m_radius,t.m_p=this.m_p.Clone(),t},GetChildCount:function(){return" 1},testpoint:function(t,e){var="" u(n,n)<="this.m_radius*this.m_radius},RayCast:function(t,e,i,n){var" s="r.Add(i.p,w(i.q,this.m_p)),o=r.Subtract(e.p1,s),a=u(o,o)-this.m_radius*this.m_radius,c=r.Subtract(e.p2,e.p1),h=u(o,c),l=u(c,c),_=h*h-l*a;if(_<0||l<Qe)return!1;var" d="-(h+Ei(_));return" 0<="d&&d<=e.maxFraction*l&&(d/=l,t.fraction=d,t.normal=r.Add(o,r.Multiply(d,c)),t.normal.Normalize(),!0)},ComputeAABB:function(t,e,i){var" n="e.p.x+(e.q.c*this.m_p.x-e.q.s*this.m_p.y),r=e.p.y+(e.q.s*this.m_p.x+e.q.c*this.m_p.y);t.lowerBound.x=n-this.m_radius,t.lowerBound.y=r-this.m_radius,t.upperBound.x=n+this.m_radius,t.upperBound.y=r+this.m_radius},ComputeMass:function(t,e){t.mass=e*Ke*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+u(this.m_p,this.m_p))},GetSupport:function(t){return" 0},getsupportvertex:function(t){return="" this.m_p},getvertexcount:function(){return="" 1},getvertex:function(e){return="" t(0="=e),this.m_p},_serialize:function(t){var" this.parent.prototype._serialize.call(this,e),e.m_p="this.m_p._serialize(),e},_deserialize:function(t){this.parent.prototype._deserialize.call(this,t),this.m_p._deserialize(t.m_p)}},H._extend(Y),q.prototype={Set:function(t,e){this.m_vertex1.Assign(t),this.m_vertex2.Assign(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1},Clone:function(){var" q;return="" t.m_vertex0="this.m_vertex0.Clone(),t.m_vertex1=this.m_vertex1.Clone(),t.m_vertex2=this.m_vertex2.Clone(),t.m_vertex3=this.m_vertex3.Clone(),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t},GetChildCount:function(){return" 1},testpoint:function(t,e){return!1},raycast:function(t,e,i,n){var="" r(l.y,-l.x);_.normalize();var="" p="d/f;if(p<0||e.maxFraction<p)return!1;var" m="r.Add(s,r.Multiply(p,a)),g=r.Subtract(h,c),v=u(g,g);if(0==v)return!1;var" y="u(r.Subtract(m,c),g)/v;return!(y<0||1<y)&&(t.fraction=p,d">0?t.normal=w(i.q,_).Negate():t.normal=w(i.q,_),!0)},ComputeAABB:function(t,e,i){var n=e.q.c*this.m_vertex1.x-e.q.s*this.m_vertex1.y+e.p.x,r=e.q.s*this.m_vertex1.x+e.q.c*this.m_vertex1.y+e.p.y,s=e.q.c*this.m_vertex2.x-e.q.s*this.m_vertex2.y+e.p.x,o=e.q.s*this.m_vertex2.x+e.q.c*this.m_vertex2.y+e.p.y,a=Ri(n,s),c=Ri(r,o),h=Pi(n,s),l=Pi(r,o);t.lowerBound.x=a-this.m_radius,t.lowerBound.y=c-this.m_radius,t.upperBound.x=h+this.m_radius,t.upperBound.y=l+this.m_radius},ComputeMass:function(t,e){t.mass=0,t.center=r.Multiply(.5,r.Add(this.m_vertex1,this.m_vertex2)),t.I=0},_serialize:function(t){var e=t||{};return this.parent.prototype._serialize.call(this,e),e.m_vertex1=this.m_vertex1._serialize(),e.m_vertex2=this.m_vertex2._serialize(),e.m_hasVertex0=this.m_hasVertex0,this.m_hasVertex0&&(e.m_vertex0=this.m_vertex0._serialize()),e.m_hasVertex3=this.m_hasVertex3,this.m_hasVertex3&&(e.m_vertex3=this.m_vertex3._serialize()),e},_deserialize:function(t){this.parent.prototype._deserialize.call(this,t),this.m_vertex1._deserialize(t.m_vertex1),this.m_vertex2._deserialize(t.m_vertex2),this.m_hasVertex0=t.m_hasVertex0,this.m_hasVertex0&&this.m_vertex0._deserialize(t.m_vertex0),this.m_hasVertex3=t.m_hasVertex3,this.m_hasVertex3&&this.m_vertex3._deserialize(t.m_vertex3)}},q._extend(Y),Z._tempEdge=new q,Z.prototype={Clear:function(){this.m_vertices=null,this.m_count=0},CreateLoop:function(e,i){t(null==this.m_vertices&&0==this.m_count),t(i>=3);for(var n=1;n<i;++n)t(v(e[n-1],e[n])>ni*ni);this.m_count=i+1,this.m_vertices=new Array(this.m_count);for(var n=0;n<i;++n)this.m_vertices[n]=e[n].clone();this.m_vertices[i]=this.m_vertices[0].clone(),this.m_prevvertex.assign(this.m_vertices[this.m_count-2]),this.m_nextvertex.assign(this.m_vertices[1]),this.m_hasprevvertex=!0,this.m_hasnextvertex=!0},createchain:function(e,i){t(null==this.m_vertices&&0==this.m_count),t(i>=2);for(var n=1;n<i;++n){var r="e[n-1],s=e[n];t(v(r,s)">ni*ni)}this.m_count=i,this.m_vertices=new Array(i);for(var n=0;n<i;++n)this.m_vertices[n]=e[n].clone();this.m_hasprevvertex=!1,this.m_hasnextvertex=!1,this.m_prevvertex.setzero(),this.m_nextvertex.setzero()},setprevvertex:function(t){this.m_prevvertex.assign(t),this.m_hasprevvertex=!0},setnextvertex:function(t){this.m_nextvertex.assign(t),this.m_hasnextvertex=!0},clone:function(){var t="new" z;t.m_count="this.m_count,t.m_vertices=new" array(this.m_count);for(var="" e="0;e<this.m_count;++e)t.m_vertices[e]=this.m_vertices[e].Clone();return" t.m_prevvertex="this.m_prevVertex.Clone(),t.m_nextVertex=this.m_nextVertex.Clone(),t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},GetChildCount:function(){return" this.m_count-1},getchildedge:function(e,i){t(0<="i&&i<this.m_count-1),e.m_type=Y.e_edge,e.m_radius=this.m_radius,e.m_vertex1=this.m_vertices[i+0],e.m_vertex2=this.m_vertices[i+1],i">0?(e.m_vertex0=this.m_vertices[i-1],e.m_hasVertex0=!0):(e.m_vertex0=this.m_prevVertex,e.m_hasVertex0=this.m_hasPrevVertex),i<this.m_count-2?(e.m_vertex3=this.m_vertices[i+2],e.m_hasvertex3=!0):(e.m_vertex3=this.m_nextvertex,e.m_hasvertex3=this.m_hasnextvertex)},testpoint:function(t,e){return!1},raycast:function(e,i,n,r){t(r<this.m_count);var s="r,o=r+1;return" o="=this.m_count&&(o=0),Z._tempEdge.m_vertex1=this.m_vertices[s].Clone(),Z._tempEdge.m_vertex2=this.m_vertices[o].Clone(),Z._tempEdge.RayCast(e,i,n,0)},ComputeAABB:function(e,i,n){t(n<this.m_count);var" r="n,s=n+1;s==this.m_count&&(s=0);var" e="t||{};this.parent.prototype._serialize.call(this,e),e.m_count=this.m_count,e.m_vertices=[];for(var" i="0;i<this.m_count;++i)e.m_vertices.push(this.m_vertices[i]._serialize());return" e.m_hasprevvertex="this.m_hasPrevVertex,this.m_hasPrevVertex&&(e.m_prevVertex=this.m_prevVertex._serialize()),e.m_hasNextVertex=this.m_hasNextVertex,this.m_hasNextVertex&&(e.m_nextVertex=this.m_nextVertex._serialize()),e},_deserialize:function(t){this.parent.prototype._deserialize.call(this,t),this.m_count=t.m_count,this.m_vertices=[];for(var" r,this.m_vertices[e]._deserialize(t.m_vertices[e]);this.m_hasprevvertex="t.m_hasPrevVertex,this.m_hasPrevVertex&&this.m_prevVertex._deserialize(t.m_prevVertex),this.m_hasNextVertex=t.m_hasNextVertex,this.m_hasNextVertex&&this.m_nextVertex._deserialize(t.m_nextVertex)}},Z._extend(Y),J.prototype={Clone:function(){var" t="new" j;t.m_count="this.m_count,t.m_centroid=this.m_centroid.Clone();for(var" t},getchildcount:function(){return="" 1},set:function(e,i){if(t(3<="i&&i<=ti),i<3)return" void="" this.setasbox(1,1);for(var="" n="Ri(i,ti),s=new" array(ti),o="0,a=0;a<n;++a){for(var" c="e[a],h=!0,l=0;l<o;++l)if(v(c,s[l])<.5*ni){h=!1;break}h&&(s[o++]=c.Clone())}if(n=o,n<3)return" t(!1),void="" this.setasbox(1,1);var="" u="0,f=s[0].x;for(a=1;a<n;++a){var" p="s[a].x;(p">f||p==f&&s[a].y<s[u].y)&&(u=a,f=p)}for(var m="new" array(ti),g="0,y=u;;){m[g]=y;var" x="0;for(l=1;l<n;++l)if(x!=y){var" t="r.Subtract(s[x],s[m[g]]),c=r.Subtract(s[l],s[m[g]]),b=_(T,c);b<0&&(x=l),0==b&&c.LengthSquared()">T.LengthSquared()&&(x=l)}else x=l;if(++g,y=x,x==u)break}if(g<3)return t(!1),void="" this.setasbox(1,1);for(this.m_count="g,a=0;a<g;++a)this.m_vertices[a]=s[m[a]].Clone();for(a=0;a<g;++a){var" c="a,A=a+1<g?a+1:0,S=r.Subtract(this.m_vertices[A],this.m_vertices[C]);t(S.LengthSquared()">Qe*Qe),this.m_normals[a]=d(S,1).Clone(),this.m_normals[a].Normalize()}this.m_centroid=J.ComputeCentroid(this.m_vertices,g)},SetAsBox:function(t,e,i,n){if(this.m_count=4,this.m_vertices[0]=new r(-t,-e),this.m_vertices[1]=new r(t,-e),this.m_vertices[2]=new r(t,e),this.m_vertices[3]=new r(-t,e),this.m_normals[0]=new r(0,-1),this.m_normals[1]=new r(1,0),this.m_normals[2]=new r(0,1),this.m_normals[3]=new r(-1,0),i){this.m_centroid.Assign(i);var s=new h;s.p=i,s.q.Set(n);for(var o=0;o<this.m_count;++o)this.m_vertices[o].assign(r(s,this.m_vertices[o])),this.m_normals[o].assign(w(s.q,this.m_normals[o]))}},testpoint:function(t,e){for(var i="I(t.q,r.Subtract(e,t.p)),n=0;n<this.m_count;++n){var" s="u(this.m_normals[n],r.Subtract(i,this.m_vertices[n]));if(s">0)return!1}return!0},RayCast:function(e,i,n,s){for(var o=I(n.q,r.Subtract(i.p1,n.p)),a=I(n.q,r.Subtract(i.p2,n.p)),c=r.Subtract(a,o),h=0,l=i.maxFraction,_=-1,d=0;d<this.m_count;++d){var f="u(this.m_normals[d],r.Subtract(this.m_vertices[d],o)),p=u(this.m_normals[d],c);if(0==p){if(f<0)return!1}else" p<0&&f<h*p?(h="f/p,_=d):p">0&&f<l*p&&(l=f p);if(l<h)return!1}return="" t(0<="h&&h<=i.maxFraction),_">=0&&(e.fraction=h,e.normal=w(n.q,this.m_normals[_]),!0)},ComputeAABB:function(t,e,i){for(var n=e.q.c*this.m_vertices[0].x-e.q.s*this.m_vertices[0].y+e.p.x,r=e.q.s*this.m_vertices[0].x+e.q.c*this.m_vertices[0].y+e.p.y,s=n,o=r,a=1;a<this.m_count;++a){var c="e.q.c*this.m_vertices[a].x-e.q.s*this.m_vertices[a].y+e.p.x,h=e.q.s*this.m_vertices[a].x+e.q.c*this.m_vertices[a].y+e.p.y;n=Ri(n,c),r=Ri(r,h),s=Pi(s,c),o=Pi(o,h)}t.lowerBound.x=n-this.m_radius,t.lowerBound.y=r-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=o+this.m_radius},ComputeMass:function(e,i){t(this.m_count">=3);for(var n=new r(0,0),s=0,o=0,a=new r(0,0),c=0;c<this.m_count;++c)a.add(this.m_vertices[c]);a.multiply(1 this.m_count);for(var="" h="1/3,c=0;c<this.m_count;++c){var" l="r.Subtract(this.m_vertices[c],a),d=c+1<this.m_count?r.Subtract(this.m_vertices[c+1],a):r.Subtract(this.m_vertices[0],a),f=_(l,d),p=.5*f;s+=p,n.Add(r.Multiply(p*h,r.Add(l,d)));var" m="l.x,g=l.y,v=d.x,y=d.y,x=m*m+v*m+v*v,T=g*g+y*g+y*y;o+=.25*h*f*(x+T)}e.mass=i*s,t(s">Qe),n.Multiply(1/s),e.center=r.Add(n,a),e.I=i*o,e.I+=e.mass*(u(e.center,e.center)-u(n,n))},GetVertexCount:function(){return this.m_count},GetVertex:function(e){return t(0<=e&&e<this.m_count),this.m_vertices[e]},validate:function(){for(var t="0;t<this.m_count;++t)for(var" e="t,i=t<this.m_count-1?e+1:0,n=this.m_vertices[e],s=r.Subtract(this.m_vertices[i],n),o=0;o<this.m_count;++o)if(o!=e&&o!=i){var" a="r.Subtract(this.m_vertices[o],n),c=_(s,a);if(c<0)return!1}return!0},_serialize:function(t){var" i="0;i<this.m_count;++i)e.m_vertices.push(this.m_vertices[i]._serialize()),e.m_normals.push(this.m_normals[i]._serialize());return" e},_deserialize:function(t){this.parent.prototype._deserialize.call(this,t),this.m_count="t.m_count,this.m_centroid._deserialize(t.m_centroid),this.m_vertices=[],this.m_normals=[];for(var" r,this.m_vertices[e]._deserialize(t.m_vertices[e]),this.m_normals[e]="new" r,this.m_normals[e]._deserialize(t.m_normals[e])}},j.computecentroid="function(e,i){t(i">=3);for(var n=new r,s=0,o=new r(0,0),a=1/3,c=0;c<i;++c){var h="o,l=e[c],u=c+1<i?e[c+1]:e[0],d=r.Subtract(l,h),f=r.Subtract(u,h),p=_(d,f),m=.5*p;s+=m,n.Add(r.Multiply(m,r.Multiply(a,r.Add(r.Add(h,l),u))))}return" t(s="">Qe),n.Multiply(1/s),n},J._extend(Y),$.prototype={CreateProxy:function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},DestroyProxy:function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},MoveProxy:function(t,e,i){var n=this.m_tree.MoveProxy(t,e,i);n&&this.BufferMove(t)},TouchProxy:function(t){this.BufferMove(t)},GetFatAABB:function(t){return this.m_tree.GetFatAABB(t)},GetUserData:function(t){return this.m_tree.GetUserData(t)},TestOverlap:function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return Rt(i,n)},GetProxyCount:function(){return this.m_proxyCount},UpdatePairs:function(t){this.m_pairCount=0,this.m_pairBuffer.length=0;for(var e=0;e<this.m_movecount;++e)if(this.m_queryproxyid=this.m_movebuffer[e],this.m_queryproxyid!=$.e_nullproxy){var i="this.m_tree.GetFatAABB(this.m_queryProxyId);this.m_tree.Query(this,i)}this.m_moveCount=0,this.m_pairBuffer.sort(K);for(var" e="0;e<this.m_pairCount;){var" n="this.m_pairBuffer[e],r=this.m_tree.GetUserData(n.proxyIdA),s=this.m_tree.GetUserData(n.proxyIdB);for(t.AddPair(r,s),++e;e<this.m_pairCount;){var" o="this.m_pairBuffer[e];if(o.proxyIdA!=n.proxyIdA||o.proxyIdB!=n.proxyIdB)break;++e}}},Query:function(t,e){this.m_tree.Query(t,e)},RayCast:function(t,e){this.m_tree.RayCast(t,e)},GetTreeHeight:function(){return" this.m_tree.getheight()},gettreebalance:function(){return="" this.m_tree.getmaxbalance()},gettreequality:function(){return="" this.m_tree.getarearatio();="" },shiftorigin:function(t){this.m_tree.shiftorigin(t)},buffermove:function(t){this.m_movebuffer[this.m_movecount]="t,++this.m_moveCount},UnBufferMove:function(t){for(var" t="=this.m_queryProxyId||(this.m_pairBuffer[this.m_pairCount]=new" q,this.m_pairbuffer[this.m_paircount].proxyida="Ri(t,this.m_queryProxyId),this.m_pairBuffer[this.m_pairCount].proxyIdB=Pi(t,this.m_queryProxyId),++this.m_pairCount,!0)}},$.e_nullProxy=-1,tt.prototype={Assign:function(t){this.m_vertices=t.m_vertices,this.m_count=t.m_count,this.m_radius=t.m_radius},Set:function(e,i){switch(e.GetType()){case" y.e_circle:var="" y.e_polygon:var="" r="e;this.m_vertices=r.m_vertices,this.m_count=r.m_count,this.m_radius=r.m_radius;break;case" y.e_chain:var="" s="e;t(0<=i&&i<s.m_count),this.m_vertices=[s.m_vertices[i]],i+1<s.m_count?this.m_vertices[1]=s.m_vertices[i+1]:this.m_vertices[1]=s.m_vertices[0],this.m_count=2,this.m_radius=s.m_radius;break;case" y.e_edge:var="">n&&(i=r,n=s)}return i},GetSupportVertex:function(t,e){return this.m_vertices[this.GetSupport(t,e)]},GetVertexCount:function(){return this.m_count},GetVertex:function(e){return t(0<=e&&e<this.m_count),this.m_vertices[e]}},rt.prototype={assign:function(t){this.wa.x=t.wa.x,this.wa.y=t.wa.y,this.wb.x=t.wb.x,this.wb.y=t.wb.y,this.w.x=t.w.x,this.w.y=t.w.y,this.a=t.a,this.indexa=t.indexa,this.indexb=t.indexb}},st.prototype={readcache:function(e,i,n,r,s){t(e.count<=3),this.m_count=e.count;for(var o="this.m_v,a=0;a<this.m_count;++a){var" c="o[a];c.indexA=e.indexA[a],c.indexB=e.indexB[a];var" h="i.GetVertex(c.indexA),l=r.GetVertex(c.indexB);c.wA.x=n.q.c*h.x-n.q.s*h.y+n.p.x,c.wA.y=n.q.s*h.x+n.q.c*h.y+n.p.y,c.wB.x=s.q.c*l.x-s.q.s*l.y+s.p.x,c.wB.y=s.q.s*l.x+s.q.c*l.y+s.p.y,c.w.x=c.wB.x-c.wA.x,c.w.y=c.wB.y-c.wA.y,c.a=0}if(this.m_count">1){var u=e.metric,_=this.GetMetric();(_<.5*u||2*u<_||_<qe)&&(this.m_count=0)}if(0==this.m_count){var c="o[0];c.indexA=0,c.indexB=0;var" h="i.GetVertex(0),l=r.GetVertex(0);c.wA.x=n.q.c*h.x-n.q.s*h.y+n.p.x,c.wA.y=n.q.s*h.x+n.q.c*h.y+n.p.y,c.wB.x=s.q.c*l.x-s.q.s*l.y+s.p.x,c.wB.y=s.q.s*l.x+s.q.c*l.y+s.p.y,c.w.x=c.wB.x-c.wA.x,c.w.y=c.wB.y-c.wA.y,c.a=1,this.m_count=1}},WriteCache:function(t){t.metric=this.GetMetric(),t.count=this.m_count;for(var" e="this.m_v,i=0;i<this.m_count;++i)t.indexA[i]=e[i].indexA,t.indexB[i]=e[i].indexB},GetSearchDirection:function(e){switch(this.m_count){case" 1:e.x="-this.m_v[0].w.x,e.y=-this.m_v[0].w.y;break;case" 2:var="" i="this.m_v[1].w.x-this.m_v[0].w.x,n=this.m_v[1].w.y-this.m_v[0].w.y,r=i*-this.m_v[0].w.y-n*-this.m_v[0].w.x;r">0?(e.x=-1*n,e.y=1*i):(e.x=1*n,e.y=-1*i);break;default:t(!1),e.x=e.y=0}},GetClosestPoint:function(e){switch(this.m_count){case 1:e.x=this.m_v[0].w.x,e.y=this.m_v[0].w.y;break;case 2:e.x=this.m_v[0].a*this.m_v[0].w.x+this.m_v[1].a*this.m_v[1].w.x,e.y=this.m_v[0].a*this.m_v[0].w.y+this.m_v[1].a*this.m_v[1].w.y;break;case 3:e.x=e.y=0;break;default:t(!1),e.x=e.y=0}},GetWitnessPoints:function(e,i){switch(this.m_count){case 1:e.x=this.m_v[0].wA.x,e.y=this.m_v[0].wA.y,i.x=this.m_v[0].wB.x,i.y=this.m_v[0].wB.y;break;case 2:e.x=this.m_v[0].a*this.m_v[0].wA.x+this.m_v[1].a*this.m_v[1].wA.x,e.y=this.m_v[0].a*this.m_v[0].wA.y+this.m_v[1].a*this.m_v[1].wA.y,i.x=this.m_v[0].a*this.m_v[0].wB.x+this.m_v[1].a*this.m_v[1].wB.x,i.y=this.m_v[0].a*this.m_v[0].wB.y+this.m_v[1].a*this.m_v[1].wB.y;break;case 3:e.x=this.m_v[0].a*this.m_v[0].wA.x+this.m_v[1].a*this.m_v[1].wA.x+this.m_v[2].a*this.m_v[2].wA.x,e.y=this.m_v[0].a*this.m_v[0].wA.y+this.m_v[1].a*this.m_v[1].wA.y+this.m_v[2].a*this.m_v[2].wA.y,i.x=e.x,i.y=e.y;break;default:t(!1)}},GetMetric:function(){switch(this.m_count){case 1:return 0;case 2:return g(this.m_v[0].w,this.m_v[1].w);case 3:return(this.m_v[1].w.x-this.m_v[0].w.x)*(this.m_v[2].w.y-this.m_v[0].w.y)-(this.m_v[1].w.y-this.m_v[0].w.y)*(this.m_v[2].w.x-this.m_v[0].w.x);default:return t(!1),0}},Solve2:function(){var t=this.m_v[0].w,e=this.m_v[1].w,i=e.x-t.x,n=e.y-t.y,r=-(t.x*i+t.y*n);if(r<=0)return this.m_v[0].a="1,void(this.m_count=1);var" s="e.x*i+e.y*n;if(s<=0)return" this.m_v[1].a="1,this.m_count=1,void" this.m_v[0].assign(this.m_v[1]);var="" o="1/(s+r);this.m_v[0].a=s*o,this.m_v[1].a=r*o,this.m_count=2},Solve3:function(){var" t="this.m_v[0].w,e=this.m_v[1].w,i=this.m_v[2].w,n=e.x-t.x,r=e.y-t.y,s=t.x*n+t.y*r,o=e.x*n+e.y*r,a=o,c=-s,h=i.x-t.x,l=i.y-t.y,u=t.x*h+t.y*l,_=i.x*h+i.y*l,d=_,f=-u,p=i.x-e.x,m=i.y-e.y,g=e.x*p+e.y*m,v=i.x*p+i.y*m,y=v,x=-g,T=n*l-r*h,b=T*(e.x*i.y-e.y*i.x),C=T*(i.x*t.y-i.y*t.x),A=T*(t.x*e.y-t.y*e.x);if(c<=0&&f<=0)return">0&&c>0&&A<=0){var s="1/(a+c);return" this.m_v[0].a="a*S,this.m_v[1].a=c*S,void(this.m_count=2)}if(d">0&&f>0&&C<=0){var e="1/(d+f);return" this.m_v[0].a="d*E,this.m_v[2].a=f*E,this.m_count=2,void" this.m_v[1].assign(this.m_v[2])}if(a<="0&&x<=0)return" this.m_v[1].a="1,this.m_count=1,void" this.m_v[0].assign(this.m_v[1]);if(d<="0&&y<=0)return" this.m_v[2].a="1,this.m_count=1,void" this.m_v[0].assign(this.m_v[2]);if(y="">0&&x>0&&b<=0){var w="1/(y+x);return" this.m_v[1].a="y*w,this.m_v[2].a=x*w,this.m_count=2,void" this.m_v[0].assign(this.m_v[2])}var="" i="1/(b+C+A);this.m_v[0].a=b*I,this.m_v[1].a=C*I,this.m_v[2].a=A*I,this.m_count=3}};var" oi="new" st,bi="new" r,di="new" r;ot.b2_gjkcalls="0,ot.b2_gjkIters=0,ot.b2_gjkMaxIters=0;at.prototype={indexA:0,indexB:0,typeA:0,typeB:0,Reset:function(){this.indexA=this.indexB=this.typeA=this.typeB=0},Get:function(){return" this.indexa|this.indexb<<8|this.typea<<16|this.typeb<<24},assign:function(t){this.indexa="t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB}},at.e_vertex=0,at.e_face=1,ct.prototype={Clone:function(){var" t="new" ct;return="" t.localpoint.x="this.localPoint.x,t.localPoint.y=this.localPoint.y,t.normalImpulse=this.normalImpulse,t.tangentImpulse=this.tangentImpulse,t.id.Assign(this.id),t}},ht.prototype={Clone:function(){var" ht;t.pointcount="this.pointCount,t.type=this.type,t.localPoint.x=this.localPoint.x,t.localPoint.y=this.localPoint.y,t.localNormal.x=this.localNormal.x,t.localNormal.y=this.localNormal.y;for(var" e="0;e<this.pointCount;++e)t.points[e]=this.points[e].Clone();return" t},assign:function(t){this.pointcount="t.pointCount,this.type=t.type,this.localPoint.x=t.localPoint.x,this.localPoint.y=t.localPoint.y,this.localNormal.x=t.localNormal.x,this.localNormal.y=t.localNormal.y;for(var" ht.e_circles:this.normal.x="1,this.normal.y=0;var" o="e.q.c*t.localPoint.x-e.q.s*t.localPoint.y+e.p.x,a=e.q.s*t.localPoint.x+e.q.c*t.localPoint.y+e.p.y,c=n.q.c*t.points[0].localPoint.x-n.q.s*t.points[0].localPoint.y+n.p.x,h=n.q.s*t.points[0].localPoint.x+n.q.c*t.points[0].localPoint.y+n.p.y,l=o-c,u=a-h;l*l+u*u">Qe*Qe&&(this.normal.x=c-o,this.normal.y=h-a,this.normal.Normalize());var _=o+i*this.normal.x,d=a+i*this.normal.y,f=c-s*this.normal.x,p=h-s*this.normal.y;this.points[0]=new r(.5*(_+f),.5*(d+p)),this.separations[0]=(f-_)*this.normal.x+(p-d)*this.normal.y;break;case ht.e_faceA:this.normal.x=e.q.c*t.localNormal.x-e.q.s*t.localNormal.y,this.normal.y=e.q.s*t.localNormal.x+e.q.c*t.localNormal.y;for(var m=e.q.c*t.localPoint.x-e.q.s*t.localPoint.y+e.p.x,g=e.q.s*t.localPoint.x+e.q.c*t.localPoint.y+e.p.y,v=0;v<t.pointcount;++v){var y="n.q.c*t.points[v].localPoint.x-n.q.s*t.points[v].localPoint.y+n.p.x,x=n.q.s*t.points[v].localPoint.x+n.q.c*t.points[v].localPoint.y+n.p.y,T=(y-m)*this.normal.x+(x-g)*this.normal.y,_=y+(i-T)*this.normal.x,d=x+(i-T)*this.normal.y,f=y-s*this.normal.x,p=x-s*this.normal.y;this.points[v]=new" r(.5*(_+f),.5*(d+p)),this.separations[v]="(f-_)*this.normal.x+(p-d)*this.normal.y}break;case" ht.e_faceb:this.normal.x="n.q.c*t.localNormal.x-n.q.s*t.localNormal.y,this.normal.y=n.q.s*t.localNormal.x+n.q.c*t.localNormal.y;for(var" m="n.q.c*t.localPoint.x-n.q.s*t.localPoint.y+n.p.x,g=n.q.s*t.localPoint.x+n.q.c*t.localPoint.y+n.p.y,v=0;v<t.pointCount;++v){var" t="new" pt;return="" t.lowerbound.x="this.lowerBound.x,t.lowerBound.y=this.lowerBound.y,t.upperBound.x=this.upperBound.x,t.upperBound.y=this.upperBound.y,t},IsValid:function(){return" this.upperbound.x-this.lowerbound.x="">=0&&this.upperBound.y-this.lowerBound.y>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},GetCenter:function(){return new r(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},GetExtents:function(){return new r(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},GetPerimeter:function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))},Combine:function(t,e){e?(this.lowerBound.x=Ri(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Ri(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Pi(t.upperBound.x,e.upperBound.x),this.upperBound.y=Pi(t.upperBound.y,e.upperBound.y)):(this.lowerBound.x=Ri(this.lowerBound.x,t.lowerBound.x),this.lowerBound.y=Ri(this.lowerBound.y,t.lowerBound.y),this.upperBound.x=Pi(this.upperBound.x,t.upperBound.x),this.upperBound.y=Pi(this.upperBound.y,t.upperBound.y))},Contains:function(t){return this.lowerBound.x<=t.lowerbound.x&&this.lowerbound.y<=t.lowerbound.y&&t.upperbound.x<=this.upperbound.x&&t.upperbound.y<=this.upperbound.y},raycast:function(t,e){for(var i="-Je,n=Je,s=e.p1,o=r.Subtract(e.p2,e.p1),a=D(o),c=new" r,h="0;h<2;++h)if(a.get_i(h)<Qe){if(s.get_i(h)<this.lowerBound.get_i(h)||this.upperBound.get_i(h)<s.get_i(h))return!1}else{var" l="1/o.get_i(h),u=(this.lowerBound.get_i(h)-s.get_i(h))*l,_=(this.upperBound.get_i(h)-s.get_i(h))*l,d=-1;if(u">_){var f=_;_=u,u=f,d=1}if(u>i&&(c.x=c.y=0,c.set_i(h,d),i=u),n=Ri(n,_),i>n)return!1}return!(i<0||e.maxfraction<i)&&(t.fraction=i,t.normal.x=c.x,t.normal.y=c.y,!0)}},xt._localtangent=new r,xt._local_incidentedges="[new" _t,new="" _t],bt.e_unknown="0,bt.e_edgeA=1,bt.e_edgeB=2,St._temp_edge=new" r,st._temp_edge0="new" r,st._temp_edge2="new" r,st.prototype="{Collide:function(t,e,i,n,r){this.m_xf.Assign(B(i,r)),this.m_centroidB.x=this.m_xf.q.c*n.m_centroid.x-this.m_xf.q.s*n.m_centroid.y+this.m_xf.p.x,this.m_centroidB.y=this.m_xf.q.s*n.m_centroid.x+this.m_xf.q.c*n.m_centroid.y+this.m_xf.p.y,this.m_v0.x=e.m_vertex0.x,this.m_v0.y=e.m_vertex0.y,this.m_v1.x=e.m_vertex1.x,this.m_v1.y=e.m_vertex1.y,this.m_v2.x=e.m_vertex2.x,this.m_v2.y=e.m_vertex2.y,this.m_v3.x=e.m_vertex3.x,this.m_v3.y=e.m_vertex3.y;var" s="e.m_hasVertex0,o=e.m_hasVertex3;St._temp_edge.x=this.m_v2.x-this.m_v1.x,St._temp_edge.y=this.m_v2.y-this.m_v1.y,St._temp_edge.Normalize(),this.m_normal1.x=St._temp_edge.y,this.m_normal1.y=-St._temp_edge.x;var" a="this.m_normal1.x*(this.m_centroidB.x-this.m_v1.x)+this.m_normal1.y*(this.m_centroidB.y-this.m_v1.y),c=0,h=0,l=!1,u=!1;s&&(St._temp_edge0.x=this.m_v1.x-this.m_v0.x,St._temp_edge0.y=this.m_v1.y-this.m_v0.y,St._temp_edge0.Normalize(),this.m_normal0.x=St._temp_edge0.y,this.m_normal0.y=-St._temp_edge0.x,l=St._temp_edge0.x*St._temp_edge.y-St._temp_edge0.y*St._temp_edge.x">=0,c=this.m_normal0.x*(this.m_centroidB.x-this.m_v0.x)+this.m_normal0.y*(this.m_centroidB.y-this.m_v0.y)),o&&(St._temp_edge2.x=this.m_v3.x-this.m_v2.x,St._temp_edge2.y=this.m_v3.y-this.m_v2.y,St._temp_edge2.Normalize(),this.m_normal2.x=St._temp_edge2.y,this.m_normal2.y=-St._temp_edge2.x,u=St._temp_edge.x*St._temp_edge2.y-St._temp_edge.y*St._temp_edge2.x>0,h=this.m_normal2.x*(this.m_centroidB.x-this.m_v2.x)+this.m_normal2.y*(this.m_centroidB.y-this.m_v2.y)),s&&o?l&&u?(this.m_front=c>=0||a>=0||h>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal0.x,this.m_lowerLimit.y=this.m_normal0.y,this.m_upperLimit.x=this.m_normal2.x,this.m_upperLimit.y=this.m_normal2.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y)):l?(this.m_front=c>=0||a>=0&&h>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal0.x,this.m_lowerLimit.y=this.m_normal0.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal2.x,this.m_lowerLimit.y=-this.m_normal2.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y)):u?(this.m_front=h>=0||c>=0&&a>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=this.m_normal2.x,this.m_upperLimit.y=this.m_normal2.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=-this.m_normal0.x,this.m_upperLimit.y=-this.m_normal0.y)):(this.m_front=c>=0&&a>=0&&h>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal2.x,this.m_lowerLimit.y=-this.m_normal2.y,this.m_upperLimit.x=-this.m_normal0.x,this.m_upperLimit.y=-this.m_normal0.y)):s?l?(this.m_front=c>=0||a>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal0.x,this.m_lowerLimit.y=this.m_normal0.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y)):(this.m_front=c>=0&&a>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=-this.m_normal0.x,this.m_upperLimit.y=-this.m_normal0.y)):o?u?(this.m_front=a>=0||h>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=this.m_normal2.x,this.m_upperLimit.y=this.m_normal2.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y)):(this.m_front=a>=0&&h>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal2.x,this.m_lowerLimit.y=-this.m_normal2.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y)):(this.m_front=a>=0,this.m_front?(this.m_normal.x=this.m_normal1.x,this.m_normal.y=this.m_normal1.y,this.m_lowerLimit.x=-this.m_normal1.x,this.m_lowerLimit.y=-this.m_normal1.y,this.m_upperLimit.x=-this.m_normal1.x,this.m_upperLimit.y=-this.m_normal1.y):(this.m_normal.x=-this.m_normal1.x,this.m_normal.y=-this.m_normal1.y,this.m_lowerLimit.x=this.m_normal1.x,this.m_lowerLimit.y=this.m_normal1.y,this.m_upperLimit.x=this.m_normal1.x,this.m_upperLimit.y=this.m_normal1.y)),this.m_polygonB.count=n.m_count;for(var _=0;_<n.m_count;++_)this.m_polygonb.vertices[_]=r(this.m_xf,n.m_vertices[_]),this.m_polygonb.normals[_]=w(this.m_xf.q,n.m_normals[_]);this.m_radius=2*si,t.pointcount=0;var d="this.ComputeEdgeSeparation();if(d.type!=bt.e_unknown&&!(d.separation">this.m_radius)){var f=this.ComputePolygonSeparation();if(!(f.type!=bt.e_unknown&&f.separation>this.m_radius)){var p=.98,m=.001,g=new bt;g=f.type==bt.e_unknown?d:f.separation>p*d.separation+m?f:d;var v=new Array(2),y=new At;if(g.type==bt.e_edgeA){t.type=ht.e_faceA;for(var x=0,T=this.m_normal.x*this.m_polygonB.normals[0].x+this.m_normal.y*this.m_polygonB.normals[0].y,_=1;_<this.m_polygonb.count;++_){var b="this.m_normal.x*this.m_polygonB.normals[_].x+this.m_normal.y*this.m_polygonB.normals[_].y;b<T&&(T=b,x=_)}var" c="x,A=C+1<this.m_polygonB.count?C+1:0;v[0]=new" _t,v[0].v.x="this.m_polygonB.vertices[C].x,v[0].v.y=this.m_polygonB.vertices[C].y,v[0].id.indexA=0,v[0].id.indexB=C,v[0].id.typeA=at.e_face,v[0].id.typeB=at.e_vertex,v[1]=new" _t,v[1].v.x="this.m_polygonB.vertices[A].x,v[1].v.y=this.m_polygonB.vertices[A].y,v[1].id.indexA=0,v[1].id.indexB=A,v[1].id.typeA=at.e_face,v[1].id.typeB=at.e_vertex,this.m_front?(y.i1=0,y.i2=1,y.v1.x=this.m_v1.x,y.v1.y=this.m_v1.y,y.v2.x=this.m_v2.x,y.v2.y=this.m_v2.y,y.normal.x=this.m_normal1.x,y.normal.y=this.m_normal1.y):(y.i1=1,y.i2=0,y.v1.x=this.m_v2.x,y.v1.y=this.m_v2.y,y.v2.x=this.m_v1.x,y.v2.y=this.m_v1.y,y.normal.x=-this.m_normal1.x,y.normal.y=-this.m_normal1.y)}else" t.type="ht.e_faceB,v[0]=new" _t,v[0].v="this.m_v1,v[0].id.indexA=0,v[0].id.indexB=g.index,v[0].id.typeA=at.e_vertex,v[0].id.typeB=at.e_face,v[1]=new" _t,v[1].v="this.m_v2,v[1].id.indexA=0,v[1].id.indexB=g.index,v[1].id.typeA=at.e_vertex,v[1].id.typeB=at.e_face,y.i1=g.index,y.i2=y.i1+1<this.m_polygonB.count?y.i1+1:0,y.v1.x=this.m_polygonB.vertices[y.i1].x,y.v1.y=this.m_polygonB.vertices[y.i1].y,y.v2.x=this.m_polygonB.vertices[y.i2].x,y.v2.y=this.m_polygonB.vertices[y.i2].y,y.normal.x=this.m_polygonB.normals[y.i1].x,y.normal.y=this.m_polygonB.normals[y.i1].y;y.sideNormal1.x=y.normal.y,y.sideNormal1.y=-y.normal.x,y.sideNormal2.x=-y.sideNormal1.x,y.sideNormal2.y=-y.sideNormal1.y,y.sideOffset1=y.sideNormal1.x*y.v1.x+y.sideNormal1.y*y.v1.y,y.sideOffset2=y.sideNormal2.x*y.v2.x+y.sideNormal2.y*y.v2.y;var" s,e="new" array(2),i="new" array(2);if(s="wt(E,v,y.sideNormal1.x,y.sideNormal1.y,y.sideOffset1,y.i1),!(S<$e||(S=wt(I,E,y.sideNormal2.x,y.sideNormal2.y,y.sideOffset2,y.i2),S<$e))){g.type==bt.e_edgeA?(t.localNormal.x=y.normal.x,t.localNormal.y=y.normal.y,t.localPoint.x=y.v1.x,t.localPoint.y=y.v1.y):(t.localNormal.x=n.m_normals[y.i1].x,t.localNormal.y=n.m_normals[y.i1].y,t.localPoint.x=n.m_vertices[y.i1].x,t.localPoint.y=n.m_vertices[y.i1].y);for(var" o="0,_=0;_<$e;++_){var" d="y.normal.x*(I[_].v.x-y.v1.x)+y.normal.y*(I[_].v.y-y.v1.y);if(D<=this.m_radius){var" m="t.points[O]=new" ct;g.type="=bt.e_edgeA?(M.localPoint.Assign(P(this.m_xf,I[_].v)),M.id.Assign(I[_].id)):(M.localPoint.x=I[_].v.x,M.localPoint.y=I[_].v.y,M.id.typeA=I[_].id.typeB,M.id.typeB=I[_].id.typeA,M.id.indexA=I[_].id.indexB,M.id.indexB=I[_].id.indexA),++O}}t.pointCount=O}}}},ComputeEdgeSeparation:function(){var" t="new" bt;t.type="bt.e_edgeA,t.index=this.m_front?0:1,t.separation=Number.MAX_VALUE;for(var" e="0;e<this.m_polygonB.count;++e){var" i="this.m_normal.x*(this.m_polygonB.vertices[e].x-this.m_v1.x)+this.m_normal.y*(this.m_polygonB.vertices[e].y-this.m_v1.y);i<t.separation&&(t.separation=i)}return" t},computepolygonseparation:function(){var="" r="-this.m_polygonB.normals[n].x,s=-this.m_polygonB.normals[n].y,o=r*(this.m_polygonB.vertices[n].x-this.m_v1.x)+s*(this.m_polygonB.vertices[n].y-this.m_v1.y),a=r*(this.m_polygonB.vertices[n].x-this.m_v2.x)+s*(this.m_polygonB.vertices[n].y-this.m_v2.y),c=Ri(o,a);if(c">this.m_radius)return t.type=bt.e_edgeB,t.index=n,t.separation=c,t;if(r*e+s*i>=0){if((r-this.m_upperLimit.x)*this.m_normal.x+(s-this.m_upperLimit.y)*this.m_normal.y<-ri)continue}else if((r-this.m_lowerlimit.x)*this.m_normal.x+(s-this.m_lowerlimit.y)*this.m_normal.y<-ri)continue;c="">t.separation&&(t.type=bt.e_edgeB,t.index=n,t.separation=c)}return t}},St.e_isolated=0,St.e_concave=1,St.e_convex=2,Et.collider=new St,It.input=new it,It.cache=new et,It.output=new nt;var Mi=-1;Pt.prototype={IsLeaf:function(){return this.child1==Mi}},Ot.aabbExtensionFattener=new r(ei,ei),Ot.prototype={CreateProxy:function(t,e){var i=this.AllocateNode();return this.m_nodes[i].aabb.lowerBound.Assign(r.Subtract(t.lowerBound,Ot.aabbExtensionFattener)),this.m_nodes[i].aabb.upperBound.Assign(r.Add(t.upperBound,Ot.aabbExtensionFattener)),this.m_nodes[i].userData=e,this.m_nodes[i].height=0,this.InsertLeaf(i),i},DestroyProxy:function(e){t(0<=e&&e<this.m_nodecapacity),t(this.m_nodes[e].isleaf()),this.removeleaf(e),this.freenode(e)},moveproxy:function(e,i,n){if(t(0<=e&&e<this.m_nodecapacity),t(this.m_nodes[e].isleaf()),this.m_nodes[e].aabb.contains(i))return!1;this.removeleaf(e),this.m_nodes[e].aabb.assign(i),this.m_nodes[e].aabb.lowerbound.subtract(ot.aabbextensionfattener),this.m_nodes[e].aabb.upperbound.add(ot.aabbextensionfattener);var s="r.Multiply(ii,n);return" s.x<0?this.m_nodes[e].aabb.lowerbound.x+="s.x:this.m_nodes[e].aabb.upperBound.x+=s.x,s.y<0?this.m_nodes[e].aabb.lowerBound.y+=s.y:this.m_nodes[e].aabb.upperBound.y+=s.y,this.InsertLeaf(e),!0},GetUserData:function(e){return" t(0<="e&&e<this.m_nodeCapacity),this.m_nodes[e].userData},GetFatAABB:function(e){return" i="[];for(i.push(this.m_root);i.length">0;){var n=i.pop();if(n!=Mi){var r=this.m_nodes[n];if(Rt(r.aabb,e))if(r.IsLeaf()){var s=t.QueryCallback(n);if(0==s)return}else i.push(r.child1),i.push(r.child2)}}},RayCast:function(e,i){var n=i.p1,s=i.p2,o=r.Subtract(s,n);t(o.LengthSquared()>0),o.Normalize();var a=f(1,o),c=D(a),h=i.maxFraction,l=new pt,_=r.Add(n,r.Multiply(h,r.Subtract(s,n)));l.lowerBound.Assign(L(n,_)),l.upperBound.Assign(N(n,_));var d=[];for(d.push(this.m_root);d.length>0;){var p=d.pop();if(p!=Mi){var m=this.m_nodes[p];if(0!=Rt(m.aabb,l)){var g=m.aabb.GetCenter(),v=m.aabb.GetExtents(),y=Ii(u(a,r.Subtract(n,g)))-u(c,v);if(!(y>0))if(m.IsLeaf()){var x=new dt;x.p1.Assign(i.p1),x.p2.Assign(i.p2),x.maxFraction=h;var T=e.RayCastCallback(x,p);if(0==T)return;if(T>0){h=T;var _=r.Add(n,r.Multiply(h,r.Subtract(s,n)));l.lowerBound.Assign(L(n,_)),l.upperBound.Assign(N(n,_))}}else d.push(m.child1),d.push(m.child2)}}}},Validate:function(){this.ValidateStructure(this.m_root),this.ValidateMetrics(this.m_root);for(var e=0,i=this.m_freeList;i!=Mi;)t(0<=i&&i<this.m_nodecapacity),i=this.m_nodes[i].parent,++e;t(this.getheight()==this.computeheight()),t(this.m_nodecount+e==this.m_nodecapacity)},getheight:function(){return this.m_root="=Mi?0:this.m_nodes[this.m_root].height},GetMaxBalance:function(){for(var" e="0,i=0;i<this.m_nodeCapacity;++i){var" n="this.m_nodes[i];if(!(n.height<=1)){t(0==n.IsLeaf());var" r="n.child1,s=n.child2,o=Ii(this.m_nodes[s].height-this.m_nodes[r].height);e=Pi(e,o)}}return" e},getarearatio:function(){if(this.m_root="=Mi)return" 0;for(var="" t="this.m_nodes[this.m_root],e=t.aabb.GetPerimeter(),i=0,n=0;n<this.m_nodeCapacity;++n){var" i="" e},rebuildbottomup:function(){for(var="" array(this.m_nodecount),e="0,i=0;i<this.m_nodeCapacity;++i)this.m_nodes[i].height<0||(this.m_nodes[i].IsLeaf()?(this.m_nodes[i].parent=Mi,t[e]=i,++e):this.FreeNode(i));for(;e">1;){var n=Je,r=-1,s=-1;for(i=0;i<e;++i)for(var o="this.m_nodes[t[i]].aabb,a=i+1;a<e;++a){var" c="this.m_nodes[t[a]].aabb,h=new" pt;h.combine(o,c);var="" l="h.GetPerimeter();l<n&&(r=i,s=a,n=l)}var" u="t[r],_=t[s],d=this.m_nodes[u],f=this.m_nodes[_],p=this.AllocateNode(),m=this.m_nodes[p];m.child1=u,m.child2=_,m.height=1+Pi(d.height,f.height),m.aabb.Combine(d.aabb,f.aabb),m.parent=Mi,d.parent=p,f.parent=p,t[s]=t[e-1],t[r]=p,--e}this.m_root=t[0],this.Validate()},ShiftOrigin:function(t){for(var" e="0;e<this.m_nodeCapacity;++e)this.m_nodes[e].aabb.lowerBound.Subtract(t),this.m_nodes[e].aabb.upperBound.Subtract(t)},AllocateNode:function(){if(this.m_freeList==Mi){t(this.m_nodeCount==this.m_nodeCapacity);var" array(this.m_nodecapacity-this.m_nodecount));for(var="" i="this.m_nodeCount;i<this.m_nodeCapacity-1;++i)this.m_nodes[i]=new" pt,this.m_nodes[i].parent="i+1,this.m_nodes[i].height=-1;this.m_nodes[this.m_nodeCapacity-1]=new" pt,this.m_nodes[this.m_nodecapacity-1].parent="Mi,this.m_nodes[this.m_nodeCapacity-1].height=-1,this.m_freeList=this.m_nodeCount}var" n="this.m_freeList;return" this.m_freelist="this.m_nodes[n].parent,this.m_nodes[n].parent=Mi,this.m_nodes[n].child1=Mi,this.m_nodes[n].child2=Mi,this.m_nodes[n].height=0,this.m_nodes[n].userData=null,++this.m_nodeCount,n},FreeNode:function(e){t(0<=e&&e<this.m_nodeCapacity),t(0<this.m_nodeCount),this.m_nodes[e].parent=this.m_freeList,this.m_nodes[e].height=-1,this.m_freeList=e,--this.m_nodeCount},InsertLeaf:function(e){if(++this.m_insertionCount,this.m_root==Mi)return" this.m_root="e,void(this.m_nodes[this.m_root].parent=Mi);for(var" r="this.m_nodes[n].child1,s=this.m_nodes[n].child2,o=this.m_nodes[n].aabb.GetPerimeter(),a=new" pt;a.combine(this.m_nodes[n].aabb,i);var="" c,h,l="a.GetPerimeter(),u=2*l,_=2*(l-o);if(this.m_nodes[r].IsLeaf())h=new" pt,h.combine(i,this.m_nodes[r].aabb),c="h.GetPerimeter()+_;else{h=new" pt,h.combine(i,this.m_nodes[r].aabb);var="" d="this.m_nodes[r].aabb.GetPerimeter(),f=h.GetPerimeter();c=f-d+_}var" p;if(this.m_nodes[s].isleaf())h="new" pt,h.combine(i,this.m_nodes[s].aabb),p="h.GetPerimeter()+_;else{h=new" pt,h.combine(i,this.m_nodes[s].aabb);var="" m="n,g=this.m_nodes[m].parent,v=this.AllocateNode();for(this.m_nodes[v].parent=g,this.m_nodes[v].userData=null,this.m_nodes[v].aabb.Combine(i,this.m_nodes[m].aabb),this.m_nodes[v].height=this.m_nodes[m].height+1,g!=Mi?(this.m_nodes[g].child1==m?this.m_nodes[g].child1=v:this.m_nodes[g].child2=v,this.m_nodes[v].child1=m,this.m_nodes[v].child2=e,this.m_nodes[m].parent=v,this.m_nodes[e].parent=v):(this.m_nodes[v].child1=m,this.m_nodes[v].child2=e,this.m_nodes[m].parent=v,this.m_nodes[e].parent=v,this.m_root=v),n=this.m_nodes[e].parent;n!=Mi;){n=this.Balance(n);var" void(this.m_root="Mi);var" e,i="this.m_nodes[t].parent,n=this.m_nodes[i].parent;if(e=this.m_nodes[i].child1==t?this.m_nodes[i].child2:this.m_nodes[i].child1,n!=Mi){this.m_nodes[n].child1==i?this.m_nodes[n].child1=e:this.m_nodes[n].child2=e,this.m_nodes[e].parent=n,this.FreeNode(i);for(var" s="this.m_nodes[r].child1,o=this.m_nodes[r].child2;this.m_nodes[r].aabb.Combine(this.m_nodes[s].aabb,this.m_nodes[o].aabb),this.m_nodes[r].height=1+Pi(this.m_nodes[s].height,this.m_nodes[o].height),r=this.m_nodes[r].parent}}else" e;var="">1){var c=o.child1,h=o.child2,l=this.m_nodes[c],u=this.m_nodes[h];return t(0<=c&&c<this.m_nodecapacity),t(0<=h&&h<this.m_nodecapacity),o.child1=e,o.parent=i.parent,i.parent=r,o.parent!=mi?this.m_nodes[o.parent].child1==e?this.m_nodes[o.parent].child1=r:(t(this.m_nodes[o.parent].child2==e),this.m_nodes[o.parent].child2=r):this.m_root=r,l.height>u.height?(o.child2=c,i.child2=h,u.parent=e,i.aabb.Combine(s.aabb,u.aabb),o.aabb.Combine(i.aabb,l.aabb),i.height=1+Pi(s.height,u.height),o.height=1+Pi(i.height,l.height)):(o.child2=h,i.child2=c,l.parent=e,i.aabb.Combine(s.aabb,l.aabb),o.aabb.Combine(i.aabb,u.aabb),i.height=1+Pi(s.height,l.height),o.height=1+Pi(i.height,u.height)),r}if(a<-1){var _="s.child1,d=s.child2,f=this.m_nodes[_],p=this.m_nodes[d];return" t(0<="_&&_<this.m_nodeCapacity),t(0<=d&&d<this.m_nodeCapacity),s.child1=e,s.parent=i.parent,i.parent=n,s.parent!=Mi?this.m_nodes[s.parent].child1==e?this.m_nodes[s.parent].child1=n:(t(this.m_nodes[s.parent].child2==e),this.m_nodes[s.parent].child2=n):this.m_root=n,f.height">p.height?(s.child2=_,i.child1=d,p.parent=e,i.aabb.Combine(o.aabb,p.aabb),s.aabb.Combine(i.aabb,f.aabb),i.height=1+Pi(o.height,p.height),s.height=1+Pi(i.height,f.height)):(s.child2=d,i.child1=_,f.parent=e,i.aabb.Combine(o.aabb,f.aabb),s.aabb.Combine(i.aabb,p.aabb),i.height=1+Pi(o.height,f.height),s.height=1+Pi(i.height,p.height)),n}return e},ComputeHeight:function(e){"undefined"==typeof e&&(e=this.m_root),t(0<=e&&e<this.m_nodecapacity);var i="this.m_nodes[e];if(i.IsLeaf())return" 0;var="" n="this.ComputeHeight(i.child1),r=this.ComputeHeight(i.child2);return" 1+pi(n,r)},validatestructure:function(e){if(e!="Mi){e==this.m_root&&t(this.m_nodes[e].parent==Mi);var" t(n="=Mi),t(r==Mi),void" t(0="=i.height);t(0<=n&&n<this.m_nodeCapacity),t(0<=r&&r<this.m_nodeCapacity),t(this.m_nodes[n].parent==e),t(this.m_nodes[r].parent==e),this.ValidateStructure(n),this.ValidateStructure(r)}},ValidateMetrics:function(e){if(e!=Mi){var" o,a="this.m_nodes[n].height,c=this.m_nodes[s].height;o=1+Pi(a,c),t(i.height==o);var" h="new" pt;h.combine(this.m_nodes[n].aabb,this.m_nodes[s].aabb),t(r.equals(h.lowerbound,i.aabb.lowerbound)),t(r.equals(h.upperbound,i.aabb.upperbound)),this.validatemetrics(n),this.validatemetrics(s)}}},dt.e_unknown="0,Dt.e_failed=1,Dt.e_overlapped=2,Dt.e_touching=3,Dt.e_separated=4;var" li="new" h,ni="new" h;mt.prototype="{Initialize:function(e,i,n,r,s,o){this.m_proxyA=i,this.m_proxyB=r;var" a="e.count;if(t(0<a&&a<3),this.m_sweepA=n,this.m_sweepB=s,this.m_sweepA.GetTransform(Li,o),this.m_sweepB.GetTransform(Ni,o),1==a){this.m_type=Mt.e_points;var" c="this.m_proxyA.GetVertex(e.indexA[0]),h=this.m_proxyB.GetVertex(e.indexB[0]),l=Li.q.c*c.x-Li.q.s*c.y+Li.p.x,u=Li.q.s*c.x+Li.q.c*c.y+Li.p.y,_=Ni.q.c*h.x-Ni.q.s*h.y+Ni.p.x,d=Ni.q.s*h.x+Ni.q.c*h.y+Ni.p.y;this.m_axis.x=_-l,this.m_axis.y=d-u;var" f="this.m_axis.Normalize();return" f}if(e.indexa[0]="=e.indexA[1]){this.m_type=Mt.e_faceB;var" p="r.GetVertex(e.indexB[0]),m=r.GetVertex(e.indexB[1]);this.m_axis.x=1*(m.y-p.y),this.m_axis.y=-1*(m.x-p.x),this.m_axis.Normalize();var" g="Ni.q.c*this.m_axis.x-Ni.q.s*this.m_axis.y,v=Ni.q.s*this.m_axis.x+Ni.q.c*this.m_axis.y;this.m_localPoint.x=.5*(p.x+m.x),this.m_localPoint.y=.5*(p.y+m.y);var" _="Ni.q.c*this.m_localPoint.x-Ni.q.s*this.m_localPoint.y+Ni.p.x,d=Ni.q.s*this.m_localPoint.x+Ni.q.c*this.m_localPoint.y+Ni.p.y,c=i.GetVertex(e.indexA[0]),l=Li.q.c*c.x-Li.q.s*c.y+Li.p.x,u=Li.q.s*c.x+Li.q.c*c.y+Li.p.y,f=(l-_)*g+(u-d)*v;" return="" f<0&&(this.m_axis.x="-this.m_axis.x,this.m_axis.y=-this.m_axis.y,f=-f),f}this.m_type=Mt.e_faceA;var" y="this.m_proxyA.GetVertex(e.indexA[0]),x=this.m_proxyA.GetVertex(e.indexA[1]);this.m_axis.x=1*(x.y-y.y),this.m_axis.y=-1*(x.x-y.x),this.m_axis.Normalize();var" l="Li.q.c*this.m_localPoint.x-Li.q.s*this.m_localPoint.y+Li.p.x,u=Li.q.s*this.m_localPoint.x+Li.q.c*this.m_localPoint.y+Li.p.y,h=this.m_proxyB.GetVertex(e.indexB[0]),_=Ni.q.c*h.x-Ni.q.s*h.y+Ni.p.x,d=Ni.q.s*h.x+Ni.q.c*h.y+Ni.p.y,f=(_-l)*g+(d-u)*v;return" mt.e_points:var="" mt.e_facea:var="" d="Li.q.c*this.m_axis.x-Li.q.s*this.m_axis.y,f=Li.q.s*this.m_axis.x+Li.q.c*this.m_axis.y,h=Li.q.c*this.m_localPoint.x-Li.q.s*this.m_localPoint.y+Li.p.x,l=Li.q.s*this.m_localPoint.x+Li.q.c*this.m_localPoint.y+Li.p.y,s=Ni.q.c*-d+Ni.q.s*-f,o=-Ni.q.s*-d+Ni.q.c*-f;e[0]=-1,e[1]=this.m_proxyB.GetSupport(s,o);var" mt.e_faceb:var="" t(!1),e[0]="-1,e[1]=-1,0}},Evaluate:function(e,i,n){switch(this.m_sweepA.GetTransform(Li,n),this.m_sweepB.GetTransform(Ni,n),this.m_type){case" r="this.m_proxyA.GetVertex(e),s=this.m_proxyB.GetVertex(i),o=Li.q.c*r.x-Li.q.s*r.y+Li.p.x,a=Li.q.s*r.x+Li.q.c*r.y+Li.p.y,c=Ni.q.c*s.x-Ni.q.s*s.y+Ni.p.x,h=Ni.q.s*s.x+Ni.q.c*s.y+Ni.p.y,l=(c-o)*this.m_axis.x+(h-a)*this.m_axis.y;return" l;case="" u="Li.q.c*this.m_axis.x-Li.q.s*this.m_axis.y,_=Li.q.s*this.m_axis.x+Li.q.c*this.m_axis.y,o=Li.q.c*this.m_localPoint.x-Li.q.s*this.m_localPoint.y+Li.p.x,a=Li.q.s*this.m_localPoint.x+Li.q.c*this.m_localPoint.y+Li.p.y,s=this.m_proxyB.GetVertex(i),c=Ni.q.c*s.x-Ni.q.s*s.y+Ni.p.x,h=Ni.q.s*s.x+Ni.q.c*s.y+Ni.p.y,l=(c-o)*u+(h-a)*_;return" l;default:return="" t(!1),0}}},mt.e_points="0,Mt.e_faceA=1,Mt.e_faceB=2;var" fi="Ze.create("toi","solveTOI");Lt._temp_sweepA=new" l,lt._temp_sweepb="new" l,lt.b2_toitime="0,Lt.b2_toiMaxTime=0,Lt.b2_toiCalls=0,Lt.b2_toiIters=0,Lt.b2_toiMaxIters=0,Lt.b2_toiRootIters=0,Lt.b2_toiMaxRootIters=0,Nt.prototype={_deserialize:function(t){this.type=t.type,this.position._deserialize(t.position),this.angle=t.angle,this.linearVelocity._deserialize(t.linearVelocity),this.angularVelocity=t.angularVelocity,this.linearDamping=t.linearDamping,this.angularDamping=t.angularDamping,this.allowSleep=t.allowSleep,this.awake=t.awake,this.fixedRotation=t.fixedRotation,this.bullet=t.bullet,this.active=t.active,this.gravityScale=t.gravityScale}},Ft.b2_staticBody=0,Ft.b2_kinematicBody=1,Ft.b2_dynamicBody=2,Ft.e_islandFlag=1,Ft.e_awakeFlag=2,Ft.e_autoSleepFlag=4,Ft.e_bulletFlag=8,Ft.e_fixedRotationFlag=16,Ft.e_activeFlag=32,Ft.e_toiFlag=64,Ft.m_local_oldCenter=new" r,ft.m_local_xf1="new" h,ft.prototype="{CreateFixture:function(e,i){if("undefined"!=typeof" i){var="" zt;return="" n.shape="e,n.density=i,this.CreateFixture(n)}if(t(0==this.m_world.IsLocked()),1==this.m_world.IsLocked())return" null;var="" gt;if(r.create(this,e),this.m_flags&ft.e_activeflag){var="" s="this.m_world.m_contactManager.m_broadPhase;r.CreateProxies(s,this.m_xf)}return" r.m_next="this.m_fixtureList,this.m_fixtureList=r,++this.m_fixtureCount,r.m_body=this,r.m_density">0&&this.ResetMassData(),this.m_world.m_flags|=Kt.e_newFixture,r},DestroyFixture:function(e){if(t(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()){t(e.m_body==this),t(this.m_fixtureCount>0);for(var i=this.m_fixtureList,n=!1;null!=i;){if(i==e){this.m_fixtureList=i=e.m_next,n=!0;break}i=i.m_next}t(n);for(var r=this.m_contactList;r;){var s=r.contact;r=r.next;var o=s.GetFixtureA(),a=s.GetFixtureB();e!=o&&e!=a||this.m_world.m_contactManager.Destroy(s)}if(this.m_flags&Ft.e_activeFlag){var c=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxies(c)}e.Destroy(),e.m_body=null,e.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},SetTransform:function(e,i){if(t(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()){this.m_xf.q.Set(i),this.m_xf.p.Assign(e),this.m_sweep.c.Assign(R(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.a=i,this.m_sweep.c0.Assign(this.m_sweep.c),this.m_sweep.a0=i;for(var n=this.m_world.m_contactManager.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.Synchronize(n,this.m_xf,this.m_xf)}},GetTransform:function(){return this.m_xf},GetPosition:function(){return this.m_xf.p},GetAngle:function(){return this.m_sweep.a},GetWorldCenter:function(){return this.m_sweep.c},GetLocalCenter:function(){return this.m_sweep.localCenter},SetLinearVelocity:function(t){this.m_type!=Ft.b2_staticBody&&(u(t,t)>0&&this.SetAwake(!0),this.m_linearVelocity=t)},GetLinearVelocity:function(){return this.m_linearVelocity},SetAngularVelocity:function(t){this.m_type!=Ft.b2_staticBody&&(t*t>0&&this.SetAwake(!0),this.m_angularVelocity=t)},GetAngularVelocity:function(){return this.m_angularVelocity},ApplyForce:function(t,e,i){this.m_type==Ft.b2_dynamicBody&&(i&&0==(this.m_flags&Ft.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&Ft.e_awakeFlag&&(this.m_force.Add(t),this.m_torque+=_(r.Subtract(e,this.m_sweep.c),t)))},ApplyForceToCenter:function(t,e){this.m_type==Ft.b2_dynamicBody&&(e&&0==(this.m_flags&Ft.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&Ft.e_awakeFlag&&this.m_force.Add(t))},ApplyTorque:function(t,e){this.m_type==Ft.b2_dynamicBody&&(e&&0==(this.m_flags&Ft.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&Ft.e_awakeFlag&&(this.m_torque+=t))},ApplyLinearImpulse:function(t,e,i){this.m_type==Ft.b2_dynamicBody&&(i&&0==(this.m_flags&Ft.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&Ft.e_awakeFlag&&(this.m_linearVelocity.Add(r.Multiply(this.m_invMass,t)),this.m_angularVelocity+=this.m_invI*_(r.Subtract(e,this.m_sweep.c),t)))},ApplyAngularImpulse:function(t,e){this.m_type==Ft.b2_dynamicBody&&(e&&0==(this.m_flags&Ft.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&Ft.e_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},GetMass:function(){return this.m_mass},GetInertia:function(){return this.m_I+this.m_mass*u(this.m_sweep.localCenter,this.m_sweep.localCenter)},GetMassData:function(t){t.mass=this.m_mass,t.I=this.m_I+this.m_mass*u(this.m_sweep.localCenter,this.m_sweep.localCenter),t.center=this.m_sweep.localCenter},SetMassData:function(e){t(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==Ft.b2_dynamicBody&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invmass=1 this.m_mass,e.i="">0&&0==(this.m_flags&Ft.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*u(e.center,e.center),t(this.m_I>0),this.m_invI=1/this.m_I),Ft.m_local_oldCenter.Assign(this.m_sweep.c),this.m_sweep.localCenter.Assign(e.center),this.m_sweep.c0.Assign(R(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.Assign(this.m_sweep.c0),this.m_linearVelocity.Add(f(this.m_angularVelocity,r.Subtract(this.m_sweep.c,Ft.m_local_oldCenter))))},ResetMassData:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type==Ft.b2_staticBody||this.m_type==Ft.b2_kinematicBody)return this.m_sweep.c0.Assign(this.m_xf.p),this.m_sweep.c.Assign(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);t(this.m_type==Ft.b2_dynamicBody);for(var e=new r(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var n=new X;i.GetMassData(n),this.m_mass+=n.mass,e.Add(r.Multiply(n.mass,n.center)),this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.Multiply(this.m_invMass)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&Ft.e_fixedRotationFlag)?(this.m_I-=this.m_mass*u(e,e),t(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),Ft.m_local_oldCenter.Assign(this.m_sweep.c),this.m_sweep.localCenter.Assign(e),this.m_sweep.c0.Assign(R(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.Assign(this.m_sweep.c0),this.m_linearVelocity.Add(f(this.m_angularVelocity,r.Subtract(this.m_sweep.c,Ft.m_local_oldCenter)))},GetWorldPoint:function(t){return R(this.m_xf,t)},GetWorldVector:function(t){return w(this.m_xf.q,t)},GetLocalPoint:function(t){return P(this.m_xf,t)},GetLocalVector:function(t){return I(this.m_xf.q,t)},GetLinearVelocityFromWorldPoint:function(t){return r.Add(this.m_linearVelocity,f(this.m_angularVelocity,r.Subtract(t,this.m_sweep.c)))},GetLinearVelocityFromLocalPoint:function(t){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t))},GetLinearDamping:function(){return this.m_linearDamping},SetLinearDamping:function(t){this.m_linearDamping=t},GetAngularDamping:function(){return this.m_angularDamping},SetAngularDamping:function(t){this.m_angularDamping=t},GetGravityScale:function(){return this.m_gravityScale},SetGravityScale:function(t){this.m_gravityScale=t},SetType:function(e){if(t(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type!=e){this.m_type=e,this.ResetMassData(),this.m_type==Ft.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Assign(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;){var n=i;i=i.next,this.m_world.m_contactManager.Destroy(n.contact)}this.m_contactList=null;for(var r=this.m_world.m_contactManager.m_broadPhase,s=this.m_fixtureList;s;s=s.m_next)for(var o=s.m_proxyCount,a=0;a<o;++a)r.touchproxy(s.m_proxies[a].proxyid)}},gettype:function(){return this.m_type},setbullet:function(t){t?this.m_flags|="Ft.e_bulletFlag:this.m_flags&=~Ft.e_bulletFlag},IsBullet:function(){return(this.m_flags&Ft.e_bulletFlag)==Ft.e_bulletFlag},SetSleepingAllowed:function(t){t?this.m_flags|=Ft.e_autoSleepFlag:(this.m_flags&=~Ft.e_autoSleepFlag,this.SetAwake(!0))},IsSleepingAllowed:function(){return(this.m_flags&Ft.e_autoSleepFlag)==Ft.e_autoSleepFlag},SetAwake:function(t){t?0==(this.m_flags&Ft.e_awakeFlag)&&(this.m_flags|=Ft.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~Ft.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},IsAwake:function(){return(this.m_flags&Ft.e_awakeFlag)==Ft.e_awakeFlag},SetActive:function(e){if(t(0==this.m_world.IsLocked()),e!=this.IsActive())if(e){this.m_flags|=Ft.e_activeFlag;for(var" i="this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.CreateProxies(i,this.m_xf)}else{this.m_flags&=~Ft.e_activeFlag;for(var" r="this.m_contactList;r;){var" s="r;r=r.next,this.m_world.m_contactManager.Destroy(s.contact)}this.m_contactList=null}},IsActive:function(){return(this.m_flags&Ft.e_activeFlag)==Ft.e_activeFlag},SetFixedRotation:function(t){var" e="(this.m_flags&Ft.e_fixedRotationFlag)==Ft.e_fixedRotationFlag;e!=t&&(t?this.m_flags|=Ft.e_fixedRotationFlag:this.m_flags&=~Ft.e_fixedRotationFlag,this.m_angularVelocity=0,this.ResetMassData())},IsFixedRotation:function(){return(this.m_flags&Ft.e_fixedRotationFlag)==Ft.e_fixedRotationFlag},GetFixtureList:function(){return" this.m_fixturelist},getjointlist:function(){return="" this.m_jointlist},getcontactlist:function(){return="" this.m_contactlist},getnext:function(){return="" this.m_next},getuserdata:function(){return="" this.m_userdata},setuserdata:function(t){this.m_userdata="t},GetWorld:function(){return" this.m_world},synchronizefixtures:function(){ft.m_local_xf1.q.set(this.m_sweep.a0),ft.m_local_xf1.p.assign(r.subtract(this.m_sweep.c0,w(ft.m_local_xf1.q,this.m_sweep.localcenter)));for(var="" t="this.m_world.m_contactManager.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(t,Ft.m_local_xf1,this.m_xf)},SynchronizeTransform:function(){this.m_xf.q.Set(this.m_sweep.a),this.m_xf.p.Assign(r.Subtract(this.m_sweep.c,w(this.m_xf.q,this.m_sweep.localCenter)))},ShouldCollide:function(t){if(this.m_type!=Ft.b2_dynamicBody&&t.m_type!=Ft.b2_dynamicBody)return!1;for(var" e.fixtures="null,e.type=this.m_type,e.position=this.GetPosition()._serialize(),e.angle=this.GetAngle(),e.linearVelocity=this.GetLinearVelocity()._serialize(),e.angularVelocity=this.GetAngularVelocity(),e.linearDamping=this.GetLinearDamping(),e.angularDamping=this.GetAngularDamping(),e.allowSleep=this.IsSleepingAllowed(),e.awake=this.IsAwake(),e.fixedRotation=this.IsFixedRotation(),e.bullet=this.IsBullet(),e.active=this.IsActive(),e.gravityScale=this.GetGravityScale(),e}},kt.prototype={Clone:function(){var" kt;return="" t.categorybits="this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},Assign:function(t){this.categoryBits=t.categoryBits,this.maskBits=t.maskBits,this.groupIndex=t.groupIndex},_serialize:function(t){var" e.categorybits="this.categoryBits,e.maskBits=this.maskBits,e.groupIndex=this.groupIndex,e},_deserialize:function(t){this.categoryBits=t.categoryBits,this.maskBits=t.maskBits,this.groupIndex=t.groupIndex}},zt.prototype={_deserialize:function(t){this.friction=t.friction,this.restitution=t.restitution,this.density=t.density,this.isSensor=t.isSensor,this.filter._deserialize(t.filter)}},Gt.prototype={GetType:function(){return" this.m_shape.gettype()},getshape:function(){return="" this.m_shape},setsensor:function(t){t!="this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)},IsSensor:function(){return" this.m_issensor},setfilterdata:function(t){this.m_filter="t,this.Refilter()},GetFilterData:function(){return" this.m_filter},refilter:function(){if(null!="this.m_body){for(var" this.m_body},getnext:function(){return="" this.m_shape.testpoint(this.m_body.gettransform(),t)},raycast:function(t,e,i){return="" this.m_shape.raycast(t,e,this.m_body.gettransform(),i)},getmassdata:function(t){this.m_shape.computemass(t,this.m_density)},setdensity:function(e){t(n(e)&&e="">=0),this.m_density=e},GetDensity:function(){return this.m_density},GetFriction:function(){return this.m_friction},SetFriction:function(t){this.m_friction=t},GetRestitution:function(){return this.m_restitution},SetRestitution:function(t){this.m_restitution=t},GetAABB:function(e){return t(0<=e&&e<this.m_proxycount),this.m_proxies[e].aabb},create:function(t,e){this.m_userdata=e.userdata,this.m_friction=e.friction,this.m_restitution=e.restitution,this.m_body=t,this.m_next=null,this.m_filter.assign(e.filter),this.m_issensor=e.issensor,this.m_shape=e.shape.clone();var i="this.m_shape.GetChildCount();this.m_proxies=new" array(i);for(var="" n="0;n<i;++n)this.m_proxies[n]=new" vt,this.m_proxies[n].fixture="null,this.m_proxies[n].proxyId=$.e_nullProxy;this.m_proxyCount=0,this.m_density=e.density},Destroy:function(){t(0==this.m_proxyCount),this.m_proxies=null,this.m_shape=null},CreateProxies:function(e,i){t(0==this.m_proxyCount),this.m_proxyCount=this.m_shape.GetChildCount();for(var" r="this.m_proxies[n];this.m_shape.ComputeAABB(r.aabb,i,n),r.proxyId=e.CreateProxy(r.aabb,r),r.fixture=this,r.childIndex=n}},DestroyProxies:function(t){for(var" e="0;e<this.m_proxyCount;++e){var" s="this.m_proxies[n],o=new" pt,a="new" pt;this.m_shape.computeaabb(o,e,s.childindex),this.m_shape.computeaabb(a,i,s.childindex),s.aabb.combine(o,a);var="" c="r.Subtract(i.p,e.p);t.MoveProxy(s.proxyId,s.aabb,c)}},_serialize:function(t){var" e.shape="null,e.friction=this.m_friction,e.restitution=this.m_restitution,e.density=this.m_density,e.isSensor=this.m_isSensor,e.filter=this.m_filter._serialize(),e}},Wt.prototype={SayGoodbyeJoint:function(t){},SayGoodbyeFixture:function(t){}},Ut.prototype={ShouldCollide:function(t,e){var" i.groupindex="">0;var r=0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits);return r}},Xt.prototype={BeginContact:function(t){},EndContact:function(t){},PreSolve:function(t,e){},PostSolve:function(t,e){}},Yt.prototype={ReportFixture:function(t){return!1}},Ht.prototype={ReportFixture:function(t,e,i,n){}};var ki=Ze.create("step"),zi=Ze.create("collide","step"),Vi=Ze.create("solve","step"),Gi=Ze.create("solveTOI","step"),Wi=Ze.create("broadphase","step");$t.prototype={QueryCallback:function(t){var e=this.broadPhase.GetUserData(t);return this.callback.ReportFixture(e.fixture)}},te.prototype={RayCastCallback:function(t,e){var i=this.broadPhase.GetUserData(e),n=i,s=n.fixture,o=n.childIndex,a=new ft,c=s.RayCast(a,t,o);if(c){var h=a.fraction,l=r.Add(r.Multiply(1-h,t.p1),r.Multiply(h,t.p2));return this.callback.ReportFixture(s,l,a.normal,h)}return t.maxFraction}},Kt.m_local_sweep_backupA=new l,Kt.m_local_sweep_backupB=new l,Kt.m_local_sweep_backupC=new l,Kt.prototype={Destroy:function(){for(var t=this.m_bodyList;t;){for(var e=t.m_next,i=t.m_fixtureList;i;){var n=i.m_next;i.m_proxyCount=0,i.Destroy(),i=n}t=e}},SetDestructionListener:function(t){this.m_destructionListener=t},SetContactFilter:function(t){this.m_contactManager.m_contactFilter=t},SetContactListener:function(t){this.m_contactManager.m_contactListener=t},SetDebugDraw:function(t){this.g_debugDraw=t},CreateBody:function(e){if(t(0==this.IsLocked()),this.IsLocked())return null;var i=new Ft(e,this);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i},DestroyBody:function(e){if(t(this.m_bodyCount>0),t(0==this.IsLocked()),!this.IsLocked()){for(var i=e.m_jointList;i;){var n=i;i=i.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(n.joint),this.DestroyJoint(n.joint),e.m_jointList=i}e.m_jointList=null;for(var r=e.m_contactList;r;){var s=r;r=r.next,this.m_contactManager.Destroy(s.contact)}e.m_contactList=null;for(var o=e.m_fixtureList;o;){var a=o;o=o.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(a),a.DestroyProxies(this.m_contactManager.m_broadPhase),a.Destroy(),e.m_fixtureList=o,e.m_fixtureCount-=1}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_bodyList&&(this.m_bodyList=e.m_next),e.m_destroyed=!0,--this.m_bodyCount}},CreateJoint:function(e){if(t(0==this.IsLocked()),this.IsLocked())return null;var i=Ae.Create(e);i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_edgeA.joint=i,i.m_edgeA.other=i.m_bodyB,i.m_edgeA.prev=null,i.m_edgeA.next=i.m_bodyA.m_jointList,i.m_bodyA.m_jointList&&(i.m_bodyA.m_jointList.prev=i.m_edgeA),i.m_bodyA.m_jointList=i.m_edgeA,i.m_edgeB.joint=i,i.m_edgeB.other=i.m_bodyA,i.m_edgeB.prev=null,i.m_edgeB.next=i.m_bodyB.m_jointList,i.m_bodyB.m_jointList&&(i.m_bodyB.m_jointList.prev=i.m_edgeB),i.m_bodyB.m_jointList=i.m_edgeB;var n=e.bodyA,r=e.bodyB;if(0==e.collideConnected)for(var s=r.GetContactList();s;)s.other==n&&s.contact.FlagForFiltering(),s=s.next;return i},DestroyJoint:function(e){if(t(0==this.IsLocked()),!this.IsLocked()){var i=e.m_collideConnected;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_jointList&&(this.m_jointList=e.m_next);var n=e.m_bodyA,r=e.m_bodyB;if(n.SetAwake(!0),r.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA==n.m_jointList&&(n.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB==r.m_jointList&&(r.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,Ae.Destroy(e),t(this.m_jointCount>0),--this.m_jointCount,0==i)for(var s=r.GetContactList();s;)s.other==n&&s.contact.FlagForFiltering(),s=s.next}},Step:function(t,e,i){ki.start(),this.m_flags&Kt.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~Kt.e_newFixture),this.m_flags|=Kt.e_locked,this.p_step.dt=t,this.p_step.velocityIterations=e,this.p_step.positionIterations=i,t>0?this.p_step.inv_dt=1/t:this.p_step.inv_dt=0,this.p_step.dtRatio=this.m_inv_dt0*t,this.p_step.warmStarting=this.m_warmStarting,zi.start(),this.m_contactManager.Collide(),zi.stop(),this.m_stepComplete&&this.p_step.dt>0&&(Vi.start(),this.Solve(this.p_step),Vi.stop()),this.m_continuousPhysics&&this.p_step.dt>0&&(Gi.start(),this.SolveTOI(this.p_step),Gi.stop()),this.p_step.dt>0&&(this.m_inv_dt0=this.p_step.inv_dt),this.m_flags&Kt.e_clearForces&&this.ClearForces(),this.m_flags&=~Kt.e_locked,ki.stop()},ClearForces:function(){for(var t=this.m_bodyList;t;t=t.GetNext())t.m_force.x=t.m_force.y=0,t.m_torque=0},DrawDebugData:function(){if(null!=this.g_debugDraw){this.g_debugDraw.ClearDraw();var t=this.g_debugDraw.GetFlags();if(t&U.e_shapeBit)for(var e=this.m_bodyList;e;e=e.GetNext())for(var i=e.GetTransform(),n=e.GetFixtureList();n;n=n.GetNext())0==e.IsActive()?this.DrawShape(n,i,new W(.5,.5,.3)):e.GetType()==Ft.b2_staticBody?this.DrawShape(n,i,new W(.5,.9,.5)):e.GetType()==Ft.b2_kinematicBody?this.DrawShape(n,i,new W(.5,.5,.9)):0==e.IsAwake()?this.DrawShape(n,i,new W(.6,.6,.6)):this.DrawShape(n,i,new W(.9,.7,.7));if(t&U.e_jointBit)for(var s=this.m_jointList;s;s=s.GetNext())this.DrawJoint(s);if(t&U.e_pairBit)for(var o=new W(.3,.9,.9),a=this.m_contactManager.m_contactList;a;a=a.GetNext()){var c=a.GetFixtureA(),h=a.GetFixtureB(),l=c.GetAABB(a.GetChildIndexA()).GetCenter(),u=h.GetAABB(a.GetChildIndexB()).GetCenter();this.g_debugDraw.DrawSegment(l,u,o)}if(t&U.e_aabbBit)for(var o=new W(.9,.3,.9),_=new W(.3,.3,.9),d=this.m_contactManager.m_broadPhase,e=this.m_bodyList;e;e=e.GetNext())if(0!=e.IsActive())for(var n=e.GetFixtureList();n;n=n.GetNext())for(var f=0;f<n.m_proxycount;++f){var p="n.m_proxies[f],m=d.GetFatAABB(p.proxyId),g=[];g[0]=new" r(m.lowerbound.x,m.lowerbound.y),g[1]="new" r(m.upperbound.x,m.lowerbound.y),g[2]="new" r(m.upperbound.x,m.upperbound.y),g[3]="new" r(m.lowerbound.x,m.upperbound.y),this.g_debugdraw.drawpolygon(g,4,o);var="" v="new" pt;n.getshape().computeaabb(v,e.gettransform(),0);var="" g="[];g[0]=new" r(v.lowerbound.x,v.lowerbound.y),g[1]="new" r(v.upperbound.x,v.lowerbound.y),g[2]="new" r(v.upperbound.x,v.upperbound.y),g[3]="new" r(v.lowerbound.x,v.upperbound.y),this.g_debugdraw.drawpolygon(g,4,_)}if(t&u.e_centerofmassbit)for(var="" e="this.m_bodyList;e;e=e.GetNext()){var" i="e.GetTransform().Clone();i.p=e.GetWorldCenter(),this.g_debugDraw.DrawTransform(i)}}},QueryAABB:function(t,e){var" $t;i.broadphase="this.m_contactManager.m_broadPhase,i.callback=t,this.m_contactManager.m_broadPhase.Query(i,e)},RayCast:function(t,e,i){var" n="new" te;n.broadphase="this.m_contactManager.m_broadPhase,n.callback=t;var" r="new" dt;r.maxfraction="1,r.p1=e,r.p2=i,this.m_contactManager.m_broadPhase.RayCast(n,r)},GetBodyList:function(){return" this.m_bodylist},getjointlist:function(){return="" this.m_jointlist},getcontactlist:function(){return="" this.m_contactmanager.m_contactlist},setallowsleeping:function(t){if(t!="this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var" this.m_allowsleep},setwarmstarting:function(t){this.m_warmstarting="t},GetWarmStarting:function(){return" this.m_warmstarting},setcontinuousphysics:function(t){this.m_continuousphysics="t},GetContinuousPhysics:function(){return" this.m_continuousphysics},setsubstepping:function(t){this.m_substepping="t},GetSubStepping:function(){return" this.m_substepping},getproxycount:function(){return="" this.m_contactmanager.m_broadphase.getproxycount()},getbodycount:function(){return="" this.m_bodycount},getjointcount:function(){return="" this.m_jointcount},getcontactcount:function(){return="" this.m_contactmanager.m_contactcount},gettreeheight:function(){return="" this.m_contactmanager.m_broadphase.gettreeheight()},gettreebalance:function(){return="" this.m_contactmanager.m_broadphase.gettreebalance()},gettreequality:function(){return="" this.m_contactmanager.m_broadphase.gettreequality()},setgravity:function(t){this.m_gravity="t},GetGravity:function(){return" this.m_gravity},islocked:function(){return(this.m_flags&kt.e_locked)="=Kt.e_locked},SetAutoClearForces:function(t){t?this.m_flags|=Kt.e_clearForces:this.m_flags&=~Kt.e_clearForces},GetAutoClearForces:function(){return(this.m_flags&Kt.e_clearForces)==Kt.e_clearForces},ShiftOrigin:function(e){if(t(0==(this.m_flags&Kt.e_locked)),(this.m_flags&Kt.e_locked)!=Kt.e_locked){for(var" this.m_contactmanager},solve:function(e){this.p_island.initialize(this.m_bodycount,this.m_contactmanager.m_contactcount,this.m_jointcount,this.m_contactmanager.m_contactlistener);for(var="" s="this.m_bodyCount,o=new" array(s),a="this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&Ft.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=Ft.b2_staticBody){this.p_island.Clear();var" c="0;for(o[c++]=a,a.m_flags|=Ft.e_islandFlag;c">0;){var i=o[--c];if(t(1==i.IsActive()),this.p_island.AddBody(i),i.SetAwake(!0),i.GetType()!=Ft.b2_staticBody){for(var h=i.m_contactList;h;h=h.next){var l=h.contact;if(!(l.m_flags&se.e_islandFlag)&&0!=l.IsEnabled()&&0!=l.IsTouching()){var u=l.m_fixtureA.m_isSensor,_=l.m_fixtureB.m_isSensor;if(!u&&!_){this.p_island.AddContact(l),l.m_flags|=se.e_islandFlag;var d=h.other;d.m_flags&Ft.e_islandFlag||(t(c<s),o[c++]=d,d.m_flags|=ft.e_islandflag)}}}for(var f="i.m_jointList;f;f=f.next)if(1!=f.joint.m_islandFlag){var" d="f.other;0!=d.IsActive()&&(this.p_island.AddJoint(f.joint),f.joint.m_islandFlag=!0,d.m_flags&Ft.e_islandFlag||(t(c<s),o[c++]=d,d.m_flags|=Ft.e_islandFlag))}}}this.p_island.Solve(e,this.m_gravity,this.m_allowSleep);for(var" p="0;p<this.p_island.m_bodyCount;++p){var" i="this.p_island.m_bodies[p];i.GetType()==Ft.b2_staticBody&&(i.m_flags&=~Ft.e_islandFlag)}}Wi.start();for(var" n="this.m_contactManager.m_contactList;n;n=n.m_next)n.m_flags&=~(se.e_toiFlag|se.e_islandFlag),n.m_toiCount=0,n.m_toi=1}for(;;){for(var" r="null,s=1,n=this.m_contactManager.m_contactList;n;n=n.m_next)if(0!=n.IsEnabled()&&!(n.m_toiCount">oi)){var o=1;if(n.m_flags&se.e_toiFlag)o=n.m_toi;else{var a=n.GetFixtureA(),c=n.GetFixtureB();if(a.IsSensor()||c.IsSensor())continue;var h=a.GetBody(),l=c.GetBody(),u=h.m_type,_=l.m_type;t(u==Ft.b2_dynamicBody||_==Ft.b2_dynamicBody);var d=h.IsAwake()&&u!=Ft.b2_staticBody,f=l.IsAwake()&&_!=Ft.b2_staticBody;if(0==d&&0==f)continue;var p=h.IsBullet()||u!=Ft.b2_dynamicBody,m=l.IsBullet()||_!=Ft.b2_dynamicBody;if(0==p&&0==m)continue;var g=h.m_sweep.alpha0;h.m_sweep.alpha0<l.m_sweep.alpha0?(g=l.m_sweep.alpha0,h.m_sweep.advance(g)):l.m_sweep.alpha0<h.m_sweep.alpha0&&(g=h.m_sweep.alpha0,l.m_sweep.advance(g)),t(g<1);var v="n.GetChildIndexA(),y=n.GetChildIndexB(),x=new" bt;x.proxya.set(a.getshape(),v),x.proxyb.set(c.getshape(),y),x.sweepa.assign(h.m_sweep),x.sweepb.assign(l.m_sweep),x.tmax="1;var" t="new" dt;lt(t,x);var="" b="T.t;o=T.state==Dt.e_touching?Ri(g+(1-g)*b,1):1,n.m_toi=o,n.m_flags|=se.e_toiFlag}o<s&&(r=n,s=o)}if(null==r||1-10*Qe<s){this.m_stepComplete=!0;break}var" a="r.GetFixtureA(),c=r.GetFixtureB(),h=a.GetBody(),l=c.GetBody();if(Kt.m_local_sweep_backupA.Assign(h.m_sweep),Kt.m_local_sweep_backupB.Assign(l.m_sweep),h.Advance(s),l.Advance(s),r.Update(this.m_contactManager.m_contactListener),r.m_flags&=~se.e_toiFlag,++r.m_toiCount,0!=r.IsEnabled()&&0!=r.IsTouching()){h.SetAwake(!0),l.SetAwake(!0),this.p_island.Clear(),this.p_island.AddBody(h),this.p_island.AddBody(l),this.p_island.AddContact(r),h.m_flags|=Ft.e_islandFlag,l.m_flags|=Ft.e_islandFlag,r.m_flags|=se.e_islandFlag;for(var" c="[h,l],A=0;A<2;++A){var" s="C[A];if(S.m_type==Ft.b2_dynamicBody)for(var" e="S.m_contactList;E&&this.p_island.m_bodyCount!=this.p_island.m_bodyCapacity&&this.p_island.m_contactCount!=this.p_island.m_contactCapacity;E=E.next){var" w="E.contact;if(!(w.m_flags&se.e_islandFlag)){var" i="E.other;if(I.m_type!=Ft.b2_dynamicBody||0!=S.IsBullet()||0!=I.IsBullet()){var" r="w.m_fixtureA.m_isSensor,P=w.m_fixtureB.m_isSensor;R||P||(Kt.m_local_sweep_backupC.Assign(I.m_sweep),0==(I.m_flags&Ft.e_islandFlag)&&I.Advance(s),w.Update(this.m_contactManager.m_contactListener),0!=w.IsEnabled()&&0!=w.IsTouching()?(w.m_flags|=se.e_islandFlag,this.p_island.AddContact(w),I.m_flags&Ft.e_islandFlag||(I.m_flags|=Ft.e_islandFlag,I.m_type!=Ft.b2_staticBody&&I.SetAwake(!0),this.p_island.AddBody(I))):(I.m_sweep.Assign(Kt.m_local_sweep_backupC),I.SynchronizeTransform()))}}}}var" o="new" qt;o.dt="(1-s)*e.dt,O.inv_dt=1/O.dt,O.dtRatio=1,O.positionIterations=20,O.velocityIterations=e.velocityIterations,O.warmStarting=!1,this.p_island.SolveTOI(O,h.m_islandIndex,l.m_islandIndex);for(var" r.setenabled(!1),h.m_sweep.assign(kt.m_local_sweep_backupa),l.m_sweep.assign(kt.m_local_sweep_backupb),="" h.synchronizetransform(),l.synchronizetransform()}},drawjoint:function(t){var="" w(.5,.8,.8);switch(t.gettype()){case="" ae.e_distancejoint:this.g_debugdraw.drawsegment(a,c,h);break;case="" ae.e_pulleyjoint:var="" l="t,u=l.GetGroundAnchorA(),_=l.GetGroundAnchorB();this.g_debugDraw.DrawSegment(u,a,h),this.g_debugDraw.DrawSegment(_,c,h),this.g_debugDraw.DrawSegment(u,_,h);break;case" ae.e_mousejoint:break;case="" ae.e_motorjoint:this.g_debugdraw.drawpoint(t.getlinearoffset(),5,h);default:this.g_debugdraw.drawsegment(s,a,h),this.g_debugdraw.drawsegment(a,c,h),this.g_debugdraw.drawsegment(o,c,h)}},drawshape:function(e,i,n){switch(e.gettype()){case="" y.e_circle:var="" r(1,0));this.g_debugdraw.drawsolidcircle(o,a,c,n);break;case="" y.e_edge:var="" h="e.GetShape(),l=R(i,h.m_vertex1),u=R(i,h.m_vertex2);this.g_debugDraw.DrawSegment(l,u,n);break;case" y.e_chain:for(var="" _="e.GetShape(),d=_.m_count,f=_.m_vertices,l=R(i,f[0]),p=1;p<d;++p){var" u="R(i,f[p]);this.g_debugDraw.DrawSegment(l,u,n),l=u}break;case" y.e_polygon:var="" m="e.GetShape(),g=m.m_count;t(g<=ti);for(var" f="new" array(ti),p="0;p<g;++p)f[p]=R(i,m.m_vertices[p]);this.g_debugDraw.DrawSolidPolygon(f,g,n)}}},Kt.e_newFixture=1,Kt.e_locked=2,Kt.e_clearForces=4,re.prototype={Clear:function(){this.other=this.prev=this.next=null}},se.m_local_tempManifold=new" ht,se.prototype="{Create:function(t,e,i,n){this.m_toi=0,this.m_flags=se.e_enabledFlag,this.m_fixtureA=t||null,this.m_fixtureB=i||null,this.m_indexA=e||0,this.m_indexB=n||0,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null,this.m_toiCount=0,t?(this.m_friction=ee(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=ie(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)):(this.m_friction=0,this.m_restitution=0),this.m_tangentSpeed=0},GetManifold:function(){return" this.m_manifold},getworldmanifold:function(t){var="" this.m_next},getfixturea:function(){return="" this.m_fixturea},getchildindexa:function(){return="" this.m_indexa},getfixtureb:function(){return="" this.m_fixtureb},getchildindexb:function(){return="" this.m_indexb},setfriction:function(t){this.m_friction="t},GetFriction:function(){return" this.m_friction},resetfriction:function(){this.m_friction="ee(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},SetRestitution:function(t){this.m_restitution=t},GetRestitution:function(){return" this.m_restitution},resetrestitution:function(){this.m_restitution="ie(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},SetTangentSpeed:function(t){this.m_tangentSpeed=t},GetTangentSpeed:function(){return" this.m_tangentspeed},evaluate:function(t,e,i){},flagforfiltering:function(){this.m_flags|="se.e_filterFlag},m_oldManifold:null,Update:function(t){se.m_local_tempManifold.Assign(this.m_manifold),this.m_flags|=se.e_enabledFlag;var">0;for(var _=0;_<this.m_manifold.pointcount;++_){var d="this.m_manifold.points[_];d.normalImpulse=0,d.tangentImpulse=0;for(var" f="d.id,p=0;p<se.m_local_tempManifold.pointCount;++p){var" m="se.m_local_tempManifold.points[p];if(m.id.Get()==f.Get()){d.normalImpulse=m.normalImpulse,d.tangentImpulse=m.tangentImpulse;break}}}e!=i&&(o.SetAwake(!0),a.SetAwake(!0))}e?this.m_flags|=se.e_touchingFlag:this.m_flags&=~se.e_touchingFlag,0==i&&1==e&&t&&t.BeginContact(this),1==i&&0==e&&t&&t.EndContact(this),0==s&&e&&t&&t.PreSolve(this,se.m_local_tempManifold)}},se.e_islandFlag=1,se.e_touchingFlag=2,se.e_enabledFlag=4,se.e_filterFlag=8,se.e_bulletHitFlag=16,se.e_toiFlag=32,oe.prototype={Evaluate:function(t,e,i){mt(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,0,n,0),t(this.m_fixtureA.GetType()==Y.e_circle),t(this.m_fixtureB.GetType()==Y.e_circle)}},oe._extend(se);var" ui="new" q;ae.prototype="{Evaluate:function(t,e,i){var" n="this.m_fixtureA.GetShape();n.GetChildEdge(Ui,this.m_indexA),Tt(t,Ui,e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,i,n,r),t(this.m_fixtureA.GetType()==Y.e_chain),t(this.m_fixtureB.GetType()==Y.e_circle)}},ae._extend(se),ce.prototype={Evaluate:function(t,e,i){var" new="" ce(t,e,i,n)},ce._extend(se),he.prototype="{Evaluate:function(t,e,i){Tt(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,0,n,0),t(this.m_fixtureA.GetType()==Y.e_edge),t(this.m_fixtureB.GetType()==Y.e_circle)}},he.Create=function(t,e,i,n){return" he(t,i)},he._extend(se),le.prototype="{Evaluate:function(t,e,i){Et(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,0,n,0),t(this.m_fixtureA.GetType()==Y.e_edge),t(this.m_fixtureB.GetType()==Y.e_polygon)}},le.Create=function(t,e,i,n){return" le(t,i)},le._extend(se),ue.prototype="{Evaluate:function(t,e,i){gt(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,0,n,0),t(this.m_fixtureA.GetType()==Y.e_polygon),t(this.m_fixtureB.GetType()==Y.e_circle)}},ue.Create=function(t,e,i,n){return" ue(t,i)},ue._extend(se),_e.prototype="{Evaluate:function(t,e,i){xt(t,this.m_fixtureA.GetShape(),e,this.m_fixtureB.GetShape(),i)},Create:function(e,i,n,r){this.parent.prototype.Create.call(this,e,0,n,0),t(this.m_fixtureA.GetType()==Y.e_polygon),t(this.m_fixtureB.GetType()==Y.e_polygon)}},_e.Create=function(t,e,i,n){return" _e(t,i)},_e._extend(se),se.addtype="function(e,i,n){t(0<=i&&i<Y.e_typeCount),t(0<=n&&n<Y.e_typeCount),se.s_registers[i]||(se.s_registers[i]=[]),se.s_registers[i][n]=new" ne,se.s_registers[i][n].fcn="e,se.s_registers[i][n].primary=!0,i!=n&&(se.s_registers[n]||(se.s_registers[n]=[]),se.s_registers[n][i]=new" ne,se.s_registers[n][i].fcn="e,se.s_registers[n][i].primary=!1),e.garbage=[],e.alloc=2},se.InitializeRegisters=function(){se.AddType(oe,Y.e_circle,Y.e_circle),se.AddType(ue,Y.e_polygon,Y.e_circle),se.AddType(_e,Y.e_polygon,Y.e_polygon),se.AddType(he,Y.e_edge,Y.e_circle),se.AddType(le,Y.e_edge,Y.e_polygon),se.AddType(ae,Y.e_chain,Y.e_circle),se.AddType(ce,Y.e_chain,Y.e_polygon)},se.RetrieveGarbage=function(t){var" e;if(e="t.garbage.pop())return" e;for(var="" i="0;i<t.alloc-1;++i)t.garbage.push(new" t);return="" t.alloc+="32,new" t},se.create="function(e,i,n,r){0==se.s_initialized&&(se.InitializeRegisters(),se.s_initialized=!0);var" s="e.GetType(),o=n.GetType();t(0<=s&&s<Y.e_typeCount),t(0<=o&&o<Y.e_typeCount);var" a="se.s_registers[s]&&se.s_registers[s][o]?se.s_registers[s][o].fcn:null;if(a){var" c="se.RetrieveGarbage(a);return" se.s_registers[s][o].primary?c.create(e,i,n,r):c.create(n,r,e,i),c}return="" null},se.destroy="function(e){t(1==se.s_initialized);var">0&&0==i.IsSensor()&&0==n.IsSensor()&&(i.GetBody().SetAwake(!0),n.GetBody().SetAwake(!0));var r=i.GetType(),s=n.GetType();t(0<=r&&s<y.e_typecount),t(0<=r&&s<y.e_typecount),e.m_nodea.clear(),e.m_nodeb.clear(),se.s_registers[r][s].fcn.garbage.push(e)},se.s_registers=[],se.s_initialized=!1;var ji="new" ut,xi="new" xt;de.prototype="{AddPair:function(t,e){var" i="t,n=e,r=i.fixture,s=n.fixture,o=i.childIndex,a=n.childIndex,c=r.GetBody(),h=s.GetBody();if(c!=h){for(var" l="h.GetContactList();l;){if(l.other==c){var" u="l.contact.GetFixtureA(),_=l.contact.GetFixtureB(),d=l.contact.GetChildIndexA(),f=l.contact.GetChildIndexB();if(u==r&&_==s&&d==o&&f==a)return;if(u==s&&_==r&&d==a&&f==o)return}l=l.next}if(0!=h.ShouldCollide(c)&&(!this.m_contactFilter||0!=this.m_contactFilter.ShouldCollide(r,s))){var" p="se.Create(r,o,s,a);null!=p&&(r=p.GetFixtureA(),s=p.GetFixtureB(),o=p.GetChildIndexA(),a=p.GetChildIndexB(),c=r.GetBody(),h=s.GetBody(),p.m_prev=null,p.m_next=this.m_contactList,null!=this.m_contactList&&(this.m_contactList.m_prev=p),this.m_contactList=p,p.m_nodeA.contact=p,p.m_nodeA.other=h,p.m_nodeA.prev=null,p.m_nodeA.next=c.m_contactList,null!=c.m_contactList&&(c.m_contactList.prev=p.m_nodeA),c.m_contactList=p.m_nodeA,p.m_nodeB.contact=p,p.m_nodeB.other=c,p.m_nodeB.prev=null,p.m_nodeB.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=p.m_nodeB),h.m_contactList=p.m_nodeB,0==r.IsSensor()&&0==s.IsSensor()&&(c.SetAwake(!0),h.SetAwake(!0)),++this.m_contactCount)}}},FindNewContacts:function(){this.m_broadPhase.UpdatePairs(this)},Destroy:function(t){var" e="t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),se.Destroy(t),--this.m_contactCount},Collide:function(){for(var" t="this.m_contactList;t;){var" a="t;t=a.GetNext(),this.Destroy(a);continue}if(this.m_contactFilter&&0==this.m_contactFilter.ShouldCollide(e,i)){var" c="s.IsAwake()&&s.m_type!=Ft.b2_staticBody,h=o.IsAwake()&&o.m_type!=Ft.b2_staticBody;if(0!=c||0!=h){var">0),e.type){case ht.e_circles:var s=i.q.c*e.localPoint.x-i.q.s*e.localPoint.y+i.p.x,o=i.q.s*e.localPoint.x+i.q.c*e.localPoint.y+i.p.y,a=n.q.c*e.localPoints[0].x-n.q.s*e.localPoints[0].y+n.p.x,c=n.q.s*e.localPoints[0].x+n.q.c*e.localPoints[0].y+n.p.y;this.point.x=.5*(s+a),this.point.y=.5*(o+c),this.normal.x=a-s,this.normal.y=c-o;var h=this.normal.x,l=this.normal.y;this.normal.Normalize(),this.separation=h*this.normal.x+l*this.normal.y-e.radiusA-e.radiusB;break;case ht.e_faceA:this.normal.x=i.q.c*e.localNormal.x-i.q.s*e.localNormal.y,this.normal.y=i.q.s*e.localNormal.x+i.q.c*e.localNormal.y;var u=i.q.c*e.localPoint.x-i.q.s*e.localPoint.y+i.p.x,_=i.q.s*e.localPoint.x+i.q.c*e.localPoint.y+i.p.y,d=n.q.c*e.localPoints[r].x-n.q.s*e.localPoints[r].y+n.p.x,f=n.q.s*e.localPoints[r].x+n.q.c*e.localPoints[r].y+n.p.y;this.separation=(d-u)*this.normal.x+(f-_)*this.normal.y-e.radiusA-e.radiusB,this.point.x=d,this.point.y=f;break;case ht.e_faceB:this.normal.x=n.q.c*e.localNormal.x-n.q.s*e.localNormal.y,this.normal.y=n.q.s*e.localNormal.x+n.q.c*e.localNormal.y;var u=n.q.c*e.localPoint.x-n.q.s*e.localPoint.y+n.p.x,_=n.q.s*e.localPoint.x+n.q.c*e.localPoint.y+n.p.y,d=i.q.c*e.localPoints[r].x-i.q.s*e.localPoints[r].y+i.p.x,f=i.q.s*e.localPoints[r].x+i.q.c*e.localPoints[r].y+i.p.y;this.separation=(d-u)*this.normal.x+(f-_)*this.normal.y-e.radiusA-e.radiusB,this.point.x=d,this.point.y=f,this.normal.x=-this.normal.x,this.normal.y=-this.normal.y}}},ye.cs_xfA=new h,ye.cs_xfB=new h,ye.temp_solver_manifold=new ge,ye.prototype={Init:function(e){this.m_step=e.step,this.m_count=e.count,this.m_positionConstraints.length=this.m_count,this.m_velocityConstraints.length=this.m_count,this.m_positions=e.positions,this.m_velocities=e.velocities,this.m_contacts=e.contacts;for(var i=0;i<this.m_count;++i){var n="this.m_contacts[i],r=n.m_fixtureA,s=n.m_fixtureB,o=r.GetShape(),a=s.GetShape(),c=o.m_radius,h=a.m_radius,l=r.GetBody(),u=s.GetBody(),_=n.GetManifold(),d=_.pointCount;t(d">0);var f=this.m_velocityConstraints[i]||new me;f.friction=n.m_friction,f.restitution=n.m_restitution,f.tangentSpeed=n.m_tangentSpeed,f.indexA=l.m_islandIndex,f.indexB=u.m_islandIndex,f.invMassA=l.m_invMass,f.invMassB=u.m_invMass,f.invIA=l.m_invI,f.invIB=u.m_invI,f.contactIndex=i,f.pointCount=d,f.K.SetZero(),f.normalMass.SetZero(),this.m_velocityConstraints[i]=f;var p=this.m_positionConstraints[i]||new pe;p.indexA=l.m_islandIndex,p.indexB=u.m_islandIndex,p.invMassA=l.m_invMass,p.invMassB=u.m_invMass,p.localCenterA.x=l.m_sweep.localCenter.x,p.localCenterA.y=l.m_sweep.localCenter.y,p.localCenterB.x=u.m_sweep.localCenter.x,p.localCenterB.y=u.m_sweep.localCenter.y,p.invIA=l.m_invI,p.invIB=u.m_invI,p.localNormal.x=_.localNormal.x,p.localNormal.y=_.localNormal.y,p.localPoint.x=_.localPoint.x,p.localPoint.y=_.localPoint.y,p.pointCount=d,p.radiusA=c,p.radiusB=h,p.type=_.type,this.m_positionConstraints[i]=p;for(var m=0;m<d;++m){var g="_.points[m],v=f.points[m];this.m_step.warmStarting?(v.normalImpulse=this.m_step.dtRatio*g.normalImpulse,v.tangentImpulse=this.m_step.dtRatio*g.tangentImpulse):(v.normalImpulse=0,v.tangentImpulse=0),v.rA.SetZero(),v.rB.SetZero(),v.normalMass=0,v.tangentMass=0,v.velocityBias=0,p.localPoints[m]=g.localPoint}}},InitializeVelocityConstraints:function(){for(var" e="0;e<this.m_count;++e){var" i="this.m_velocityConstraints[e],n=this.m_positionConstraints[e],r=n.radiusA,s=n.radiusB,o=this.m_contacts[i.contactIndex].GetManifold(),a=i.indexA,c=i.indexB,h=i.invMassA,l=i.invMassB,u=i.invIA,_=i.invIB,d=n.localCenterA,f=n.localCenterB,p=this.m_positions[a].c,m=this.m_positions[a].a,g=this.m_velocities[a].v,v=this.m_velocities[a].w,y=this.m_positions[c].c,x=this.m_positions[c].a,T=this.m_velocities[c].v,b=this.m_velocities[c].w;t(o.pointCount">0),ye.cs_xfA.q.Set(m),ye.cs_xfB.q.Set(x),ye.cs_xfA.p.x=p.x-(ye.cs_xfA.q.c*d.x-ye.cs_xfA.q.s*d.y),ye.cs_xfA.p.y=p.y-(ye.cs_xfA.q.s*d.x+ye.cs_xfA.q.c*d.y),ye.cs_xfB.p.x=y.x-(ye.cs_xfB.q.c*f.x-ye.cs_xfB.q.s*f.y),ye.cs_xfB.p.y=y.y-(ye.cs_xfB.q.s*f.x+ye.cs_xfB.q.c*f.y);var C=new lt;C.Initialize(o,ye.cs_xfA,r,ye.cs_xfB,s),i.normal.x=C.normal.x,i.normal.y=C.normal.y;for(var A=i.pointCount,S=0;S<a;++s){var e="i.points[S];E.rA.x=C.points[S].x-p.x,E.rA.y=C.points[S].y-p.y,E.rB.x=C.points[S].x-y.x,E.rB.y=C.points[S].y-y.y;var" w="E.rA.x*i.normal.y-E.rA.y*i.normal.x,I=E.rB.x*i.normal.y-E.rB.y*i.normal.x,R=h+l+u*w*w+_*I*I;E.normalMass=R">0?1/R:0;var P=1*i.normal.y,O=-1*i.normal.x,B=E.rA.x*O-E.rA.y*P,D=E.rB.x*O-E.rB.y*P,M=h+l+u*B*B+_*D*D;E.tangentMass=M>0?1/M:0,E.velocityBias=0;var L=i.normal.x*(T.x+-b*E.rB.y-g.x- -v*E.rA.y)+i.normal.y*(T.y+b*E.rB.x-g.y-v*E.rA.x);L<-ci&&(e.velocitybias=-i.restitution*l)}if(2==i.pointcount){var n="i.points[0],F=i.points[1],k=N.rA.x*i.normal.y-N.rA.y*i.normal.x,z=N.rB.x*i.normal.y-N.rB.y*i.normal.x,V=F.rA.x*i.normal.y-F.rA.y*i.normal.x,G=F.rB.x*i.normal.y-F.rB.y*i.normal.x,W=h+l+u*k*k+_*z*z,U=h+l+u*V*V+_*G*G,j=h+l+u*k*V+_*z*G,X=1e3;W*W<X*(W*U-j*j)?(i.K.ex.x=W,i.K.ex.y=j,i.K.ey.x=j,i.K.ey.y=U,i.normalMass.Assign(i.K.GetInverse())):i.pointCount=1}}},WarmStart:function(){for(var" t="0;t<this.m_count;++t){for(var" e="this.m_velocityConstraints[t],i=e.indexA,n=e.indexB,r=e.invMassA,s=e.invIA,o=e.invMassB,a=e.invIB,c=e.pointCount,h=this.m_velocities[i].v,l=this.m_velocities[i].w,u=this.m_velocities[n].v,_=this.m_velocities[n].w,d=e.normal,f=1*d.y,p=-1*d.x,m=0;m<c;++m){var" g="e.points[m],v=g.normalImpulse*d.x+g.tangentImpulse*f,y=g.normalImpulse*d.y+g.tangentImpulse*p;l-=s*(g.rA.x*y-g.rA.y*v),h.x-=r*v,h.y-=r*y,_+=a*(g.rB.x*y-g.rB.y*v),u.x+=o*v,u.y+=o*y}this.m_velocities[i].w=l,this.m_velocities[n].w=_}},SolveVelocityConstraints:function(){for(var" i="this.m_velocityConstraints[e],n=i.indexA,r=i.indexB,s=i.invMassA,o=i.invIA,a=i.invMassB,c=i.invIB,h=i.pointCount,l=this.m_velocities[n].v,u=this.m_velocities[n].w,_=this.m_velocities[r].v,d=this.m_velocities[r].w,f=i.normal,p=1*f.y,m=-1*f.x,g=i.friction;t(1==h||2==h);for(var" v="0;v<h;++v){var" y="i.points[v],x=_.x+-d*y.rB.y-l.x-" -u*y.ra.y,t="_.y+d*y.rB.x-l.y-u*y.rA.x,b=x*p+T*m-i.tangentSpeed,C=y.tangentMass*-b,A=g*y.normalImpulse,S=F(y.tangentImpulse+C,-A,A);C=S-y.tangentImpulse,y.tangentImpulse=S;var" r="i.points[0],P=i.points[1],O=R.normalImpulse,B=P.normalImpulse;t(O">=0&&B>=0);var D=_.x+-d*R.rB.y-l.x- -u*R.rA.y,M=_.y+d*R.rB.x-l.y-u*R.rA.x,L=_.x+-d*P.rB.y-l.x- -u*P.rA.y,N=_.y+d*P.rB.x-l.y-u*P.rA.x,k=D*f.x+M*f.y,z=L*f.x+N*f.y,V=k-R.velocityBias,G=z-P.velocityBias;for(V-=i.K.ex.x*O+i.K.ey.x*B,G-=i.K.ex.y*O+i.K.ey.y*B;;){var W=-(i.normalMass.ex.x*V+i.normalMass.ey.x*G),U=-(i.normalMass.ex.y*V+i.normalMass.ey.y*G);if(W>=0&&U>=0){var j=W-O,X=U-B,Y=j*f.x,H=j*f.y,q=X*f.x,Z=X*f.y;l.x-=s*(Y+q),l.y-=s*(H+Z),u-=o*(R.rA.x*H-R.rA.y*Y+(P.rA.x*Z-P.rA.y*q)),_.x+=a*(Y+q),_.y+=a*(H+Z),d+=c*(R.rB.x*H-R.rB.y*Y+(P.rB.x*Z-P.rB.y*q)),R.normalImpulse=W,P.normalImpulse=U;break}if(W=-R.normalMass*V,U=0,k=0,z=i.K.ex.y*W+G,W>=0&&z>=0){j=W-O,X=U-B,Y=j*f.x,H=j*f.y,q=X*f.x,Z=X*f.y,l.x-=s*(Y+q),l.y-=s*(H+Z),u-=o*(R.rA.x*H-R.rA.y*Y+(P.rA.x*Z-P.rA.y*q)),_.x+=a*(Y+q),_.y+=a*(H+Z),d+=c*(R.rB.x*H-R.rB.y*Y+(P.rB.x*Z-P.rB.y*q)),R.normalImpulse=W,P.normalImpulse=U;break}if(W=0,U=-P.normalMass*G,k=i.K.ey.x*U+V,z=0,U>=0&&k>=0){j=W-O,X=U-B,Y=j*f.x,H=j*f.y,q=X*f.x,Z=X*f.y,l.x-=s*(Y+q),l.y-=s*(H+Z),u-=o*(R.rA.x*H-R.rA.y*Y+(P.rA.x*Z-P.rA.y*q)),_.x+=a*(Y+q),_.y+=a*(H+Z),d+=c*(R.rB.x*H-R.rB.y*Y+(P.rB.x*Z-P.rB.y*q)),R.normalImpulse=W,P.normalImpulse=U;break}if(W=0,U=0,k=V,z=G,k>=0&&z>=0){j=W-O,X=U-B,Y=j*f.x,H=j*f.y,q=X*f.x,Z=X*f.y,l.x-=s*(Y+q),l.y-=s*(H+Z),u-=o*(R.rA.x*H-R.rA.y*Y+(P.rA.x*Z-P.rA.y*q)),_.x+=a*(Y+q),_.y+=a*(H+Z),d+=c*(R.rB.x*H-R.rB.y*Y+(P.rB.x*Z-P.rB.y*q)),R.normalImpulse=W,P.normalImpulse=U;break}break}}this.m_velocities[n].w=u,this.m_velocities[r].w=d}},StoreImpulses:function(){for(var t=0;t<this.m_count;++t)for(var e="this.m_velocityConstraints[t],i=this.m_contacts[e.contactIndex].GetManifold(),n=0;n<e.pointCount;++n)i.points[n].normalImpulse=e.points[n].normalImpulse,i.points[n].tangentImpulse=e.points[n].tangentImpulse},SolvePositionConstraints:function(){for(var" t="0,e=0;e<this.m_count;++e){for(var" i="this.m_positionConstraints[e],n=i.indexA,r=i.indexB,s=i.localCenterA,o=i.invMassA,a=i.invIA,c=i.localCenterB,h=i.invMassB,l=i.invIB,u=i.pointCount,_=this.m_positions[n].c,d=this.m_positions[n].a,f=this.m_positions[r].c,p=this.m_positions[r].a,m=0;m<u;++m){ye.cs_xfA.q.Set(d),ye.cs_xfB.q.Set(p),ye.cs_xfA.p.x=_.x-(ye.cs_xfA.q.c*s.x-ye.cs_xfA.q.s*s.y),ye.cs_xfA.p.y=_.y-(ye.cs_xfA.q.s*s.x+ye.cs_xfA.q.c*s.y),ye.cs_xfB.p.x=f.x-(ye.cs_xfB.q.c*c.x-ye.cs_xfB.q.s*c.y),ye.cs_xfB.p.y=f.y-(ye.cs_xfB.q.s*c.x+ye.cs_xfB.q.c*c.y),ye.temp_solver_manifold.Initialize(i,ye.cs_xfA,ye.cs_xfB,m);var" g="ye.temp_solver_manifold.normal,v=ye.temp_solver_manifold.point,y=ye.temp_solver_manifold.separation,x=v.x-_.x,T=v.y-_.y,b=v.x-f.x,C=v.y-f.y;t=Ri(t,y);var" a="F(pi*(y+ni),-hi,0),S=x*g.y-T*g.x,E=b*g.y-C*g.x,w=o+h+a*S*S+l*E*E,I=w">0?-A/w:0,R=I*g.x,P=I*g.y;_.x-=o*R,_.y-=o*P,d-=a*(x*P-T*R),f.x+=h*R,f.y+=h*P,p+=l*(b*P-C*R)}this.m_positions[n].a=d,this.m_positions[r].a=p}return t>=-3*ni},SolveTOIPositionConstraints:function(t,e){for(var i=0,n=0;n<this.m_count;++n){var s="this.m_positionConstraints[n],o=s.indexA,a=s.indexB,c=s.localCenterA,h=s.localCenterB,l=s.pointCount,u=0,d=0;o!=t&&o!=e||(u=s.invMassA,d=s.invIA);var" f="0,p=0;a!=t&&a!=e||(f=s.invMassB,p=s.invIB);for(var" m="this.m_positions[o].c,g=this.m_positions[o].a,v=this.m_positions[a].c,y=this.m_positions[a].a,x=0;x<l;++x){ye.cs_xfA.q.Set(g),ye.cs_xfB.q.Set(y),ye.cs_xfA.p.Assign(r.Subtract(m,w(ye.cs_xfA.q,c))),ye.cs_xfB.p.Assign(r.Subtract(v,w(ye.cs_xfB.q,h))),ye.temp_solver_manifold.Initialize(s,ye.cs_xfA,ye.cs_xfB,x);var" t="ye.temp_solver_manifold.normal,b=ye.temp_solver_manifold.point,C=ye.temp_solver_manifold.separation,A=r.Subtract(b,m),S=r.Subtract(b,v);i=Ri(i,C);var" e="F(mi*(C+ni),-hi,0),I=_(A,T),R=_(S,T),P=u+f+d*I*I+p*R*R,O=P">0?-E/P:0,B=r.Multiply(O,T);m.Subtract(r.Multiply(u,B)),g-=d*_(A,B),v.Add(r.Multiply(f,B)),y+=p*_(S,B)}this.m_positions[o].a=g,this.m_positions[a].a=y}return i>=-1.5*ni}};var Yi=Ze.create("solve initialization","solve"),Hi=Ze.create("warm starting","solve initialization"),qi=Ze.create("solve velocities","solve"),Zi=Ze.create("solve positions","solve");xe._solverData=new Qt,xe._solverDef=new ve,xe._solver=new ye,xe.prototype={Clear:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},Initialize:function(t,e,i,n){this.m_listener=n,this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_bodies.length=t,this.m_contacts.length=e,this.m_joints.length=i,this.m_velocities.length=t,this.m_positions.length=t},Solve:function(t,e,i){Yi.start();for(var n=t.dt,r=0;r<this.m_bodycount;++r){var s="this.m_bodies[r];this.m_positions[r].c.Assign(s.m_sweep.c);var" o="s.m_sweep.a;this.m_velocities[r].v.Assign(s.m_linearVelocity);var" a="s.m_angularVelocity;s.m_sweep.c0.Assign(s.m_sweep.c),s.m_sweep.a0=s.m_sweep.a,s.m_type==Ft.b2_dynamicBody&&(this.m_velocities[r].v.x+=n*(s.m_gravityScale*e.x+s.m_invMass*s.m_force.x),this.m_velocities[r].v.y+=n*(s.m_gravityScale*e.y+s.m_invMass*s.m_force.y),a+=n*s.m_invI*s.m_torque,this.m_velocities[r].v.x*=1/(1+n*s.m_linearDamping),this.m_velocities[r].v.y*=1/(1+n*s.m_linearDamping),a*=1/(1+n*s.m_angularDamping)),this.m_positions[r].a=o,this.m_velocities[r].w=a}xe._solverData.step=t,xe._solverData.positions=this.m_positions,xe._solverData.velocities=this.m_velocities,xe._solverDef.step=t,xe._solverDef.contacts=this.m_contacts,xe._solverDef.count=this.m_contactCount,xe._solverDef.positions=this.m_positions,xe._solverDef.velocities=this.m_velocities,xe._solverDef.allocator=this.m_allocator,xe._solver.Init(xe._solverDef),xe._solver.InitializeVelocityConstraints(),t.warmStarting&&(Hi.start(),xe._solver.WarmStart(),Hi.stop());for(var" r="0;r<this.m_jointCount;++r)this.m_joints[r].InitVelocityConstraints(xe._solverData);Yi.stop(),qi.start();for(var" c="0;c<this.m_jointCount;++c)this.m_joints[c].SolveVelocityConstraints(xe._solverData);xe._solver.SolveVelocityConstraints()}xe._solver.StoreImpulses(),qi.stop(),Zi.start();for(var" h="this.m_positions[r].c,o=this.m_positions[r].a,l=this.m_velocities[r].v,a=this.m_velocities[r].w,_=n*l.x,d=n*l.y,f=_*_+d*d;if(f">_i){var p=ui/Ei(f);l.x*=p,l.y*=p}var m=n*a;if(m*m>fi){var p=di/Ii(m);a*=p}h.x+=n*l.x,h.y+=n*l.y,o+=n*a,this.m_positions[r].a=o,this.m_velocities[r].w=a}for(var g=!1,r=0;r<t.positioniterations;++r){for(var v="xe._solver.SolvePositionConstraints(),y=!0,c=0;c<this.m_jointCount;++c){var" x="this.m_joints[c].SolvePositionConstraints(xe._solverData);y=y&&x}if(v&&y){g=!0;break}}for(var" r="0;r<this.m_bodyCount;++r){var" t="this.m_bodies[r];T.m_sweep.c.Assign(this.m_positions[r].c),T.m_sweep.a=this.m_positions[r].a,T.m_linearVelocity.Assign(this.m_velocities[r].v),T.m_angularVelocity=this.m_velocities[r].w,T.SynchronizeTransform()}if(Zi.stop(),this.Report(xe._solver.m_velocityConstraints),i){for(var" b="Je,C=vi*vi,A=yi*yi,r=0;r<this.m_bodyCount;++r){var" s="this.m_bodies[r];s.GetType()!=Ft.b2_staticBody&&(0==(s.m_flags&Ft.e_autoSleepFlag)||s.m_angularVelocity*s.m_angularVelocity">A||u(s.m_linearVelocity,s.m_linearVelocity)>C?(s.m_sleepTime=0,b=0):(s.m_sleepTime+=n,b=Ri(b,s.m_sleepTime)))}if(b>=gi&&g)for(var r=0;r<this.m_bodycount;++r){var s="this.m_bodies[r];s.SetAwake(!1)}}},SolveTOI:function(e,i,n){t(i<this.m_bodyCount),t(n<this.m_bodyCount);for(var" o="this.m_bodies[s];this.m_positions[s].c.Assign(o.m_sweep.c),this.m_positions[s].a=o.m_sweep.a,this.m_velocities[s].v.Assign(o.m_linearVelocity),this.m_velocities[s].w=o.m_angularVelocity}xe._solverDef.contacts=this.m_contacts,xe._solverDef.count=this.m_contactCount,xe._solverDef.step=e,xe._solverDef.positions=this.m_positions,xe._solverDef.velocities=this.m_velocities,xe._solver.Init(xe._solverDef);for(var" a="xe._solver.SolveTOIPositionConstraints(i,n);if(a)break}this.m_bodies[i].m_sweep.c0.Assign(this.m_positions[i].c),this.m_bodies[i].m_sweep.a0=this.m_positions[i].a,this.m_bodies[n].m_sweep.c0.Assign(this.m_positions[n].c),this.m_bodies[n].m_sweep.a0=this.m_positions[n].a,xe._solver.InitializeVelocityConstraints();for(var" c="e.dt,s=0;s<this.m_bodyCount;++s){var" h="this.m_positions[s].c,l=this.m_positions[s].a,_=this.m_velocities[s].v,d=this.m_velocities[s].w,f=r.Multiply(c,_);if(u(f,f)">_i){var p=ui/f.Length();_.Multiply(p)}var m=c*d;if(m*m>fi){var p=di/Ii(m);d*=p}h.Add(r.Multiply(c,_)),l+=c*d,this.m_positions[s].a=l,this.m_velocities[s].w=d;var g=this.m_bodies[s];g.m_sweep.c.Assign(h),g.m_sweep.a=l,g.m_linearVelocity.Assign(_),g.m_angularVelocity=d,g.SynchronizeTransform()}this.Report(xe._solver.m_velocityConstraints)},AddBody:function(e){t(this.m_bodyCount<this.m_bodycapacity),e.m_islandindex=this.m_bodycount,this.m_bodies[this.m_bodycount]=e,this.m_positions[this.m_bodycount]||(this.m_positions[this.m_bodycount]=new zt,this.m_velocities[this.m_bodycount]="new" jt),++this.m_bodycount},addcontact:function(e){t(this.m_contactcount<this.m_contactcapacity),this.m_contacts[this.m_contactcount++]="e},AddJoint:function(e){t(this.m_jointCount<this.m_jointCapacity),this.m_joints[this.m_jointCount++]=e},Report:function(t){if(null!=this.m_listener)for(var" e="0;e<this.m_contactCount;++e){var" i="this.m_contacts[e],n=t[e],r=new" jt;r.count="n.pointCount;for(var" s="0;s<n.pointCount;++s)r.normalImpulses[s]=n.points[s].normalImpulse,r.tangentImpulses[s]=n.points[s].tangentImpulse;this.m_listener.PostSolve(i,r)}}},Ce.prototype={_deserialize:function(t,e,i){this.bodyA=e[t.bodyA],this.bodyB=e[t.bodyB],this.collideConnected=t.collideConnected}},Ae.prototype={GetType:function(){return" this.m_type},getbodya:function(){return="" this.m_bodya},getbodyb:function(){return="" this.m_bodyb},getanchora:function(){},getanchorb:function(){},getreactionforce:function(t){},getreactiontorque:function(t){},getnext:function(){return="" this.m_next},getuserdata:function(){return="" this.m_userdata},setuserdata:function(t){this.m_userdata="t},IsActive:function(){return" this.m_bodya.isactive()&&this.m_bodyb.isactive()},getcollideconnected:function(){return="" this.m_collideconnected},shiftorigin:function(t){},initvelocityconstraints:function(t){},solvevelocityconstraints:function(t){},solvepositionconstraints:function(t){},_serialize:function(t){var="" e.bodya="null,e.bodyB=null,e.type=this.m_type,e.collideConnected=this.m_collideConnected,e}},Ae.e_inactiveLimit=0,Ae.e_atLowerLimit=1,Ae.e_atUpperLimit=2,Ae.e_equalLimits=3,Ae.e_unknownJoint=0,Ae.e_revoluteJoint=1,Ae.e_prismaticJoint=2,Ae.e_distanceJoint=3,Ae.e_pulleyJoint=4,Ae.e_mouseJoint=5,Ae.e_gearJoint=6,Ae.e_wheelJoint=7,Ae.e_weldJoint=8,Ae.e_frictionJoint=9,Ae.e_ropeJoint=10,Ae.e_motorJoint=11,Ae.Create=function(e){var" ae.e_distancejoint:i="new" pe(e);break;case="" ae.e_mousejoint:i="new" ie(e);break;case="" ae.e_prismaticjoint:i="new" be(e);break;case="" ae.e_revolutejoint:i="new" ee(e);break;case="" ae.e_pulleyjoint:i="new" je(e);break;case="" ae.e_gearjoint:i="new" ve(e);break;case="" ae.e_wheeljoint:i="new" ke(e);break;case="" ae.e_weldjoint:i="new" ne(e);break;case="" ae.e_frictionjoint:i="new" me(e);break;case="" ae.e_ropejoint:i="new" ye(e);break;case="" ae.e_motorjoint:i="new" we(e);break;default:t(!1)}return="" i},ae.destroy="function(t){},Se.prototype={Initialize:function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.referenceAngle=t.referenceAngle,this.lowerAngle=t.lowerAngle,this.upperAngle=t.upperAngle,this.maxMotorTorque=t.maxMotorTorque,this.motorSpeed=t.motorSpeed,this.enableLimit=t.enableLimit,this.enableMotor=t.enableMotor}},Se._extend(Ce),Ee.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getlocalanchora:function(){return="" this.m_localanchora},getlocalanchorb:function(){return="" this.m_localanchorb},getreferenceangle:function(){return="" this.m_referenceangle},getjointangle:function(){var="" t="this.m_bodyA,e=this.m_bodyB;return" e.m_sweep.a-t.m_sweep.a-this.m_referenceangle},getjointspeed:function(){var="" e.m_angularvelocity-t.m_angularvelocity},islimitenabled:function(){return="" this.m_enablelimit},enablelimit:function(t){t!="this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},GetLowerLimit:function(){return" this.m_lowerangle},getupperlimit:function(){return="" this.m_upperangle},setlimits:function(e,i){t(e<="i),e==this.m_lowerAngle&&i==this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=e,this.m_upperAngle=i)},IsMotorEnabled:function(){return" this.m_enablemotor},enablemotor:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_enablemotor="t},SetMotorSpeed:function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},GetMotorSpeed:function(){return" this.m_motorspeed},setmaxmotortorque:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_maxmotortorque="t},GetMaxMotorTorque:function(){return" this.m_maxmotortorque},getreactionforce:function(t){var="" r(this.m_impulse.x,this.m_impulse.y);return="" r.multiply(t,e)},getreactiontorque:function(t){return="" t*this.m_impulse.z},getmotortorque:function(t){return="" t*this.m_motorimpulse},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var" c(e),l="new" c(s);="" this.m_ra="w(h,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=w(l,r.Subtract(this.m_localAnchorB,this.m_localCenterB));var" u="this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,p=this.m_invIB,m=f+p==0;if(this.m_mass.ex.x=u+d+this.m_rA.y*this.m_rA.y*f+this.m_rB.y*this.m_rB.y*p,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*f-this.m_rB.y*this.m_rB.x*p,this.m_mass.ez.x=-this.m_rA.y*f-this.m_rB.y*p,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=u+d+this.m_rA.x*this.m_rA.x*f+this.m_rB.x*this.m_rB.x*p,this.m_mass.ez.y=this.m_rA.x*f+this.m_rB.x*p,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=f+p,this.m_motorMass=f+p,this.m_motorMass">0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||m)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==m){var g=s-e-this.m_referenceAngle;Ii(this.m_upperAngle-this.m_lowerAngle)<2*ri?this.m_limitstate=ae.e_equallimits:g<=this.m_lowerangle?(this.m_limitstate!=ae.e_atlowerlimit&&(this.m_impulse.z=0),this.m_limitstate=ae.e_atlowerlimit):g>=this.m_upperAngle?(this.m_limitState!=Ae.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=Ae.e_atUpperLimit):(this.m_limitState=Ae.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=Ae.e_inactiveLimit;if(t.step.warmStarting){this.m_impulse.Multiply(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var v=new r(this.m_impulse.x,this.m_impulse.y);i.Subtract(r.Multiply(u,v)),n-=f*(_(this.m_rA,v)+this.m_motorImpulse+this.m_impulse.z),o.Add(r.Multiply(d,v)),a+=p*(_(this.m_rB,v)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].v.Assign(i),t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].v.Assign(o),t.velocities[this.m_indexB].w=a},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),o=t.velocities[this.m_indexB].w,a=this.m_invMassA,c=this.m_invMassB,h=this.m_invIA,l=this.m_invIB,u=h+l==0;if(this.m_enableMotor&&this.m_limitState!=Ae.e_equalLimits&&0==u){var d=o-i-this.m_motorSpeed,p=-this.m_motorMass*d,m=this.m_motorImpulse,g=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=F(this.m_motorImpulse+p,-g,g),p=this.m_motorImpulse-m,i-=h*p,o+=l*p}if(this.m_enableLimit&&this.m_limitState!=Ae.e_inactiveLimit&&0==u){var v=r.Subtract(r.Subtract(r.Add(n,f(o,this.m_rB)),e),f(i,this.m_rA)),y=o-i,d=new s(v.x,v.y,y),p=this.m_mass.Solve33(d).Negate();if(this.m_limitState==Ae.e_equalLimits)this.m_impulse.Add(p);else if(this.m_limitState==Ae.e_atLowerLimit){var x=this.m_impulse.z+p.z;if(x<0){var t="r.Add(v.Negate(),r.Multiply(this.m_impulse.z,new" r(this.m_mass.ez.x,this.m_mass.ez.y))),b="this.m_mass.Solve22(T);p.x=b.x,p.y=b.y,p.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else" this.m_impulse.add(p)}else="" if(this.m_limitstate="=Ae.e_atUpperLimit){var" x="this.m_impulse.z+p.z;if(x">0){var T=r.Add(v.Negate(),r.Multiply(this.m_impulse.z,new r(this.m_mass.ez.x,this.m_mass.ez.y))),b=this.m_mass.Solve22(T);p.x=b.x,p.y=b.y,p.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.Add(p)}var C=new r(p.x,p.y);e.Subtract(r.Multiply(a,C)),i-=h*(_(this.m_rA,C)+p.z),n.Add(r.Multiply(c,C)),o+=l*(_(this.m_rB,C)+p.z)}else{var d=r.Subtract(r.Subtract(r.Add(n,f(o,this.m_rB)),e),f(i,this.m_rA)),p=this.m_mass.Solve22(d.Negate());this.m_impulse.x+=p.x,this.m_impulse.y+=p.y,e.Subtract(r.Multiply(a,p)),i-=h*_(this.m_rA,p),n.Add(r.Multiply(c,p)),o+=l*_(this.m_rB,p)}t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=o},SolvePositionConstraints:function(t){var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c.Clone(),s=t.positions[this.m_indexB].a,a=new c(i),h=new c(s),l=0,u=0,d=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=Ae.e_inactiveLimit&&0==d){var f=s-i-this.m_referenceAngle,p=0;if(this.m_limitState==Ae.e_equalLimits){var m=F(f-this.m_lowerAngle,-li,li);p=-this.m_motorMass*m,l=Ii(m)}else if(this.m_limitState==Ae.e_atLowerLimit){var m=f-this.m_lowerAngle;l=-m,m=F(m+ri,-li,0),p=-this.m_motorMass*m}else if(this.m_limitState==Ae.e_atUpperLimit){var m=f-this.m_upperAngle;l=m,m=F(m-ri,0,li),p=-this.m_motorMass*m}i-=this.m_invIA*p,s+=this.m_invIB*p}a.Set(i),h.Set(s);var g=w(a,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),v=w(h,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),m=r.Subtract(r.Subtract(r.Add(n,v),e),g);u=m.Length();var y=this.m_invMassA,x=this.m_invMassB,T=this.m_invIA,b=this.m_invIB,C=new o;C.ex.x=y+x+T*g.y*g.y+b*v.y*v.y,C.ex.y=-T*g.x*g.y-b*v.x*v.y,C.ey.x=C.ex.y,C.ey.y=y+x+T*g.x*g.x+b*v.x*v.x;var A=C.Solve(m).Negate();return e.Subtract(r.Multiply(y,A)),i-=T*_(g,A),n.Add(r.Multiply(x,A)),s+=b*_(v,A),t.positions[this.m_indexA].c.Assign(e),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].c.Assign(n),t.positions[this.m_indexB].a=s,u<=ni&&l<=ri},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.referenceAngle=this.m_referenceAngle,e.lowerAngle=this.m_lowerAngle,e.upperAngle=this.m_upperAngle,e.maxMotorTorque=this.m_maxMotorTorque,e.motorSpeed=this.m_motorSpeed,e.enableLimit=this.m_enableLimit,e.enableMotor=this.m_enableMotor,e}},Ee._extend(Ae),we._extend(Ce),Ie.prototype={GetAnchorA:function(){return" this.m_targeta},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){return="" r.multiply(t,this.m_impulse)},getreactiontorque:function(t){return="" 0*t},settarget:function(t){0="=this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_targetA.Assign(t)},GetTarget:function(){return" this.m_targeta},setmaxforce:function(t){this.m_maxforce="t},GetMaxForce:function(){return" this.m_maxforce},setfrequency:function(t){this.m_frequencyhz="t},GetFrequency:function(){return" this.m_frequencyhz},setdampingratio:function(t){this.m_dampingratio="t},GetDampingRatio:function(){return" this.m_dampingratio},shiftorigin:function(t){this.m_targeta.subtract(t)},initvelocityconstraints:function(e){this.m_indexb="this.m_bodyB.m_islandIndex,this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var" i="e.positions[this.m_indexB].c.Clone(),n=e.positions[this.m_indexB].a,s=e.velocities[this.m_indexB].v.Clone(),a=e.velocities[this.m_indexB].w,h=new" c(n),l="this.m_bodyB.GetMass(),u=2*Ke*this.m_frequencyHz,d=2*l*this.m_dampingRatio*u,f=l*(u*u),p=e.step.dt;t(d+p*f">Qe),this.m_gamma=p*(d+p*f),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=p*f*this.m_gamma,this.m_rB.Assign(w(h,r.Subtract(this.m_localAnchorB,this.m_localCenterB)));var m=new o;m.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,m.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,m.ey.x=m.ex.y,m.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass.Assign(m.GetInverse()),this.m_C.Assign(r.Subtract(r.Add(i,this.m_rB),this.m_targetA)),this.m_C.Multiply(this.m_beta),a*=.98,e.step.warmStarting?(this.m_impulse.Multiply(e.step.dtRatio),s.Add(r.Multiply(this.m_invMassB,this.m_impulse)),a+=this.m_invIB*_(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),e.velocities[this.m_indexB].v.Assign(s),e.velocities[this.m_indexB].w=a},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexB].v.Clone(),i=t.velocities[this.m_indexB].w,n=r.Add(e,f(i,this.m_rB)),s=p(this.m_mass,r.Add(r.Add(n,this.m_C),r.Multiply(this.m_gamma,this.m_impulse)).Negate()),o=this.m_impulse.Clone();this.m_impulse.Add(s);var a=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>a*a&&this.m_impulse.Multiply(a/this.m_impulse.Length()),s.Assign(r.Subtract(this.m_impulse,o)),e.Add(r.Multiply(this.m_invMassB,s)),i+=this.m_invIB*_(this.m_rB,s),t.velocities[this.m_indexB].v.Assign(e),t.velocities[this.m_indexB].w=i},SolvePositionConstraints:function(t){return!0}},Ie._extend(Ae),Re.prototype={Initialize:function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(n);var s=r.Subtract(n,i);this.length=s.Length()},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.length=t.length,this.frequencyHz=t.frequencyHz,this.dampingRatio=t.dampingRatio}},Re._extend(Ce),Pe.prototype={GetAnchorA:function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},GetAnchorB:function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},GetReactionForce:function(t){var e=r.Multiply(t*this.m_impulse,this.m_u);return e},GetReactionTorque:function(t){return 0},GetLocalAnchorA:function(){return this.m_localAnchorA},GetLocalAnchorB:function(){return this.m_localAnchorB},SetLength:function(t){this.m_length=t},GetLength:function(){return this.m_length},SetFrequency:function(t){this.m_frequencyHz=t},GetFrequency:function(){return this.m_frequencyHz},SetDampingRatio:function(t){this.m_dampingRatio=t},GetDampingRatio:function(){return this.m_dampingRatio},InitVelocityConstraints:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v.Clone(),s=t.velocities[this.m_indexA].w,o=t.positions[this.m_indexB].c.Clone(),a=t.positions[this.m_indexB].a,h=t.velocities[this.m_indexB].v.Clone(),l=t.velocities[this.m_indexB].w,u=new c(i),d=new c(a);this.m_rA=w(u,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=w(d,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),this.m_u=r.Subtract(r.Subtract(r.Add(o,this.m_rB),e),this.m_rA);var f=this.m_u.Length();f>ni?this.m_u.Multiply(1/f):this.m_u.Set(0,0);var p=_(this.m_rA,this.m_u),m=_(this.m_rB,this.m_u),g=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*m*m;if(this.m_mass=0!=g?1/g:0,this.m_frequencyHz>0){var v=f-this.m_length,y=2*Ke*this.m_frequencyHz,x=2*this.m_mass*this.m_dampingRatio*y,T=this.m_mass*y*y,b=t.step.dt;this.m_gamma=b*(x+b*T),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=v*b*T*this.m_gamma,g+=this.m_gamma,this.m_mass=0!=g?1/g:0}else this.m_gamma=0,this.m_bias=0;if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var C=r.Multiply(this.m_impulse,this.m_u);n.Subtract(r.Multiply(this.m_invMassA,C)),s-=this.m_invIA*_(this.m_rA,C),h.Add(r.Multiply(this.m_invMassB,C)),l+=this.m_invIB*_(this.m_rB,C)}else this.m_impulse=0;t.velocities[this.m_indexA].v.Assign(n),t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].v.Assign(h),t.velocities[this.m_indexB].w=l},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=r.Add(e,f(i,this.m_rA)),a=r.Add(n,f(s,this.m_rB)),c=u(this.m_u,r.Subtract(a,o)),h=-this.m_mass*(c+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=h;var l=r.Multiply(h,this.m_u);e.Subtract(r.Multiply(this.m_invMassA,l)),i-=this.m_invIA*_(this.m_rA,l),n.Add(r.Multiply(this.m_invMassB,l)),s+=this.m_invIB*_(this.m_rB,l),t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s},SolvePositionConstraints:function(t){if(this.m_frequencyHz>0)return!0;var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c.Clone(),s=t.positions[this.m_indexB].a,o=new c(i),a=new c(s),h=w(o,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),l=w(a,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),u=r.Subtract(r.Subtract(r.Add(n,l),e),h),d=u.Normalize(),f=d-this.m_length;f=F(f,-hi,hi);var p=-this.m_mass*f,m=r.Multiply(p,u);return e.Subtract(r.Multiply(this.m_invMassA,m)),i-=this.m_invIA*_(h,m),n.Add(r.Multiply(this.m_invMassB,m)),s+=this.m_invIB*_(l,m),t.positions[this.m_indexA].c.Assign(e),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].c.Assign(n),t.positions[this.m_indexB].a=s,Ii(f)<ni},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.length=this.m_length,e.frequencyHz=this.m_frequencyHz,e.dampingRatio=this.m_dampingRatio,e}},Pe._extend(Ae),Oe.prototype={Initialize:function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.localAxisA._deserialize(t.localAxisA),this.referenceAngle=t.referenceAngle,this.enableLimit=t.enableLimit,this.lowerTranslation=t.lowerTranslation,this.upperTranslation=t.upperTranslation,this.enableMotor=t.enableMotor,this.maxMotorForce=t.maxMotorForce,this.motorSpeed=t.motorSpeed}},Oe._extend(Ce),Be.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){return="" r.multiply(t,r.add(r.multiply(this.m_impulse.x,this.m_perp),r.multiply(this.m_motorimpulse+this.m_impulse.z,this.m_axis)))},getreactiontorque:function(t){return="" t*this.m_impulse.y},getlocalanchora:function(){return="" this.m_localanchora},getlocalanchorb:function(){return="" this.m_localanchorb},getlocalaxisa:function(){return="" this.m_localxaxisa},getreferenceangle:function(){return="" this.m_referenceangle},getjointtranslation:function(){var="" t="this.m_bodyA.GetWorldPoint(this.m_localAnchorA),e=this.m_bodyB.GetWorldPoint(this.m_localAnchorB),i=r.Subtract(e,t),n=this.m_bodyA.GetWorldVector(this.m_localXAxisA),s=u(i,n);return" s},getjointspeed:function(){var="" p},islimitenabled:function(){return="" this.m_enablelimit},enablelimit:function(t){t!="this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},GetLowerLimit:function(){return" this.m_lowertranslation},getupperlimit:function(){return="" this.m_uppertranslation},setlimits:function(e,i){t(e<="i),e==this.m_lowerTranslation&&i==this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=i,this.m_impulse.z=0)},IsMotorEnabled:function(){return" this.m_enablemotor},enablemotor:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_enablemotor="t},SetMotorSpeed:function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},GetMotorSpeed:function(){return" this.m_motorspeed},setmaxmotorforce:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_maxmotorforce="t},GetMaxMotorForce:function(){return" this.m_maxmotorforce},getmotorforce:function(t){return="" t*this.m_motorimpulse},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var" c(i),f="new" c(a),p="w(d,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),m=w(f,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),g=r.Add(r.Subtract(o,e),r.Subtract(m,p)),v=this.m_invMassA,y=this.m_invMassB,x=this.m_invIA,T=this.m_invIB;this.m_axis=w(d,this.m_localXAxisA),this.m_a1=_(r.Add(g,p),this.m_axis),this.m_a2=_(m,this.m_axis),this.m_motorMass=v+y+x*this.m_a1*this.m_a1+T*this.m_a2*this.m_a2,this.m_motorMass">0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=w(d,this.m_localYAxisA),this.m_s1=_(r.Add(g,p),this.m_perp),this.m_s2=_(m,this.m_perp);var b=v+y+x*this.m_s1*this.m_s1+T*this.m_s2*this.m_s2,C=x*this.m_s1+T*this.m_s2,A=x*this.m_s1*this.m_a1+T*this.m_s2*this.m_a2,S=x+T;0==S&&(S=1);var E=x*this.m_a1+T*this.m_a2,I=v+y+x*this.m_a1*this.m_a1+T*this.m_a2*this.m_a2;if(this.m_K.ex.Set(b,C,A),this.m_K.ey.Set(C,S,E),this.m_K.ez.Set(A,E,I),this.m_enableLimit){var R=u(this.m_axis,g);Ii(this.m_upperTranslation-this.m_lowerTranslation)<2*ni?this.m_limitstate=ae.e_equallimits:r<=this.m_lowertranslation?this.m_limitstate!=ae.e_atlowerlimit&&(this.m_limitstate=ae.e_atlowerlimit,this.m_impulse.z=0):r>=this.m_upperTranslation?this.m_limitState!=Ae.e_atUpperLimit&&(this.m_limitState=Ae.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=Ae.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=Ae.e_inactiveLimit,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse.Multiply(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var P=r.Add(r.Multiply(this.m_impulse.x,this.m_perp),r.Multiply(this.m_motorImpulse+this.m_impulse.z,this.m_axis)),O=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,B=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.Subtract(r.Multiply(v,P)),s-=x*O,h.Add(r.Multiply(y,P)),l+=T*B}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].v.Assign(n),t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].v.Assign(h),t.velocities[this.m_indexB].w=l},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),o=t.velocities[this.m_indexB].w,a=this.m_invMassA,c=this.m_invMassB,h=this.m_invIA,l=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=Ae.e_equalLimits){var _=u(this.m_axis,r.Subtract(n,e))+this.m_a2*o-this.m_a1*i,d=this.m_motorMass*(this.m_motorSpeed-_),f=this.m_motorImpulse,p=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=F(this.m_motorImpulse+d,-p,p),d=this.m_motorImpulse-f;var m=r.Multiply(d,this.m_axis),g=d*this.m_a1,v=d*this.m_a2;e.Subtract(r.Multiply(a,m)),i-=h*g,n.Add(r.Multiply(c,m)),o+=l*v}var y=new r;if(y.x=u(this.m_perp,r.Subtract(n,e))+this.m_s2*o-this.m_s1*i,y.y=o-i,this.m_enableLimit&&this.m_limitState!=Ae.e_inactiveLimit){var x;x=u(this.m_axis,r.Subtract(n,e))+this.m_a2*o-this.m_a1*i;var _=new s(y.x,y.y,x),T=this.m_impulse.Clone(),b=this.m_K.Solve33(_.Negate());this.m_impulse.Add(b),this.m_limitState==Ae.e_atLowerLimit?this.m_impulse.z=Pi(this.m_impulse.z,0):this.m_limitState==Ae.e_atUpperLimit&&(this.m_impulse.z=Ri(this.m_impulse.z,0));var C=r.Subtract(y.Negate(),r.Multiply(this.m_impulse.z-T.z,new r(this.m_K.ez.x,this.m_K.ez.y))),A=r.Add(this.m_K.Solve22(C),new r(T.x,T.y));this.m_impulse.x=A.x,this.m_impulse.y=A.y,b=s.Subtract(this.m_impulse,T);var m=r.Add(r.Multiply(b.x,this.m_perp),r.Multiply(b.z,this.m_axis)),g=b.x*this.m_s1+b.y+b.z*this.m_a1,v=b.x*this.m_s2+b.y+b.z*this.m_a2;e.Subtract(r.Multiply(a,m)),i-=h*g,n.Add(r.Multiply(c,m)),o+=l*v}else{var b=this.m_K.Solve22(y.Negate());this.m_impulse.x+=b.x,this.m_impulse.y+=b.y;var m=r.Multiply(b.x,this.m_perp),g=b.x*this.m_s1+b.y,v=b.x*this.m_s2+b.y;e.Subtract(r.Multiply(a,m)),i-=h*g,n.Add(r.Multiply(c,m)),o+=l*v}t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=o},SolvePositionConstraints:function(t){var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c.Clone(),h=t.positions[this.m_indexB].a,l=new c(i),d=new c(h),f=this.m_invMassA,p=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,v=w(l,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),y=w(d,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),x=r.Subtract(r.Subtract(r.Add(n,y),e),v),T=w(l,this.m_localXAxisA),b=_(r.Add(x,v),T),C=_(y,T),A=w(l,this.m_localYAxisA),S=_(r.Add(x,v),A),E=_(y,A),I=new s,R=new r;R.x=u(A,x),R.y=h-i-this.m_referenceAngle;var P=Ii(R.x),O=Ii(R.y),B=!1,D=0;if(this.m_enableLimit){var M=u(T,x);Ii(this.m_upperTranslation-this.m_lowerTranslation)<2*ni?(d=f(m,-hi,hi),p=pi(p,ii(m)),b=!0):m<=this.m_lowertranslation?(d=f(m-this.m_lowertranslation+ni,-hi,0),p=pi(p,this.m_lowertranslation-m),b=!0):m>=this.m_upperTranslation&&(D=F(M-this.m_upperTranslation-ni,0,hi),P=Pi(P,M-this.m_upperTranslation),B=!0)}if(B){var L=f+p+m*S*S+g*E*E,N=m*S+g*E,k=m*S*b+g*E*C,z=m+g;0==z&&(z=1);var V=m*b+g*C,G=f+p+m*b*b+g*C*C,W=new a;W.ex.Set(L,N,k),W.ey.Set(N,z,V),W.ez.Set(k,V,G);var U=new s;U.x=R.x,U.y=R.y,U.z=D,I=W.Solve33(U.Negate())}else{var L=f+p+m*S*S+g*E*E,N=m*S+g*E,z=m+g;0==z&&(z=1);var W=new o;W.ex.Set(L,N),W.ey.Set(N,z);var j=W.Solve(R.Negate());I.x=j.x,I.y=j.y,I.z=0}var X=r.Add(r.Multiply(I.x,A),r.Multiply(I.z,T)),Y=I.x*S+I.y+I.z*b,H=I.x*E+I.y+I.z*C;return e.Subtract(r.Multiply(f,X)),i-=m*Y,n.Add(r.Multiply(p,X)),h+=g*H,t.positions[this.m_indexA].c.Assign(e),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].c.Assign(n),t.positions[this.m_indexB].a=h,P<=ni&&o<=ri},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.localAxisA=this.m_localXAxisA._serialize(),e.referenceAngle=this.m_referenceAngle,e.enableLimit=this.m_enableLimit,e.lowerTranslation=this.m_lowerTranslation,e.upperTranslation=this.m_upperTranslation,e.enableMotor=this.m_enableMotor,e.maxMotorForce=this.m_maxMotorForce,e.motorSpeed=this.m_motorSpeed,e}},Be._extend(Ae),De.prototype={Initialize:function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.Assign(this.bodyA.GetLocalPoint(i)),this.localAnchorB.Assign(this.bodyB.GetLocalPoint(i))},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.maxForce=t.maxForce,this.maxTorque=t.maxTorque}},De._extend(Ce),Me.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){return="" r.multiply(t,this.m_linearimpulse)},getreactiontorque:function(t){return="" t*this.m_angularimpulse},getlocalanchora:function(){return="" this.m_localanchora},getlocalanchorb:function(){return="" this.m_localanchorb},setmaxforce:function(e){t(n(e)&&e="">=0),this.m_maxForce=e},GetMaxForce:function(){return this.m_maxForce},SetMaxTorque:function(e){t(n(e)&&e>=0),this.m_maxTorque=e},GetMaxTorque:function(){return this.m_maxTorque},InitVelocityConstraints:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v.Clone(),n=t.velocities[this.m_indexA].w,s=t.positions[this.m_indexB].a,a=t.velocities[this.m_indexB].v.Clone(),h=t.velocities[this.m_indexB].w,l=new c(e),u=new c(s);this.m_rA=w(l,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=w(u,r.Subtract(this.m_localAnchorB,this.m_localCenterB));var d=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,m=this.m_invIB,g=new o;if(g.ex.x=d+f+p*this.m_rA.y*this.m_rA.y+m*this.m_rB.y*this.m_rB.y,g.ex.y=-p*this.m_rA.x*this.m_rA.y-m*this.m_rB.x*this.m_rB.y,g.ey.x=g.ex.y,g.ey.y=d+f+p*this.m_rA.x*this.m_rA.x+m*this.m_rB.x*this.m_rB.x,this.m_linearMass=g.GetInverse(),this.m_angularMass=p+m,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.step.warmStarting){this.m_linearImpulse.Multiply(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;var v=new r(this.m_linearImpulse.x,this.m_linearImpulse.y);i.Subtract(r.Multiply(d,v)),n-=p*(_(this.m_rA,v)+this.m_angularImpulse),a.Add(r.Multiply(f,v)),h+=m*(_(this.m_rB,v)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].v.Assign(i),t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].v.Assign(a),t.velocities[this.m_indexB].w=h},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=this.m_invMassA,a=this.m_invMassB,c=this.m_invIA,h=this.m_invIB,l=t.step.dt,u=s-i,d=-this.m_angularMass*u,m=this.m_angularImpulse,g=l*this.m_maxTorque;this.m_angularImpulse=F(this.m_angularImpulse+d,-g,g),d=this.m_angularImpulse-m,i-=c*d,s+=h*d;var u=r.Add(n,r.Subtract(f(s,this.m_rB),r.Subtract(e,f(i,this.m_rA)))),d=p(this.m_linearMass,u).Negate(),m=this.m_linearImpulse.Clone();this.m_linearImpulse.Add(d);var g=l*this.m_maxForce;this.m_linearImpulse.LengthSquared()>g*g&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(g)),d=r.Subtract(this.m_linearImpulse,m),e.Subtract(r.Multiply(o,d)),i-=c*_(this.m_rA,d),n.Add(r.Multiply(a,d)),s+=h*_(this.m_rB,d),t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s},SolvePositionConstraints:function(t){return!0},_serialize:function(t){var e=t||{};return this.parent.prototype._serialize.call(this,e),e.localAnchorA=this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.maxForce=this.m_maxForce,e.maxTorque=this.m_maxTorque,e}},Me._extend(Ae),Le.prototype={Initialize:function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.Assign(this.bodyA.GetLocalPoint(i)),this.localAnchorB.Assign(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.referenceAngle=t.referenceAngle,this.frequencyHz=t.frequencyHz,this.dampingRatio=t.dampingRatio}},Le._extend(Ce),Ne.prototype={GetAnchorA:function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},GetAnchorB:function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},GetReactionForce:function(t){var e=new r(this.m_impulse.x,this.m_impulse.y);return r.Multiply(t,e)},GetReactionTorque:function(t){return t*this.m_impulse.z},GetLocalAnchorA:function(){return this.m_localAnchorA},GetLocalAnchorB:function(){return this.m_localAnchorB},GetReferenceAngle:function(){return this.m_referenceAngle},SetFrequency:function(t){this.m_frequencyHz=t},GetFrequency:function(){return this.m_frequencyHz},SetDampingRatio:function(t){this.m_dampingRatio=t},GetDampingRatio:function(){return this.m_dampingRatio},InitVelocityConstraints:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v.Clone(),n=t.velocities[this.m_indexA].w,s=t.positions[this.m_indexB].a,o=t.velocities[this.m_indexB].v.Clone(),h=t.velocities[this.m_indexB].w,l=new c(e),u=new c(s);this.m_rA.Assign(w(l,r.Subtract(this.m_localAnchorA,this.m_localCenterA))),this.m_rB.Assign(w(u,r.Subtract(this.m_localAnchorB,this.m_localCenterB)));var d=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,m=this.m_invIB,g=new a;if(g.ex.x=d+f+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*m,g.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*m,g.ez.x=-this.m_rA.y*p-this.m_rB.y*m,g.ex.y=g.ey.x,g.ey.y=d+f+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*m,g.ez.y=this.m_rA.x*p+this.m_rB.x*m,g.ex.z=g.ez.x,g.ey.z=g.ez.y,g.ez.z=p+m,this.m_frequencyHz>0){g.GetInverse22(this.m_mass);var v=p+m,y=v>0?1/v:0,x=s-e-this.m_referenceAngle,T=2*Ke*this.m_frequencyHz,b=2*y*this.m_dampingRatio*T,C=y*T*T,A=t.step.dt;this.m_gamma=A*(b+A*C),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=x*A*C*this.m_gamma,v+=this.m_gamma,this.m_mass.ez.z=0!=v?1/v:0}else 0==g.ez.z?(g.GetInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(g.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.step.warmStarting){this.m_impulse.Multiply(t.step.dtRatio);var S=new r(this.m_impulse.x,this.m_impulse.y);i.Subtract(r.Multiply(d,S)),n-=p*(_(this.m_rA,S)+this.m_impulse.z),o.Add(r.Multiply(f,S)),h+=m*(_(this.m_rB,S)+this.m_impulse.z)}else this.m_impulse.SetZero();t.velocities[this.m_indexA].v.Assign(i),t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].v.Assign(o),t.velocities[this.m_indexB].w=h},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),o=t.velocities[this.m_indexB].w,a=this.m_invMassA,c=this.m_invMassB,h=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){var u=o-i,d=-this.m_mass.ez.z*(u+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=d,i-=h*d,o+=l*d;var p=r.Subtract(r.Subtract(r.Add(n,f(o,this.m_rB)),e),f(i,this.m_rA)),m=A(this.m_mass,p).Negate();this.m_impulse.x+=m.x,this.m_impulse.y+=m.y;var g=m.Clone();e.Subtract(r.Multiply(a,g)),i-=h*_(this.m_rA,g),n.Add(r.Multiply(c,g)),o+=l*_(this.m_rB,g)}else{var p=r.Subtract(r.Subtract(r.Add(n,f(o,this.m_rB)),e),f(i,this.m_rA)),u=o-i,v=new s(p.x,p.y,u),y=C(this.m_mass,v).Negate();this.m_impulse.Add(y);var g=new r(y.x,y.y);e.Subtract(r.Multiply(a,g)),i-=h*(_(this.m_rA,g)+y.z),n.Add(r.Multiply(c,g)),o+=l*(_(this.m_rB,g)+y.z)}t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=o},SolvePositionConstraints:function(t){var e,i,n=t.positions[this.m_indexA].c.Clone(),o=t.positions[this.m_indexA].a,h=t.positions[this.m_indexB].c.Clone(),l=t.positions[this.m_indexB].a,u=new c(o),d=new c(l),f=this.m_invMassA,p=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,v=w(u,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),y=w(d,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),x=new a;if(x.ex.x=f+p+v.y*v.y*m+y.y*y.y*g,x.ey.x=-v.y*v.x*m-y.y*y.x*g,x.ez.x=-v.y*m-y.y*g,x.ex.y=x.ey.x,x.ey.y=f+p+v.x*v.x*m+y.x*y.x*g,x.ez.y=v.x*m+y.x*g,x.ex.z=x.ez.x,x.ey.z=x.ez.y,x.ez.z=m+g,this.m_frequencyHz>0){var T=r.Subtract(r.Subtract(r.Add(h,y),n),v);e=T.Length(),i=0;var b=x.Solve22(T).Negate();n.Subtract(r.Multiply(f,b)),o-=m*_(v,b),h.Add(r.Multiply(p,b)),l+=g*_(y,b)}else{var T=r.Subtract(r.Subtract(r.Add(h,y),n),v),C=l-o-this.m_referenceAngle;e=T.Length(),i=Ii(C);var A,S=new s(T.x,T.y,C);if(x.ez.z>0)A=x.Solve33(S).Invert();else{
var E=x.Solve22(T).Invert();A=new s(E.x,E.y,0)}var b=new r(A.x,A.y);n.Subtract(r.Multiply(f,b)),o-=m*(_(v,b)+A.z),h.Add(r.Multiply(p,b)),l+=g*(_(y,b)+A.z)}return t.positions[this.m_indexA].c.Assign(n),t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].c.Assign(h),t.positions[this.m_indexB].a=l,e<=ni&&i<=ri},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.referenceAngle=this.m_referenceAngle,e.frequencyHz=this.m_frequencyHz,e.dampingRatio=this.m_dampingRatio,e}},Ne._extend(Ae),Fe.prototype={Initialize:function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.Assign(this.bodyA.GetLocalPoint(i)),this.localAnchorB.Assign(this.bodyB.GetLocalPoint(i)),this.localAxisA.Assign(this.bodyA.GetLocalVector(n))},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.localAxisA._deserialize(t.localAxisA),this.enableMotor=t.enableMotor,this.maxMotorTorque=t.maxMotorTorque,this.motorSpeed=t.motorSpeed,this.frequencyHz=t.frequencyHz,this.dampingRatio=t.dampingRatio}},Fe._extend(Ce),ke.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){return="" r.multiply(t,r.add(r.multiply(this.m_impulse,this.m_ay),r.multiply(this.m_springimpulse,this.m_ax)))},getreactiontorque:function(t){return="" t*this.m_motorimpulse},getlocalanchora:function(){return="" this.m_localanchora},getlocalanchorb:function(){return="" this.m_localanchorb},getlocalaxisa:function(){return="" this.m_localxaxisa},getjointtranslation:function(){var="" t="this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchorA),n=e.GetWorldPoint(this.m_localAnchorB),s=r.Subtract(n,i),o=t.GetWorldVector(this.m_localXAxisA),a=u(s,o);return" a},getjointspeed:function(){var="" e-t},ismotorenabled:function(){return="" this.m_enablemotor},enablemotor:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_enablemotor="t},SetMotorSpeed:function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},GetMotorSpeed:function(){return" this.m_motorspeed},setmaxmotortorque:function(t){this.m_bodya.setawake(!0),this.m_bodyb.setawake(!0),this.m_maxmotortorque="t},GetMaxMotorTorque:function(){return" this.m_maxmotortorque},getmotortorque:function(t){return="" t*this.m_motorimpulse},setspringfrequencyhz:function(t){this.m_frequencyhz="t},GetSpringFrequencyHz:function(){return" this.m_frequencyhz},setspringdampingratio:function(t){this.m_dampingratio="t},GetSpringDampingRatio:function(){return" this.m_dampingratio},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var" c(a),v="new" c(f),y="w(g,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),x=w(v,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),T=r.Subtract(r.Subtract(r.Add(d,x),o),y);if(this.m_ay.Assign(w(g,this.m_localYAxisA)),this.m_sAy=_(r.Add(T,y),this.m_ay),this.m_sBy=_(x,this.m_ay),this.m_mass=e+i+n*this.m_sAy*this.m_sAy+s*this.m_sBy*this.m_sBy,this.m_mass">0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax.Assign(w(g,this.m_localXAxisA)),this.m_sAx=_(r.Add(T,y),this.m_ax),this.m_sBx=_(x,this.m_ax);var b=e+i+n*this.m_sAx*this.m_sAx+s*this.m_sBx*this.m_sBx;if(b>0){this.m_springMass=1/b;var C=u(T,this.m_ax),A=2*Ke*this.m_frequencyHz,T=2*this.m_springMass*this.m_dampingRatio*A,S=this.m_springMass*A*A,E=t.step.dt;this.m_gamma=E*(T+E*S),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=C*E*S*this.m_gamma,this.m_springMass=b+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=n+s,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio;var I=r.Add(r.Multiply(this.m_impulse,this.m_ay),r.Multiply(this.m_springImpulse,this.m_ax)),R=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,P=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;h.Subtract(r.Multiply(this.m_invMassA,I)),l-=this.m_invIA*R,p.Add(r.Multiply(this.m_invMassB,I)),m+=this.m_invIB*P}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;t.velocities[this.m_indexA].v.Assign(h),t.velocities[this.m_indexA].w=l,t.velocities[this.m_indexB].v.Assign(p),t.velocities[this.m_indexB].w=m},SolveVelocityConstraints:function(t){var e=this.m_invMassA,i=this.m_invMassB,n=this.m_invIA,s=this.m_invIB,o=t.velocities[this.m_indexA].v.Clone(),a=t.velocities[this.m_indexA].w,c=t.velocities[this.m_indexB].v.Clone(),h=t.velocities[this.m_indexB].w,l=u(this.m_ax,r.Subtract(c,o))+this.m_sBx*h-this.m_sAx*a,_=-this.m_springMass*(l+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=_;var d=r.Multiply(_,this.m_ax),f=_*this.m_sAx,p=_*this.m_sBx;o.Subtract(r.Multiply(e,d)),a-=n*f,c.Add(r.Multiply(i,d)),h+=s*p;var l=h-a-this.m_motorSpeed,_=-this.m_motorMass*l,m=this.m_motorImpulse,g=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=F(this.m_motorImpulse+_,-g,g),_=this.m_motorImpulse-m,a-=n*_,h+=s*_;var l=u(this.m_ay,r.Subtract(c,o))+this.m_sBy*h-this.m_sAy*a,_=-this.m_mass*l;this.m_impulse+=_;var d=r.Multiply(_,this.m_ay),f=_*this.m_sAy,p=_*this.m_sBy;o.Subtract(r.Multiply(e,d)),a-=n*f,c.Add(r.Multiply(i,d)),h+=s*p,t.velocities[this.m_indexA].v.Assign(o),t.velocities[this.m_indexA].w=a,t.velocities[this.m_indexB].v.Assign(c),t.velocities[this.m_indexB].w=h},SolvePositionConstraints:function(t){var e,i=t.positions[this.m_indexA].c.Clone(),n=t.positions[this.m_indexA].a,s=t.positions[this.m_indexB].c.Clone(),o=t.positions[this.m_indexB].a,a=new c(n),h=new c(o),l=w(a,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),d=w(h,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),f=r.Add(r.Subtract(s,i),r.Subtract(d,l)),p=w(a,this.m_localYAxisA),m=_(r.Add(f,l),p),g=_(d,p),v=u(f,p),y=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;e=0!=y?-v/y:0;var x=r.Multiply(e,p),T=e*m,b=e*g;return i.Subtract(r.Multiply(this.m_invMassA,x)),n-=this.m_invIA*T,s.Add(r.Multiply(this.m_invMassB,x)),o+=this.m_invIB*b,t.positions[this.m_indexA].c.Assign(i),t.positions[this.m_indexA].a=n,t.positions[this.m_indexB].c.Assign(s),t.positions[this.m_indexB].a=o,Ii(v)<=ni},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.localAxisA=this.m_localAxisA._serialize(),e.enableMotor=this.m_enableMotor,e.maxMotorTorque=this.m_maxMotorTorque,e.motorSpeed=this.m_motorSpeed,e.frequencyHz=this.m_frequencyHz,e.dampingRatio=this.m_dampingRatio,e}},ke._extend(Ae),ze.prototype={_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.joint1=t.joint1,this.joint2=t.joint2,this.ratio=t.ratio}},ze._extend(Ce),Ve.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){var="" r.multiply(t,e)},getreactiontorque:function(t){var="" t*e},getjoint1:function(){return="" this.m_joint1},getjoint2:function(){return="" this.m_joint2},setratio:function(e){t(n(e)),this.m_ratio="e},GetRatio:function(){return" this.m_ratio},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Assign(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Assign(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var" c(e),g="new" c(s),v="new" c(h),y="new" c(d);if(this.m_mass="0,this.m_typeA==Ae.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var" x="w(v,this.m_localAxisC),T=w(v,r.Subtract(this.m_localAnchorC,this.m_lcC)),b=w(m,r.Subtract(this.m_localAnchorA,this.m_lcA));this.m_JvAC.Assign(x),this.m_JwC=_(T,x),this.m_JwA=_(b,x),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB==Ae.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var">0?1/this.m_mass:0,t.step.warmStarting?(i.Add(r.Multiply(this.m_mA*this.m_impulse,this.m_JvAC)),n+=this.m_iA*this.m_impulse*this.m_JwA,o.Add(r.Multiply(this.m_mB*this.m_impulse,this.m_JvBD)),a+=this.m_iB*this.m_impulse*this.m_JwB,l.Subtract(r.Multiply(this.m_mC*this.m_impulse,this.m_JvAC)),u-=this.m_iC*this.m_impulse*this.m_JwC,f.Subtract(r.Multiply(this.m_mD*this.m_impulse,this.m_JvBD)),p-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,t.velocities[this.m_indexA].v.Assign(i),t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].v.Assign(o),t.velocities[this.m_indexB].w=a,t.velocities[this.m_indexC].v.Assign(l),t.velocities[this.m_indexC].w=u,t.velocities[this.m_indexD].v.Assign(f),t.velocities[this.m_indexD].w=p},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=t.velocities[this.m_indexC].v.Clone(),a=t.velocities[this.m_indexC].w,c=t.velocities[this.m_indexD].v.Clone(),h=t.velocities[this.m_indexD].w,l=u(this.m_JvAC,r.Subtract(e,o))+u(this.m_JvBD,r.Subtract(n,c));l+=this.m_JwA*i-this.m_JwC*a+(this.m_JwB*s-this.m_JwD*h);var _=-this.m_mass*l;this.m_impulse+=_,e.Add(r.Multiply(this.m_mA*_,this.m_JvAC)),i+=this.m_iA*_*this.m_JwA,n.Add(r.Multiply(this.m_mB*_,this.m_JvBD)),s+=this.m_iB*_*this.m_JwB,o.Subtract(r.Multiply(this.m_mC*_,this.m_JvAC)),a-=this.m_iC*_*this.m_JwC,c.Subtract(r.Multiply(this.m_mD*_,this.m_JvBD)),h-=this.m_iD*_*this.m_JwD,t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s,t.velocities[this.m_indexC].v.Assign(o),t.velocities[this.m_indexC].w=a,t.velocities[this.m_indexD].v.Assign(c),t.velocities[this.m_indexD].w=h},SolvePositionConstraints:function(t){var e,i,n,s,o,a,h=t.positions[this.m_indexA].c.Clone(),l=t.positions[this.m_indexA].a,d=t.positions[this.m_indexB].c.Clone(),f=t.positions[this.m_indexB].a,p=t.positions[this.m_indexC].c.Clone(),m=t.positions[this.m_indexC].a,g=t.positions[this.m_indexD].c.Clone(),v=t.positions[this.m_indexD].a,y=new c(l),x=new c(f),T=new c(m),b=new c(v),C=0,A=new r,S=new r,E=0;if(this.m_typeA==Ae.e_revoluteJoint)A.SetZero(),n=1,o=1,E+=this.m_iA+this.m_iC,e=l-m-this.m_referenceAngleA;else{var R=w(T,this.m_localAxisC),P=w(T,r.Subtract(this.m_localAnchorC,this.m_lcC)),O=w(y,r.Subtract(this.m_localAnchorA,this.m_lcA));A.Assign(R),o=_(P,R),n=_(O,R),E+=this.m_mC+this.m_mA+this.m_iC*o*o+this.m_iA*n*n;var B=r.Subtract(this.m_localAnchorC,this.m_lcC),D=I(T,r.Add(O,r.Subtract(h,p)));e=u(r.Subtract(D,B),this.m_localAxisC)}if(this.m_typeB==Ae.e_revoluteJoint)S.SetZero(),s=this.m_ratio,a=this.m_ratio,E+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=f-v-this.m_referenceAngleB;else{var R=w(b,this.m_localAxisD),M=w(b,r.Subtract(this.m_localAnchorD,this.m_lcD)),L=w(x,r.Subtract(this.m_localAnchorB,this.m_lcB));S.Assign(r.Multiply(this.m_ratio,R)),a=this.m_ratio*_(M,R),s=this.m_ratio*_(L,R),E+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*a*a+this.m_iB*s*s;var N=r.Subtract(this.m_localAnchorD,this.m_lcD),F=I(b,r.Add(L,r.Subtract(d,g)));i=u(r.Subtract(F,N),this.m_localAxisD)}var k=e+this.m_ratio*i-this.m_constant,z=0;return E>0&&(z=-k/E),h.Add(r.Multiply(this.m_mA,r.Multiply(z,A))),l+=this.m_iA*z*n,d.Add(r.Multiply(this.m_mB,r.Multiply(z,S))),f+=this.m_iB*z*s,p.Subtract(r.Multiply(this.m_mC,r.Multiply(z,A))),m-=this.m_iC*z*o,g.Subtract(r.Multiply(this.m_mD,r.Multiply(z,S))),v-=this.m_iD*z*a,t.positions[this.m_indexA].c.Assign(h),t.positions[this.m_indexA].a=l,t.positions[this.m_indexB].c.Assign(d),t.positions[this.m_indexB].a=f,t.positions[this.m_indexC].c.Assign(p),t.positions[this.m_indexC].a=m,t.positions[this.m_indexD].c.Assign(g),t.positions[this.m_indexD].a=v,C<ni},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.joint1="this.m_joint1.__temp_joint_id,e.joint2=this.m_joint2.__temp_joint_id,e.ratio=this.m_ratio,e}},Ve._extend(Ae),Ge.prototype={Initialize:function(t,e){this.bodyA=t,this.bodyB=e;var" i="this.bodyB.GetPosition();this.linearOffset.Assign(this.bodyA.GetLocalPoint(i));var" n="this.bodyA.GetAngle(),r=this.bodyB.GetAngle();this.angularOffset=r-n},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.linearOffset._deserialize(t.linearOffset),this.angularOffset=t.angularOffset,this.maxForce=t.maxForce,this.maxTorque=t.maxTorque,this.correctionFactor=t.correctionFactor}},Ge._extend(Ce),We.prototype={GetAnchorA:function(){return" this.m_bodya.getposition()},getanchorb:function(){return="" this.m_bodyb.getposition()},getreactionforce:function(t){return="" r.multiply(t,this.m_linearimpulse)},getreactiontorque:function(t){return="" t*this.m_angularimpulse},setlinearoffset:function(t){t.x="=this.m_linearOffset.x&&t.y==this.m_linearOffset.y||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Assign(t))},GetLinearOffset:function(){return" this.m_linearoffset},setangularoffset:function(t){t!="this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)},GetAngularOffset:function(){return" this.m_angularoffset},setmaxforce:function(e){t(n(e)&&e="">=0),this.m_maxForce=e},GetMaxForce:function(){return this.m_maxForce},SetMaxTorque:function(e){t(n(e)&&e>=0),this.m_maxTorque=e},GetMaxTorque:function(){return this.m_maxTorque},SetCorrectionFactor:function(e){t(n(e)&&0<=e&&e<=1),this.m_correctionfactor=e},getcorrectionfactor:function(){return this.m_correctionfactor},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var" e="t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v.Clone(),s=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].c.Clone(),h=t.positions[this.m_indexB].a,l=t.velocities[this.m_indexB].v.Clone(),u=t.velocities[this.m_indexB].w,d=new" c(i),f="new" c(h);this.m_ra.assign(w(d,this.m_localcentera.negate())),this.m_rb.assign(w(f,this.m_localcenterb.negate()));var="" p="this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,v=this.m_invIB,y=new" o;if(y.ex.x="p+m+g*this.m_rA.y*this.m_rA.y+v*this.m_rB.y*this.m_rB.y,y.ex.y=-g*this.m_rA.x*this.m_rA.y-v*this.m_rB.x*this.m_rB.y,y.ey.x=y.ex.y,y.ey.y=p+m+g*this.m_rA.x*this.m_rA.x+v*this.m_rB.x*this.m_rB.x,this.m_linearMass.Assign(y.GetInverse()),this.m_angularMass=g+v,this.m_angularMass">0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError.x=a.x+this.m_rB.x-e.x-this.m_rA.x-(d.c*this.m_linearOffset.x-d.s*this.m_linearOffset.y),this.m_linearError.y=a.y+this.m_rB.y-e.y-this.m_rA.y-(d.s*this.m_linearOffset.x+d.c*this.m_linearOffset.y),this.m_angularError=h-i-this.m_angularOffset,t.step.warmStarting){this.m_linearImpulse.Multiply(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;var x=new r(this.m_linearImpulse.x,this.m_linearImpulse.y);n.Subtract(r.Multiply(p,x)),s-=g*(_(this.m_rA,x)+this.m_angularImpulse),l.Add(r.Multiply(m,x)),u+=v*(_(this.m_rB,x)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].v.Assign(n),t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].v.Assign(l),t.velocities[this.m_indexB].w=u},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=this.m_invMassA,a=this.m_invMassB,c=this.m_invIA,h=this.m_invIB,l=t.step.dt,u=t.step.inv_dt,d=s-i+u*this.m_correctionFactor*this.m_angularError,f=-this.m_angularMass*d,m=this.m_angularImpulse,g=l*this.m_maxTorque;this.m_angularImpulse=F(this.m_angularImpulse+f,-g,g),f=this.m_angularImpulse-m,i-=c*f,s+=h*f;var d=new r(n.x+-s*this.m_rB.x-e.x- -i*this.m_rA.x+u*this.m_correctionFactor*this.m_linearError.x,n.y+s*this.m_rB.y-e.y-i*this.m_rA.y+u*this.m_correctionFactor*this.m_linearError.y),f=p(this.m_linearMass,d).Negate(),m=this.m_linearImpulse.Clone();this.m_linearImpulse.Add(f);var g=l*this.m_maxForce;this.m_linearImpulse.LengthSquared()>g*g&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(g)),f.Assign(r.Subtract(this.m_linearImpulse,m)),e.Subtract(r.Multiply(o,f)),i-=c*_(this.m_rA,f),n.Add(r.Multiply(a,f)),s+=h*_(this.m_rB,f),t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s},SolvePositionConstraints:function(t){return!0},_serialize:function(t){var e=t||{};return this.parent.prototype._serialize.call(this,e),e.linearOffset=this.m_linearOffset._serialize(),e.angularOffset=this.m_angularOffset,e.maxForce=this.m_maxForce,e.maxTorque=this.m_maxTorque,e.correctionFactor=this.m_correctionFactor,e}},We._extend(Ae);Ue.prototype={Initialize:function(e,i,n,s,o,a,c){this.bodyA=e,this.bodyB=i,this.groundAnchorA.Assign(n),this.groundAnchorB.Assign(s),this.localAnchorA.Assign(this.bodyA.GetLocalPoint(o)),this.localAnchorB.Assign(this.bodyB.GetLocalPoint(a));var h=r.Subtract(o,n);this.lengthA=h.Length();var l=r.Subtract(a,s);this.lengthB=l.Length(),this.ratio=c,t(this.ratio>Qe)},_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.groundAnchorA._deserialize(t.groundAnchorA),this.groundAnchorB._deserialize(t.groundAnchorB),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.lengthA=t.lengthA,this.lengthB=t.lengthB,this.ratio=t.ratio}},Ue._extend(Ce),je.prototype={GetAnchorA:function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},GetAnchorB:function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},GetReactionForce:function(t){var e=r.Multiply(this.m_impulse,this.m_uB);return r.Multiply(t,e)},GetReactionTorque:function(t){return 0},GetGroundAnchorA:function(){return this.m_groundAnchorA},GetGroundAnchorB:function(){return this.m_groundAnchorB},GetLengthA:function(){return this.m_lengthA},GetLengthB:function(){return this.m_lengthB},GetRatio:function(){return this.m_ratio},GetCurrentLengthA:function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA,i=r.Subtract(t,e);return i.Length()},GetCurrentLengthB:function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB,i=r.Subtract(t,e);return i.Length()},ShiftOrigin:function(t){this.m_groundAnchorA.Subtract(t),this.m_groundAnchorB.Subtract(t)},InitVelocityConstraints:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v.Clone(),s=t.velocities[this.m_indexA].w,o=t.positions[this.m_indexB].c.Clone(),a=t.positions[this.m_indexB].a,h=t.velocities[this.m_indexB].v.Clone(),l=t.velocities[this.m_indexB].w,u=new c(i),d=new c(a);this.m_rA.Assign(w(u,r.Subtract(this.m_localAnchorA,this.m_localCenterA))),this.m_rB.Assign(w(d,r.Subtract(this.m_localAnchorB,this.m_localCenterB))),this.m_uA.Assign(r.Add(e,r.Subtract(this.m_rA,this.m_groundAnchorA))),this.m_uB.Assign(r.Add(o,r.Subtract(this.m_rB,this.m_groundAnchorB)));var f=this.m_uA.Length(),p=this.m_uB.Length();f>10*ni?this.m_uA.Multiply(1/f):this.m_uA.SetZero(),p>10*ni?this.m_uB.Multiply(1/p):this.m_uB.SetZero();var m=_(this.m_rA,this.m_uA),g=_(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*m*m,y=this.m_invMassB+this.m_invIB*g*g;if(this.m_mass=v+this.m_ratio*this.m_ratio*y,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var x=r.Multiply(-this.m_impulse,this.m_uA),T=r.Multiply(-this.m_ratio*this.m_impulse,this.m_uB);n.Add(r.Multiply(this.m_invMassA,x)),s+=this.m_invIA*_(this.m_rA,x),h.Add(r.Multiply(this.m_invMassB,T)),l+=this.m_invIB*_(this.m_rB,T)}else this.m_impulse=0;t.velocities[this.m_indexA].v.Assign(n),t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].v.Assign(h),t.velocities[this.m_indexB].w=l},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=r.Add(e,f(i,this.m_rA)),a=r.Add(n,f(s,this.m_rB)),c=-u(this.m_uA,o)-this.m_ratio*u(this.m_uB,a),h=-this.m_mass*c;this.m_impulse+=h;var l=r.Multiply(-h,this.m_uA),d=r.Multiply(-this.m_ratio,r.Multiply(h,this.m_uB));e.Add(r.Multiply(this.m_invMassA,l)),i+=this.m_invIA*_(this.m_rA,l),n.Add(r.Multiply(this.m_invMassB,d)),s+=this.m_invIB*_(this.m_rB,d),t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s},SolvePositionConstraints:function(t){var e=t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c.Clone(),s=t.positions[this.m_indexB].a,o=new c(i),a=new c(s),h=w(o,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),l=w(a,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),u=r.Add(e,r.Subtract(h,this.m_groundAnchorA)),d=r.Add(n,r.Subtract(l,this.m_groundAnchorB)),f=u.Length(),p=d.Length();f>10*ni?u.Multiply(1/f):u.SetZero(),p>10*ni?d.Multiply(1/p):d.SetZero();var m=_(h,u),g=_(l,d),v=this.m_invMassA+this.m_invIA*m*m,y=this.m_invMassB+this.m_invIB*g*g,x=v+this.m_ratio*this.m_ratio*y;x>0&&(x=1/x);var T=this.m_constant-f-this.m_ratio*p,b=Ii(T),C=-x*T,A=r.Multiply(-C,u),S=r.Multiply(-this.m_ratio,r.Multiply(C,d));return e.Add(r.Multiply(this.m_invMassA,A)),i+=this.m_invIA*_(h,A),n.Add(r.Multiply(this.m_invMassB,S)),s+=this.m_invIB*_(l,S),t.positions[this.m_indexA].c.Assign(e),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].c.Assign(n),t.positions[this.m_indexB].a=s,b<ni},_serialize:function(t){var e="t||{};return" this.parent.prototype._serialize.call(this,e),e.groundanchora="this.m_groundAnchorA._serialize(),e.groundAnchorB=this.m_groundAnchorB._serialize(),e.localAnchorA=this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.lengthA=this.m_lengthA,e.lengthB=this.m_lengthB,e.ratio=this.m_ratio,e}},je._extend(Ae),Xe.prototype={_deserialize:function(t,e,i){this.parent.prototype._deserialize.call(this,t,e,i),this.localAnchorA._deserialize(t.localAnchorA),this.localAnchorB._deserialize(t.localAnchorB),this.maxLength=t.maxLength}},Xe._extend(Ce),Ye.prototype={GetAnchorA:function(){return" this.m_bodya.getworldpoint(this.m_localanchora)},getanchorb:function(){return="" this.m_bodyb.getworldpoint(this.m_localanchorb)},getreactionforce:function(t){var="" e},getreactiontorque:function(t){return="" 0},getlocalanchora:function(){return="" this.m_localanchora},getlocalanchorb:function(){return="" this.m_localanchorb},setmaxlength:function(t){this.m_maxlength="t},GetMaxLength:function(){return" this.m_maxlength},getlimitstate:function(){return="" this.m_state},initvelocityconstraints:function(t){this.m_indexa="this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Assign(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Assign(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var" c(i),d="new" c(a);this.m_ra.assign(w(u,r.subtract(this.m_localanchora,this.m_localcentera))),this.m_rb.assign(w(d,r.subtract(this.m_localanchorb,this.m_localcenterb))),this.m_u.assign(r.subtract(r.subtract(r.add(o,this.m_rb),e),this.m_ra)),this.m_length="this.m_u.Length();var" f="this.m_length-this.m_maxLength;if(f">0?this.m_state=Ae.e_atUpperLimit:this.m_state=Ae.e_inactiveLimit,!(this.m_length>ni))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.Multiply(1/this.m_length);var p=_(this.m_rA,this.m_u),m=_(this.m_rB,this.m_u),g=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*m*m;if(this.m_mass=0!=g?1/g:0,t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var v=r.Multiply(this.m_impulse,this.m_u);n.Subtract(r.Multiply(this.m_invMassA,v)),s-=this.m_invIA*_(this.m_rA,v),h.Add(r.Multiply(this.m_invMassB,v)),l+=this.m_invIB*_(this.m_rB,v)}else this.m_impulse=0;t.velocities[this.m_indexA].v.Assign(n),t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].v.Assign(h),t.velocities[this.m_indexB].w=l},SolveVelocityConstraints:function(t){var e=t.velocities[this.m_indexA].v.Clone(),i=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v.Clone(),s=t.velocities[this.m_indexB].w,o=r.Add(e,f(i,this.m_rA)),a=r.Add(n,f(s,this.m_rB)),c=this.m_length-this.m_maxLength,h=u(this.m_u,r.Subtract(a,o));c<0&&(h+=t.step.inv_dt*c);var l="-this.m_mass*h,d=this.m_impulse;this.m_impulse=Ri(0,this.m_impulse+l),l=this.m_impulse-d;var" p="r.Multiply(l,this.m_u);e.Subtract(r.Multiply(this.m_invMassA,p)),i-=this.m_invIA*_(this.m_rA,p),n.Add(r.Multiply(this.m_invMassB,p)),s+=this.m_invIB*_(this.m_rB,p),t.velocities[this.m_indexA].v.Assign(e),t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].v.Assign(n),t.velocities[this.m_indexB].w=s},SolvePositionConstraints:function(t){var" e="t.positions[this.m_indexA].c.Clone(),i=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c.Clone(),s=t.positions[this.m_indexB].a,o=new" c(i),a="new" c(s),h="w(o,r.Subtract(this.m_localAnchorA,this.m_localCenterA)),l=w(a,r.Subtract(this.m_localAnchorB,this.m_localCenterB)),u=r.Subtract(r.Subtract(r.Add(n,l),e),h),d=u.Normalize(),f=d-this.m_maxLength;f=F(f,0,hi);var" e.subtract(r.multiply(this.m_invmassa,m)),i-="this.m_invIA*_(h,m),n.Add(r.Multiply(this.m_invMassB,m)),s+=this.m_invIB*_(l,m),t.positions[this.m_indexA].c.Assign(e),t.positions[this.m_indexA].a=i,t.positions[this.m_indexB].c.Assign(n),t.positions[this.m_indexB].a=s,d-this.m_maxLength<ni},_serialize:function(t){var" this.parent.prototype._serialize.call(this,e),e.localanchora="this.m_localAnchorA._serialize(),e.localAnchorB=this.m_localAnchorB._serialize(),e.maxLength=this.m_maxLength,e}},Ye._extend(Ae);var" ji="Math.exp;qe.prototype={Initialize:function(e){t(e.count">=3),this.m_count=e.count,this.m_ps=new Array(this.m_count),this.m_p0s=new Array(this.m_count),this.m_vs=new Array(this.m_count),this.m_ims=new Array(this.m_count);for(var i=0;i<this.m_count;++i){this.m_ps[i]=e.vertices[i].clone(),this.m_p0s[i]=e.vertices[i].clone(),this.m_vs[i]=new r;var="" n="e.masses[i];n">0?this.m_ims[i]=1/n:this.m_ims[i]=0}var s=this.m_count-1,o=this.m_count-2;this.m_Ls=new Array(s),this.m_as=new Array(o);for(var i=0;i<s;++i){var a="this.m_ps[i],c=this.m_ps[i+1];this.m_Ls[i]=g(a,c)}for(var" i="0;i<o;++i){var">0&&this.m_vs[n].Add(r.Multiply(t,this.m_gravity)),this.m_vs[n].Multiply(i),this.m_ps[n].Add(r.Multiply(t,this.m_vs[n]));for(var n=0;n<e;++n)this.solvec2(),this.solvec3(),this.solvec2();for(var s="1/t,n=0;n<this.m_count;++n)this.m_vs[n]=r.Multiply(s,r.Subtract(this.m_ps[n],this.m_p0s[n]))}},GetVertexCount:function(){return" this.m_count},getvertices:function(){return="" this.m_ps},draw:function(t){for(var="" e="new" w(.4,.5,.7),i="0;i<this.m_count-1;++i)t.DrawSegment(this.m_ps[i],this.m_ps[i+1],e)},SetAngle:function(t){for(var" t="this.m_count-1,e=0;e<t;++e){var" i="this.m_ps[e],n=this.m_ps[e+1],s=r.Subtract(n,i),o=s.Normalize(),a=this.m_ims[e],c=this.m_ims[e+1];if(a+c!=0){var" h="a/(a+c),l=c/(a+c);i.Subtract(r.Multiply(this.m_k2*h*(this.m_Ls[e]-o),s)),n.Add(r.Multiply(this.m_k2*l*(this.m_Ls[e]-o),s))}}},SolveC3:function(){for(var" p="_(h,l),m=u(h,l),g=wi(p,m),v=r.Multiply(-1/d,h.Skew()),y=r.Multiply(1/f,l.Skew()),x=r.Negate(v),T=r.Subtract(v,y),b=y,C=o*u(x,x)+a*u(T,T)+c*u(b,b);if(0!=C){C=1/C;for(var" a="g-this.m_as[e];A">Ke;)g-=2*Ke,A=g-this.m_as[e];for(;A<-ke;)g+=2*ke,a=g-this.m_as[e];var s="-this.m_k3*C*A;i.Add(r.Multiply(o*S,x)),n.Add(r.Multiply(a*S,T)),s.Add(r.Multiply(c*S,b))}}}}};var" qi="{serialize:function(t){var" e,i,n,r,s,o="[];for(n=t.GetBodyList();n;n=n.GetNext())for(r=n.GetFixtureList();r;r=r.GetNext())s=r.GetShape(),r.__temp_shape_id=o.length,o.push(s._serialize());" var="" a="[];for(n=t.GetBodyList();n;n=n.GetNext())for(n.__temp_fixture_ids=[],r=n.GetFixtureList();r;r=r.GetNext())i=r._serialize(),i.shape=r.__temp_shape_id,delete" r.__temp_shape_id,n.__temp_fixture_ids.push(a.length),a.push(i);var="" c="[];for(n=t.GetBodyList();n;n=n.GetNext()){for(i=n._serialize(),i.fixtures=[],e=0;e<n.__temp_fixture_ids.length;++e)i.fixtures.push(n.__temp_fixture_ids[e]);delete" n.__temp_fixture_ids,n.__temp_body_id="c.length,c.push(i)}var" h,l="[];for(h=t.GetJointList(),e=0;h;h=h.GetNext(),++e)h.__temp_joint_id=e;for(h=t.GetJointList();h;h=h.GetNext())h.GetType()!==Ae.e_mouseJoint&&(i=h._serialize(),i.bodyA=h.GetBodyA().__temp_body_id,i.bodyB=h.GetBodyB().__temp_body_id,l.push(i));for(h=t.GetJointList();h;h=h.GetNext())delete" h.__temp_joint_id;for(n="t.GetBodyList();n;n=n.GetNext())delete" n.__temp_body_id;return{shapes:o,fixtures:a,bodies:c,joints:l}},deserialize:function(t,e,i){var="" n="JSON.parse(t);if(i){for(var" r="e.GetBodyList();r;){var" o="e.GetJointList();o;){var" y.e_circle:h="new" h;break;case="" y.e_edge:h="new" q;break;case="" y.e_chain:h="new" z;break;case="" y.e_polygon:h="new" j}h._deserialize(l),a.push(h)}var="" u="[];for(c=0;c<n.fixtures.length;++c){var" _="n.fixtures[c],d=new" zt;d._deserialize(_),d.shape="a[_.shape],u.push(d)}var" f="[];for(c=0;c<n.bodies.length;++c){var" p="n.bodies[c],m=new" nt;m._deserialize(p);for(var="" g="e.CreateBody(m),v=0;v<p.fixtures.length;++v)g.CreateFixture(u[p.fixtures[v]]);f.push(g)}var" y="[],x=[];for(c=0;c<n.joints.length;++c){var" t,b="n.joints[c];switch(b.type){case" ae.e_revolutejoint:t="new" se;break;case="" ae.e_prismaticjoint:t="new" oe;break;case="" ae.e_distancejoint:t="new" re;break;case="" ae.e_pulleyjoint:t="new" ue;break;case="" ae.e_gearjoint:t="new" ze;break;case="" ae.e_wheeljoint:t="new" fe;break;case="" ae.e_weldjoint:t="new" le;break;case="" ae.e_frictionjoint:t="new" de;break;case="" ae.e_ropejoint:t="new" xe;break;case="" ae.e_motorjoint:t="new" ge;break;default:throw="" new="" error("unknown="" joint")}if(t._deserialize(b,f),b.type="==Ae.e_gearJoint)x.push([T,y.length]),y.push(null);else{var" t(t){return="" r(t?t.x||0:0,t?t.y||0:0)}function="" e(t){for(var="" e="new" array(t.x.length),i="0;i<e.length;++i)e[i]=new" r(t.x[i],t.y[i]);return="" e}function="" i(e,i){var="" n,r="e.name;if("undefined"!=typeof" e.int)n="e.int;else" if("undefined"!="typeof" e.float)n="e.float;else" e.string)n="e.string;else" e.bool)n="e.bool;else{if("undefined"==typeof" e.vec2)throw="" property="" type");n="t(e.vec2)}if(i.hasOwnProperty(r))throw" error("custom="" possibly="" overwriting="" an="" existing="" one");i[r]="n}function" n(n,r){var="" zt;s.density="n.density||0,s.filter.categoryBits="undefined"==typeof" n["filter-categorybits"]?1:n["filter-categorybits"],s.filter.maskbits="undefined" =="typeof" n["filter-maskbits"]?65535:n["filter-maskbits"],s.filter.groupindex="undefined" n["filter-groupindex"]?0:n["filter-groupindex"],s.friction="n.friction||0,s.restitution=n.restitution||0,s.isSensor=n.sensor||0;var" o;if("undefined"!="typeof" n.circle)o="new" h,o.m_p="t(n.circle.center),o.m_radius=n.circle.radius||0;else" n.polygon){var="" j,o.set(a,a.length)}else{if("undefined"="=typeof" n.chain)throw="" shape="" type");var="" z,o.m_count="a.length,o.m_vertices=a,(o.m_hasNextVertex=n.chain.hasNextVertex)&&(o.m_nextVertex=t(n.chain.nextVertex)),(o.m_hasPrevVertex=n.chain.hasPrevVertex)&&(o.m_prevVertex=t(n.chain.prevVertex))}s.shape=o;var" h="0;h<n.customProperties.length;++h)i(n,c)}function" s(e,r){var="" nt;s.type="e.type||Ft.b2_staticBody,s.angle=e.angle||0,s.angularDamping=e.angularDamping||0,s.angularVelocity=e.angularVelocity||0,s.awake=e.awake||!1,s.bullet=e.bullet||!1,s.fixedRotation=e.fixedRotation||!1,s.linearDamping=e.linearDamping||!1,s.linearVelocity=t(e.linearVelocity),s.gravityScale="undefined"!=typeof" e.gravityscale?e.gravityscale:1;var="" x;o.mass="e["massData-mass"]||0,o.center=t(e["massData-center"]),o.I=e["massData-I"]||0,s.position=t(e.position);var" a}function="" o(e,n,r){if(!h[e.type])throw="" joint="" h[e.type];switch(s.type){case="" ae.e_revolutejoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.enableLimit=e.enableLimit||!1,s.enableMotor=e.enableMotor||!1,s.lowerAngle=e.lowerLimit||0,s.maxMotorTorque=e.maxMotorTorque||0,s.motorSpeed=e.motorSpeed||0,s.referenceAngle=e.refAngle||0,s.upperAngle=e.upperLimit||0;break;case" ae.e_distancejoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.dampingRatio=e.dampingRatio||0,s.frequencyHz=e.frequency||0,s.length=e.length||0;break;case" ae.e_prismaticjoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.enableLimit=e.enableLimit||!1,s.enableMotor=e.enableMotor||!1,s.localAxisA=t(e.localAxisA),s.lowerTranslation=e.lowerLimit||0,s.maxMotorForce=e.maxMotorForce||0,s.motorSpeed=e.motorSpeed||0,s.referenceAngle=e.refAngle||0,s.upperTranslation=e.upperLimit||0;break;case" ae.e_wheeljoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.enableMotor=e.enableMotor||!1,s.localAxisA=t(e.localAxisA),s.maxMotorTorque=e.maxMotorTorque||0,s.motorSpeed=e.motorSpeed||0,s.dampingRatio=e.springDampingRatio||0,s.frequencyHz=e.springFrequency||0;break;case" ae.e_ropejoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.maxLength=e.maxLength||0;break;case" ae.e_motorjoint:s.linearoffset="t(e.anchorA),s.angularOffset=e.refAngle||0,s.maxForce=e.maxForce||0,s.maxTorque=e.maxTorque||0,s.correctionFactor=e.correctionFactor||0;break;case" ae.e_weldjoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.referenceAngle=e.refAngle||0,s.dampingRatio=e.dampingRatio||0,s.frequencyHz=e.frequencyHz||0;break;case" ae.e_frictionjoint:s.localanchora="t(e.anchorA),s.localAnchorB=t(e.anchorB),s.maxForce=e.maxForce||0,s.maxTorque=e.maxTorque||0;break;default:throw" error("wat?")}s.bodya="r[e.bodyA||0],s.bodyB=r[e.bodyB||0],s.collideConnected=e.collideConnected||!1;var" o}function="" a(){this.world="null,this.positionIterations=0,this.velocityIterations=0,this.stepsPerSecond=0,this.fixtures={},this.bodies={},this.joints={},Object.seal(this)}function" c(e,i){var="" a;n.world="i=i||new" kt(new="" r(0,0)),n.positioniterations="e.positionIterations||0,n.velocityIterations=e.velocityIterations||0,n.stepsPerSecond=e.stepsPerSecond||0,e.gravity&&i.SetGravity(t(e.gravity)),i.SetAllowSleeping(e.allowSleep||!1),i.SetAutoClearForces(e.autoClearForces||!1),i.SetWarmStarting(e.warmStarting||!1),i.SetContinuousPhysics(e.continuousPhysics||!1),i.SetSubStepping(e.subStepping||!1);var" l="0;l<h.length;++l){var" d="[],f=e.joint;if(f)for(l=0;l<f.length;++l){var" n}var="" b2_compatibility&&"undefined"!="typeof" window)for(var="" tn="0;tn<$i.length;++tn)window[$i[tn].name]=$i[tn].def;else{for(var" en="{},tn=0;tn<$i.length;++tn)en[$i[tn].trimmed]=$i[tn].def;"undefined"!=typeof" e?e.exports="en:window.b2=en}})()}),{}],311:[(function(t,e,i){Object.create=Object.create||function(t){function" e(){}return="" e.prototype="t,new" e};var="" n,r,s="function(t,e){if(!t)throw" error("assertion="" failed:="" "+e)},o="function(t,e){!t&&console&&console.warn&&(console.warn("ASSERTION" "+e),console.trace&&console.trace())},a="function(t,e){return" t<e?t:e},c="function(t,e){return" t="">e?t:e};"object"==typeof window&&window.navigator.userAgent.indexOf("Firefox")>-1?(n=Math.min,r=Math.max):(n=a,r=c);var h=function(t,e){return t<e?t+" "+e:e+"="" "+t},l="function(t,e){for(var" i="0;i<t.length;i++)if(t[i]===e)return" t[i]="t[t.length-1],void" t.length--},u="function(t,e,i){var" n="E(e,i),r=v(T(n,E(t,i))/L(n));return" s(i,i(n,r))},_="function(t,e,i,n,r,s){var" o="i-r,a=n-s,c=v(b(o,a,t-r,e-s)/N(o,a));return" new="" y(r+o*c,s+a*c)};cp.momentforcircle="function(t,e,i,n){return" t*(.5*(e*e+i*i)+l(n))},cp.areaforcircle="function(t,e){return" math.pi*math.abs(t*t-e*e)},cp.momentforsegment="function(t,e,i){var" t*(w(i,e)="" 12+l(n))},cp.areaforsegment="function(t,e,i){return" i*(math.pi*i+2*g(t,e))},cp.momentforpoly="function(t,e,i){for(var" a="e[o]+i.x,c=e[o+1]+i.y,h=e[(o+2)%s]+i.x,l=e[(o+3)%s]+i.y,u=P(h,l,a,c),_=b(a,c,a,c)+b(a,c,h,l)+b(h,l,h,l);n+=u*_,r+=u}return" t*n="" (6*r)},cp.areaforpoly="function(t){for(var" e="0,i=0,n=t.length;i<n;i+=2)e+=R(new" y(t[i],t[i+1]),new="" y(t[(i+2)%n],t[(i+3)%n]));return-e="" 2},cp.centroidforpoly="function(t){for(var" y(0,0),n="0,r=t.length;n<r;n+=2){var" s="new" y(t[n],t[n+1]),o="new" y(t[(n+2)%r],t[(n+3)%r]),a="R(s,o);e+=a,i=S(i,I(S(s,o),a))}return" i(i,1="" (3*e))},cp.recenterpoly="function(t){for(var" t*(e*e+i*i)="" 12},cp.momentforbox2="function(t,e){var" cp.momentforbox(t,i,n)+t*l(r)};var="" d="cp.loopIndexes=function(t){var" e,i,n,r,s="0,o=0;e=n=t[0],i=r=t[1];for(var">>1,c=1;c<a;c++){var h="t[2*c],l=t[2*c+1];h<e||h==e&&l<i?(e=h,i=l,s=c):(h">n||h==n&&l>r)&&(n=h,r=l,o=c)}return[s,o]},f=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},p=function(t,e,i,n,r,s){if(0===i)return 0;for(var o=0,a=e,c=E(r,n),h=s*C(c),l=e,u=e+i-1;l<=u;){var _="new" y(t[2*l],t[2*l+1]),d="R(c,E(_,n));d">h?(d>o&&(o=d,a=l),l++):(f(t,l,u),u--)}return a!=e&&f(t,e,a),l-e},m=function(t,e,i,n,r,s,o,a){if(n<0)return 0;if(0="=n)return" e[2*a]="s.x,e[2*a+1]=s.y,1;var" c="p(e,i,n,r,s,t),h=new" y(e[2*i],e[2*i+1]),l="m(t,e,i+1,c-1,r,h,s,a),u=a+l++;e[2*u]=s.x,e[2*u+1]=s.y;var" _="p(e,i+c,n-c,s,o,t),d=new" y(e[2*(i+c)],e[2*(i+c)+1]);return="" l+m(t,e,i+c+1,_-1,s,d,o,a+l)};cp.convexhull="function(t,e,i){if(e)for(var" n="0;n<t.length;n++)e[n]=t[n];else" e="t;var" r="d(t),s=r[0],a=r[1];if(s==a)return" e.length="2,e;f(e,0,s),f(e,1,0==a?s:a);var" y(e[0],e[1]),h="new" y(e[2],e[3]),l="t.length">>1,u=m(i,e,2,l-2,c,h,c,1)+1;return e.length=2*u,o(it(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),e};var g=function(t,e,i){return n(r(t,e),i)},v=function(t){return r(0,n(t,1))},y=cp.Vect=function(t,e){this.x=t,this.y=e};cp.v=function(t,e){return new y(t,e)};var x=cp.vzero=new y(0,0),T=cp.v.dot=function(t,e){return t.x*e.x+t.y*e.y},b=function(t,e,i,n){return t*i+e*n},C=cp.v.len=function(t){return Math.sqrt(T(t,t))},A=cp.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},S=(cp.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},cp.v.add=function(t,e){return new y(t.x+e.x,t.y+e.y)});y.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this};var E=cp.v.sub=function(t,e){return new y(t.x-e.x,t.y-e.y)};y.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this};var w=cp.v.neg=function(t){return new y(-t.x,-t.y)};y.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var I=cp.v.mult=function(t,e){return new y(t.x*e,t.y*e)};y.prototype.mult=function(t){return this.x*=t,this.y*=t,this};var R=cp.v.cross=function(t,e){return t.x*e.y-t.y*e.x},P=function(t,e,i,n){return t*n-e*i},O=cp.v.perp=function(t){return new y(-t.y,t.x)},B=(cp.v.pvrperp=function(t){return new y(t.y,-t.x)},cp.v.project=function(t,e){return I(e,T(t,e)/L(e))});y.prototype.project=function(t){return this.mult(T(this,t)/L(t)),this};var D=cp.v.rotate=function(t,e){return new y(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)};y.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this};var M=cp.v.unrotate=function(t,e){return new y(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},L=cp.v.lengthsq=function(t){return T(t,t)},N=cp.v.lengthsq2=function(t,e){return t*t+e*e},F=cp.v.lerp=function(t,e,i){return S(I(t,1-i),I(e,i))},k=cp.v.normalize=function(t){return I(t,1/C(t))},z=cp.v.normalize_safe=function(t){return 0===t.x&&0===t.y?x:k(t)},V=cp.v.clamp=function(t,e){return T(t,t)>e*e?I(k(t),e):t},G=(cp.v.lerpconst=function(t,e,i){return S(t,V(E(e,t),i))},cp.v.dist=function(t,e){return C(E(t,e))}),W=cp.v.distsq=function(t,e){return L(E(t,e))},U=(cp.v.near=function(t,e,i){return W(t,e)<i*i},cp.v.slerp=function(t,e,i){var n="Math.acos(T(t,e));if(n){var" r="1/Math.sin(n);return" s(i(t,math.sin((1-i)*n)*r),i(e,math.sin(i*n)*r))}return="" t}),j="(cp.v.slerpconst=function(t,e,i){var" u(t,e,n(i,r)="" r)},cp.v.forangle="function(t){return" new="" y(math.cos(t),math.sin(t))},cp.v.toangle="function(t){return" math.atan2(t.y,t.x)},cp.v.str="function(t){return"("+t.x.toFixed(3)+"," "+t.y.tofixed(3)+")"},0),x="cp.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,j++};cp.bb=function(t,e,i,n){return" x(t,e,i,n)};var="" y="function(t,e){return" x(t.x-e,t.y-e,t.x+e,t.y+e)},h="function(t,e,i,n,r){return" t.l<="n&&e<=t.r&&t.b<=r&&i<=t.t},q=0,Z=(cp.NO_GROUP=0,cp.ALL_LAYERS=-1);cp.resetShapeIdCounter=function(){q=0};var" j="cp.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=q++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=x,this.collision_type=0,this.group=0,this.layers=Z,this.space=null,this.collisionCode=this.collisionCode};J.prototype.setElasticity=function(t){this.e=t},J.prototype.setFriction=function(t){this.body.activate(),this.u=t},J.prototype.setLayers=function(t){this.body.activate(),this.layers=t},J.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},J.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},J.prototype.getBody=function(){return" this.body},j.prototype.active="function(){return" this.body&&this.body.shapelist.indexof(this)!="=-1},J.prototype.setBody=function(t){s(!this.active(),"You" cannot="" change="" the="" body="" on="" an="" active="" shape.="" you="" must="" remove="" shape="" from="" space="" before="" changing="" body."),this.body="t},J.prototype.cacheBB=function(){return" this.update(this.body.p,this.body.rot)},j.prototype.update="function(t,e){s(!isNaN(e.x),"Rotation" is="" nan"),s(!isnan(t.x),"position="" nan"),this.cachedata(t,e)},j.prototype.pointquery="function(t){var" e="this.nearestPointQuery(t);if(e.d<0)return" e},j.prototype.getbb="function(){return" x(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var="" q="function(t,e,i){this.shape=t,this.p=e,this.d=i},K=function(t,e,i){this.shape=t,this.t=e,this.n=i};K.prototype.hitPoint=function(t,e){return" f(t,e,this.t)},k.prototype.hitdist="function(t,e){return" g(t,e)*this.t};var="" $="cp.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",J.call(this,t)};$.prototype=Object.create(J.prototype),$.prototype.cacheData=function(t,e){var" i="this.tc=D(this.c,e).add(t),n=this.r;this.bb_l=i.x-n,this.bb_b=i.y-n,this.bb_r=i.x+n,this.bb_t=i.y+n},$.prototype.nearestPointQuery=function(t){var" y(this.tc.x+e*r="" n,this.tc.y+i*r="" n);return="" q(this,s,n-r)};var="" tt="function(t,e,i,n,r,s){n=E(n,e),r=E(r,e);var" o="T(n,n)-2*T(n,r)+T(r,r),a=-2*T(n,n)+2*T(n,r),c=T(n,n)-i*i,h=a*a-4*o*c;if(h">=0){var l=(-a-Math.sqrt(h))/(2*o);if(0<=l&&l<=1)return new="" k(t,l,k(f(n,r,l)))}};$.prototype.segmentquery="function(t,e){return" tt(this,this.tc,this.r,t,e)};var="" et="cp.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=O(k(E(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.a_tangent=x,this.b_tangent=x,this.type="segment",J.call(this,t)};et.prototype=Object.create(J.prototype),et.prototype.cacheData=function(t,e){this.ta=S(t,D(this.a,e)),this.tb=S(t,D(this.b,e)),this.tn=D(this.n,e);var" i,n,r,s;this.ta.x<this.tb.x?(i="this.ta.x,n=this.tb.x):(i=this.tb.x,n=this.ta.x),this.ta.y<this.tb.y?(r=this.ta.y,s=this.tb.y):(r=this.tb.y,s=this.ta.y);var" o="this.r;this.bb_l=i-o,this.bb_b=r-o,this.bb_r=n+o,this.bb_t=s+o},et.prototype.nearestPointQuery=function(t){var" e="u(t,this.ta,this.tb),i=t.x-e.x,n=t.y-e.y,r=A(i,n),s=this.r,o=r?S(e,I(new" y(i,n),s="" r)):e;return="" q(this,o,r-s)},et.prototype.segmentquery="function(t,e){var" i="this.tn,n=T(E(this.ta,t),i),r=this.r,s=n">0?w(i):i,o=E(I(s,r),t),a=S(this.ta,o),c=S(this.tb,o),h=E(e,t);if(R(h,a)*R(h,c)<=0){var l="n+(n">0?-r:r),u=-l,_=T(h,i)-l;if(u*_<0)return new="" k(this,u="" (u-_),s)}else="" if(0!="=r){var" d="tt(this,this.ta,this.r,t,e),f=tt(this,this.tb,this.r,t,e);return" d?f&&f.t<d.t?f:d:f}},et.prototype.setneighbors="function(t,e){this.a_tangent=E(t,this.a),this.b_tangent=E(e,this.b)},et.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=O(k(E(e,t)))};var" it="function(t){for(var" e="t.length,i=0;i<e;i+=2){var" n="t[i],r=t[i+1],s=t[(i+2)%e],o=t[(i+3)%e],a=t[(i+4)%e],c=t[(i+5)%e];if(P(s-n,o-r,a-s,c-o)">0)return!1}return!0},nt=cp.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",J.call(this,t)};nt.prototype=Object.create(J.prototype);var rt=function(t,e){this.n=t,this.d=e};rt.prototype.compare=function(t){return T(this.n,t)-this.d},nt.prototype.setVerts=function(t,e){s(t.length>=4,"Polygons require some verts"),s("number"==typeof t[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),s(it(t),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var i=t.length,n=i>>1;this.verts=new Array(i),this.tVerts=new Array(i),this.planes=new Array(n),this.tPlanes=new Array(n);for(var r=0;r<i;r+=2){var o="t[r]+e.x,a=t[r+1]+e.y,c=t[(r+2)%i]+e.x,h=t[(r+3)%i]+e.y,l=k(O(new" y(c-o,h-a)));this.verts[r]="o,this.verts[r+1]=a,this.planes[r">>1]=new rt(l,b(l.x,l.y,o,a)),this.tPlanes[r>>1]=new rt(new y(0,0),0)}};var st=(cp.BoxShape=function(t,e,i){var n=e/2,r=i/2;return st(t,new X(-n,-r,n,r))},cp.BoxShape2=function(t,e){var i=[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b];return new nt(t,i,x)});nt.prototype.transformVerts=function(t,e){for(var i=this.verts,s=this.tVerts,o=1/0,a=-(1/0),c=1/0,h=-(1/0),l=0;l<i.length;l+=2){var u="i[l],_=i[l+1],d=t.x+u*e.x-_*e.y,f=t.y+u*e.y+_*e.x;s[l]=d,s[l+1]=f,o=n(o,d),a=r(a,d),c=n(c,f),h=r(h,f)}this.bb_l=o,this.bb_b=c,this.bb_r=a,this.bb_t=h},nt.prototype.transformAxes=function(t,e){for(var" i="this.planes,n=this.tPlanes,r=0;r<i.length;r++){var" s="D(i[r].n,e);n[r].n=s,n[r].d=T(t,s)+i[r].d}},nt.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},nt.prototype.nearestPointQuery=function(t){for(var" e="this.tPlanes,i=this.tVerts,n=i[i.length-2],r=i[i.length-1],s=1/0,o=x,a=!1,c=0;c<e.length;c++){e[c].compare(t)">0&&(a=!0);var h=i[2*c],l=i[2*c+1],u=_(t.x,t.y,n,r,h,l),d=G(t,u);d<s&&(s=d,o=u),n=h,r=l}return new="" q(this,o,a?s:-s)},nt.prototype.segmentquery="function(t,e){for(var" i="this.tPlanes,n=this.tVerts,r=i.length,s=2*r,o=0;o<r;o++){var" a="i[o].n,c=T(t,a);if(!(i[o].d">c)){var h=T(e,a),l=(i[o].d-c)/(h-c);if(!(l<0||1<l)){var u="F(t,e,l),_=-R(a,u),d=-P(a.x,a.y,n[2*o],n[2*o+1]),f=-P(a.x,a.y,n[(2*o+2)%s],n[(2*o+3)%s]);if(d<=_&&_<=f)return" new="" k(this,l,a)}}}},nt.prototype.valueonaxis="function(t,e){for(var" i="this.tVerts,r=b(t.x,t.y,i[0],i[1]),s=2;s<i.length;s+=2)r=n(r,b(t.x,t.y,i[s],i[s+1]));return" r-e},nt.prototype.containsvert="function(t,e){for(var" r="i[n].n,s=b(r.x,r.y,t,e)-i[n].d;if(s">0)return!1}return!0},nt.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,r=0;r<n.length;r++){var s="n[r].n;if(!(T(s,i)<0)){var" o="b(s.x,s.y,t,e)-n[r].d;if(o">0)return!1}}return!0},nt.prototype.getNumVerts=function(){return this.verts.length/2},nt.prototype.getVert=function(t){return new y(this.verts[2*t],this.verts[2*t+1])};var ot=cp.Body=function(t,e){this.p=new y(0,0),this.vx=this.vy=0,this.f=new y(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new y(0,0),this.setAngle(0)},at=function(){var t=new ot(1/0,1/0);return t.nodeIdleTime=1/0,t};if(cp.StaticBody=at,"undefined"!=typeof DEBUG&&DEBUG){var ct=function(t,e){s(t.x==t.x&&t.y==t.y,e)},ht=function(t,e){s(Math.abs(t.x)!==1/0&&Math.abs(t.y)!==1/0,e)},lt=function(t,e){ct(t,e),ht(t,e)};ot.prototype.sanityCheck=function(){s(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),s(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),lt(this.p,"Body's position is invalid."),lt(this.f,"Body's force is invalid."),s(this.vx===this.vx&&Math.abs(this.vx)!==1/0,"Body's velocity is invalid."),s(this.vy===this.vy&&Math.abs(this.vy)!==1/0,"Body's velocity is invalid."),s(this.a===this.a&&Math.abs(this.a)!==1/0,"Body's angle is invalid."),s(this.w===this.w&&Math.abs(this.w)!==1/0,"Body's angular velocity is invalid."),s(this.t===this.t&&Math.abs(this.t)!==1/0,"Body's torque is invalid."),lt(this.rot,"Body's rotation vector is invalid."),s(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),s(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")}}else ot.prototype.sanityCheck=function(){};ot.prototype.getPos=function(){return this.p},ot.prototype.getVel=function(){return new y(this.vx,this.vy)},ot.prototype.getAngVel=function(){return this.w},ot.prototype.isSleeping=function(){return null!==this.nodeRoot},ot.prototype.isStatic=function(){return this.nodeIdleTime===1/0},ot.prototype.isRogue=function(){return null===this.space},ot.prototype.setMass=function(t){s(t>0,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},ot.prototype.setMoment=function(t){s(t>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},ot.prototype.addShape=function(t){this.shapeList.push(t)},ot.prototype.removeShape=function(t){l(this.shapeList,t)};var ut=function(t,e,i){return t===i?t.next(e):(t.a===e?t.next_a=ut(t.next_a,e,i):t.next_b=ut(t.next_b,e,i),t)};ot.prototype.removeConstraint=function(t){
this.constraintList=ut(this.constraintList,this,t)},ot.prototype.setPos=function(t){this.activate(),this.sanityCheck(),t===x&&(t=cp.v(0,0)),this.p=t},ot.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},ot.prototype.setAngVel=function(t){this.activate(),this.w=t},ot.prototype.setAngleInternal=function(t){s(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},ot.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},ot.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,r=this.vy*e+(t.y+this.f.y*this.m_inv)*i,s=this.v_limit,o=n*n+r*r,a=o>s*s?s/Math.sqrt(o):1;this.vx=n*a,this.vy=r*a;var c=this.w_limit;this.w=g(this.w*e+this.t*this.i_inv*i,-c,c),this.sanityCheck()},ot.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},ot.prototype.resetForces=function(){this.activate(),this.f=new y(0,0),this.t=0},ot.prototype.applyForce=function(t,e){this.activate(),this.f=S(this.f,t),this.t+=R(e,t)},ot.prototype.applyImpulse=function(t,e){this.activate(),de(this,t.x,t.y,e)},ot.prototype.getVelAtPoint=function(t){return S(new y(this.vx,this.vy),I(O(t),this.w))},ot.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(E(t,this.p))},ot.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(D(t,this.rot))},ot.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;e<i;e++)t(this.shapelist[e])},ot.prototype.eachconstraint=function(t){for(var e="this.constraintList;e;){var" i="e.next(this);t(e),e=i}},ot.prototype.eachArbiter=function(t){for(var" s(this.p,d(t,this.rot))},ot.prototype.world2local="function(t){return" m(e(t,this.p),this.rot)},ot.prototype.kineticenergy="function(){var" t="this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)};var" _t="cp.SpatialIndex=function(t){if(this.staticIndex=t,t){if(t.dynamicIndex)throw" new="" error("this="" static="" index="" is="" already="" associated="" with="" a="" dynamic="" index.");t.dynamicindex="this}};_t.prototype.collideStatic=function(t,e){if(t.count">0){var i=t.query;this.each((function(t){i(t,new X(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)}))}};var dt=cp.BBTree=function(t){_t.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};dt.prototype=Object.create(_t.prototype);var ft=0,pt=function(t,e,i){this.obj=null,this.bb_l=n(e.bb_l,i.bb_l),this.bb_b=n(e.bb_b,i.bb_b),this.bb_r=r(e.bb_r,i.bb_r),this.bb_t=r(e.bb_t,i.bb_t),this.parent=null,this.setA(e),this.setB(i)};dt.prototype.makeNode=function(t,e){var i=this.pooledNodes;return i?(this.pooledNodes=i.parent,i.constructor(this,t,e),i):(ft++,new pt(this,t,e))};var mt=0,gt=function(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null,mt++};dt.prototype.getBB=function(t,e){var i=this.velocityFunc;if(i){var s=.1,o=(t.bb_r-t.bb_l)*s,a=(t.bb_t-t.bb_b)*s,c=I(i(t),.1);e.bb_l=t.bb_l+n(-o,c.x),e.bb_b=t.bb_b+n(-a,c.y),e.bb_r=t.bb_r+r(o,c.x),e.bb_t=t.bb_t+r(a,c.y)}else e.bb_l=t.bb_l,e.bb_b=t.bb_b,e.bb_r=t.bb_r,e.bb_t=t.bb_t},dt.prototype.getStamp=function(){var t=this.dynamicIndex;return t&&t.stamp?t.stamp:this.stamp},dt.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++};var vt=0,yt=function(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n};dt.prototype.makePair=function(t,e,i,n){var r=this.pooledPairs;return r?(this.pooledPairs=r.prevA,r.prevA=null,r.leafA=t,r.nextA=e,r.prevB=null,r.leafB=i,r.nextB=n,r):(vt++,new yt(t,e,i,n))},yt.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this};var xt=function(t,e,i){i&&(i.leafA===e?i.prevA=t:i.prevB=t),t?t.leafA===e?t.nextA=i:t.nextB=i:e.pairs=i};gt.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;)i.leafA===this?(e=i.nextA,xt(i.prevB,i.leafB,i.nextB)):(e=i.nextB,xt(i.prevA,i.leafA,i.nextA)),i.recycle(t),i=e};var Tt=function(t,e,i){var n=t.pairs,r=e.pairs,s=i.makePair(t,n,e,r);t.pairs=e.pairs=s,n&&(n.leafA===t?n.prevA=s:n.prevB=s),r&&(r.leafA===e?r.prevA=s:r.prevB=s)};pt.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},gt.prototype.recycle=function(t){},pt.prototype.setA=function(t){this.A=t,t.parent=this},pt.prototype.setB=function(t){this.B=t,t.parent=this},gt.prototype.isLeaf=!0,pt.prototype.isLeaf=!1,pt.prototype.otherChild=function(t){return this.A==t?this.B:this.A},pt.prototype.replaceChild=function(t,e,i){o(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t?(this.A.recycle(i),this.setA(e)):(this.B.recycle(i),this.setB(e));for(var s=this;s;s=s.parent){var a=s.A,c=s.B;s.bb_l=n(a.bb_l,c.bb_l),s.bb_b=n(a.bb_b,c.bb_b),s.bb_r=r(a.bb_r,c.bb_r),s.bb_t=r(a.bb_t,c.bb_t)}},pt.prototype.bbArea=gt.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var bt=function(t,e){return(r(t.bb_r,e.bb_r)-n(t.bb_l,e.bb_l))*(r(t.bb_t,e.bb_t)-n(t.bb_b,e.bb_b))},Ct=function(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)},At=function(t,e,i){if(null==t)return e;if(t.isLeaf)return i.makeNode(e,t);var s=t.B.bbArea()+bt(t.A,e),o=t.A.bbArea()+bt(t.B,e);return s===o&&(s=Ct(t.A,e),o=Ct(t.B,e)),o<s?t.setb(at(t.b,e,i)):t.seta(at(t.a,e,i)),t.bb_l=n(t.bb_l,e.bb_l),t.bb_b=n(t.bb_b,e.bb_b),t.bb_r=r(t.bb_r,e.bb_r),t.bb_t=r(t.bb_t,e.bb_t),t};pt.prototype.intersectsbb=gt.prototype.intersectsbb=function(t){return 1="" this.bb_l<="t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t};var" st="function(t,e,i){t.intersectsBB(e)&&(t.isLeaf?i(t.obj):(St(t.A,e,i),St(t.B,e,i)))},Et=function(t,e,i){var" s="1/(i.x-e.x),o=t.bb_l==e.x?-(1/0):(t.bb_l-e.x)*s,a=t.bb_r==e.x?1/0:(t.bb_r-e.x)*s,c=n(o,a),h=r(o,a),l=1/(i.y-e.y),u=t.bb_b==e.y?-(1/0):(t.bb_b-e.y)*l,_=t.bb_t==e.y?1/0:(t.bb_t-e.y)*l,d=n(u,_),f=r(u,_);if(d<=h&&c<=f){var" p="r(c,d),m=n(h,f);if(0<=m&&p<=1)return" r(p,0)}return="" 0},wt="function(t,e,i,r,s){if(t.isLeaf)return" s(t.obj);var="" o="Et(t.A,e,i),a=Et(t.B,e,i);return" o<a?(o<r&&(r="n(r,wt(t.A,e,i,r,s))),a<r&&(r=n(r,wt(t.B,e,i,r,s)))):(a<r&&(r=n(r,wt(t.B,e,i,r,s))),o<r&&(r=n(r,wt(t.A,e,i,r,s)))),r};dt.prototype.subtreeRecycle=function(t){t.isLeaf&&(this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this))};var" it="function(t,e,i){if(e==t)return" null;var="" n="e.parent;if(n==t){var" r="t.otherChild(e);return" r.parent="t.parent,t.recycle(i),r}return" n.parent.replacechild(n,n.otherchild(e),i),t},rt="function(t,e){return" t.bb_l<="e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t};gt.prototype.markLeafQuery=function(t,e,i,n){Rt(t,this)&&(e?Tt(t,this,i):(this.stamp<t.stamp&&Tt(this,t,i),n&&n(t.obj,this.obj)))},pt.prototype.markLeafQuery=function(t,e,i,n){Rt(t,this)&&(this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n))},gt.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp()){e&&e.markLeafQuery(this,!1,t,i);for(var" for(var="">=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},gt.prototype.update=function(t){var e=t.root,i=this.obj;return!this.containsObj(i)&&(t.getBB(this.obj,this),e=It(e,this,t),t.root=At(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0)},gt.prototype.addPairs=function(t){var e=t.dynamicIndex;if(e){var i=e.root;i&&i.markLeafQuery(this,!0,e,null)}else{var n=t.staticIndex.root;this.markSubtree(t,n,null)}},dt.prototype.insert=function(t,e){var i=new gt(this,t);this.leaves[e]=i,this.root=At(this.root,i,this),this.count++,i.stamp=this.getStamp(),i.addPairs(this),this.incrementStamp()},dt.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=It(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},dt.prototype.contains=function(t,e){return null!=this.leaves[e]};var Pt=function(t,e){};dt.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);var n=this.staticIndex,r=n&&n.root;this.root.markSubtree(this,r,t),n&&!r&&this.collideStatic(this,n,t),this.incrementStamp()}},dt.prototype.reindex=function(){this.reindexQuery(Pt)},dt.prototype.reindexObject=function(t,e){var i=this.leaves[e];i&&(i.update(this)&&i.addPairs(this),this.incrementStamp())},dt.prototype.pointQuery=function(t,e){this.query(new X(t.x,t.y,t.x,t.y),e)},dt.prototype.segmentQuery=function(t,e,i,n){this.root&&wt(this.root,t,e,i,n)},dt.prototype.query=function(t,e){this.root&&St(this.root,t,e)},dt.prototype.count=function(){return this.count},dt.prototype.each=function(t){var e;for(e in this.leaves)t(this.leaves[e].obj)};var Ot=function(t,e,i,s,o){return(r(t.bb_r,s)-n(t.bb_l,e))*(r(t.bb_t,o)-n(t.bb_b,i))},Bt=function(t,e,i,s){if(1==s)return e[i];if(2==s)return t.makeNode(e[i],e[i+1]);for(var o=e[i],a=o.bb_l,c=o.bb_b,h=o.bb_r,l=o.bb_t,u=i+s,_=i+1;_<u;_++)o=e[_],a=n(a,o.bb_l),c=n(c,o.bb_b),h=r(h,o.bb_r),l=r(l,o.bb_t);var d="h-a">l-c,f=new Array(2*s);if(d)for(var _=i;_<u;_++)f[2*_+0]=e[_].bb_l,f[2*_+1]=e[_].bb_r;else for(var="" _="i;_<u;_++)f[2*_+0]=e[_].bb_b,f[2*_+1]=e[_].bb_t;f.sort((function(t,e){return" t-e}));var="" p=".5*(f[s-1]+f[s]),m=a,g=c,v=h,y=l,x=a,T=c,b=h,C=l;d?v=x=p:y=T=p;for(var" a="u,S=i;S<A;){var" o="e[S];Ot(o,x,T,b,C)<Ot(o,m,g,v,y)?(A--,e[S]=e[A],e[A]=o):S++}if(A==s){for(var" o}return="" nodenew(t,bt(t,e,i,a-i),bt(t,e,a,u-a))};dt.prototype.optimize="function(){var" t="new" array(this.count),e="0;for(var" i="" in="" this.leaves)t[e++]="this.nodes[i];tree.subtreeRecycle(root),this.root=Bt(tree,t,t.length)};var" dt="function(t,e){!t.isLeaf&&e<=10&&(Dt(t.A,e+1),Dt(t.B,e+1));for(var" ,n="0;n<e;n++)i+="" ";console.log(i+t.bb_b+"="" "+t.bb_t)};dt.prototype.log="function(){this.root&&Dt(this.root,0)};var" mt="cp.CollisionHandler=function(){this.a=this.b=0};Mt.prototype.begin=function(t,e){return!0},Mt.prototype.preSolve=function(t,e){return!0},Mt.prototype.postSolve=function(t,e){},Mt.prototype.separate=function(t,e){};var" lt="function(t,e){this.e=0,this.u=0,this.surface_vr=x,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first" coll"};lt.prototype.getshapes="function(){return" this.swappedcoll?[this.b,this.a]:[this.a,this.b]},lt.prototype.totalimpulse="function(){for(var" y(0,0),i="0,n=t.length;i<n;i++){var" r="t[i];e.add(I(r.n,r.jnAcc))}return" this.swappedcoll?e:e.neg()},lt.prototype.totalimpulsewithfriction="function(){for(var" y(r.jnacc,r.jtacc).rotate(r.n))}return="" this.swappedcoll?e:e.neg()},lt.prototype.totalke="function(){for(var" s="i[n],o=s.jnAcc,a=s.jtAcc;e+=t*o*o/s.nMass+a*a/s.tMass}return" e},lt.prototype.ignore="function(){this.state="ignore"},Lt.prototype.getA=function(){return" this.swappedcoll?this.b:this.a},lt.prototype.getb="function(){return" this.swappedcoll?this.a:this.b},lt.prototype.isfirstcontact="function(){return"first" coll"="==this.state};var" nt="function(t,e,i){this.point=t,this.normal=e,this.dist=i};Lt.prototype.getContactPointSet=function(){var" t,e="new" array(this.contacts.length);for(t="0;t<e.length;t++)e[t]=new" nt(this.contacts[t].p,this.contacts[t].n,this.contacts[t].dist);return="" e},lt.prototype.getnormal="function(t){var" e="this.contacts[t].n;return" this.swappedcoll?w(e):e},lt.prototype.getpoint="function(t){return" this.contacts[t].p},lt.prototype.getdepth="function(t){return" this.contacts[t].dist};var="" ft="function(t,e,i,n){i?i.body_a===e?i.thread_a_next=n:i.thread_b_next=n:e.arbiterList=n,n&&(n.body_a===e?n.thread_a_prev=i:n.thread_b_prev=i)};Lt.prototype.unthread=function(){Ft(this,this.body_a,this.thread_a_prev,this.thread_a_next),Ft(this,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Lt.prototype.update=function(t,e,i,n){if(this.contacts)for(var" coll")},lt.prototype.prestep="function(t,e,i){for(var" kt="0,zt=0;Lt.prototype.applyImpulse=function(){kt++;for(var" y="-(o.bounce+f)*a,x=o.jnAcc;o.jnAcc=r(x+y,0);var" w="o.jnAcc-x,I=o.jtAcc-A;fe(t,e,h,l,c.x*w-c.y*I,c.x*I+c.y*w)}},Lt.prototype.callSeparate=function(t){var" this.body_a="=t?this.thread_a_next:this.thread_b_next};var" vt="0,Gt=function(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=x,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=n,Vt++},Wt=[],Ut=function(t,e,i,n){var">=r*r)){var a=Math.sqrt(o);return new Gt(S(t,I(s,.5+(i-.5*r)/(a?a:1/0))),a?I(s,1/a):new y(1,0),a-r,0)}},jt=function(t,e){var i=Ut(t.tc,e.tc,t.r,e.r);return i?[i]:Wt},Xt=function(t,e){var i=e.ta,n=e.tb,r=t.tc,s=E(n,i),o=v(T(s,E(r,i))/L(s)),a=S(i,I(s,o)),c=Ut(r,a,t.r,e.r);if(c){var h=c.n;return 0===o&&T(h,e.a_tangent)<0||1===o&&t(h,e.b_tangent)<0?wt:[c]}return wt},yt="0,Ht=function(t,e){var" i="0,n=t.valueOnAxis(e[0].n,e[0].d);if(n">0)return-1;for(var r=1;r<e.length;r++){var s="t.valueOnAxis(e[r].n,e[r].d);if(s">0)return-1;s>n&&(n=s,i=r)}return Yt=n,i},qt=function(t,e,i,n){for(var r=[],s=t.tVerts,o=0;o<s.length;o+=2){var a="s[o],c=s[o+1];e.containsVertPartial(a,c,w(i))&&r.push(new" gt(new="" y(a,c),i,n,h(t.hashid,o)))}for(var="" l="e.tVerts,o=0;o<l.length;o+=2){var" y(a,c),i,n,h(e.hashid,o)))}return="" r},zt="function(t,e,i,n){for(var" r="[],s=t.tVerts,o=0;o<s.length;o+=2){var" y(a,c),i,n,h(t.hashid,o="">>1)))}for(var l=e.tVerts,o=0;o<l.length;o+=2){var a="l[o],c=l[o+1];t.containsVert(a,c)&&r.push(new" gt(new="" y(a,c),i,n,h(e.hashid,o="">>1)))}return r.length?r:qt(t,e,i,n)},Jt=function(t,e){var i=Ht(e,t.tPlanes);if(i==-1)return Wt;var n=Yt,r=Ht(t,e.tPlanes);if(r==-1)return Wt;var s=Yt;return n>s?Zt(t,e,t.tPlanes[i].n,n):Zt(t,e,w(e.tPlanes[r].n),s)},Qt=function(t,e,i){var r=T(e,t.ta)-t.r,s=T(e,t.tb)-t.r;return n(r,s)-i},Kt=function(t,e,i,n,r){for(var s=R(e.tn,e.ta),o=R(e.tn,e.tb),a=I(e.tn,r),c=i.tVerts,l=0;l<c.length;l+=2){var u="c[l],_=c[l+1];if(b(u,_,a.x,a.y)<T(e.tn,e.ta)*r+e.r){var" d="P(e.tn.x,e.tn.y,u,_);s">=d&&d>=o&&t.push(new Gt(new y(u,_),a,n,h(i.hashid,l)))}}},$t=function(t,e){var i=[],n=e.tPlanes,r=n.length,s=T(t.tn,t.ta),o=e.valueOnAxis(t.tn,s)-t.r,a=e.valueOnAxis(w(t.tn),-s)-t.r;if(a>0||o>0)return Wt;var c=0,l=Qt(t,n[0].n,n[0].d);if(l>0)return Wt;for(var u=0;u<r;u++){var _="Qt(t,n[u].n,n[u].d);if(_">0)return Wt;_>l&&(l=_,c=u)}var d=w(n[c].n),f=S(t.ta,I(d,t.r)),p=S(t.tb,I(d,t.r));if(e.containsVert(f.x,f.y)&&i.push(new Gt(f,d,l,h(t.hashid,0))),e.containsVert(p.x,p.y)&&i.push(new Gt(p,d,l,h(t.hashid,1))),(o>=l||a>=l)&&(o>a?Kt(i,t,e,o,1):Kt(i,t,e,a,-1)),0===i.length){var m,g=2*c,v=e.tVerts,x=new y(v[g],v[g+1]);if(m=Ut(t.ta,x,t.r,0,i))return[m];if(m=Ut(t.tb,x,t.r,0,i))return[m];var b=2*r,C=new y(v[(g+2)%b],v[(g+3)%b]);if(m=Ut(t.ta,C,t.r,0,i))return[m];if(m=Ut(t.tb,C,t.r,0,i))return[m]}return i},te=function(t,e){for(var i=e.tPlanes,n=0,r=T(i[0].n,t.tc)-i[0].d-t.r,s=0;s<i.length;s++){var o="T(i[s].n,t.tc)-i[s].d-t.r;if(o">0)return Wt;o>r&&(r=o,n=s)}var a=i[n].n,c=e.tVerts,h=c.length,l=n<<1,u=c[l],_=c[l+1],d=c[(l+2)%h],f=c[(l+3)%h],p=p(a.x,a.y,u,_),m=p(a.x,a.y,d,f),g=r(a,t.tc);if(g<m){var v="Ut(t.tc,new" y(d,f),t.r,0,v);return="" v?[v]:wt}if(g<p)return[new="" gt(e(t.tc,i(a,t.r+r="" 2)),w(a),r,0)];var="" y(u,_),t.r,0,v);return="" v?[v]:wt};$.prototype.collisioncode="0,et.prototype.collisionCode=1,nt.prototype.collisionCode=2,$.prototype.collisionTable=[jt,Xt,te],et.prototype.collisionTable=[null,function(t,e){return" wt},$t],nt.prototype.collisiontable="[null,null,Jt];var" ee="cp.collideShapes=function(t,e){return" s(t.collisioncode<="e.collisionCode,"Collided" shapes="" must="" be="" sorted="" by="" type"),t.collisiontable[e.collisioncode](t,e)},ie="new" mt,ne="cp.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new" dt(null),this.activeshapes="new" dt(this.staticshapes),this.arbiters="[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=ie,this.postStepCallbacks=[],this.iterations=10,this.gravity=x,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new" ot(1="" 0,1="" 0),this.staticbody.nodeidletime="1/0,this.collideShapes=this.makeCollideShapes()};ne.prototype.getCurrentTimeStep=function(){return" this.curr_dt},ne.prototype.setiterations="function(t){this.iterations=t},ne.prototype.isLocked=function(){return" this.locked};var="" re="function(t){s(!t.locked,"This" addition="" removal="" cannot="" done="" safely="" during="" a="" call="" to="" cpspacestep()="" or="" query.="" put="" these="" calls="" into="" post-step="" callback.")};ne.prototype.addcollisionhandler="function(t,e,i,n,r,s){re(this),this.removeCollisionHandler(t,e);var" o="new" mt;o.a="t,o.b=e,i&&(o.begin=i),n&&(o.preSolve=n),r&&(o.postSolve=r),s&&(o.separate=s),this.collisionHandlers[h(t,e)]=o},ne.prototype.removeCollisionHandler=function(t,e){re(this),delete" this.collisionhandlers[h(t,e)]},ne.prototype.setdefaultcollisionhandler="function(t,e,i,n){re(this);var" r="new" mt;t&&(r.begin="t),e&&(r.preSolve=e),i&&(r.postSolve=i),n&&(r.separate=n),this.defaultHandler=r},ne.prototype.lookupHandler=function(t,e){return" this.collisionhandlers[h(t,e)]||this.defaulthandler},ne.prototype.addshape="function(t){var" e="t.body;return" e.isstatic()?this.addstaticshape(t):(s(!t.space,"this="" shape="" is="" already="" added="" space="" and="" another."),re(this),e.activate(),e.addshape(t),t.update(e.p,e.rot),this.activeshapes.insert(t,t.hashid),t.space="this,t)},ne.prototype.addStaticShape=function(t){s(!t.space,"This" another."),re(this);var="" e.addshape(t),t.update(e.p,e.rot),this.staticshapes.insert(t,t.hashid),t.space="this,t},ne.prototype.addBody=function(t){return" s(!t.isstatic(),"static="" bodies="" as="" they="" are="" not="" meant="" simulated."),s(!t.space,"this="" body="" another."),re(this),this.bodies.push(t),t.space="this,t},ne.prototype.addConstraint=function(t){s(!t.space,"This" e.activate(),i.activate(),this.constraints.push(t),t.next_a="e.constraintList,e.constraintList=t,t.next_b=i.constraintList,i.constraintList=t,t.space=this,t},ne.prototype.filterArbiters=function(t,e){for(var" i="" in="" this.cachedarbiters){var="" n="this.cachedArbiters[i];(t!==n.body_a||e!==n.a&&null!==e)&&(t!==n.body_b||e!==n.b&&null!==e)||(e&&"cached"!==n.state&&n.callSeparate(this),n.unthread(),l(this.arbiters,n),delete" this.cachedarbiters[i])}},ne.prototype.removeshape="function(t){var" remove="" that="" was="" the="" space.="" (removed="" twice="" maybe?)"),re(this),e.activate(),e.removeshape(t),this.filterarbiters(e,t),this.activeshapes.remove(t,t.hashid),t.space="null)},ne.prototype.removeStaticShape=function(t){s(this.containsShape(t),"Cannot" static="" sleeping="" maybe?)"),re(this);var="" maybe?)"),re(this),t.activate(),l(this.bodies,t),t.space="null},ne.prototype.removeConstraint=function(t){s(this.containsConstraint(t),"Cannot" constraint="" maybe?)"),re(this),t.a.activate(),t.b.activate(),l(this.constraints,t),t.a.removeconstraint(t),t.b.removeconstraint(t),t.space="null},ne.prototype.containsShape=function(t){return" t.space="==this},ne.prototype.containsBody=function(t){return" this.cachedarbiters[h(t.a.hashid,t.b.hashid)],l(this.arbiters,t)},ne.prototype.eachbody="function(t){this.lock();for(var" manually="" reindex="" objects="" while="" locked.="" wait="" until="" current="" query="" step="" complete."),this.staticshapes.each((function(t){var="" complete.");var="" new="" error("spatial="" hash="" implemented.")},ne.prototype.activatebody="function(t){if(s(!t.isRogue(),"Internal" error:="" attempting="" activate="" rogue="" body."),this.locked)this.rousedbodies.indexof(t)="==-1&&this.rousedBodies.push(t);else{this.bodies.push(t);for(var" c="t.constraintList;c;c=c.nodeNext){var" deactivate="" body."),l(this.bodies,t);for(var="" se="function(t){return" t?t.noderoot:null},oe="function(t){if(t&&t.isSleeping(t)){s(!t.isRogue(),"Internal" componentactivate()="" called="" on="" body.");for(var="" non-static="" dangling="" contact="" graph="" pointers="" detected.="" (a)"),o(null="==(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal" (b)");var="" (c)"),t.body_a="==this?t.thread_a_next=e:t.thread_b_next=e,e&&(e.body_a===this?e.thread_a_prev=t:e.thread_b_prev=t),this.arbiterList=t};var" ae="function(t,e){e.nodeRoot=t,e!==t&&(e.nodeNext=t.nodeNext,t.nodeNext=e)},ce=function(t,e){if(!e.isRogue()){var" o(i="==t,"Internal" inconsistency="" detected="" graph.")}},he="function(t,e){for(var" next="" pointer="" graph."),o(null="==r.nodeRoot,"Internal" root="" graph.")}if(e)for(var="" s="this.idleSpeedThreshold,a=s?s*s:L(this.gravity)*t*t,n=0;n<i.length;n++){var">c?0:r.nodeIdleTime+t}for(var h=this.arbiters,n=0,l=h.length;n<l;n++){var u="h[n],_=u.body_a,d=u.body_b;e&&((d.isRogue()&&!d.isStatic()||_.isSleeping())&&_.activate(),(_.isRogue()&&!_.isStatic()||d.isSleeping())&&d.activate()),_.pushArbiter(u),d.pushArbiter(u)}if(e){for(var" f="this.constraints,n=0;n<f.length;n++){var" p="f[n],_=p.a,d=p.b;d.isRogue()&&!d.isStatic()&&_.activate(),_.isRogue()&&!_.isStatic()&&d.activate()}for(var" n="0;n<i.length;){var" r="i[n];if(null!==se(r)||(ce(r,r),he(r,this.sleepTimeThreshold)))n++,r.nodeRoot=null,r.nodeNext=null;else{this.sleepingComponents.push(r);for(var" m="r;m;m=m.nodeNext)this.deactivateBody(m)}}}},ot.prototype.sleep=function(){this.sleepWithGroup(null)},ot.prototype.sleepWithGroup=function(t){s(!this.isStatic()&&!this.isRogue(),"Rogue" and="" static="" bodies="" cannot="" be="" put="" to="" sleep.");var="" e="this.space;if(s(e,"Cannot" a="" rogue="" body="" sleep."),s(!e.locked,"bodies="" sleep="" during="" query="" or="" call="" cpspacestep().="" these="" calls="" into="" post-step="" callback."),s(null="==t||t.isSleeping(),"Cannot" use="" non-sleeping="" as="" group="" identifier."),this.issleeping())return="" void="" s(se(this)="==se(t),"The" is="" already="" sleeping="" it's="" reassigned.");for(var="" i="0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);if(e.deactivateBody(this),t){var" this.noderoot="this,this.nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this);l(e.bodies,this)},ne.prototype.activateShapesTouchingShape=function(t){this.sleepTimeThreshold!==1/0&&this.shapeQuery(t,(function(t,e){t.body.activate()}))},ne.prototype.pointQuery=function(t,e,i,n){var" x(t.x,t.y,t.x,t.y);this.lock(),this.activeshapes.query(s,r),this.staticshapes.query(s,r),this.unlock(!0)},ne.prototype.pointqueryfirst="function(t,e,i){var" this.pointquery(t,e,i,(function(t){t.sensor||(n="t)})),n},ne.prototype.nearestPointQuery=function(t,e,i,n,r){var" s="function(s){if((!s.group||n!==s.group)&&i&s.layers){var" o="s.nearestPointQuery(t);o.d<e&&r(s,o.d,o.p)}},o=Y(t,e);this.lock(),this.activeShapes.query(o,s),this.staticShapes.query(o,s),this.unlock(!0)},ne.prototype.nearestPointQueryNearest=function(t,e,i,n){var" r,s="function(s){if((!s.group||n!==s.group)&&i&s.layers&&!s.sensor){var" this.activeshapes.query(o,s),this.staticshapes.query(o,s),r},ne.prototype.segmentquery="function(t,e,i,n,r){var" o;return(!s.group||n!="=s.group)&&i&s.layers&&(o=s.segmentQuery(t,e))&&r(s,o.t,o.n),1};this.lock(),this.staticShapes.segmentQuery(t,e,1,s),this.activeShapes.segmentQuery(t,e,1,s),this.unlock(!0)},ne.prototype.segmentQueryFirst=function(t,e,i,n){var" this.staticshapes.segmentquery(t,e,1,s),this.activeshapes.segmentquery(t,e,r?r.t:1,s),r},ne.prototype.bbquery="function(t,e,i,n){var" x(t.bb_l,t.bb_b,t.bb_r,t.bb_t),r="!1,s=function(i){var" s;if(n.collisioncode<="i.collisionCode)s=ee(n,i);else{s=ee(i,n);for(var" array(s.length),o="0;o<s.length;o++)a[o]=new" nt(s[o].p,s[o].n,s[o].dist);e(i,a)}}};return="" this.lock(),this.activeshapes.query(n,s),this.staticshapes.query(n,s),this.unlock(!0),r},ne.prototype.addpoststepcallback="function(t){o(this.locked,"Adding" callback="" when="" the="" space="" not="" locked="" unnecessary.="" callbacks="" will="" called="" until="" end="" of="" next="" cpspacestep()="" query."),this.poststepcallbacks.push(t)},ne.prototype.runpoststepcallbacks="function(){for(var" t="0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},ne.prototype.lock=function(){this.locked++},ne.prototype.unlock=function(t){if(this.locked--,s(this.locked">=0,"Internal Error: Space lock underflow."),0===this.locked&&t){for(var e=this.rousedBodies,i=0;i<e.length;i++)this.activatebody(e[i]);e.length=0,this.runpoststepcallbacks()}},ne.prototype.makecollideshapes=function(){var t="this;return" function(e,i){var="" n="t;if(e.bb_l<=i.bb_r&&i.bb_l<=e.bb_r&&e.bb_b<=i.bb_t&&i.bb_b<=e.bb_t&&e.body!==i.body&&(!e.group||e.group!==i.group)&&e.layers&i.layers){var" r="n.lookupHandler(e.collision_type,i.collision_type),s=e.sensor||i.sensor;if(!s||r!==ie){if(e.collisionCode">i.collisionCode){var o=e;e=i,i=o}var a=ee(e,i);if(0!==a.length){var c=h(e.hashid,i.hashid),l=n.cachedArbiters[c];l||(l=n.cachedArbiters[c]=new Lt(e,i)),l.update(a,r,e,i),"first coll"!=l.state||r.begin(l,n)||l.ignore(),"ignore"!==l.state&&r.preSolve(l,n)&&!s?n.arbiters.push(l):(l.contacts=null,
"ignore"!==l.state&&(l.state="normal")),l.stamp=n.stamp}}}}},ne.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;return!(!i.isStatic()&&!i.isSleeping()||!n.isStatic()&&!n.isSleeping())||(e>=1&&"cached"!=t.state&&(t.callSeparate(this),t.state="cached"),!(e>=this.collisionPersistence)||(t.contacts=null,!1))};var le=function(t){var e=t.body;t.update(e.p,e.rot)};ne.prototype.step=function(t){if(0!==t){s(0===x.x&&0===x.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;var i,n,r,o=this.bodies,a=this.constraints,c=this.arbiters;for(i=0;i<c.length;i++){var h="c[i];h.state="normal",h.body_a.isSleeping()||h.body_b.isSleeping()||h.unthread()}for(c.length=0,this.lock(),i=0;i<o.length;i++)o[i].position_func(t);this.activeShapes.each(le),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock();for(r" in="" this.cachedarbiters)this.arbitersetfilter(this.cachedarbiters[r])||delete="" this.cachedarbiters[r];var="" l="this.collisionSlop,u=1-Math.pow(this.collisionBias,t);for(i=0;i<c.length;i++)c[i].preStep(t,l,u);for(i=0;i<a.length;i++){var" _="a[i];_.preSolve(this),_.preStep(t)}var" d="Math.pow(this.damping,t),f=this.gravity;for(i=0;i<o.length;i++)o[i].velocity_func(f,d,t);var" p="0===e?0:t/e;for(i=0;i<c.length;i++)c[i].applyCachedImpulse(p);for(i=0;i<a.length;i++)a[i].applyCachedImpulse(p);for(i=0;i<this.iterations;i++){for(n=0;n<c.length;n++)c[n].applyImpulse();for(n=0;n<a.length;n++)a[n].applyImpulse()}for(i=0;i<a.length;i++)a[i].postSolve(this);for(i=0;i<c.length;i++)c[i].handler.postSolve(c[i],this);this.unlock(!0)}};var" ue="function(t,e,i,n){var" r="t.vx+-i.y*t.w,s=t.vy+i.x*t.w,o=e.vx+-n.y*e.w,a=e.vy+n.x*e.w;return" new="" y(o-r,a-s)},_e="function(t,e,i,n,r){var" s="t.vx+-i.y*t.w,o=t.vy+i.x*t.w,a=e.vx+-n.y*e.w,c=e.vy+n.x*e.w;return" b(a-s,c-o,r.x,r.y)},de="function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},fe=function(t,e,i,n,r,s){de(t,-r,-s,i),de(e,r,s,n)},pe=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*P(n.x,n.y,e,i)},me=function(t,e,i){var" n="R(e,i);return" t.m_inv+t.i_inv*n*n},ge="function(t,e,i,n,r){var" o(0!="=s,"Unsolvable" collision="" or="" constraint."),s},ve="function(t,e,i,n,r,s){var" a,c,h,l,u="t.m_inv+e.m_inv;a=u,c=0,h=0,l=u;var" m="e.i_inv,g=n.x*n.x*m,v=n.y*n.y*m,y=-n.x*n.y*m;a+=v,c+=y,h+=y,l+=g;var" x="a*l-c*h;o(0!==x,"Unsolvable" constraint.");var="" t="1/x;r.x=l*T,r.y=-c*T,s.x=-h*T,s.y=a*T},ye=function(t,e,i){return" y(t(t,e),t(t,i))},xe="function(t,e){return" 1-math.pow(t,e)},te="cp.Constraint=function(t,e){this.a=t,this.b=e,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};Te.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},Te.prototype.preStep=function(t){},Te.prototype.applyCachedImpulse=function(t){},Te.prototype.applyImpulse=function(){},Te.prototype.getImpulse=function(){return" 0},te.prototype.presolve="function(t){},Te.prototype.postSolve=function(t){},Te.prototype.next=function(t){return" this.a="==t?this.next_a:this.next_b};var" be="cp.PinJoint=function(t,e,i,n){Te.call(this,t,e),this.anchr1=i,this.anchr2=n;var">0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};be.prototype=Object.create(Te.prototype),be.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=E(S(i.p,this.r2),S(e.p,this.r1)),r=C(n);this.n=I(n,1/(r?r:1/0)),this.nMass=1/ge(e,i,this.r1,this.r2,this.n);var s=this.maxBias;this.bias=g(-xe(this.errorBias,t)*(r-this.dist)/t,-s,s),this.jnMax=this.maxForce*t},be.prototype.applyCachedImpulse=function(t){var e=I(this.n,this.jnAcc*t);fe(this.a,this.b,this.r1,this.r2,e.x,e.y)},be.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=_e(t,e,this.r1,this.r2,i),r=(this.bias-n)*this.nMass,s=this.jnAcc;this.jnAcc=g(s+r,-this.jnMax,this.jnMax),r=this.jnAcc-s,fe(t,e,this.r1,this.r2,i.x*r,i.y*r)},be.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Ce=cp.SlideJoint=function(t,e,i,n,r,s){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=r,this.max=s,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Ce.prototype=Object.create(Te.prototype),Ce.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=E(S(i.p,this.r2),S(e.p,this.r1)),r=C(n),s=0;r>this.max?(s=r-this.max,this.n=z(n)):r<this.min?(s=this.min-r,this.n=w(z(n))):(this.n=x,this.jnacc=0),this.nmass=1 ge(e,i,this.r1,this.r2,this.n);var="" o="this.maxBias;this.bias=g(-xe(this.errorBias,t)*s/t,-o,o),this.jnMax=this.maxForce*t},Ce.prototype.applyCachedImpulse=function(t){var" e="this.jnAcc*t;fe(this.a,this.b,this.r1,this.r2,this.n.x*e,this.n.y*e)},Ce.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var" t="this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,s=ue(t,e,n,r),o=T(s,i),a=(this.bias-o)*this.nMass,c=this.jnAcc;this.jnAcc=g(c+a,-this.jnMax,0),a=this.jnAcc-c,fe(t,e,this.r1,this.r2,i.x*a,i.y*a)}},Ce.prototype.getImpulse=function(){return" math.abs(this.jnacc)};var="" ae="cp.PivotJoint=function(t,e,i,n){if(Te.call(this,t,e),"undefined"==typeof" n){var="" r="i;i=t?t.world2Local(r):r,n=e?e.world2Local(r):r}this.anchr1=i,this.anchr2=n,this.r1=this.r2=x,this.k1=new" y(0,0),this.k2="new" y(0,0),this.jacc="x,this.jMaxLen=0,this.bias=x};Ae.prototype=Object.create(Te.prototype),Ae.prototype.preStep=function(t){var" n="E(S(i.p,this.r2),S(e.p,this.r1));this.bias=V(I(n,-xe(this.errorBias,t)/t),this.maxBias)},Ae.prototype.applyCachedImpulse=function(t){fe(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Ae.prototype.applyImpulse=function(){var" c(this.jacc)};var="" se="cp.GrooveJoint=function(t,e,i,n,r){Te.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=O(k(E(n,i))),this.anchr2=r,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new" a="R(S(i.p,this.r2),s);a<=R(n,s)?(this.clamp=1,this.r1=E(n,e.p)):a">=R(r,s)?(this.clamp=-1,this.r1=E(r,e.p)):(this.clamp=0,this.r1=E(S(I(O(s),-a),I(s,o)),e.p)),ve(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var c=E(S(i.p,this.r2),S(e.p,this.r1));this.bias=V(I(c,-xe(this.errorBias,t)/t),this.maxBias)},Se.prototype.applyCachedImpulse=function(t){fe(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Se.prototype.grooveConstrain=function(t){var e=this.grv_tn,i=this.clamp*R(t,e)>0?t:B(t,e);return V(i,this.jMaxLen)},Se.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,r=ue(t,e,i,n),s=ye(E(this.bias,r),this.k1,this.k2),o=this.jAcc;this.jAcc=this.grooveConstrain(S(o,s)),fe(t,e,this.r1,this.r2,this.jAcc.x-o.x,this.jAcc.y-o.y)},Se.prototype.getImpulse=function(){return C(this.jAcc)},Se.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=O(k(E(this.grv_b,t))),this.activateBodies()},Se.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=O(k(E(t,this.grv_a))),this.activateBodies()};var Ee=function(t,e){return(t.restLength-e)*t.stiffness},we=cp.DampedSpring=function(t,e,i,n,r,s,o){Te.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=r,this.stiffness=s,this.damping=o,this.springForceFunc=Ee,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};we.prototype=Object.create(Te.prototype),we.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=E(S(i.p,this.r2),S(e.p,this.r1)),r=C(n);this.n=I(n,1/(r?r:1/0));var s=ge(e,i,this.r1,this.r2,this.n);o(0!==s,"Unsolvable this."),this.nMass=1/s,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*s);var a=this.springForceFunc(this,r);fe(e,i,this.r1,this.r2,this.n.x*a*t,this.n.y*a*t)},we.prototype.applyCachedImpulse=function(t){},we.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,s=_e(t,e,n,r,i),o=(this.target_vrn-s)*this.v_coef;this.target_vrn=s+o,o*=this.nMass,fe(t,e,this.r1,this.r2,this.n.x*o,this.n.y*o)},we.prototype.getImpulse=function(){return 0};var Ie=function(t,e){return(e-t.restAngle)*t.stiffness},Re=cp.DampedRotarySpring=function(t,e,i,n,r){Te.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=r,this.springTorqueFunc=Ie,this.target_wrn=0,this.w_coef=0,this.iSum=0};Re.prototype=Object.create(Te.prototype),Re.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;o(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0;var r=this.springTorqueFunc(this,e.a-i.a)*t;e.w-=r*e.i_inv,i.w+=r*i.i_inv},Re.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n;var r=n*this.iSum;t.w+=r*t.i_inv,e.w-=r*e.i_inv};var Pe=cp.RotaryLimitJoint=function(t,e,i,n){Te.call(this,t,e),this.min=i,this.max=n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Pe.prototype=Object.create(Te.prototype),Pe.prototype.preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,r=0;n>this.max?r=this.max-n:n<this.min&&(r=this.min-n),this.isum=1 (1="" e.i+1="" i.i);var="" s="this.maxBias;this.bias=g(-xe(this.errorBias,t)*r/t,-s,s),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Pe.prototype.applyCachedImpulse=function(t){var" e="this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Pe.prototype.applyImpulse=function(){if(this.bias){var" t="this.a,e=this.b,i=e.w-t.w,n=-(this.bias+i)*this.iSum,r=this.jAcc;this.bias<0?this.jAcc=g(r+n,0,this.jMax):this.jAcc=g(r+n,-this.jMax,0),n=this.jAcc-r,t.w-=n*t.i_inv,e.w+=n*e.i_inv}},Pe.prototype.getImpulse=function(){return" math.abs(joint.jacc)};var="" oe="cp.RatchetJoint=function(t,e,i,n){Te.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};Oe.prototype=Object.create(Te.prototype),Oe.prototype.preStep=function(t){var">0?c=a:this.angle=Math.floor((o-r)/s)*s+r,this.iSum=1/(e.i_inv+i.i_inv);var h=this.maxBias;this.bias=g(-xe(this.errorBias,t)*c/t,-h,h),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Oe.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Oe.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=this.ratchet,r=-(this.bias+i)*this.iSum,s=this.jAcc;this.jAcc=g((s+r)*n,0,this.jMax*Math.abs(n))/n,r=this.jAcc-s,t.w-=r*t.i_inv,e.w+=r*e.i_inv}},Oe.prototype.getImpulse=function(t){return Math.abs(t.jAcc)};var Be=cp.GearJoint=function(t,e,i,n){Te.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Be.prototype=Object.create(Te.prototype),Be.prototype.preStep=function(t){var e=this.a,i=this.b;this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv);var n=this.maxBias;this.bias=g(-xe(this.errorBias,t)*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},Be.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv*this.ratio_inv,i.w+=n*i.i_inv},Be.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w*this.ratio-t.w,n=(this.bias-i)*this.iSum,r=this.jAcc;this.jAcc=g(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv*this.ratio_inv,e.w+=n*e.i_inv},Be.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Be.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()};var De=cp.SimpleMotor=function(t,e,i){Te.call(this,t,e),this.rate=i,this.jAcc=0,this.iSum=this.jMax=0};De.prototype=Object.create(Te.prototype),De.prototype.preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},De.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},De.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w-t.w+this.rate,n=-i*this.iSum,r=this.jAcc;this.jAcc=g(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv,e.w+=n*e.i_inv},De.prototype.getImpulse=function(){return Math.abs(this.jAcc)}}),{}],312:[(function(t,e,i){e.exports=(function(){"use strict";function t(){if("undefined"==typeof window.performance&&(window.performance={}),!window.performance.now){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}window.performance.mark||(window.performance.mark=function(){}),window.performance.measure||(window.performance.measure=function(){}),window.performance.memory||(window.performance.memory={usedJSHeapSize:0,totalJSHeapSize:0})}function e(t){var e=100,i=Math.floor(Math.log(t)/p);return 0===t?"n/a":Math.round(t*e/Math.pow(1024,i))/e+" "+m[i]}var i=Math.round(window.devicePixelRatio||1),n=function(t,e){this._color=e||"#666",this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvas.className="pstats-canvas",t.appendChild(this._canvas)};n.prototype.init=function(t,e){var n=t*i,r=e*i;this._canvas.width=n,this._canvas.height=r,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px",this._ctx.globalAlpha=1,this._ctx.fillStyle="#444",this._ctx.fillRect(0,0,n,r)};var r=Math.round(window.devicePixelRatio||1),s=(function(t){function e(e,i){t.call(this,e,i),this._current=0,this._max=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.draw=function(t,e){var i=this._canvas.width,n=this._canvas.height;this._current+=.1*(t-this._current),this._max*=.99,this._current>this._max&&(this._max=this._current);var s=Math.round((1-this._current/this._max)*n);this._ctx.globalAlpha=1,this._ctx.drawImage(this._canvas,r,0,i-r,n,0,0,i-r,n),e?(this._ctx.fillStyle="#444",this._ctx.fillRect(i-r,0,r,n),this._ctx.fillStyle="#b70000",this._ctx.fillRect(i-r,s,r,n-s),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-r,s,r,r)):(this._ctx.fillStyle="#444",this._ctx.fillRect(i-r,0,r,n),this._ctx.fillStyle=this._color,this._ctx.fillRect(i-r,s,r,n-s),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-r,s,r,r))},e})(n),o=Math.round(window.devicePixelRatio||1),a=(function(t){function e(e,i){t.call(this,e,i),this._threshold=0,this._canvas2=document.createElement("canvas"),this._ctx2=this._canvas2.getContext("2d")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(e,i){t.prototype.init.call(this,e,i);var n=e*o,r=i*o;this._canvas2.width=n,this._canvas2.height=r,this._canvas2.style.width=e+"px",this._canvas2.style.height=i+"px",this._ctx2.globalAlpha=1,this._ctx2.fillStyle="#444",this._ctx2.fillRect(0,0,n,r)},e.prototype.draw=function(t,e){var i=this._canvas.width,n=this._canvas.height;if(this._ctx.globalAlpha=1,this._ctx2.globalAlpha=1,t>this._threshold){var r=(t-t%n)/n,s=n*(r+1),a=this._threshold;this._threshold=s;var c=a/s;this._ctx2.drawImage(this._canvas,0,0),this._ctx.fillStyle="#444",this._ctx.fillRect(0,0,i,n),this._ctx.drawImage(this._canvas2,o,0,i-o,n,0,Math.round((1-c)*n),i-o,n)}else this._ctx.drawImage(this._canvas,o,0,i-o,n,0,0,i-o,n);var h=Math.round(n*(1-t/this._threshold));e?(this._ctx.fillStyle="#444",this._ctx.fillRect(i-o,0,o,n),this._ctx.fillStyle="#b70000",this._ctx.fillRect(i-o,h,o,n-h),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-o,h,o,o)):(this._ctx.fillStyle="#444",this._ctx.fillRect(i-o,0,o,n),this._ctx.fillStyle=this._color,this._ctx.fillRect(i-o,h,o,n-h),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-o,h,o,o))},e})(n),c=Math.round(window.devicePixelRatio||1),h=(function(t){function e(e,i,n,r){t.call(this,e,i),this._min=n,this._max=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.draw=function(t,e){var i=this._canvas.width,n=this._canvas.height,r=(t-this._min)/(this._max-this._min),s=Math.round((1-r)*n);this._ctx.globalAlpha=1,this._ctx.drawImage(this._canvas,c,0,i-c,n,0,0,i-c,n),e?(this._ctx.fillStyle="#444",this._ctx.fillRect(i-c,0,c,n),this._ctx.fillStyle="#b70000",this._ctx.fillRect(i-c,s,c,n-s),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-c,s,c,c)):(this._ctx.fillStyle="#444",this._ctx.fillRect(i-c,0,c,n),this._ctx.fillStyle=this._color,this._ctx.fillRect(i-c,s,c,n-s),this._ctx.globalAlpha=.5,this._ctx.fillStyle="#fff",this._ctx.fillRect(i-c,s,c,c))},e})(n),l=Math.round(window.devicePixelRatio||1),u=function(t,e){this._colors=e,this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvas.className="pstats-canvas",t.appendChild(this._canvas)};u.prototype.init=function(t,e,i){var n=t*l,r=e*l;this._canvas.width=n,this._canvas.height=r*i,this._canvas.style.width=t+"px",this._canvas.style.height=e*i+"px",this._ctx.globalAlpha=1,this._ctx.fillStyle="#444",this._ctx.fillRect(0,0,n,r*i)},u.prototype.draw=function(t){var e=this,i=this._canvas.width,n=this._canvas.height;this._ctx.globalAlpha=1,this._ctx.drawImage(this._canvas,l,0,i-l,n,0,0,i-l,n);for(var r=0,s=0;s<t.length;++s){var o="t[s]*n;e._ctx.fillStyle=e._colors[s],e._ctx.fillRect(i-l,r,l,o),r+=o}};var" _="function(t,e){this._id=t,this._opts=e||{},this._value=0,this._total=0,this._averageValue=0,this._accumValue=0,this._accumSamples=0,this._accumStart=window.performance.now()},d={value:{}};_.prototype._average=function(t){if(this._opts.average){this._accumValue+=t,++this._accumSamples;var" e="performance.now();e-this._accumStart">=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=e,this._accumSamples=0)}},d.value.get=function(){return this._value},d.value.set=function(t){this._value=t},_.prototype.sample=function(){this._average(this._value)},_.prototype.human=function(){var t=this._opts.average?this._averageValue:this._value;return Math.round(100*t)/100},_.prototype.alarm=function(){return this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over},Object.defineProperties(_.prototype,d);var f=(function(t){function e(e,i){t.call(this,e,i),this._time=window.performance.now()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.start=function(){this._time=window.performance.now()},e.prototype.end=function(){this._value=window.performance.now()-this._time,this._average(this._value)},e.prototype.tick=function(){this.end(),this.start()},e.prototype.frame=function(){var t=window.performance.now(),e=t-this._time;this._total++;var i=this._opts.average||1e3;e>i&&(this._value=1e3*this._total/e,this._total=0,this._time=t,this._average(this._value))},e})(_),p=Math.log(1024),m=["Bytes","KB","MB","GB","TB"],g=(function(t){function i(e,i,n){t.call(this,i,n),this._stats=e,this._start=0,0===n.extension.indexOf("memory.")&&(this._field=n.extension.substring(7))}return t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i,i.prototype.snapshot=function(){this._value=this._stats[this._field]},i.prototype.start=function(){this._start=this._stats[this._field]},i.prototype.end=function(){this._value=this._stats[this._field]-this._start},i.prototype.human=function(){return e(t.prototype.human.call(this))},i})(_),v=function(){var t=window.performance.memory;0===t.totalJSHeapSize&&console.warn("totalJSHeapSize === 0, performance.memory is only available in Chrome."),this._used=0,this._total=0,this._lastUsed=0},y={alarm:{},used:{},total:{}};v.prototype.tick=function(){this._lastUsed=this._used,this._used=window.performance.memory.usedJSHeapSize,this._total=window.performance.memory.totalJSHeapSize},y.alarm.get=function(){return this._used-this._lastUsed<0},y.used.get=function(){return window.performance.memory.usedjsheapsize},y.total.get="function(){return" this._total},v.prototype.counter="function(t,e){return" new="" g(this,t,e)},object.defineproperties(v.prototype,y);var="" x="{memory:v},T=100,b=10,C="\n" .pstats="" {\n="" position:="" fixed;\n="" z-index:="" 9999;\n\n="" padding:="" 5px;\n="" width:="" "+(t+150)+"px;\n="" right:="" bottom:="" 5px;\n\n="" font-size:="" 10px;\n="" font-family:="" 'roboto="" condensed',="" tahoma,="" sans-serif;\n="" overflow:="" hidden;\n="" user-select:="" none;\n="" cursor:="" default;\n\n="" background:="" #222;\n="" border-radius:="" 3px;\n="" }\n\n="" .pstats-container="" display:="" block;\n="" relative;\n="" color:="" #888;\n="" white-space:="" nowrap;\n="" .pstats-item="" absolute;\n="" 250px;\n="" height:="" 12px;\n="" left:="" 0px;\n="" .pstats-label="" 150px;\n="" text-align:="" left;\n="" transition:="" background="" 0.3s;\n="" .pstats-label.alarm="" #ccc;\n="" #800;\n\n="" 0s;\n="" .pstats-counter-id="" 90px;\n="" .pstats-counter-value="" 60px;\n="" right;\n="" .pstats-canvas="" top:="" 1px;\n="" .pstats-fraction="" .pstats-legend="" 150px;\n\n=""> span {\n    position: absolute;\n    right: 0px;\n  }\n",A=document.createElement("style");A.type="text/css",A.textContent=C,document.head.appendChild(A);var S=function(t,e){var i=this;if(e=e||{},this._showGraph=void 0===e.showGraph||e._showGraph,this._values=e.values||{},this._fractions=e.fractions||[],this._id2counter={},this._id2item={},this._name2extStats={},e.css){var n=document.createElement("style");n.type="text/css",n.textContent=e.css,document.head.appendChild(n)}if(e.extensions)for(var r=0;r<e.extensions.length;++r){var o="e.extensions[r],c=x[o];c?i._name2extStats[o]=new" c:console.warn("can="" not="" find="" extensions="" "+o+",="" please="" register="" your="" extension="" via="" pstats.register().")}this._root="document.createElement("div"),this._root.className="pstats";var" l="document.createElement("div");l.className="pstats-container",this._root.appendChild(l);var" _="0;for(var" d="" in="" i._values){var="" f="i._values[d],p=document.createElement("div");p.className="pstats-item";var" m="document.createElement("div");m.className="pstats-label";var" g="document.createElement("span");g.className="pstats-counter-id",g.textContent=f.desc||d;var" v="document.createElement("div");v.className="pstats-counter-value";var" y="document.createTextNode("");y.nodeValue="0",m.appendChild(g),m.appendChild(v),v.appendChild(y),p.appendChild(m);var" c="void" 0;i._showgraph&&(c="void" 0!="=f.min||void" h(p,f.color,f.min||0,f.max||9999):f.threshold?new="" a(p,f.color):new="" s(p,f.color),c.init(t-5,b)),i._id2item[d]="{label:m,valueText:y,graph:C},p.style.top=_+"px",l.appendChild(p),_+=12}if(this._showGraph&&e.fractions)for(var" a="0;A<e.fractions.length;++A){var" s="e.fractions[A],E=S.steps,w=E.length*b+2;S.colors=S.colors||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];var" i="document.createElement("div");I.className="pstats-fraction";var" r="document.createElement("div");R.className="pstats-legend",R.style.height=w+"px";for(var" p="0;P<E.length;++P){var" b="new" u(i,s.colors);b.init(t-5,b,e.length),s.graph="B,S.values=new" array(e.length),l.appendchild(i),_+="E.length*b+2}l.style.height=_+"px",this._root.style.height=_+"px",this._showGraph||(this._root.style.width="150px"),t.appendChild(this._root)};S.prototype.item=function(t){if(!t)return" null;var="" e="this._id2counter[t];if(e)return" e;var="" null;if(i.extension){var="" n="i.extension.indexOf("."),r=i.extension.substring(0,n),s=this._name2extStats[r];if(!s)return" console.error("extension="" "+r+"="" found,="" make="" sure="" you="" have="" and="" enable="" it."),null;e="s.counter(t,i)}else" f(t,i);return="" this._id2counter[t]="e,e},S.prototype.tick=function(){var" t="this;for(var" t._name2extstats){var="" t._values){var="">0),a.valueText.nodeValue=o,t._showGraph&&a.graph.draw(r.value,s)}}if(this._showGraph)for(var c=0;c<this._fractions.length;++c){var h="t._fractions[c],l=t._id2counter[h.base];if(l){for(var" u="h.steps,_=0;_<u.length;++_){var" d="u[_],f=t._id2counter[d];f&&(h.values[_]=f.value/l.value)}h.graph.draw(h.values)}}},t();var" e="{new:function(t,e){var" i="new" s(t,e);return="" function(t){return="" t?i.item(t):i}},register:function(t,e){x[t]="e}};return" e})()}),{}],313:[(function(t,e,i){function('if(typeof="" cc_test="="undefined")CC_TEST=typeof" tap="="object"||typeof" qunit="="object";if(typeof" cc_editor="="undefined")CC_EDITOR=typeof" editor="="object"&&typeof" process="="object"&&"electron"" in="" process.versions;if(typeof="" cc_dev="="undefined")CC_DEV=CC_EDITOR||CC_TEST;if(typeof" cc_jsb="="undefined")CC_JSB=false;')(),t("./predefine");var" n="!1;n?cc._initDebugSetting(1):t("./cocos2d/index.js"),t("./extends"),n&&(Editor.versions.cocos2d=t("./package.json").version),e.exports=cc}),{"./cocos2d/index.js":240,"./extends":289,"./package.json":void" 0,".="" predefine":318}],314:[(function(t,e,i){array.isarray||(array.isarray="function(t){return"[object" array]"="==Object.prototype.toString.call(t)})}),{}],315:[(function(t,e,i){Math.sign||(Math.sign=function(t){return" t="+t,0===t||isNaN(t)?t:t">0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&(0|t)===t})}),{}],316:[(function(t,e,i){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.lastIndexOf(t,e)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){("undefined"==typeof e||e>this.length)&&(e=this.length),e-=t.length;var i=this.indexOf(t,e);return i!==-1&&i===e})}),{}],317:[(function(t,e,i){window.__extends=function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},window.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r="" in="" e)object.prototype.hasownproperty.call(e,r)&&(t[r]="e[r])}return" t},window.__rest="function(t,e){var" i="{};for(var" n="" t)object.prototype.hasownproperty.call(t,n)&&e.indexof(n)<0&&(i[n]="t[n]);if(null!=t&&"function"==typeof" object.getownpropertysymbols)for(var="" i},window.__decorate="function(t,e,i,n){var" r,s="arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof" reflect&&"function"="=typeof" reflect.decorate)o="Reflect.decorate(t,e,i,n);else" for(var="" a="t.length-1;a">=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o},window.__param=function(t,e){return function(i,n){e(i,n,t)}},window.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},window.__awaiter=function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(o,a)}c((n=n.apply(t,e)).next())})},window.__generator=function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,s=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]</3?r(o):s></n;i++){e=arguments[i];for(var></this._fractions.length;++c){var></e.extensions.length;++r){var></0},y.used.get=function(){return></this._opts.below||this._opts.over&&this._value></t.length;++s){var></this.min&&(r=this.min-n),this.isum=1></this.min?(s=this.min-r,this.n=w(z(n))):(this.n=x,this.jnacc=0),this.nmass=1></c.length;i++){var></e.length;i++)this.activatebody(e[i]);e.length=0,this.runpoststepcallbacks()}},ne.prototype.makecollideshapes=function(){var></l;n++){var></1,u=c[l],_=c[l+1],d=c[(l+2)%h],f=c[(l+3)%h],p=p(a.x,a.y,u,_),m=p(a.x,a.y,d,f),g=r(a,t.tc);if(g<m){var></i.length;s++){var></r;u++){var></c.length;l+=2){var></l.length;o+=2){var></s.length;o+=2){var></e.length;r++){var></0||1===o&&t(h,e.b_tangent)<0?wt:[c]}return></u;_++)f[2*_+0]=e[_].bb_l,f[2*_+1]=e[_].bb_r;else></u;_++)o=e[_],a=n(a,o.bb_l),c=n(c,o.bb_b),h=r(h,o.bb_r),l=r(l,o.bb_t);var></=t.bb_b&&this.bb_t></s?t.setb(at(t.b,e,i)):t.seta(at(t.a,e,i)),t.bb_l=n(t.bb_l,e.bb_l),t.bb_b=n(t.bb_b,e.bb_b),t.bb_r=r(t.bb_r,e.bb_r),t.bb_t=r(t.bb_t,e.bb_t),t};pt.prototype.intersectsbb=gt.prototype.intersectsbb=function(t){return></i;e++)t(this.shapelist[e])},ot.prototype.eachconstraint=function(t){for(var></n.length;r++){var></0||1<l)){var></s&&(s=d,o=u),n=h,r=l}return></i.length;l+=2){var></i;r+=2){var></0)return></=0){var></=l&&l<=1)return></i*i},cp.v.slerp=function(t,e,i){var></0)return></=u;){var></a;c++){var></e?t+"></-ke;)g+=2*ke,a=g-this.m_as[e];var></e;++n)this.solvec2(),this.solvec3(),this.solvec2();for(var></s;++i){var></this.m_count;++i){this.m_ps[i]=e.vertices[i].clone(),this.m_p0s[i]=e.vertices[i].clone(),this.m_vs[i]=new></0&&(h+=t.step.inv_dt*c);var></ni},_serialize:function(t){var></=e&&e<=1),this.m_correctionfactor=e},getcorrectionfactor:function(){return></ni},_serialize:function(t){var></=ni},_serialize:function(t){var></=ni&&i<=ri},_serialize:function(t){var></=ni&&o<=ri},_serialize:function(t){var></2*ni?(d=f(m,-hi,hi),p=pi(p,ii(m)),b=!0):m<=this.m_lowertranslation?(d=f(m-this.m_lowertranslation+ni,-hi,0),p=pi(p,this.m_lowertranslation-m),b=!0):m></2*ni?this.m_limitstate=ae.e_equallimits:r<=this.m_lowertranslation?this.m_limitstate!=ae.e_atlowerlimit&&(this.m_limitstate=ae.e_atlowerlimit,this.m_impulse.z=0):r></ni},_serialize:function(t){var></=ni&&l<=ri},_serialize:function(t){var></0){var></2*ri?this.m_limitstate=ae.e_equallimits:g<=this.m_lowerangle?(this.m_limitstate!=ae.e_atlowerlimit&&(this.m_impulse.z=0),this.m_limitstate=ae.e_atlowerlimit):g></this.m_bodycapacity),e.m_islandindex=this.m_bodycount,this.m_bodies[this.m_bodycount]=e,this.m_positions[this.m_bodycount]||(this.m_positions[this.m_bodycount]=new></this.m_bodycount;++r){var></t.positioniterations;++r){for(var></this.m_bodycount;++r){var></this.m_count;++n){var></this.m_count;++t)for(var></-ci&&(e.velocitybias=-i.restitution*l)}if(2==i.pointcount){var></a;++s){var></d;++m){var></this.m_count;++i){var></=r&&s<y.e_typecount),t(0<=r&&s<y.e_typecount),e.m_nodea.clear(),e.m_nodeb.clear(),se.s_registers[r][s].fcn.garbage.push(e)},se.s_registers=[],se.s_initialized=!1;var></this.m_manifold.pointcount;++_){var></l.m_sweep.alpha0?(g=l.m_sweep.alpha0,h.m_sweep.advance(g)):l.m_sweep.alpha0<h.m_sweep.alpha0&&(g=h.m_sweep.alpha0,l.m_sweep.advance(g)),t(g<1);var></s),o[c++]=d,d.m_flags|=ft.e_islandflag)}}}for(var></n.m_proxycount;++f){var></=e&&e<this.m_proxycount),this.m_proxies[e].aabb},create:function(t,e){this.m_userdata=e.userdata,this.m_friction=e.friction,this.m_restitution=e.restitution,this.m_body=t,this.m_next=null,this.m_filter.assign(e.filter),this.m_issensor=e.issensor,this.m_shape=e.shape.clone();var></o;++a)r.touchproxy(s.m_proxies[a].proxyid)}},gettype:function(){return></=0&&(this.m_mass=1),this.m_invmass=1></=e&&e<this.m_nodecapacity);var></-1){var></=c&&c<this.m_nodecapacity),t(0<=h&&h<this.m_nodecapacity),o.child1=e,o.parent=i.parent,i.parent=r,o.parent!=mi?this.m_nodes[o.parent].child1==e?this.m_nodes[o.parent].child1=r:(t(this.m_nodes[o.parent].child2==e),this.m_nodes[o.parent].child2=r):this.m_root=r,l.height></e;++i)for(var></=i&&i<this.m_nodecapacity),i=this.m_nodes[i].parent,++e;t(this.getheight()==this.computeheight()),t(this.m_nodecount+e==this.m_nodecapacity)},getheight:function(){return></=e&&e<this.m_nodecapacity),t(this.m_nodes[e].isleaf()),this.removeleaf(e),this.freenode(e)},moveproxy:function(e,i,n){if(t(0<=e&&e<this.m_nodecapacity),t(this.m_nodes[e].isleaf()),this.m_nodes[e].aabb.contains(i))return!1;this.removeleaf(e),this.m_nodes[e].aabb.assign(i),this.m_nodes[e].aabb.lowerbound.subtract(ot.aabbextensionfattener),this.m_nodes[e].aabb.upperbound.add(ot.aabbextensionfattener);var></-ri)continue}else></this.m_polygonb.count;++_){var></n.m_count;++_)this.m_polygonb.vertices[_]=r(this.m_xf,n.m_vertices[_]),this.m_polygonb.normals[_]=w(this.m_xf.q,n.m_normals[_]);this.m_radius=2*si,t.pointcount=0;var></0||e.maxfraction<i)&&(t.fraction=i,t.normal.x=c.x,t.normal.y=c.y,!0)}},xt._localtangent=new></=t.lowerbound.x&&this.lowerbound.y<=t.lowerbound.y&&t.upperbound.x<=this.upperbound.x&&t.upperbound.y<=this.upperbound.y},raycast:function(t,e){for(var></t.pointcount;++v){var></=0){var></=0){var></=0){var></=0)return></.5*u||2*u<_||_<qe)&&(this.m_count=0)}if(0==this.m_count){var></=e&&e<this.m_count),this.m_vertices[e]}},rt.prototype={assign:function(t){this.wa.x=t.wa.x,this.wa.y=t.wa.y,this.wb.x=t.wb.x,this.wb.y=t.wb.y,this.w.x=t.w.x,this.w.y=t.w.y,this.a=t.a,this.indexa=t.indexa,this.indexb=t.indexb}},st.prototype={readcache:function(e,i,n,r,s){t(e.count<=3),this.m_count=e.count;for(var></this.m_movecount;++e)if(this.m_queryproxyid=this.m_movebuffer[e],this.m_queryproxyid!=$.e_nullproxy){var></i;++c){var></=e&&e<this.m_count),this.m_vertices[e]},validate:function(){for(var></this.m_count;++c)a.add(this.m_vertices[c]);a.multiply(1></this.m_count;++a){var></l*p&&(l=f></this.m_count;++d){var></this.m_count;++o)this.m_vertices[o].assign(r(s,this.m_vertices[o])),this.m_normals[o].assign(w(s.q,this.m_normals[o]))}},testpoint:function(t,e){for(var></3)return></s[u].y)&&(u=a,f=p)}for(var></this.m_count-2?(e.m_vertex3=this.m_vertices[i+2],e.m_hasvertex3=!0):(e.m_vertex3=this.m_nextvertex,e.m_hasvertex3=this.m_hasnextvertex)},testpoint:function(t,e){return!1},raycast:function(e,i,n,r){t(r<this.m_count);var></i;++n)this.m_vertices[n]=e[n].clone();this.m_hasprevvertex=!1,this.m_hasnextvertex=!1,this.m_prevvertex.setzero(),this.m_nextvertex.setzero()},setprevvertex:function(t){this.m_prevvertex.assign(t),this.m_hasprevvertex=!0},setnextvertex:function(t){this.m_nextvertex.assign(t),this.m_hasnextvertex=!0},clone:function(){var></i;++n){var></i;++n)this.m_vertices[n]=e[n].clone();this.m_vertices[i]=this.m_vertices[0].clone(),this.m_prevvertex.assign(this.m_vertices[this.m_count-2]),this.m_nextvertex.assign(this.m_vertices[1]),this.m_hasprevvertex=!0,this.m_hasnextvertex=!0},createchain:function(e,i){t(null==this.m_vertices&&0==this.m_count),t(i></i;++n)t(v(e[n-1],e[n])></qe)return></this.points.length;++t)this.points[t]=new></a-c){e.state=dt.e_failed,e.t=h,m=!0;break}if(t<=a+c){e.state=dt.e_touching,e.t=h,m=!0;break}for(var></=0){e.state=dt.e_overlapped,e.t=0;break}if(f.distance<a+c){e.state=dt.e_touching,e.t=h;break}var></this.m_nodecapacity-1;++t)this.m_nodes[t]=new></0&&(m=-m,l=-l),f.indexa=0,f.typea=at.e_face,e.pointcount=1,e.type=ht.e_facea,e.localnormal.x=m,e.localnormal.y=l,e.localnormal.normalize(),e.localpoint.x=a.x,e.localpoint.y=a.y,e.points[0]=new></=0){var></g?f+1:0,t=v[y],b=v[x];xt._localtangent.x=b.x-t.x,xt._localtangent.y=b.y-t.y,xt._localtangent.normalize();var></=r&&r<i.m_count);for(var></s;++d){for(var></=0){if(v(o,y)></l?p+1:0,g=u[p],y=u[m];if(c<qe)return></l;++d){var></$e;++r)t[r]=ht.b2_nullstate,e[r]=ht.b2_nullstate;for(var></h;){_=oi.m_count;for(var></t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},t.prototype.clear=function(){this.items.length=0},t})();t.pool=o;var></t;n++)i[n]=e;return></0?-e:e},t.pi=3.1415927,t.pi2=2*t.pi,t.radianstodegrees=180></0?-1:0},t.toint=function(t){return></e?e:t></0?this.a=0:this.a></0?this.b=0:this.b></0?this.g=0:this.g></-t.mathutils.pi&&(b+=t.mathutils.pi2),b=i+(b+_)*r;var></-t.mathutils.pi&&(b+=t.mathutils.pi2),b*=e;var></p;f++){var></3;n++){var></this.regions.length;e++)if(this.regions[e].name==t)return></t.slots.length;n++){var></e.events.length;f++){var></=i))return!0}l=d,u=f}return!1},e.prototype.getpolygon=function(t){if(null==t)throw></=r||x></=u)&&(x></=f||x></=e)){var></=n||y></=l)&&(y></=d||y></e&&(o=!o)}s=a}return></i&&c></r;n++)if(this.containspointpolygon(i[n],t,e))return></t.maxy&&this.maxy></o)},e.prototype.aabbintersectsskeleton=function(t){return></o||(l=(a-e)></a)return!0;var></a)return!0;if(h=c*(o-t)+e,h></=this.maxy},e.prototype.aabbintersectssegment=function(t,e,i,n){var></=this.maxx&&e></o;s++)this.sortpathconstraintattachment(this.data.skins[s],n,r);var></e.bones.length;i++){var></300?i.rawassets[e]=json.parse(n.responsetext):i.errors[e]="couldn't></300?i.rawassets[e]=n.responsetext:i.errors[e]="couldn't></8;q++)g+=z,w+=v,z+=f,v+=k,x+=math.sqrt(g*g+w*w),j[q]=x;g+=z,w+=v,x+=math.sqrt(g*g+w*w),j[8]=x,g+=z+f,w+=v+k,x+=math.sqrt(g*g+w*w),j[9]=x,y=0}for(b*=x;;y++){var></f;v++,u+=6)r=u[u],p=u[u+1],o=u[u+2],b=u[u+3],d=u[u+4],m=u[u+5],l=.1875*(w-2*r+o),n=.1875*(i-2*p+b),f=.09375*(3*(r-o)-w+d),k=.09375*(3*(p-b)-i+m),z=2*l+f,v=2*n+k,g=.75*(r-w)+l+.16666667*f,w=.75*(p-i)+n+.16666667*k,e+=math.sqrt(g*g+w*w),g+=z,w+=v,z+=f,v+=k,e+=math.sqrt(g*g+w*w),g+=z,w+=v,e+=math.sqrt(g*g+w*w),g+=z+f,w+=v+k,e+=math.sqrt(g*g+w*w),s[v]=e,w=d,i=m;if(s&&(c*=e),o)for(var></-t.mathutils.pi&&(k+=t.mathutils.pi2),k*=i,z=math.cos(k),v=math.sin(k),x.a=z*m-v*n,x.b=z*l-v*f,x.c=v*m+z*n,x.d=v*l+z*f}x.appliedvalid=!1}}}},e.prototype.computeworldpositions=function(i,n,r,s,o){var></_;v++,r+=3){var></y;){var></-180&&(l+=360),i.updateworldtransformwith(p,m,nt+l*o,i.ascalex,i.ascaley,i.ashearx,i.asheary)},e})();t.ikconstraint=e})(n||(n={}));var></-180&&(m+=360),e.updateworldtransformwith(a,c,nt+m*o,e.ascalex,e.ascaley,0,0),nt=i.arotation,l=((l+it)*t.mathutils.raddeg-i.ashearx)*f+d-nt,l></=(q+k)></q&&(h=t.mathutils.pi,q=b,z=e);var></0&&(u=-u),u=-(g+u)></-180&&(u+=360),e.updateworldtransformwith(e.ax,e.ay,e.arotation+u*r,e.ascalex,e.ascaley,e.ashearx,e.asheary)},e.prototype.apply2=function(e,i,n,r,s,o){if(0==o)return></t.bones.length;i++)this.bones.push(e.findbone(t.bones[i].name));this.target=e.findbone(t.target.name)}return></0)throw></0:this.skeleton.flipx!=this.skeleton.flipy)&&(this.b=-this.b,this.d=-this.d))}this.skeleton.flipx&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipy&&(this.c=-this.c,this.d=-this.d)},e.prototype.settosetuppose=function(){var></d;t+=2,b+=8){var></i;c+=2,h+=8)this.worldvertices[h]=r+e[c+1]*o,this.worldvertices[h+1]=s+a-e[c]*a;else></i;r+=2,f+=2){var></e;u+=2){var></300?(n.assets[t]=r.responsetext,e&&e(t,r.responsetext)):(n.errors[t]="couldn't></t.length;i+=2){var></empty></=0){var></n)&&this.queue.complete(t);a<c;a++){var></c;a++){var></=90&&(math.abs(x)></l[0])return></n.eventthreshold?this.events:null,o=r<n.attachmentthreshold,a=r<n.draworderthreshold,c=n.animationlast,h=n.getanimationtime(),l=n.animation.timelines.length,u=n.animation.timelines,_=n.timelinesfirst,d=n.alpha*e.mixalpha*(1-r),f=0==n.timelinesrotation.length;f&&t.utils.setarraysize(n.timelinesrotation,l<<1,null);for(var></l;_++)u[_].apply(e,c,h,i,1,!0,!1);else{var></s;r++){var></n;i++){var></24)+this.pathconstraintindex},s.prototype.setframe=function(t,e,i,n){t*=s.entries,this.frames[t]=e,this.frames[t+s.rotate]=i,this.frames[t+s.translate]=n},s.prototype.apply=function(t,i,n,r,o,a,c){var></24)+this.pathconstraintindex},n.prototype.apply=function(t,i,r,s,o,a,c){var></24)+this.pathconstraintindex},s.prototype.setframe=function(t,e,i){t*=s.entries,this.frames[t]=e,this.frames[t+s.value]=i},s.prototype.apply=function(t,i,n,r,o,a,c){var></24)+this.transformconstraintindex},s.prototype.setframe=function(t,e,i,n,r,o){t*=s.entries,this.frames[t]=e,this.frames[t+s.rotate]=i,this.frames[t+s.translate]=n,this.frames[t+s.scale]=r,this.frames[t+s.shear]=o},s.prototype.apply=function(t,i,n,r,o,a,c){var></p;f++)h[f]=l[d[f]]},n})();t.drawordertimeline=d;var></24},n.prototype.getframecount=function(){return></h&&n></c[0])){var></f;y++){var></24)+this.slotindex},s.prototype.setframe=function(t,e,i){this.frames[t]=e,this.framevertices[t]=i},s.prototype.apply=function(i,n,r,s,o,a,c){var></24)+this.slotindex},n.prototype.getframecount=function(){return></24)+this.slotindex},s.prototype.setframe=function(t,e,i,n,r,o){t*=s.entries,this.frames[t]=e,this.frames[t+s.r]=i,this.frames[t+s.g]=n,this.frames[t+s.b]=r,this.frames[t+s.a]=o},s.prototype.apply=function(t,i,n,r,o,a,c){var></24)+this.boneindex},n.prototype.apply=function(t,i,r,s,o,a,c){var></24)+this.boneindex},s.prototype.apply=function(i,n,r,o,a,c,h){var></24)+this.boneindex},s.prototype.setframe=function(t,e,i,n){t*=s.entries,this.frames[t]=e,this.frames[t+s.x]=i,this.frames[t+s.y]=n},s.prototype.apply=function(t,i,n,r,o,a,c){var></1)}return></v;f+=2)p[f]=m,p[f+1]=g,_+=l,d+=u,l+=c,u+=h,m+=_,g+=d},e.prototype.getcurvepercent=function(i,n){n=t.mathutils.clamp(n,0,1);var></=0)throw></=r;n+=i)if(t[n]></=e?n=s+1:r=s,n==r)return(n+1)*i;s=n+r></l;h++)c[h].apply(t,e,i,r,s,o,a)},t.binarysearch=function(t,e,i){void></e.length;i++){var></c;a++){var></=n&&(r.length=n+1),i._replaceddisplaydataset.length<=n&&(i._replaceddisplaydataset.length=n+1),i._replaceddisplaydataset[n]=e,1==e.type){var></r;++n){var></a;++o){var></_;++l){if(o+a<=l&&u<s.length){var></2&&(n.tweeneasing=t.dragonbones.no_tween),s></m;++p){var></d;_+=2)if(!c||_<h||_-h></a;++h)s.zorder[h]=-1;for(var></d;_+=7){var></n.y?n.y=h:h></a;++o)this._isolddata&&this._armature.addslot(this._parseslot(r[o],s++)),n.addslot(this._parseslotdisplayset(r[o]));this._skin=null}return></c;++a){var></u;++l)h&&s[l]==h&&(s[l]=null)}else></r;++n){var></i;++e)this.actions[e].returntopool();for(var></r,u=l?e[o]:0,_=l?e[o+1]:0,d=e[o+2],f=e[o+3],p=e[o+4],m=e[o+5],g=l?e[o+6]:1,v=l?e[o+7]:1,y=0,x=1;x-y></=u&&(1==this.type?(e*=l></=l){var></t&&(i=!i)}s=n}}else{var></e&&a></=this.height)for(var></=this.width&&e></=e)){if(!o){g=i,v=r,y=i,x=r,_++,a&&(a.x=math.atan2(c-f,b-d)-.5*math.pi,a.y=a.x);break}var></=n||r></=f)&&(0==l||r></=c||r></=t)){var></=i||i></=d)&&(0==h||i></=b||i></0?-1:s<=p?0:1,i=e<0?-1:e<=p?0:1,r=w*i;if(r<0)return-1;0==r&&(w==-1?(c=2,i=t+e*m,n=(e+e*g)></c;if(_&&d)return-1;for(var></a&&r></c,d=n></a&&i></n?o|=4:e></s;++r)n[r].parent=t;delete></0||r.ik&&this._sortedbones.indexof(r.ik)<0||(r.ik&&r.chain></e;++t)this.actions[t].returntopool();this.framerate=0,this.type=-1,this.name=null,this.parent=null,this.userdata=null,this.aabb.clear(),this.actions.length=0,this.cacheframerate=0,this.scale=1;for(var></s;++r){var></0||this._displayindex></this._displaylist.length?this._displaydirty=this._display!=this._displaylist[this._displayindex]:this._displaydirty=null!=this._display,this._displaydirty},i.prototype._setzorder=function(t){return></n;++i){var></this._displaydataset.displays.length?this._displaydataset.displays[this._displayindex].mesh:null;var></c;++a)this._childarmature._bufferaction(o[a]);else></this._displaydataset.displays.length&&(this.origin.copyfrom(this._displaydataset.displays[this._displayindex].transform),this._origindirty=!0),this._updatemeshdata(!1),n!=this._rawdisplay&&n!=this._meshdisplay||this._updateframe(),this._childarmature!=i&&(i&&(i._parent=null,this.inheritanimation&&i.animation.reset()),this._childarmature&&(this._childarmature._parent=this,this.inheritanimation))){if(0==this._childarmature.cacheframerate){var></this._displaylist.length?(this._display=this._displaylist[this._displayindex],this._display></i;++e){var></r;++n){var></0&&(c=-c),(!g||c<h)&&(h=c,u=s.x,_=s.y,g=t,a&&(p=a.x))}if(o){var></s;++r){var></s;++r){var></1,n=0,r=e.length;n<r;++n){var></0&&(this._slotsdirty=!0,this._slots.push(t))},i.prototype._removeslotfromslotlist=function(t){var></0&&(this._bonesdirty=!0,this._bones.push(t))},i.prototype._removebonefrombonelist=function(t){var></0||r.ik&&this._bones.indexof(r.ik)<0||(r.ik&&r.ikchain></e;++t)this._bones[t].returntopool();for(var></e;++t)this._animatebles[t]=null},e._clock=null,e})();t.worldclock=e})(n||(n={}));var></0&&(this._animatebles.push(e),t.dragonbones.debug&&e></r;++i){var></s;++r)i._slotffdvertices[r]=i._ffdvertices[r]*n;else></o;++s)if(n._slotffdvertices[s]!=r[s]){n._tweenffd=1;break}},i.prototype._onupdateframe=function(t){var></=n._currenttransform.skewy){var></=h.position||r!=i._currentplaytimes)&&(h=h.prev)}if(i._isreverse)for(;h!=c;)i._oncrossframe(h),h=h.prev;else></0||t!=t)&&(t=0);var></o;++s){var></0&&this._animationdata.getbonetimeline(t)&&this._bonemask.push(t),e)for(var></=0||this._fadeprogress<=0)&&(this._fadeprogress=1e-6);for(var></0||t!=t)&&(t=0),this._ispauseplayhead=e,this._fadestate></u;++l){var></=0&&(this._fadeprogress=.999999),this._timeline=t.baseobject.borrowobject(t.animationtimelinestate),this._timeline.fadein(this._armature,this,this._animationdata,this._time),this._animationdata.zordertimeline&&(this._zordertimeline=t.baseobject.borrowobject(t.zordertimelinestate),this._zordertimeline.fadein(this._armature,this,this._animationdata.zordertimeline,this._time)),this._updatetimelinestates()},i.prototype._updateffdtimelinestates=function(){var></=e)if(i._fadestate></i;++e)t.push(this._animations[this._animationnames[e]]);return></e;++t)if(!this._animationstates[t].iscompleted)return!1;return!0}return!1},enumerable:!0,configurable:!0}),object.defineproperty(i.prototype,"lastanimationname",{get:function(){return></i;++e){var></0?this._duration=0:this._duration></0?this._duration=0:this._duration></v;++g){var></e;++t)this._animationstates[t].returntopool();this._isplaying=!1,this._lastanimationstate=null,this._animationstates.length=0},i.prototype.stop=function(t){if(void></=0?(h++,n.returntopool(),e._animationstatedirty=!0,e._lastanimationstate==n&&(c-h></i;++c){var></=0?(n.returntopool(),e._animationstates.length=0,e._animationstatedirty=!0,e._lastanimationstate=null):n._advancetime(t,1,0);></e;++t)this._animationstates[t].returntopool();this.timescale=1,this._animationstatedirty=!1,this._armature=null,this._isplaying=!1,this._time=0,this._duration=0,this._lastanimationstate=null,this._animationnames.length=0,this._animationstates.length=0},i.prototype._fadeout=function(t,e,i,n,r){var></s;++r){var></s;++r){var></=1||i._currentframe.next==i._timeline.frames[0]&&(i._tweeneasing!=t.dragonbones.no_tween||i._curve)&&i._animationstate.playtimes></=0)return></=0)return></=-r)?(e._iscompleted=!0,i=n,t=t<0?0:e._duration):(e._iscompleted=!1,t<0?(i=math.floor(-t></0&&(this.scaley=-this.scaley,this.skewx=this.skewx-math.pi),this},t.prototype.tomatrix=function(t){return></0&&(this.scalex=-this.scalex,this.skewy=this.skewy-math.pi),n></e?t.a></e?t.d></n){if(!(r.indexof(e)<0))throw></0&&t._armatures.push(e)},t.removearmature=function(e){if(e){var></-h&&(o.height=-h)}o.width-=o.x,o.height-=o.y,e.rect=o;var></c&&(o.width=c),o.y></-h&&(o.height=-h)}}else></c&&(o.width=c),o.y></n;i+=2){a=math.floor(i></-g&&(d.height=-g)}for(d.width-=d.x,d.height-=d.y,f=0,p=this._meshdata.vertexindices.length;f<p;++f)_.push(this._meshdata.vertexindices[f]);var></m&&(d.width=m),d.y></this._displaydataset.displays.length?this._displaydataset.displays[this._displayindex]:null,e=this._displayindex<this._replaceddisplaydataset.length?this._replaceddisplaydataset[this._displayindex]:null,i=e||t,n=i.texture;if(n){var></_;++u)h._bufferaction(l[u]);else></i;++e){var></0)&&(this.animationname=""),this._refresh()},visible:!1},_animationname:"",animationname:{get:function(){return></e;t++)o=s[t],o.child.setsiblingindex(o.index);this._syncchildrenorder()},_anchorchanged:function(){for(var></0)l._tryremovenode();else{n.push(h);var></this._detachedchildren.length;t++){var></i.length;n++){var></d.length;f++)_[d[f].getattribute("name")]=d[f].getattribute("value");var></o.length;l++)a[o[l].getattribute("name")]=o[l].getattribute("value");e.setproperties(a)}var></m.length;v++)g[m[v].getattribute("name")]=m[v].getattribute("value");i.properties=g}return></d.length;s++){var></f.length;r++)p[f[r].getattribute("name")]=f[r].getattribute("value");this.properties=p}}var></4;++z){switch(t[ht]=bt[z].x,t[ht+1]=bt[z].y,t[ht+2]=y,e[ht+3]=this._color[0],z){case></0){x=w;continue}}for(h></-ut){x+=math.floor(2*-nt></u;++j){for(x=v;x<w;++x)if(ht+24></24|k<<16|f<<8|n;var></-x-ot){w+=math.floor(2*(-x-tt)></z;++g){for(w=n;w<k;++w)if(u=it+w,a[u])h=a[u]._rendercmd,0===a[u]._localzorder&&h.rendering&&a[u]._visible&&(h.rendering(t,e,i),m.settransform(s,e,i),m.setglobalalpha(_));else></u&&a[v])h=a[v]._rendercmd,0===a[v]._localzorder&&h.rendering&&a[v]._visible&&h.rendering(t,e,i);else></=0)){var></i.height;o++)for(var></c;a++){var></l;h++){var></0||t.y<0)throw></0||t.y<0)throw></0||r.y<0)throw></0||e<0)throw></0||e<0)throw></a&&(s=o[r],s._localzorder<0);r++)s.visit(this);for(n.pushrendercommand(e);r<a;r++)s=o[r],c&&0===s._localzorder&&h[s.tag]?(isnan(s._customz)&&(s._vertexz=n.assignedz,n.assignedz+=n.assignedzstep),s._rendercmd.updatestatus()):s.visit(this)}else></d&&(m&&!f[_]&&(m=!1),m||!f[_]);++_)p={texid:e,x:0,y:0,width:n,height:r,t:0,l:0,r:0,b:0},t.rectforgid(_,p),p.x+=g,p.y+=g,p.width-=2*g,p.height-=2*g,p.t=p.y></d-2;o++)a=cc.psub(cc.v2(t[0]),cc.pmult(_[0].offset,c)),c=cc.psub(cc.v2(t[o+1]),cc.pmult(_[o+1].offset,c)),h=cc.psub(cc.v2(t[o+2]),cc.pmult(_[o+2].offset,c)),b.push(new></i.length;o++)r[o]=new></o;t++)c[t]=-1;h=-1,l=-1,u=0}},cc.gl.useprogram=s?function(t){t!==a&&(a=t,cc._rendercontext.useprogram(t))}:function(t){cc._rendercontext.useprogram(t)},cc.gl.deleteprogram=function(t){s&&t===a&&(a=-1),gl.deleteprogram(t)},cc.gl.setblending=function(t,e){var></u;it++)if(1===w[it]||2===w[it]){et=q[3+it]></=-1?o=-b+1:b=!0}else{for(var></=127?p=b+1:b></e;n+=12,r++){var></=4)return></=0)cc.logid(8001);else{if(t<=1)return></i;a++){var></t;o++)r[o]=new></u;a++)if(c=_[a],h=0|.5*c.size,l=c.color.a></this._elapsed&&this.stopsystem()}this._particleidx=0;var></this._totalparticles&&(this._emitcounter+=t);this.particlecount<this._totalparticles&&this._emitcounter></a.length;i++){var></e.length;++i){var></c;h++){var></s.length;o++){var></=t?++i:--i)n.push(this.data[this.pos++]);return></=t?i<t:i></=l?++d:--d)this.transparency.indexed.push(255);break;case></=l?d<l:d></=e?++_:--_)t.push(this.data[this.pos++]);break;case"trns":switch(this.transparency={},this.colortype){case></a;r++)t[4*r]=0,t[4*r+1]=x*r,t[2*(2*r+1)]=1,t[2*(2*r+1)+1]=x*r;this._previousnupoints=a}this._nupoints=a}},_createrendercmd:function(){return></this._minseg,m=cc.p(h[2*(a-2)],h[2*(a-2)+1]),g=1!==a&&cc.pdistancesq(m,this._positionr)<2*this._minseg;(p||g)&&(d=!1)}if(d){h[2*a]=this._positionr.x,h[2*a+1]=this._positionr.y,c[a]=1;var></n;i++)e[4*i]=t.r,e[4*i+1]=t.g,e[4*i+2]=t.b},reset:function(){this._nupoints=0},setposition:function(t,e){this.startingpositioninitialized=!0,void></=1)){e*=.5;for(var></t.w+e&&this.w></t.z+e&&this.z></t.y+e&&this.y></t.length;n++){var></t.z+e&&this.z></t.y+e&&this.y></t.x+e&&this.x></t.y+cc.math.epsilon&&this.y></e}}),{}],251:[(function(t,e,i){cc.math.vec2=function(t,e){void></l&&(c.x=a.x,c.y=a.y,l=o,n(t,e,h))),this.intersectlinesegment(e,i,a)&&(u=!0,o=a.subtract(this.start).length(),o<l&&(c.x=a.x,c.y=a.y,l=o,n(e,i,h))),this.intersectlinesegment(i,t,a)&&(u=!0,o=a.subtract(this.start).length(),o<l&&(c.x=a.x,c.y=a.y,l=o,n(i,t,h))),u&&(r.x=c.x,r.y=c.y,s&&(s.x=h.x,s.y=h.y)),u}}),{}],250:[(function(t,e,i){cc.math=cc.math||{},cc.math.epsilon=1></math.min(a,h)-cc.math.epsilon||s></math.min(o,c)-cc.math.epsilon||r></math.min(t.y,e.y)-cc.math.epsilon||s></cc.math.epsilon)&&(n=((_-l)*(a-u)-(d-u)*(o-l))></1e-6-1)if(math.abs(i.lengthsq())<cc.math.epsilon)o.rotationaxis(i,math.pi);else{var></cc.math.epsilon||e<2*math.pi+cc.math.epsilon&&e></=cc.math.epsilon)throw></-.001?cc.math.plane.point_behind_plane:cc.math.plane.point_on_plane}}),{}],248:[(function(t,e,i){cc.math.quaternion=function(t,e,i,n){t&&void></i[r]))return!1;return!0},cc.math.matrix4.createbyrotationx=function(t,e){e=e||new></d;r++)t.swap(r,m[s],r,p[s]);return!0};var></d;s++)t.swap(_,s,u,s);for(s=0;s<f;s++)e.swap(_,s,u,s)}if(m[i]=_,p[i]=u,0===t.get(u,u))return!1;for(l=1></n[r]))return!1;return!0},cc.math.matrix3.createbyrotationx=function(t){var></=e.max.z},cc.math.aabb.prototype.assignfrom=function(t){this.min.assignfrom(t.min),this.max.assignfrom(t.max)},cc.math.aabb.assign=function(t,e){return></=e.max.y&&t.z></=e.max.x&&t.y></=this.max.z},cc.math.aabb.containspoint=function(t,e){return></=this.max.y&&t.z></=this.max.x&&t.y></=cc.rectgetmaxy(t)},cc.rectintersectsrect=function(t,e){var></=cc.rectgetmaxx(t)&&e.y></=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectgetmaxx=function(t){return></t.y&&this.y+this.height></t.x&&this.x+this.width></t.y&&this.y+this.height></t.x&&this.x+this.width></t.y&&e.y+e.height></t.x&&e.x+e.width></e.y&&t.y+t.height></=1)},cc.pintersectpoint=function(t,e,i,n){var></=1&&r.y></e?e:t<i?t:i},cc.clamp01=function(t){return></16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},e.exports=cc.color}),{"..></16)+(r.b<<8)+this.a,this},o.tohsv=function(){return></e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);return></e.length;++i)e[i].length></8&&(t+="ff");var></8)></16)></24></16)+(~~i<<8)+~~n}r.extend(e,n),t("..></=this.i&&--this.i},r.push=function(t){this.array.push(t)},e.exports=n}),{}],225:[(function(t,e,i){cc._prefabinfo=cc.class({name:"cc.prefabinfo",properties:{root:null,asset:null,fileid:"",sync:!1,_synced:{default:!1,serializable:!1}}}),e.exports={syncwithprefab:function(t){var></=this.i&&--this.i},r.fastremove=function(t){var></e-r))return></=n;s=i+n></e;++t){var></e.length;i++){var></t.length;++n){var></=0?0:n+1,t.substring(0,n)+e+s+r},_normalize:function(t){var></0?t+e+n:t.substring(0,i)+e+n},changebasename:function(t,e,i){if(0===e.indexof("."))return></t;i++)e=(e+(""===e?"":"></=this._capacity,2911),0===e)return}else></s;n++)o[n]=new></this._totalquads,2909);var></this._totalquads,2908);var></this._totalquads,2907),cc.assertid(t></i;r++)this._quads[c+r]=new></=this._capacity,2906);var></this._capacity,2904),this._totalquads=math.max(e+1,this._totalquads),this._setquadtoarray(t,e),this.dirty=!0},insertquad:function(t,e){if(cc.assertid(e<this._capacity,2905),this._totalquads++,this._totalquads></e;r++)n[r]=new></e;i++)cc.macro.texture_atlas_use_triangle_strip?(t[6*i+0]=4*i+0,t[6*i+1]=4*i+0,t[6*i+2]=4*i+2,t[6*i+3]=4*i+1,t[6*i+4]=4*i+3,t[6*i+5]=4*i+3):(t[6*i+0]=4*i+0,t[6*i+1]=4*i+1,t[6*i+2]=4*i+2,t[6*i+3]=4*i+3,t[6*i+4]=4*i+2,t[6*i+5]=4*i+1)},initwithfile:function(t,e){var></t.length;i++)this._setquadtoarray(t[i],e+i)},_setquadtoarray:function(t,e){var></d;++n)s[3*n]=o></0;else></1|(o[n]></6|(o[n]></11|(o[n]></0;else></4|(o[n]></8|(o[n]></12|(o[n]></0;else></5|(255&a[n])></11|(255&a[n])></0;else></5|(o[n]></11|(o[n]></d;++n)s[n]=(o[n]></4;a++){s=e[a].getcontext("2d");for(var></cc.texture2d></g;v++,y+=2)t[m]=d[y],t[m+1]=d[y+1],t[m+2]=_,e[m+3]=s,t[m+4]=f[y],t[m+5]=f[y+1],m+=6;break;case></8)+((16711680&a)></16)+(l<<8)+h}else></3;++c)for(var></p;c++)f=t[a],p=t[a+1],m=t[a+6]-f,g=t[a+7]-p,p=-p-g,l=b[a]*v,u=b[a+7]*y,_=(b[a+6]-b[a])*v,d=(b[a+1]-b[a+7])*y,""!==this._texturetorender._pattern?(c.setfillstyle(h.createpattern(x,this._texturetorender._pattern)),h.fillrect(f,p,m,g)):_></3;++i)for(var></w;c++)h.moveto(t[a++],-t[a++]),h.lineto(t[a++],-t[a++]),h.lineto(t[a++],-t[a++]);h.clip(),""!==this._texturetorender._pattern?(c.setfillstyle(h.createpattern(x,this._texturetorender._pattern)),h.fillrect(f,p,m,g)):_></s.y||u></0?0:e,e-=t,p._rebuildquads_base(this,this._spriteframe,this._contentsize,this._filltype,t,e)):(this._istriangle=!0,this._rawverts||(this._rawverts=h.get(8)||new></0?0:t,e=e></0&&(t+=e,e=-e),this._filltype!==x.radial?(e=t+e,t=t></_&&(_=g,u[2]=2*p),g></c&&(h.put(s),s=h.get(c)||new></0&&(r+=math.pi),r}},_getinsectedpoints:function(t,e,i,n,r,s,o){var></=e+i},_getvertangle:function(t,e){var></e&&(t+=n),t></=r||(e<=m?(this._generatetriangle(_,t,p,this._intersectpoint_1[c],this._vertpos[a[1]]),t+=6,b+=3):(this._generatetriangle(_,t,p,this._intersectpoint_1[c],this._intersectpoint_2[c]),t+=6,b+=3))),s+=2*math.pi,e+=2*math.pi}}t._vertcount=b,u[0]=0,u[1]=2,u[2]=4,u[3]=6},_generatetriangle:function(t,e,i,r,s){var></s&&(e+=2*math.pi),s-=2*math.pi,e-=2*math.pi;for(var></x&&(h.put(o),o=h.get(x)||new></v[0].x&&(p.x=v[0].x),p.y<v[0].y&&(p.y=v[0].y),p.y></0;)r+=1;var></0?0:s,o=o<0?0:o,a=s+o,a=a></8&&(h.put(p),p=h.get(8)||new></a&&(h.put(c),c=h.get(a)||new></0?0:x,t=t<0?0:t;var></8&&(h.put(l),l=h.get(8)||new></m;++_)d=p[_],t[g]=d.x,t[g+1]=d.y,t[g+2]=f,e[g+3]=s,t[g+4]=d.u,t[g+5]=d.v,g+=6;return></8)+((16711680&a)></16)+(l<<8)+h}else></24></0||e.y<0)},_ccsg.sprite.canvasrendercmd._cutrotateimagetocanvas=function(t,e,i){if(!t)return></n;++i)r=o[i],r._needdraw&&(r.uploaddata?this._uploadbufferdata(r):(l></c;d+=4)f=l+d,g[u++]=f+0,g[u++]=f+1,g[u++]=f+2,g[u++]=f+1,g[u++]=f+2,g[u++]=f+3;break;case></t;n+=4)r=l+n,g[u++]=r+0,g[u++]=r+1,g[u++]=r+2,g[u++]=r+1,g[u++]=r+2,g[u++]=r+3;break;case></s;r+=6)g[r]=n+0,g[r+1]=n+1,g[r+2]=n+2,g[r+3]=n+1,g[r+4]=n+2,g[r+5]=n+3,n+=4;e.bufferdata(e.element_array_buffer,g,e.dynamic_draw)}if(c){f=t*_;var></l;++h){var></e;t++){var></e-1;h++){var></i;r++)this.dirtylist[r].intvalues();return></e;i++)r(t[i]);t.length=0},l.getdirtyregions=function(){var></0&&(e=0),i<0&&(i=0),r></b?v:b)-1,s=(x></t?g:t)-1,r=(y></t._maxy?this._maxy:t._maxy,e<=i)},a.updateregion=function(t,e){if(0===t.width||0===t.height)return></t._maxx?this._maxx:t._maxx;return!(e></t._maxx&&(this._maxx=t._maxx),this._maxy<t._maxy&&(this._maxy=t._maxy),void></e._minx?t._minx:e._minx,n=t._miny<e._miny?t._miny:e._miny,r=t._maxx></e.length){if(this._cleanup&&this._cleanup(t)===!1)return;e[this.count]=t,++this.count}},m.pool=f,cc.js=m,e.exports=m}),{"..></e;++n)r+="></i;e+=1)n[e]=t[e];return></t.length;i++)if(!(t[i]instanceof></this._exps.length;i++){var></s;++r)this.objstoclear_in$t[r]._in$t=null;this.objstoclear_in$t.length=0}function></t.length;u++)s=t[u],"object"==typeof></=h;){var></e.length;++r){var></t.length;a++)e=t[a],i=e._point,n=e._prevpoint,i.x=(i.x-r.x)></t;++e){var></=50?i.push(t):(i[this._pretouchpoolpointer]=t,this._pretouchpoolpointer=(this._pretouchpoolpointer+1)%50))},gettouchbyxy:function(t,e,i){var></c;a++)e=t[a],n=e.getid(),i=o[n],null!=i&&s[i]&&(s[i]._setpoint(e._point),s[i]._setprevpoint(e._prevpoint),r.push(s[i]),this._removeusedindexbit(i),delete></c;a++)e=t[a],n=e.getid(),i=this._touchesintegerdict[n],null!=i&&s[i]&&(s[i]._setpoint(e._point),s[i]._setprevpoint(e._prevpoint),s[i]._lastmodified=o,r.push(s[i]));if(r.length></t;e=~e,this._indexbitsused&=e}},_glview:null,handletouchesbegin:function(t){for(var></0||t></t.length;++e){var></r.length;++c){var></c;u++)a+="cs["+u+l}h&&(a+="}catch(e){\ncc._throw(e);\n}\n")}return></s.length;e++)r+=s[e],e<s.length-1&&(r+=",")}else></i;e++){var></o.length;c++){for(var></o.length;a++)for(var></l-1?i+1:0,s(t[e].x,t[e].y,t[r].x,t[r].y,t[i].x,t[i].y,t[n].x,t[n].y)&&(u=1)));c||(_=!0)}return></l;i++)i!=e&&i!=r&&(c||(a=h(t[e].x,t[e].y,t[r].x,t[r].y,t[i].x,t[i].y),a></.1}return></.1&&s<.1}function></=e&&e<=s+.1;return></=t&&t<=r+.1,a=n+.1></0?s=n-1:s--}for(w=w.reverse(),e=-1,s=m;;){if(s==t){(e<0||e></f;d++){var></t.length;++e){var></_&&u.push(this)},cc.loadingitems=e.exports=g}),{"..></t.length;++i)if(o=t[i],!o.queueid||this.map[o.id]){if(n(o)){a=r(o,this._id);var></a;o++){var></i.length;n++){var></s.length;++c){var></t.length;++o){var></_;)o*=i></=8202||8232===t||8233===t||8239===t||8287===t||12288===t},fragmenttext:function(t,e,i,n){var></=13||32===t||133===t||160===t||5760===t||t></24|r<<16|r<<8|r;var></u||s></this._splitedstrings.length;++r){if(this._node.isoutlined()){var></e.length;++r)o<n[r]&&(o=n[r]);var></=0){cc.logid(4003);break}for(t._fontsize=h,i=this._constructfontdesc(),this._labelcontext.font=i,this._splitedstrings=[],s=0,r=0;r<e.length;++r){var></t;++n){var></this._numberoflines;++t)this._linesoffsetx.push(0);break;case></=0)break;var></0)){t=!0;break}}else></this.getstringlength();++e)if(this._lettersinfo[e]._valid){var></-this._textdesiredheight&&(this._tailoredbottomy=this._textdesiredheight+h),!0},_multilinetextwrapbyword:function(){return></=0&&(c.width=parsefloat(s.tofixed(2))),this._labelheight<=0&&(c.height=parsefloat(this._textdesiredheight.tofixed(2))),_ccsg.node.prototype.setcontentsize.call(this,c),this._tailoredtopy=c.height,this._tailoredbottomy=0,c></o&&(s=o),_+=f)}else></p&&(c=p),h></this._horizontalkernings.length&&t<e-1&&(v+=this._horizontalkernings[t+1]),v+=l._xadvance*this._bmfontscale+this._spacingx,g=u.x+l._width*this._bmfontscale,p<u.y&&(p=u.y),m></e;){var></0&&(this._reusedrect.height=this._reusedrect.height+p)}else></this._tailoredbottomy&&(this._reusedrect.height=n<this._tailoredbottomy?0:n-this._tailoredbottomy)}var></this._string.length;++e)if(this._lettersinfo[e]._valid){var></0;return></_;u++){var></this._specialsymbolarray.length;++e){var></i;){var></=f;d++)p=r+m*(d></0;)m+=2*o;else></this._tesstol*(b*b+c*c))return></t;s++){var></1&&(_.flags|=e.pt_innerbevel),_.flags&e.pt_corner&&(p*i*i<1||e===h.bevel||e===h.round)&&(_.flags|=e.pt_bevel),0!==(_.flags&(e.pt_bevel|e.pt_innerbevel))&&a.nbevel++,u=_,_=c[f+1]}}},w._vset=function(t,e){var></o;s++){var></o;s++)r[s]=e[s];this._indicesbuffer=r}},w._pushcmd=function(t){var></o;s++)r[s]=i[s];this._vertsbuffer=r}},w._allocindices=function(t){var></o;s++){var></h;c++){var></(i.next.x-i.x)*(s-i.y)></0||t(t,t.next,e)<0}function></0?t(t,e,t.next)></8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function></=n.z?(r=i,i=i.nextz,a--):(r=n,n=n.nextz,c--):(r=i,i=i.nextz,a--),s?s.nextz=r:t=r,r.prevz=s,s=r;i=n}s.nextz=null,h*=2}while(o></h&&(a++,n=n.nextz,n);e++);for(c=h;a></u?r:o,s,l,u,s<u?o:r,s,n.x,n.y)&&(c=math.abs(s-n.y)></n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return></=r&&a></a;o++)c=e[o]*n,h=o<a-1?e[o+1]*n:t.length,l=r(t,c,h,n,!1),l===l.next&&(l.steiner=!0),u.push(v(l));for(u.sort(_),o=0;o<u.length;o++)d(u[o],i),i=s(i,i.next);return></=_;){if(d!==t.prev&&d!==t.next&&y(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&t(d.prev,d,d.next)></s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x></i;s+=n)o=i(s,t[s],t[s+1],o);else></s;g+=i)f=t[g],p=t[g+1],f<h&&(h=f),p<l&&(l=p),f></a.length;++n)if(i=a[n],i._istargetactive(e.type)&&i._bubblinglisteners&&(e.currenttarget=i,i._bubblinglisteners.invoke(e),e._propagationstopped))return></r&&(a=i[n],a&&a.getlocalzorder()<0);n++)this._visittarget(a,!1);for(void></t.gt0index;++c)if(r=o[c],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}if(a&&!s)for(n=0;n<a.length;n++)if(r=a[n],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}if(o&&!s)for(;c<o.length;++c)if(r=o[c],r.isenabled()&&!r._ispaused()&&r._isregistered()&&e(r,i)){s=!0;break}},_setdirty:function(t,e){var></n.length;o++)if(t.currenttouch=n[o],this._dispatcheventtolisteners(e,this._ontoucheventcallback,s),t.isstopped())return;i&&r.length></s;r++)this._forceaddeventlistener(n[r]);this._toaddedlisteners.length=0}0!==this._toremovedlisteners.length&&this._cleantoremovedlisteners();></s.length;)i=s[e],i._isregistered()?++e:(cc.js.array.remove(s,i),n=o.indexof(i),n!==-1&&o.splice(n,1));if(r)for(e=0;e<r.length;)i=r[e],i._isregistered()?++e:(cc.js.array.remove(r,i),n=o.indexof(i),n!==-1&&o.splice(n,1));s&&0===s.length&&t.clearscenegraphlisteners(),r&&0===r.length&&t.clearfixedlisteners()},frameupdatelisteners:function(){var></e;++i)t+="●";this._textlabel&&this._textlabel.setstring(t)}else></0&&(t=65535),this._maxlength=t,this._rendercmd.setmaxlength(t))},getmaxlength:function(){return></s&&e.y<i*r){var></l[t];if(this._scrolleventemitmask&e)return;this._scrolleventemitmask|=e}cc.component.eventhandler.emitevents(this.scrollevents,this,l[t]),this.node.emit(t,this)},_adjustcontentoutofboundary:function(){if(this._outofboundaryamountdirty=!0,this._isoutofboundary()){var></this._rightboundary&&(e.x=this._rightboundary-(this._getcontentrightboundary()+t.x)),this._getcontenttopboundary()+t.y<this._topboundary?e.y=this._topboundary-(this._getcontenttopboundary()+t.y):this._getcontentbottomboundary()+t.y></=0||t></0&&this._dispatchevent("bounce-left"),this._isbouncing=!0),!0},_processinertiascroll:function(){var></0&&this._dispatchevent("bounce-bottom"),t.x></i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gathertouchmove:function(t){for(t=this._clampdelta(t);this._touchmovedisplacements.length></0){var></t.height?(r=e.height-t.height,n.y=i-r,this.verticalscrollbar&&this.verticalscrollbar.hide()):this.verticalscrollbar&&this.verticalscrollbar.show(),e.width<t.width?(r=e.width-t.width,n.x=s,this.horizontalscrollbar&&this.horizontalscrollbar.hide()):this.horizontalscrollbar&&this.horizontalscrollbar.show(),this._movecontent(n),this._adjustcontentoutofboundary()},_calculateboundary:function(){if(this.content){var></=0)&&!this._touching&&(this._autohideremainingtime-=t,this._autohideremainingtime<=this.autohidetime)){this._autohideremainingtime=math.max(0,this._autohideremainingtime);var></=e.width&&this.direction===r.horizontal||t.height<=e.height&&this.direction===r.vertical},_ontouchended:function(){if(this.enableautohide&&(this._touching=!1,!(this.autohidetime<=0))){if(this._scrollview){var></i&&(n=t.charat(s),!cc.textutils.isunicodespace(n)&&!cc.textutils.isunicodecjk(n));++s)r++;return></c.length-1&&this._updatelineinfo();else{if(this._islastcomponentcr(a)&&h==c.length-1)continue;this._updatelineinfo(),r=!0}}}r||this._lineswidth.push(this._lineoffsetx),this.maxwidth></c.length-1&&this._updatelineinfo()}else></this._textarray.length;++s){var></l.length-1&&this._updatelineinfo()}else></l.length;++u){var></=this.maxwidth;){var></this._labelsegments.length;++i){var></color=#0fffff></s;++r)t.addchild(n[r]);var></e.length;++i)t[i]||(t[i]=this._createindicator());else{var></t.length;++i){var></this._pages.length){if(this._isscrollable(i,r,s))return></0?1:-1:void></t;++i)this._pages[i].setsiblingindex(i),this.direction===r.horizontal?this._scrollcenteroffsetx[i]=math.abs(this.content.x+this._pages[i].x):this._scrollcenteroffsety[i]=math.abs(this.content.y+this._pages[i].y);this.indicator&&this.indicator._refresh()},_updateallpagessize:function(){if(this.sizemode===n.unified)for(var></i;e++)this.content.removechild(t[e]);this._pages.length=0,this._updatepageview()}},scrolltopage:function(t,e){t<0||t></0||t></1}},__preload:function(){this._refreshstencil()},onenable:function(){this._super(),this.node.on("size-changed",this._refreshstencil,this),this.node.on("anchor-changed",this._refreshstencil,this)},ondisable:function(){this._super(),this.node.off("size-changed",this._refreshstencil,this),this.node.off("anchor-changed",this._refreshstencil,this)},_calculatecircle:function(t,e,i){for(var></3?3:t,this._refreshstencil()},type:cc.integer,tooltip:!1},_resizetotarget:{animatable:!1,set:function(t){t&&this._resizenodetotargetnode()}}},statics:{type:r},_resizenodetotargetnode:!1,_createsgnode:function(){return></0&&(h*=-1),s=-t.y*h,this.verticaldirection===o.top_to_bottom&&(n=-1,s=(1-t.y)*h)}this._dolayouthorizontally(i,!0,c,!0),this.resizemode===r.container&&this.node.setcontentsize(i,h)},_dolayoutgridaxisvertical:function(t,e){var></v&&(v=w)):(v=v||-this.node._contentsize.width,w=e+i*(r*y+this.paddingright),w></-c.y*t;(a||s)&&(h.width></v&&(v=w)):(v=v||-this.node._contentsize.height,w=e+i*(r*y+this.paddingtop),w></-c.x*t;(a||s)&&(h.height></n;i++)e[i]=arguments[i+1];for(i=0,n=t.length;i<n;i++){var></i;++e){var></"+t+"></this._clips.length;++i){var></o;s++){var></i;e++){var></i.length;++t.i){var></0?this._neg.array:this._pos.array,r=n(i,t);r<0&&i.splice(~r,0,t)}},remove:function(t){var></n))return></i)r=o+1;else{var></=s;o=r+s></(l-c)*(r-h)></n;++i)if(u(e[i],t))return!0;return!!u(r,e)||(!!u(o,e)||(!!u(a,e)||!!u(c,e)))}function></=h&&s></s.length;o++)t.lineto(s[o].x,s[o].y);t.close(),t.stroke()}}else></r;n++)this.removecollider(i[n]),this.addcollider(i[n])},drawcolliders:function(){var></p&&(p=v.y)}n.x=f,n.y=p,n.width=m-f,n.height=g-p}},addcollider:function(t){var></f&&(f=v.x),v.y></o;++s)i=e[s],c[a]=i,a++,i._rendercmd.transform(r);_ccsg.node._performing--}cc.customrendercmd=function(t,e){this._needdraw=!0,this._target=t,this._callback=e},cc.customrendercmd.prototype.rendering=function(t,e,i){this._callback&&this._callback.call(this._target,t,e,i)};var></a&&(s=o[r],s._localzorder<0);r++)s.visit(this);for(n.pushrendercommand(e);r<a;r++)o[r].visit(this)}else></e.length;i++){var></o;++s)n=i[s],c.push(n);a++,r=c[a]}switch(t){case></n[e]._localzorder)n[e+1]=n[e];else{if(!(i._localzorder===n[e]._localzorder&&i._arrivalorder<n[e]._arrivalorder))break;n[e+1]=n[e]}e--}n[e+1]=i}this._reorderchilddirty=!1}},draw:function(t){},transformancestors:function(){null!==this._parent&&(this._parent.transformancestors(),this._parent.transform())},onenter:function(){this._istransitionfinished=!1,this._running=!0,this.resume()},performrecursive:function(t){var></e.length;i++){var></e.length;i++){var></t.length;e++)this.resumetarget(t[e])},pausetarget:function(t){cc.assertid(t,1503);var></=0)for(i=0;i<this._updates0list.length;i++)a=this._updates0list[i],a&&(a.paused=!0,r.push(a.target));for(i=0;i<this._updatesposlist.length;i++)a=this._updatesposlist[i],a&&a.priority></r.length;++s){var></=0)for(e=0;e<this._updates0list.length;)s=this._updates0list.length,r=this._updates0list[e],r&&this.unscheduleupdate(r.target),s==this._updates0list.length&&e++;for(e=0;e<this._updatesposlist.length;)s=this._updatesposlist.length,r=this._updatesposlist[e],r&&r.priority></0)for(e=0;e<this._updatesneglist.length;)s=this._updatesneglist.length,r=this._updatesneglist[e],r&&r.priority></o;s++)n.put(r[s]);r.length=0,this._currenttarget===i?this._currenttargetsalvaged=!0:this._removehashelement(i)}this.unscheduleupdate(t)}},unscheduleall:function(){this.unscheduleallwithminpriority(cc.scheduler.priority_system)},unscheduleallwithminpriority:function(t){var></r&&(t._scheduler=t._target=t._callback=null,_.push(t))};var></t[i]._localzorder)t[i+1]=t[i];else{if(!(n._localzorder===t[i]._localzorder&&n._sgnode._arrivalorder<t[i]._sgnode._arrivalorder))break;t[i+1]=t[i]}i--}t[i+1]=n}this.emit(f)}cc.director.__fastoff(cc.director.event_after_update,this.sortallchildren,this)}},_delaysort:function(){this._reorderchilddirty||(this._reorderchilddirty=!0,cc.director.__faston(cc.director.event_after_update,this.sortallchildren,this))},_updatedummysgnode:function(){var></r;e++){for(n=t[e],i=e-1;i></o.length;a++){var></l.index;++_,u=u.parent);if(u===l.node){var></s;r++)e=n[r]._sgnode,e._arrivalorder=r,cc.eventmanager._setdirtyfornode(e);cc.renderer.childrenorderdirty=!0,i._sgnode._reorderchilddirty=!0,i._delaysort()},_onpredestroy:function(){var></i.length;o++)document.addeventlistener(i[o],(function(e){var></n.length;i++)e(n[i])}};cc.director._getinstance().on(cc.director.event_projection_changed,(function(){for(var></e.length;i++){var></i.length;n++)this._glextensions+=i[n]+"></ft;++dt)pt[dt]=5;s(pt);var></ut;++lt)_t[lt]=143></24|r[this.c++]<<16|r[this.c++]<<8|r[this.c++])></a.length?a.length+r:a.length<<1):n=a.length*s,t?(e=new></=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.f=function(){var></q[s]&&(a+=f(this,q[s])),r=p(this,e),o=j[r],0<k[r]&&(o+=f(this,k[r])),n+a></=this.e;)this.e-=8,this.c--;this.b=n},d.prototype.i=function(t,e){var></q[s]&&(a+=f(this,q[s])),r=p(this,e),o=j[r],0<k[r]&&(o+=f(this,k[r])),n></et;++tt)nt[tt]=5;var></w;++g)$[g]=143></8,o=i[n++],o===v&&t(error("invalid></24|m[1]<<16|m[0];var></d&&0===y[d-1];d--);for(z=u(k),j.d(r-257,5,y),j.d(o-1,5,y),j.d(d-4,4,y),w=0;w<d;w++)j.d(y[w],3,y);for(w=0,u=e.length;w<u;w++)if(v=e[w],j.d(z[v],k[v],y),16<=v){switch(w++,v){case></z&&(k=z-3),it[q++]=16,it[q++]=k-3,nt[16]++,z-=k}for(e=t?it.subarray(0,q):it.slice(0,q),k=l(nt,7),w=0;19></z--;)it[q++]=et[h],nt[et[h]]++;else></z&&(k=z-3),10></z--;)it[q++]=0,nt[0]++;else></m;++p)g[x++]=a[p];g.length=x}this.b=x,this.a=g}break;case></s;){i=t?o.subarray(r,r+65535):o.slice(r,r+65535),r+=i.length;var></this.length&&s[n+2]></i&&(n=this.getparent(i),s[i]></=1,s|=1&a,--e;c[b]=(s<<e&255)></this.i&&(e[i]<<=8-this.i,e[i]=w[e[i]],i++),t?t=e.subarray(0,i):(e.length=i,t=e),t};var></e|t,o+=e;else></8|w[t></16|w[t></t;)switch(n=p(this,e)){case></u;)n=c[h++],n===v&&t(error("input></i;)n=o[a++],n===v&&t(error("input></n;i++)for(h=c[e[i]],c[e[i]]+=1,r=o[i]=0,s=e[i];r<s;r++)o[i]=o[i]<<1|1&h,h></i&&t("overcommitted"),h<<=1;for(65536></c;++a)u[n[a].index]=o[a];return></g;++_)x[_]=e;for(f=0;f<v[e-1];++f)b[e-1][f]=s[f],c[e-1][f]=f;for(_=0;_<e;++_)a[_]=0;for(1===y[e-1]&&(--x[0],++a[e-1]),d=e-2;0<=d;--d){for(p=_=0,m=a[d+1],f=0;f<v[d];f++)p=b[d+1][m]+b[d+1][m+1],p></u.length?(d=i[r-1],p[m++]=d,++x[d],n(u,0)):n(_,-1):u.length<c?_=u:n(u,0)}else></o&&i[a+w]===i[r+w];)++w;if(w></c;++o)d=i[r+o],p[m++]=d,++x[d];break}if(0<l.length){var></s;++r){for(o=h=0,c=3;o<c&&r+o!==s;++o)h=h<<8|i[r+o];if(f[h]===v&&(f[h]=[]),l=f[h],!(0<g--)){for(;0<l.length&&32768<r-l[0];)l.shift();if(r+3></h;++c)p[m++]=s[c];x[s[0]]++,b[s[3]]++,g=e.length+i-1,_=null}var></e;h+=s)i[h]=n<<16|c;++r}++n,r<<=1,s<<=1}return[i,u,_]}function></_&&(_=t[c]);for(e=1<<u,i=new(t?uint32array:array)(e),n=1,r=0,s=2;n<=u;){for(c=0;c<l;++c)if(t[c]===n){for(o=0,a=r,h=0;h<n;++h)o=o<<1|1&a,a></=this.index&&t(error("invalid></a;){r=1024<a?1024:a,a-=r;do></8):c=this.readbits(cc.codec.gzip.cpdext[a]),c+=cc.codec.gzip.cpdist[a];r--;){var></r;n++)this.literaltree[n]=new></8):c=this.readbits(cc.codec.gzip.cpdext[a]),c+=cc.codec.gzip.cpdist[a],a=0;a<r;a++){var></256)this.addbuffer(a);else{if(256===a)break;var></1|this.readbit()):(a-=48,a></1|this.readbit(),a></17;r++)this.fpos[r]=0;return></1|this.readbit();return></8*n;return></6|a,c.push(string.fromcharcode(e)),64!==o&&c.push(string.fromcharcode(i)),64!==a&&c.push(string.fromcharcode(n));return></4|o></8*n;return></8*n;return></n;r++)i[r].visit(e)}cc.renderer.pushrendercommand(this._aftervisitcmd),this._dirtyflag=0},s.setstencil=function(t){var></r;i++)n[i].visit(e);e._stencil&&cc.renderer.pushrendercommand(this._rendererrestorecmd),this._dirtyflag=0}}}),{}],28:[(function(t,e,i){function></n;i++)t=e[i],t&&t._visible&&t.visit(this);this._rendercmd._dirtyflag=0},getalphathreshold:function(){return></=i.length){var></0&&(t%=r,0!==t&&(t+=r));return></0&&(l*=-1),a></0&&this.emit("lastframe",this):this._lastwrappedinfo.direction></this.points.length;e++){var></l;m++){var></0&&(u=~u),b-=u></0)v=f.beziers[0],w=(0-b)*v.getlength(),g=v.start.sub(v.endctrlpoint).normalize(),z=v.start.add(g.mul(w));else></l;m++){var></.5?.5*r.bouncein(2*t):.5*r.bounceout(2*t-1)+.5},r.bounceoutin=n(r.bouncein,r.bounceout),cc.easing=e.exports=r}),{}],19:[(function(t,e,i){t(".></=0?0:t></=s&&s<=1?0<=o&&o<=1?0<=l&&l<=1?h(s,o,l):h(s,o):0<=l&&l<=1?h(s,l):s:0<=o&&o<=1?0<=l&&l<=1?h(o,l):o:l}if(0===o)return></t.length;s++){var></i.length;++e.i){var></n;r++){var></i;e++)t[e]=arguments[e];cc.director.getanimationmanager().pushdelayevent(this,"_emit",t)},this._clip=t,this._name=e||t.name}var></i.length;r++)for(var></n)}this._lastwrappedinfo.set(r)},_fireevent:function(t){if(!(t<0||t></n-1&&((l&o.pingpong)===o.pingpong?c*=-1:f=-1,d++),f===h)break;if(d></c?a:~(a+1)}}),u=function(){this.events=[]};u.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var></d.length-1;m++){var></n;i++){var></i;e++){var></r;n++)if(i[n]===t){i.splice(n,1);break}this._putelement(t),e=!0}return></t.length;i++)if(e===t[i].target)return></n&&r[s]<=t;s++)_currframeindex=s,this.target.setspriteframe(i[_currframeindex].getspriteframe()),this._nextframe=s+1},reverse:function(){var></s.length;o++){var></-180&&(this._deltay+=360)},update:function(t){t=this._computeeasetime(t),this.target.skewx=this._startskewx+this._deltax*t,this.target.skewy=this._startskewy+this._deltay*t}}),cc.skewto=function(t,e,i){return></-180&&(this._deltax+=360),this._startskewy=t.skewy%360,this._deltay=this._endskewy-this._startskewy,this._deltay></-180&&(n+=360),this._diffangley=n},reverse:function(){cc.logid(1016)},update:function(t){t=this._computeeasetime(t),this.target&&(this.target.rotationx=this._startanglex+this._diffanglex*t,this.target.rotationy=this._startangley+this._diffangley*t)}}),cc.rotateto=function(t,e,i){return></-180&&(i+=360),this._startanglex=e,this._diffanglex=i,this._startangley=t.rotationy%360;var></e.length;n++)null!=e[n]&&(i=cc.spawn._actiononetwo(i,e[n]));return></r&&(this._one=cc.sequence._actiononetwo(t,cc.delaytime(r-n))),i=!0),i},clone:function(){var></i;s++)e[s]&&(n=r,r=cc.spawn._actiononetwo(n,e[s]));this.initwithtwoactions(r,e[i])}},initwithtwoactions:function(t,e){if(!t||!e)throw></n&&(e.update(1),this._total++),this._actioninstant||(this._total===n?e.stop():e.update(t-(r-e._duration></n;)e.update(1),this._total++,e.stop(),e.startwithtarget(this.target),r+=e._duration></=i;r++)e[r]&&(n=cc.sequence._actiononetwo(n,e[r]))}return></i;s++)e[s]&&(n=r,r=cc.sequence._actiononetwo(n,e[s]));this.initwithtwoactions(r,e[i])}},initwithtwoactions:function(t,e){if(!t||!e)throw></=0?(cc.logid(1013),this):(this._speedmethod=!0,this._speed*=t,this)},getspeed:function(){return></this._easelist.length;e++)t._easelist.push(this._easelist[e].reverse())}},clone:function(){var></t.length;i++)e.push(cc.p(t[i].x,t[i].y));return></arguments.length;++e)t.push(arguments[e]);cc.assert.apply(null,t)}),"assert");cc.assertid=function(t){"use></0)&&(t[e.rendermode]=0),cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!1,0===i?cc.sys.capabilities.opengl?(cc._rendertype=cc.game.render_type_webgl,cc._supportrender=!0):cc.sys.capabilities.canvas&&(cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!0):1===i&&cc.sys.capabilities.canvas?(cc._rendertype=cc.game.render_type_canvas,cc._supportrender=!0):2===i&&cc.sys.capabilities.opengl&&(cc._rendertype=cc.game.render_type_webgl,cc._supportrender=!0)}function></i.length;s++)n(i[s]);return>